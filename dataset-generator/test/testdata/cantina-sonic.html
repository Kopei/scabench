<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" imageSrcSet="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F7a499fdf-33f5-465b-70cf-0d96eb6f9700%2Fpublic&amp;w=128&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F7a499fdf-33f5-465b-70cf-0d96eb6f9700%2Fpublic&amp;w=256&amp;q=75 2x"/><link rel="preload" as="image" imageSrcSet="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=128&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=256&amp;q=75 2x"/><link rel="preload" as="image" imageSrcSet="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2Fd5e6d378-e0c9-47e8-66eb-fba7e9ce9700%2Fpublic&amp;w=128&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2Fd5e6d378-e0c9-47e8-66eb-fba7e9ce9700%2Fpublic&amp;w=256&amp;q=75 2x"/><link rel="stylesheet" href="/_next/static/css/fb86f50bcce31023.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/309a978ed622eb10.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/4cf557a5ae63a804.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/efc7064ad17e3280.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-29f04d04c6930a1b.js"/><script src="/_next/static/chunks/87c73c54-f0b7c0d74b9f13e8.js" async=""></script><script src="/_next/static/chunks/2855-a1307a9d12952fcb.js" async=""></script><script src="/_next/static/chunks/main-app-74dc6dbdd2181cad.js" async=""></script><script src="/_next/static/chunks/4624-a3449603f7c3cd66.js" async=""></script><script src="/_next/static/chunks/6453-0d300afee42e0695.js" async=""></script><script src="/_next/static/chunks/5052-a047dafa444d349c.js" async=""></script><script src="/_next/static/chunks/8327-7278f26c255e44b8.js" async=""></script><script src="/_next/static/chunks/3914-b0738fd108b57eb1.js" async=""></script><script src="/_next/static/chunks/1290-46f05f37548bb0d6.js" async=""></script><script src="/_next/static/chunks/5595-84b7fc765ce8ce8c.js" async=""></script><script src="/_next/static/chunks/3054-c7ce83b7f9da81cf.js" async=""></script><script src="/_next/static/chunks/3978-061c41faaf17e980.js" async=""></script><script src="/_next/static/chunks/2718-de2ada3c43de8199.js" async=""></script><script src="/_next/static/chunks/6110-03a4130b17b010cf.js" async=""></script><script src="/_next/static/chunks/3860-601782eebaad6434.js" async=""></script><script src="/_next/static/chunks/2556-058a46ae1a312246.js" async=""></script><script src="/_next/static/chunks/6372-b1ed2f35068abe95.js" async=""></script><script src="/_next/static/chunks/4313-11f54c31ec5a8b0d.js" async=""></script><script src="/_next/static/chunks/2043-e93b3391f0f1c061.js" async=""></script><script src="/_next/static/chunks/1060-386c0b2232eaae96.js" async=""></script><script src="/_next/static/chunks/app/layout-cb19078f157f53f7.js" async=""></script><script src="/_next/static/chunks/db261188-e9f8aa6e4a0a2c21.js" async=""></script><script src="/_next/static/chunks/2d4f24d4-f5eb412bce79db6b.js" async=""></script><script src="/_next/static/chunks/3933-accd40f4f0e408ea.js" async=""></script><script src="/_next/static/chunks/4041-c8b70b1d1cd54479.js" async=""></script><script src="/_next/static/chunks/3414-91e4f91e8f4dab55.js" async=""></script><script src="/_next/static/chunks/7514-8ba291b301c2af6a.js" async=""></script><script src="/_next/static/chunks/1546-8f32069f317c0f05.js" async=""></script><script src="/_next/static/chunks/2189-660d4274669ab31b.js" async=""></script><script src="/_next/static/chunks/5502-dc16e77959dad9f6.js" async=""></script><script src="/_next/static/chunks/4148-efcd77d52f5d8741.js" async=""></script><script src="/_next/static/chunks/9043-a7590d9c1867f434.js" async=""></script><script src="/_next/static/chunks/5141-e71939af309307b4.js" async=""></script><script src="/_next/static/chunks/8720-0e1cb44e32e0ab67.js" async=""></script><script src="/_next/static/chunks/3215-be7b43a1226cf93d.js" async=""></script><script src="/_next/static/chunks/5279-910b94dcf6d5d422.js" async=""></script><script src="/_next/static/chunks/5838-ddc5dc5a9a24b693.js" async=""></script><script src="/_next/static/chunks/5096-61c9394f436a129a.js" async=""></script><script src="/_next/static/chunks/app/error-e4a6c54656342d67.js" async=""></script><script src="/_next/static/chunks/app/template-9570399e7e3665a7.js" async=""></script><script src="/_next/static/chunks/2159-6c2ed0808fb509dc.js" async=""></script><script src="/_next/static/chunks/5497-bb9f1cc98d6ae1f4.js" async=""></script><script src="/_next/static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js" async=""></script><script src="/_next/static/chunks/28-397907ee75f4a2ba.js" async=""></script><script src="/_next/static/chunks/app/(cantina)/layout-a5a879b5e428d20d.js" async=""></script><script src="/_next/static/chunks/app/(with-footer)/layout-846e14f9c0d37ecb.js" async=""></script><script src="/_next/static/chunks/3930-94d831ab74e1afdf.js" async=""></script><script src="/_next/static/chunks/app/not-found-f31194d283b5fba5.js" async=""></script><link rel="preload" href="https://www.googletagmanager.com/gtm.js?id=GTM-WWS29298" as="script"/><meta name="next-size-adjust"/><title>Sonic Airdrop Contracts | Cantina</title><meta name="description" content="From 25 July 2025 to 30 July 2025 a Cantina assembled team conducted a review of Sonic Airdrop Contracts of https://github.com/PaintSwap/sonic-airdrop-contracts on commit hash 09a09846e01e2a471b593ad7052fde9160ddb154."/><meta name="robots" content="index, follow"/><link rel="canonical" href="https://cantina.xyz/portfolio/80b2fc65-3c2e-4ae7-8e48-6383fa936e6d"/><meta property="og:title" content="Sonic Airdrop Contracts | Cantina"/><meta property="og:description" content="From 25 July 2025 to 30 July 2025 a Cantina assembled team conducted a review of Sonic Airdrop Contracts of https://github.com/PaintSwap/sonic-airdrop-contracts on commit hash 09a09846e01e2a471b593ad7052fde9160ddb154."/><meta property="og:url" content="https://cantina.xyz/portfolio/80b2fc65-3c2e-4ae7-8e48-6383fa936e6d"/><meta property="og:site_name" content="Cantina"/><meta property="og:locale" content="en_US"/><meta property="og:image:alt" content="Portfolio report Sonic Airdrop Contracts cover"/><meta property="og:image:type" content="image/png"/><meta property="og:image" content="https://cantina.xyz/portfolio/80b2fc65-3c2e-4ae7-8e48-6383fa936e6d/opengraph-image-1txs31/default?28e4039fb4c32605"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@cantinaxyz"/><meta name="twitter:creator" content="@cantinaxyz"/><meta name="twitter:title" content="Sonic Airdrop Contracts | Cantina"/><meta name="twitter:description" content="From 25 July 2025 to 30 July 2025 a Cantina assembled team conducted a review of Sonic Airdrop Contracts of https://github.com/PaintSwap/sonic-airdrop-contracts on commit hash 09a09846e01e2a471b593ad7052fde9160ddb154."/><meta name="twitter:image:type" content="image/png"/><meta name="twitter:image" content="https://cantina.xyz/portfolio/80b2fc65-3c2e-4ae7-8e48-6383fa936e6d/twitter-image-1txs31?e253867fbbe1849c"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="48x48"/><link rel="icon" href="/icon.svg?f8ffad73bfade710" type="image/svg+xml" sizes="any"/><link rel="apple-touch-icon" href="/apple-icon.png?b59cca6bd6dadda0" type="image/png" sizes="512x512"/><style type="text/css">.fresnel-container{margin:0;padding:0;}
@media not all and (min-width:0px) and (max-width:479.98px){.fresnel-at-xs{display:none!important;}}
@media not all and (min-width:480px) and (max-width:759.98px){.fresnel-at-sm{display:none!important;}}
@media not all and (min-width:760px) and (max-width:991.98px){.fresnel-at-md{display:none!important;}}
@media not all and (min-width:992px) and (max-width:1279.98px){.fresnel-at-lg{display:none!important;}}
@media not all and (min-width:1280px) and (max-width:1535.98px){.fresnel-at-xl{display:none!important;}}
@media not all and (min-width:1536px){.fresnel-at-2xl{display:none!important;}}
@media not all and (max-width:479.98px){.fresnel-lessThan-sm{display:none!important;}}
@media not all and (max-width:759.98px){.fresnel-lessThan-md{display:none!important;}}
@media not all and (max-width:991.98px){.fresnel-lessThan-lg{display:none!important;}}
@media not all and (max-width:1279.98px){.fresnel-lessThan-xl{display:none!important;}}
@media not all and (max-width:1535.98px){.fresnel-lessThan-2xl{display:none!important;}}
@media not all and (min-width:480px){.fresnel-greaterThan-xs{display:none!important;}}
@media not all and (min-width:760px){.fresnel-greaterThan-sm{display:none!important;}}
@media not all and (min-width:992px){.fresnel-greaterThan-md{display:none!important;}}
@media not all and (min-width:1280px){.fresnel-greaterThan-lg{display:none!important;}}
@media not all and (min-width:1536px){.fresnel-greaterThan-xl{display:none!important;}}
@media not all and (min-width:0px){.fresnel-greaterThanOrEqual-xs{display:none!important;}}
@media not all and (min-width:480px){.fresnel-greaterThanOrEqual-sm{display:none!important;}}
@media not all and (min-width:760px){.fresnel-greaterThanOrEqual-md{display:none!important;}}
@media not all and (min-width:992px){.fresnel-greaterThanOrEqual-lg{display:none!important;}}
@media not all and (min-width:1280px){.fresnel-greaterThanOrEqual-xl{display:none!important;}}
@media not all and (min-width:1536px){.fresnel-greaterThanOrEqual-2xl{display:none!important;}}
@media not all and (min-width:0px) and (max-width:479.98px){.fresnel-between-xs-sm{display:none!important;}}
@media not all and (min-width:0px) and (max-width:759.98px){.fresnel-between-xs-md{display:none!important;}}
@media not all and (min-width:0px) and (max-width:991.98px){.fresnel-between-xs-lg{display:none!important;}}
@media not all and (min-width:0px) and (max-width:1279.98px){.fresnel-between-xs-xl{display:none!important;}}
@media not all and (min-width:0px) and (max-width:1535.98px){.fresnel-between-xs-2xl{display:none!important;}}
@media not all and (min-width:480px) and (max-width:759.98px){.fresnel-between-sm-md{display:none!important;}}
@media not all and (min-width:480px) and (max-width:991.98px){.fresnel-between-sm-lg{display:none!important;}}
@media not all and (min-width:480px) and (max-width:1279.98px){.fresnel-between-sm-xl{display:none!important;}}
@media not all and (min-width:480px) and (max-width:1535.98px){.fresnel-between-sm-2xl{display:none!important;}}
@media not all and (min-width:760px) and (max-width:991.98px){.fresnel-between-md-lg{display:none!important;}}
@media not all and (min-width:760px) and (max-width:1279.98px){.fresnel-between-md-xl{display:none!important;}}
@media not all and (min-width:760px) and (max-width:1535.98px){.fresnel-between-md-2xl{display:none!important;}}
@media not all and (min-width:992px) and (max-width:1279.98px){.fresnel-between-lg-xl{display:none!important;}}
@media not all and (min-width:992px) and (max-width:1535.98px){.fresnel-between-lg-2xl{display:none!important;}}
@media not all and (min-width:1280px) and (max-width:1535.98px){.fresnel-between-xl-2xl{display:none!important;}}</style><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script><style data-emotion="css-global fajf3p">:host,:root,[data-theme]{--chakra-ring-inset:var(--chakra-empty,/*!*/ /*!*/);--chakra-ring-offset-width:0px;--chakra-ring-offset-color:#fff;--chakra-ring-color:rgba(66, 153, 225, 0.6);--chakra-ring-offset-shadow:0 0 #0000;--chakra-ring-shadow:0 0 #0000;--chakra-space-x-reverse:0;--chakra-space-y-reverse:0;--chakra-colors-transparent:transparent;--chakra-colors-current:currentColor;--chakra-colors-black:#000000;--chakra-colors-white:#FFFFFF;--chakra-colors-whiteAlpha-50:rgba(255, 255, 255, 0.04);--chakra-colors-whiteAlpha-100:rgba(255, 255, 255, 0.06);--chakra-colors-whiteAlpha-200:rgba(255, 255, 255, 0.08);--chakra-colors-whiteAlpha-300:rgba(255, 255, 255, 0.16);--chakra-colors-whiteAlpha-400:rgba(255, 255, 255, 0.24);--chakra-colors-whiteAlpha-500:rgba(255, 255, 255, 0.36);--chakra-colors-whiteAlpha-600:rgba(255, 255, 255, 0.48);--chakra-colors-whiteAlpha-700:rgba(255, 255, 255, 0.64);--chakra-colors-whiteAlpha-800:rgba(255, 255, 255, 0.80);--chakra-colors-whiteAlpha-900:rgba(255, 255, 255, 0.92);--chakra-colors-blackAlpha-50:rgba(0, 0, 0, 0.04);--chakra-colors-blackAlpha-100:rgba(0, 0, 0, 0.06);--chakra-colors-blackAlpha-200:rgba(0, 0, 0, 0.08);--chakra-colors-blackAlpha-300:rgba(0, 0, 0, 0.16);--chakra-colors-blackAlpha-400:rgba(0, 0, 0, 0.24);--chakra-colors-blackAlpha-500:rgba(0, 0, 0, 0.36);--chakra-colors-blackAlpha-600:rgba(0, 0, 0, 0.48);--chakra-colors-blackAlpha-700:rgba(0, 0, 0, 0.64);--chakra-colors-blackAlpha-800:rgba(0, 0, 0, 0.80);--chakra-colors-blackAlpha-900:rgba(0, 0, 0, 0.92);--chakra-colors-gray-50:#f9fafb;--chakra-colors-gray-100:#f3f4f6;--chakra-colors-gray-200:#e5e7eb;--chakra-colors-gray-300:#d1d5db;--chakra-colors-gray-400:#9ca3af;--chakra-colors-gray-500:#6B7280;--chakra-colors-gray-600:#4b5563;--chakra-colors-gray-700:#374151;--chakra-colors-gray-800:#1f2937;--chakra-colors-gray-900:#111827;--chakra-colors-gray-950:#030712;--chakra-colors-gray-1000:#9F9F9F;--chakra-colors-gray-50a:rgba(12, 41, 49, 0.025);--chakra-colors-gray-100a:rgba(12, 41, 49, 0.05);--chakra-colors-red-50:#FEF2F2;--chakra-colors-red-100:#FEE2E2;--chakra-colors-red-200:#FECACA;--chakra-colors-red-300:#FCA5A5;--chakra-colors-red-400:#F87171;--chakra-colors-red-500:#EF4444;--chakra-colors-red-600:#DC2626;--chakra-colors-red-700:#B91C1C;--chakra-colors-red-800:#991B1B;--chakra-colors-red-900:#7F1D1D;--chakra-colors-red-950:#691818;--chakra-colors-orange-50:#faede6;--chakra-colors-orange-100:#faddcd;--chakra-colors-orange-200:#fabd9b;--chakra-colors-orange-300:#fa9d69;--chakra-colors-orange-400:#fa7d37;--chakra-colors-orange-500:#fa5e06;--chakra-colors-orange-600:#c24703;--chakra-colors-orange-700:#943703;--chakra-colors-orange-800:#612402;--chakra-colors-orange-900:#2e1101;--chakra-colors-orange-950:#140800;--chakra-colors-orange-1000:#FA5E06;--chakra-colors-orange-1050:#FF3E14;--chakra-colors-yellow-50:#FFFBEB;--chakra-colors-yellow-100:#FEF3C7;--chakra-colors-yellow-200:#FDE68A;--chakra-colors-yellow-300:#FCD34D;--chakra-colors-yellow-400:#FBBF24;--chakra-colors-yellow-500:#F59E0B;--chakra-colors-yellow-600:#D97706;--chakra-colors-yellow-700:#B45309;--chakra-colors-yellow-800:#92400E;--chakra-colors-yellow-900:#78350F;--chakra-colors-green-50:#ECFDF5;--chakra-colors-green-100:#D1FAE5;--chakra-colors-green-200:#A7F3D0;--chakra-colors-green-300:#6EE7B7;--chakra-colors-green-400:#34D399;--chakra-colors-green-500:#10B981;--chakra-colors-green-600:#059669;--chakra-colors-green-700:#047857;--chakra-colors-green-800:#065F46;--chakra-colors-green-900:#064E3B;--chakra-colors-green-950:#043A33;--chakra-colors-teal-50:#E6FFFA;--chakra-colors-teal-100:#B2F5EA;--chakra-colors-teal-200:#81E6D9;--chakra-colors-teal-300:#4FD1C5;--chakra-colors-teal-400:#38B2AC;--chakra-colors-teal-500:#319795;--chakra-colors-teal-600:#2C7A7B;--chakra-colors-teal-700:#285E61;--chakra-colors-teal-800:#234E52;--chakra-colors-teal-900:#1D4044;--chakra-colors-blue-50:#E7F9FE;--chakra-colors-blue-100:#C2E4ED;--chakra-colors-blue-200:#A4DDED;--chakra-colors-blue-300:#64CFED;--chakra-colors-blue-400:#34C4ED;--chakra-colors-blue-500:#05BAED;--chakra-colors-blue-600:#0492BA;--chakra-colors-blue-700:#036A87;--chakra-colors-blue-800:#024254;--chakra-colors-blue-900:#011A21;--chakra-colors-blue-950:#000608;--chakra-colors-cyan-50:#EDFDFD;--chakra-colors-cyan-100:#C4F1F9;--chakra-colors-cyan-200:#9DECF9;--chakra-colors-cyan-300:#76E4F7;--chakra-colors-cyan-400:#0BC5EA;--chakra-colors-cyan-500:#00B5D8;--chakra-colors-cyan-600:#00A3C4;--chakra-colors-cyan-700:#0987A0;--chakra-colors-cyan-800:#086F83;--chakra-colors-cyan-900:#065666;--chakra-colors-purple-50:#FAF5FF;--chakra-colors-purple-100:#E9D8FD;--chakra-colors-purple-200:#D6BCFA;--chakra-colors-purple-300:#B794F4;--chakra-colors-purple-400:#9F7AEA;--chakra-colors-purple-500:#805AD5;--chakra-colors-purple-600:#6B46C1;--chakra-colors-purple-700:#553C9A;--chakra-colors-purple-800:#44337A;--chakra-colors-purple-900:#322659;--chakra-colors-pink-50:#FFF5F7;--chakra-colors-pink-100:#FED7E2;--chakra-colors-pink-200:#FBB6CE;--chakra-colors-pink-300:#F687B3;--chakra-colors-pink-400:#ED64A6;--chakra-colors-pink-500:#D53F8C;--chakra-colors-pink-600:#B83280;--chakra-colors-pink-700:#97266D;--chakra-colors-pink-800:#702459;--chakra-colors-pink-900:#521B41;--chakra-colors-primary-50:#faede6;--chakra-colors-primary-100:#faddcd;--chakra-colors-primary-200:#fabd9b;--chakra-colors-primary-300:#fa9d69;--chakra-colors-primary-400:#fa7d37;--chakra-colors-primary-500:#fa5e06;--chakra-colors-primary-600:#c24703;--chakra-colors-primary-700:#943703;--chakra-colors-primary-800:#612402;--chakra-colors-primary-900:#2e1101;--chakra-colors-primary-950:#140800;--chakra-colors-primary-1000:#FA5E06;--chakra-colors-primary-1050:#FF3E14;--chakra-colors-sand-50:#FFFBF5;--chakra-colors-sand-100:#FFF7EA;--chakra-colors-sand-200:#F7F0E3;--chakra-colors-sand-300:#EDE6DA;--chakra-colors-sand-400:#E3DCD0;--chakra-colors-sand-500:#C9C3B9;--chakra-colors-sand-600:#B0ABA1;--chakra-colors-sand-700:#96928A;--chakra-colors-sand-800:#7D7972;--chakra-colors-sand-900:#63605B;--chakra-colors-sand-950:#4A4844;--chakra-colors-rainbow-50:#D2BE52;--chakra-colors-rainbow-100:#52D2C3;--chakra-colors-rainbow-200:#5552D2;--chakra-colors-rainbow-300:#D25252;--chakra-colors-rainbow-400:#C8D252;--chakra-colors-rainbow-500:#8A52D2;--chakra-colors-indigo-50:#EFF3FF;--chakra-colors-indigo-100:#E0E7FF;--chakra-colors-indigo-200:#C7D2FE;--chakra-colors-indigo-300:#A5B4FC;--chakra-colors-indigo-400:#818CF8;--chakra-colors-indigo-500:#6366F1;--chakra-colors-indigo-600:#4F46E5;--chakra-colors-indigo-700:#4338CA;--chakra-colors-indigo-800:#3730A3;--chakra-colors-indigo-900:#312E81;--chakra-colors-complementary-50:#92C0FF;--chakra-colors-complementary-100:#7CB3FF;--chakra-colors-complementary-200:#65A5FF;--chakra-colors-complementary-300:#4D97FE;--chakra-colors-complementary-400:#3289FC;--chakra-colors-complementary-500:#057AFA;--chakra-colors-complementary-600:#0469D9;--chakra-colors-complementary-700:#0359BA;--chakra-colors-complementary-800:#02499B;--chakra-colors-complementary-900:#013A7D;--chakra-colors-complementary-950:#012B61;--chakra-colors-codeHighlighting-plain:#24292e;--chakra-colors-codeHighlighting-keyword:#D73A49;--chakra-colors-codeHighlighting-identifier:#6F42C1;--chakra-colors-codeHighlighting-meta:#6A737D;--chakra-colors-codeHighlighting-literal:#005CC5;--chakra-colors-codeHighlighting-string:#032F62;--chakra-colors-codeHighlighting-diff-inserted:#059669;--chakra-colors-codeHighlighting-diff-deleted:#D73A49;--chakra-borders-none:0;--chakra-borders-1px:1px solid;--chakra-borders-2px:2px solid;--chakra-borders-4px:4px solid;--chakra-borders-8px:8px solid;--chakra-fonts-heading:'inter_display','inter_display Fallback',sans-serif;--chakra-fonts-body:'Inter','Inter Fallback',sans-serif;--chakra-fonts-mono:'Roboto Mono','Roboto Mono Fallback',SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--chakra-fonts-markdown:-apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";--chakra-fontSizes-3xs:0.45rem;--chakra-fontSizes-2xs:0.625rem;--chakra-fontSizes-xs:0.75rem;--chakra-fontSizes-sm:0.875rem;--chakra-fontSizes-md:1rem;--chakra-fontSizes-lg:1.125rem;--chakra-fontSizes-xl:1.25rem;--chakra-fontSizes-2xl:1.5rem;--chakra-fontSizes-3xl:1.875rem;--chakra-fontSizes-4xl:2.25rem;--chakra-fontSizes-5xl:3rem;--chakra-fontSizes-6xl:3.75rem;--chakra-fontSizes-7xl:4.5rem;--chakra-fontSizes-8xl:6rem;--chakra-fontSizes-9xl:8rem;--chakra-fontWeights-hairline:100;--chakra-fontWeights-thin:200;--chakra-fontWeights-light:300;--chakra-fontWeights-normal:400;--chakra-fontWeights-medium:500;--chakra-fontWeights-semibold:600;--chakra-fontWeights-bold:700;--chakra-fontWeights-extrabold:800;--chakra-fontWeights-black:900;--chakra-letterSpacings-tighter:-0.05em;--chakra-letterSpacings-tight:-0.025em;--chakra-letterSpacings-normal:0;--chakra-letterSpacings-wide:0.025em;--chakra-letterSpacings-wider:0.05em;--chakra-letterSpacings-widest:0.1em;--chakra-lineHeights-3:.75rem;--chakra-lineHeights-4:1rem;--chakra-lineHeights-5:1.25rem;--chakra-lineHeights-6:1.5rem;--chakra-lineHeights-7:1.75rem;--chakra-lineHeights-8:2rem;--chakra-lineHeights-9:2.25rem;--chakra-lineHeights-10:2.5rem;--chakra-lineHeights-normal:normal;--chakra-lineHeights-none:1;--chakra-lineHeights-shorter:1.25;--chakra-lineHeights-short:1.375;--chakra-lineHeights-base:1.5;--chakra-lineHeights-tall:1.625;--chakra-lineHeights-taller:2;--chakra-radii-none:0;--chakra-radii-sm:0.125rem;--chakra-radii-base:0.25rem;--chakra-radii-md:0.375rem;--chakra-radii-lg:0.5rem;--chakra-radii-xl:0.75rem;--chakra-radii-2xl:1rem;--chakra-radii-3xl:1.5rem;--chakra-radii-full:9999px;--chakra-space-1:0.25rem;--chakra-space-2:0.5rem;--chakra-space-3:0.75rem;--chakra-space-4:1rem;--chakra-space-5:1.25rem;--chakra-space-6:1.5rem;--chakra-space-7:1.75rem;--chakra-space-8:2rem;--chakra-space-9:2.25rem;--chakra-space-10:2.5rem;--chakra-space-12:3rem;--chakra-space-14:3.5rem;--chakra-space-16:4rem;--chakra-space-20:5rem;--chakra-space-24:6rem;--chakra-space-28:7rem;--chakra-space-32:8rem;--chakra-space-36:9rem;--chakra-space-40:10rem;--chakra-space-44:11rem;--chakra-space-48:12rem;--chakra-space-52:13rem;--chakra-space-56:14rem;--chakra-space-60:15rem;--chakra-space-64:16rem;--chakra-space-72:18rem;--chakra-space-80:20rem;--chakra-space-96:24rem;--chakra-space-px:1px;--chakra-space-0-5:0.125rem;--chakra-space-1-5:0.375rem;--chakra-space-2-5:0.625rem;--chakra-space-3-5:0.875rem;--chakra-shadows-xs:0 0 0 1px rgba(0, 0, 0, 0.05);--chakra-shadows-sm:0px 1px 2px 0px rgba(0, 0, 0, 0.05);--chakra-shadows-base:0 1px 3px 0 rgba(0, 0, 0, 0.1),0 1px 2px 0 rgba(0, 0, 0, 0.06);--chakra-shadows-md:0 4px 6px -1px rgba(0, 0, 0, 0.1),0 2px 4px -1px rgba(0, 0, 0, 0.06);--chakra-shadows-lg:0 10px 15px -3px rgba(0, 0, 0, 0.1),0 4px 6px -2px rgba(0, 0, 0, 0.05);--chakra-shadows-xl:0 20px 25px -5px rgba(0, 0, 0, 0.1),0 10px 10px -5px rgba(0, 0, 0, 0.04);--chakra-shadows-2xl:0 25px 50px -12px rgba(0, 0, 0, 0.25);--chakra-shadows-outline:0 0 0 3px rgba(66, 153, 225, 0.6);--chakra-shadows-inner:inset 0 2px 4px 0 rgba(0,0,0,0.06);--chakra-shadows-none:none;--chakra-shadows-dark-lg:rgba(0, 0, 0, 0.1) 0px 0px 0px 1px,rgba(0, 0, 0, 0.2) 0px 5px 10px,rgba(0, 0, 0, 0.4) 0px 15px 40px;--chakra-sizes-1:0.25rem;--chakra-sizes-2:0.5rem;--chakra-sizes-3:0.75rem;--chakra-sizes-4:1rem;--chakra-sizes-5:1.25rem;--chakra-sizes-6:1.5rem;--chakra-sizes-7:1.75rem;--chakra-sizes-8:2rem;--chakra-sizes-9:2.25rem;--chakra-sizes-10:2.5rem;--chakra-sizes-12:3rem;--chakra-sizes-14:3.5rem;--chakra-sizes-16:4rem;--chakra-sizes-20:5rem;--chakra-sizes-24:6rem;--chakra-sizes-28:7rem;--chakra-sizes-32:8rem;--chakra-sizes-36:9rem;--chakra-sizes-40:10rem;--chakra-sizes-44:11rem;--chakra-sizes-48:12rem;--chakra-sizes-52:13rem;--chakra-sizes-56:14rem;--chakra-sizes-60:15rem;--chakra-sizes-64:16rem;--chakra-sizes-72:18rem;--chakra-sizes-80:20rem;--chakra-sizes-96:24rem;--chakra-sizes-px:1px;--chakra-sizes-0-5:0.125rem;--chakra-sizes-1-5:0.375rem;--chakra-sizes-2-5:0.625rem;--chakra-sizes-3-5:0.875rem;--chakra-sizes-max:max-content;--chakra-sizes-min:min-content;--chakra-sizes-full:100%;--chakra-sizes-3xs:14rem;--chakra-sizes-2xs:16rem;--chakra-sizes-xs:20rem;--chakra-sizes-sm:24rem;--chakra-sizes-md:28rem;--chakra-sizes-lg:32rem;--chakra-sizes-xl:36rem;--chakra-sizes-2xl:42rem;--chakra-sizes-3xl:48rem;--chakra-sizes-4xl:56rem;--chakra-sizes-5xl:64rem;--chakra-sizes-6xl:72rem;--chakra-sizes-7xl:80rem;--chakra-sizes-8xl:90rem;--chakra-sizes-prose:60ch;--chakra-sizes-container-sm:640px;--chakra-sizes-container-md:768px;--chakra-sizes-container-lg:1024px;--chakra-sizes-container-xl:1280px;--chakra-zIndices-hide:-1;--chakra-zIndices-auto:auto;--chakra-zIndices-base:0;--chakra-zIndices-docked:10;--chakra-zIndices-dropdown:1000;--chakra-zIndices-sticky:1100;--chakra-zIndices-banner:1200;--chakra-zIndices-overlay:1300;--chakra-zIndices-modal:1400;--chakra-zIndices-popover:1500;--chakra-zIndices-skipLink:1600;--chakra-zIndices-toast:1700;--chakra-zIndices-tooltip:1800;--chakra-transition-property-common:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform;--chakra-transition-property-colors:background-color,border-color,color,fill,stroke;--chakra-transition-property-dimensions:width,height;--chakra-transition-property-position:left,right,top,bottom;--chakra-transition-property-background:background-color,background-image,background-position;--chakra-transition-easing-ease-in:cubic-bezier(0.4, 0, 1, 1);--chakra-transition-easing-ease-out:cubic-bezier(0, 0, 0.2, 1);--chakra-transition-easing-ease-in-out:cubic-bezier(0.4, 0, 0.2, 1);--chakra-transition-duration-ultra-fast:50ms;--chakra-transition-duration-faster:100ms;--chakra-transition-duration-fast:150ms;--chakra-transition-duration-normal:200ms;--chakra-transition-duration-slow:300ms;--chakra-transition-duration-slower:400ms;--chakra-transition-duration-ultra-slow:500ms;--chakra-blur-none:0;--chakra-blur-sm:4px;--chakra-blur-base:8px;--chakra-blur-md:12px;--chakra-blur-lg:16px;--chakra-blur-xl:24px;--chakra-blur-2xl:40px;--chakra-blur-3xl:64px;--chakra-breakpoints-base:0em;--chakra-breakpoints-sm:30em;--chakra-breakpoints-md:48em;--chakra-breakpoints-lg:62em;--chakra-breakpoints-xl:80em;--chakra-breakpoints-2xl:96em;--chakra-colors-chakra-border-color:var(--chakra-colors-gray-300);--chakra-colors-muted:var(--chakra-colors-gray-500);--chakra-colors-soft:var(--chakra-colors-gray-700);--chakra-colors-default:var(--chakra-colors-gray-950);--chakra-colors-inverse:var(--chakra-colors-white);--chakra-colors-notificationBadge:#426AF7;--chakra-colors-boxShadowFocus:#68A6F8;--chakra-colors-spearbit:#25F2D0;--chakra-colors-severity-critical:#890707;--chakra-colors-severity-high:#FE3535;--chakra-colors-severity-medium:#FF9F2D;--chakra-colors-severity-low:#FFD601;--chakra-colors-severity-informational:#BA65FC;--chakra-colors-severity-gas:#7A65FC;--chakra-colors-severity-bg-critical:#FFC5C5;--chakra-colors-severity-bg-high:#FFD2D2;--chakra-colors-severity-bg-medium:#FFE0C3;--chakra-colors-severity-bg-low:#FFFAED;--chakra-colors-severity-bg-informational:#F2DDFF;--chakra-colors-severity-bg-gas:#E0DDFF;--chakra-colors-quality-high:var(--chakra-colors-green-500);--chakra-colors-quality-medium:var(--chakra-colors-yellow-500);--chakra-colors-quality-low:var(--chakra-colors-red-500);--chakra-colors-quality-bg-high:var(--chakra-colors-green-200);--chakra-colors-quality-bg-medium:var(--chakra-colors-yellow-200);--chakra-colors-quality-bg-low:var(--chakra-colors-red-200);--chakra-colors-status-new:var(--chakra-colors-purple-800);--chakra-colors-status-inReview:var(--chakra-colors-yellow-900);--chakra-colors-status-confirmed:var(--chakra-colors-blue-800);--chakra-colors-status-disputed:var(--chakra-colors-yellow-900);--chakra-colors-status-rejected:var(--chakra-colors-red-900);--chakra-colors-status-spam:var(--chakra-colors-red-900);--chakra-colors-status-duplicate:var(--chakra-colors-gray-950);--chakra-colors-status-acknowledged:var(--chakra-colors-indigo-800);--chakra-colors-status-fixed:var(--chakra-colors-green-900);--chakra-colors-status-withdrawn:var(--chakra-colors-red-900);--chakra-colors-status-bg-new:#F4F2FC;--chakra-colors-status-bg-inReview:var(--chakra-colors-yellow-50);--chakra-colors-status-bg-confirmed:var(--chakra-colors-blue-50);--chakra-colors-status-bg-disputed:var(--chakra-colors-yellow-50);--chakra-colors-status-bg-rejected:var(--chakra-colors-red-50);--chakra-colors-status-bg-spam:var(--chakra-colors-red-50);--chakra-colors-status-bg-duplicate:var(--chakra-colors-gray-50);--chakra-colors-status-bg-acknowledged:#EAEDF7;--chakra-colors-status-bg-fixed:var(--chakra-colors-green-50);--chakra-colors-status-bg-withdrawn:var(--chakra-colors-red-50);--chakra-shadows-buttonFocus:0px 0px 0px 2px #FFFFFF,0px 0px 0px 4px var(--chakra-colors-boxShadowFocus);--chakra-shadows-floatingCard:0px 5px 15px -5px rgba(0, 0, 0, 0.10);}.chakra-ui-light :host:not([data-theme]),.chakra-ui-light :root:not([data-theme]),.chakra-ui-light [data-theme]:not([data-theme]),[data-theme=light] :host:not([data-theme]),[data-theme=light] :root:not([data-theme]),[data-theme=light] [data-theme]:not([data-theme]),:host[data-theme=light],:root[data-theme=light],[data-theme][data-theme=light]{--chakra-colors-chakra-body-text:var(--chakra-colors-gray-800);--chakra-colors-chakra-body-bg:var(--chakra-colors-white);--chakra-colors-chakra-inverse-text:var(--chakra-colors-white);--chakra-colors-chakra-subtle-bg:var(--chakra-colors-gray-100);--chakra-colors-chakra-subtle-text:var(--chakra-colors-gray-600);--chakra-colors-chakra-placeholder-color:var(--chakra-colors-gray-500);}.chakra-ui-dark :host:not([data-theme]),.chakra-ui-dark :root:not([data-theme]),.chakra-ui-dark [data-theme]:not([data-theme]),[data-theme=dark] :host:not([data-theme]),[data-theme=dark] :root:not([data-theme]),[data-theme=dark] [data-theme]:not([data-theme]),:host[data-theme=dark],:root[data-theme=dark],[data-theme][data-theme=dark]{--chakra-colors-chakra-body-text:var(--chakra-colors-whiteAlpha-900);--chakra-colors-chakra-body-bg:var(--chakra-colors-gray-800);--chakra-colors-chakra-inverse-text:var(--chakra-colors-gray-800);--chakra-colors-chakra-subtle-bg:var(--chakra-colors-gray-700);--chakra-colors-chakra-subtle-text:var(--chakra-colors-gray-400);--chakra-colors-chakra-placeholder-color:var(--chakra-colors-whiteAlpha-400);}</style><style data-emotion="css-global fubdgu">html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:system-ui,sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;touch-action:manipulation;}body{position:relative;min-height:100%;margin:0;font-feature-settings:"kern";}:where(*, *::before, *::after){border-width:0;border-style:solid;box-sizing:border-box;word-wrap:break-word;}main{display:block;}hr{border-top-width:1px;box-sizing:content-box;height:0;overflow:visible;}:where(pre, code, kbd,samp){font-family:SFMono-Regular,Menlo,Monaco,Consolas,monospace;font-size:1em;}a{background-color:transparent;color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit;}abbr[title]{border-bottom:none;-webkit-text-decoration:underline;text-decoration:underline;-webkit-text-decoration:underline dotted;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;}:where(b, strong){font-weight:bold;}small{font-size:80%;}:where(sub,sup){font-size:75%;line-height:0;position:relative;vertical-align:baseline;}sub{bottom:-0.25em;}sup{top:-0.5em;}img{border-style:none;}:where(button, input, optgroup, select, textarea){font-family:inherit;font-size:100%;line-height:1.15;margin:0;}:where(button, input){overflow:visible;}:where(button, select){text-transform:none;}:where(
          button::-moz-focus-inner,
          [type="button"]::-moz-focus-inner,
          [type="reset"]::-moz-focus-inner,
          [type="submit"]::-moz-focus-inner
        ){border-style:none;padding:0;}fieldset{padding:0.35em 0.75em 0.625em;}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal;}progress{vertical-align:baseline;}textarea{overflow:auto;}:where([type="checkbox"], [type="radio"]){box-sizing:border-box;padding:0;}input[type="number"]::-webkit-inner-spin-button,input[type="number"]::-webkit-outer-spin-button{-webkit-appearance:none!important;}input[type="number"]{-moz-appearance:textfield;}input[type="search"]{-webkit-appearance:textfield;outline-offset:-2px;}input[type="search"]::-webkit-search-decoration{-webkit-appearance:none!important;}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit;}details{display:block;}summary{display:-webkit-box;display:-webkit-list-item;display:-ms-list-itembox;display:list-item;}template{display:none;}[hidden]{display:none!important;}:where(
          blockquote,
          dl,
          dd,
          h1,
          h2,
          h3,
          h4,
          h5,
          h6,
          hr,
          figure,
          p,
          pre
        ){margin:0;}button{background:transparent;padding:0;}fieldset{margin:0;padding:0;}:where(ol, ul){margin:0;padding:0;}textarea{resize:vertical;}:where(button, [role="button"]){cursor:pointer;}button::-moz-focus-inner{border:0!important;}table{border-collapse:collapse;}:where(h1, h2, h3, h4, h5, h6){font-size:inherit;font-weight:inherit;}:where(button, input, optgroup, select, textarea){padding:0;line-height:inherit;color:inherit;}:where(img, svg, video, canvas, audio, iframe, embed, object){display:block;}:where(img, video){max-width:100%;height:auto;}[data-js-focus-visible] :focus:not([data-focus-visible-added]):not(
          [data-focus-visible-disabled]
        ){outline:none;box-shadow:none;}select::-ms-expand{display:none;}:root,:host{--chakra-vh:100vh;}@supports (height: -webkit-fill-available){:root,:host{--chakra-vh:-webkit-fill-available;}}@supports (height: -moz-fill-available){:root,:host{--chakra-vh:-moz-fill-available;}}@supports (height: 100dvh){:root,:host{--chakra-vh:100dvh;}}</style><style data-emotion="css-global qi238r">body{font-family:var(--chakra-fonts-body);color:var(--chakra-colors-gray-950);background:var(--chakra-colors-gray-100);transition-property:background-color;transition-duration:var(--chakra-transition-duration-normal);line-height:var(--chakra-lineHeights-base);}*::-webkit-input-placeholder{color:var(--chakra-colors-chakra-placeholder-color);}*::-moz-placeholder{color:var(--chakra-colors-chakra-placeholder-color);}*:-ms-input-placeholder{color:var(--chakra-colors-chakra-placeholder-color);}*::placeholder{color:var(--chakra-colors-chakra-placeholder-color);}*,*::before,::after{border-color:var(--chakra-colors-chakra-border-color);word-wrap:break-word;}*{box-sizing:border-box;}::selection{background:var(--chakra-colors-gray-200);}.hide-scrollbar::-webkit-scrollbar{width:0rem;display:none;}.lexical-typeahead-anchor{z-index:1401;}</style><style data-emotion="css 1akmemn 16vni6q 18r1sh1 128ezeu 10xqgwl 18jx1zi 70qvj9 5uedcu 1lb2iqg vtap6t 19wynbg iv50s2 1i65up9 8pmr8q 1ombfz0 r0ozme 1wwab8g 1pgkvrj bv0bvv b90z33 1ufsqbu 1rn13ix 1g42d1 uykjfd 1v0cowj 10ju93e 1nld6ms h6vlo7 144e9by zg985e 1hpe94n 1uqohei enj3l8 um44p3 1m58msr cn3a9x 1uodvt1 euis13 199co4x 1tu96jy 1gozx00 90j4rp 18b9je0 1bxtuyq vgxdvo 1l9ml90 t1uzvz 1os7mvd 16d6gy0 1rl57da o959d8 porbmv 1ol2nsm 73n1r9 dp0ctz 1skpokq 1so5w5b 15ua73h 1dmhezw 14ry2m8 6bkskg 93jg2x 180fw1m 12vwza8 kabsx8 wnr2r6 1fh5bdn 14n2vmc 1wzn9m2 17roaq2 9h3ub9 lutnni yv6bx6 1x2krjs 1f0j1p5 1cyyl4u 1vy91a6 1hlsh2c 1nvbuct lq80v0 0 1kc89qn thn72w l0e4mh 14ge14j 1lnofw7 101m3ux 1l8566 hyehfz n1un5q ypnwc0 7e8jyl v26npq phvdpk wxyuev 1e0kj1c 1rem1b3 jg3yxe xcnbdp 15y7uvo 1kxrhf3 1dsl60n mgdx75 tu0njr c8eelt 1dg6mvm 8vzs7e 1f8olwv 1ucn39k ylswkg 1s7y7bx 11kvcua dti5c1">.css-1akmemn{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;background-color:var(--chakra-colors-white);-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;}.css-16vni6q{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:0.5rem;background-color:var(--chakra-colors-gray-100);height:4rem;position:relative;-webkit-padding-start:var(--chakra-space-4);padding-inline-start:var(--chakra-space-4);-webkit-padding-end:var(--chakra-space-4);padding-inline-end:var(--chakra-space-4);z-index:1;}.css-16vni6q::after{content:"";position:absolute;bottom:0px;left:0px;right:0px;height:1px;background-color:var(--chakra-colors-gray-200);}.css-18r1sh1{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:var(--chakra-space-3);overflow-x:hidden;}@media screen and (min-width: 48em){.css-18r1sh1{gap:var(--chakra-space-8);}}.css-128ezeu{transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-fast);transition-timing-function:var(--chakra-transition-easing-ease-out);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:2px solid transparent;outline-offset:2px;color:inherit;font-weight:inherit;display:inline-block;border:0;}.css-128ezeu:hover,.css-128ezeu[data-hover]{-webkit-text-decoration:underline;text-decoration:underline;color:var(--chakra-colors-primary-500);-webkit-animation:dissolve 100ms ease-out;animation:dissolve 100ms ease-out;}.css-128ezeu:focus-visible,.css-128ezeu[data-focus-visible]{box-shadow:0 0 0px 2px var(--chakra-colors-boxShadowFocus);outline:2px solid transparent;outline-offset:2px;}.css-128ezeu .chakra-icon,.css-128ezeu .lucide{display:inline-block;vertical-align:middle;}.css-10xqgwl{height:var(--chakra-sizes-6);width:var(--chakra-sizes-6);}.css-18jx1zi{font-size:var(--chakra-fontSizes-sm);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}@media screen and (min-width: 48em){.css-18jx1zi{display:none;}}.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-5uedcu{display:none;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:0.5rem;}@media screen and (min-width: 48em){.css-5uedcu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}.css-1lb2iqg{position:relative;display:block;gap:1.5rem;margin-top:-1px;-ms-overflow-style:none;scroll-bar-width:none;-webkit-align-self:stretch;-ms-flex-item-align:stretch;align-self:stretch;overflow-y:auto;right:var(--chakra-space-4);}.css-1lb2iqg::-webkit-scrollbar{display:none;}.css-1lb2iqg [role='tablist']{background:none;}.css-1lb2iqg [role='tab']{min-height:4rem;}.css-1lb2iqg [role='tab']>*{-webkit-transform:translateY(2px);-moz-transform:translateY(2px);-ms-transform:translateY(2px);transform:translateY(2px);}.css-vtap6t{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;background:linear-gradient(to top, var(--chakra-colors-gray-200) 1px, transparent 1px);gap:2rem;overflow-x:auto;-webkit-padding-start:1rem;padding-inline-start:1rem;-webkit-padding-end:1rem;padding-inline-end:1rem;-ms-overflow-style:none;scroll-bar-width:none;}.css-vtap6t::-webkit-scrollbar{display:none;}.css-19wynbg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-normal);font-size:var(--chakra-fontSizes-md);padding-top:var(--chakra-space-2);padding-bottom:0.5rem;border-bottom-color:var(--chakra-colors-transparent);border-bottom-left-radius:solid;border-bottom-width:2px;outline:2px solid transparent;outline-offset:2px;-webkit-padding-start:0px;padding-inline-start:0px;-webkit-padding-end:0px;padding-inline-end:0px;}.css-19wynbg:focus-visible,.css-19wynbg[data-focus-visible]{z-index:1;box-shadow:var(--chakra-shadows-outline);}.css-19wynbg:disabled,.css-19wynbg[disabled],.css-19wynbg[aria-disabled=true],.css-19wynbg[data-disabled]{cursor:not-allowed;opacity:0.4;}.css-19wynbg .chakra-icon,.css-19wynbg .lucide{width:var(--chakra-sizes-5);height:var(--chakra-sizes-5);}.css-19wynbg:hover>*{background-color:var(--chakra-colors-gray-100);color:var(--chakra-colors-gray-950);-webkit-transition:0.25s;transition:0.25s;}.css-19wynbg:focus,.css-19wynbg:focus-within,.css-19wynbg:focus-visible{box-shadow:var(--chakra-shadows-none);}.css-19wynbg:focus-visible>*{background-color:var(--chakra-colors-gray-100);color:var(--chakra-colors-gray-950);-webkit-transition:0.25s;transition:0.25s;box-shadow:0px 0px 0px 2px white,0px 0px 0px 4px var(--chakra-colors-boxShadowFocus);}.css-iv50s2{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:var(--chakra-space-2);border-radius:0.25rem;color:var(--chakra-colors-gray-950);-webkit-padding-start:0.25rem;padding-inline-start:0.25rem;-webkit-padding-end:0.25rem;padding-inline-end:0.25rem;padding-top:0.125rem;padding-bottom:0.125rem;white-space:nowrap;}.css-1i65up9{letter-spacing:0;line-height:1.45;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;font-size:var(--chakra-fontSizes-sm);font-weight:400;white-space:nowrap;}.css-1i65up9:after{content:attr(data-text);height:0px;visibility:hidden;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none;font-weight:600;}.css-8pmr8q{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:var(--chakra-space-3);}.css-1ombfz0{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;white-space:nowrap;vertical-align:middle;outline:2px solid transparent;outline-offset:2px;line-height:1.2;border-radius:var(--chakra-radii-md);font-weight:500;transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-normal);gap:var(--chakra-space-2);-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;text-overflow:ellipsis;overflow:hidden;-webkit-transition:all 0.2s;transition:all 0.2s;height:var(--chakra-sizes-10);min-width:var(--chakra-sizes-10);font-size:var(--chakra-fontSizes-md);-webkit-padding-start:var(--chakra-space-4);padding-inline-start:var(--chakra-space-4);-webkit-padding-end:var(--chakra-space-4);padding-inline-end:var(--chakra-space-4);padding-top:var(--chakra-space-2);padding-bottom:var(--chakra-space-2);background:white.500;color:var(--chakra-colors-gray-950);background-color:var(--chakra-colors-white);border-width:1px;border-color:var(--chakra-colors-chakra-border-color);}.css-1ombfz0:focus-visible,.css-1ombfz0[data-focus-visible]{box-shadow:0px 0px 0px 2px var(--chakra-colors-boxShadowFocus);outline:2px solid transparent;outline-offset:2px;}.css-1ombfz0:disabled,.css-1ombfz0[disabled],.css-1ombfz0[aria-disabled=true],.css-1ombfz0[data-disabled]{opacity:1;cursor:not-allowed;box-shadow:var(--chakra-shadows-none);background-color:var(--chakra-colors-gray-50a);color:var(--chakra-colors-gray-300);}.css-1ombfz0:disabled .chakra-button__icon,.css-1ombfz0[disabled] .chakra-button__icon,.css-1ombfz0[aria-disabled=true] .chakra-button__icon,.css-1ombfz0[data-disabled] .chakra-button__icon{color:var(--chakra-colors-gray-300);}.css-1ombfz0:disabled:hover,.css-1ombfz0[disabled]:hover,.css-1ombfz0[aria-disabled=true]:hover,.css-1ombfz0[data-disabled]:hover,.css-1ombfz0:disabled[data-hover],.css-1ombfz0[disabled][data-hover],.css-1ombfz0[aria-disabled=true][data-hover],.css-1ombfz0[data-disabled][data-hover]{background-color:var(--chakra-colors-gray-50a);}.css-1ombfz0:disabled:active,.css-1ombfz0[disabled]:active,.css-1ombfz0[aria-disabled=true]:active,.css-1ombfz0[data-disabled]:active,.css-1ombfz0:disabled[data-active],.css-1ombfz0[disabled][data-active],.css-1ombfz0[aria-disabled=true][data-active],.css-1ombfz0[data-disabled][data-active]{background-color:var(--chakra-colors-gray-50a);}.css-1ombfz0:disabled:focus,.css-1ombfz0[disabled]:focus,.css-1ombfz0[aria-disabled=true]:focus,.css-1ombfz0[data-disabled]:focus,.css-1ombfz0:disabled[data-focus],.css-1ombfz0[disabled][data-focus],.css-1ombfz0[aria-disabled=true][data-focus],.css-1ombfz0[data-disabled][data-focus]{background-color:var(--chakra-colors-gray-50a);}.css-1ombfz0:hover,.css-1ombfz0[data-hover]{background:white.600;background-color:var(--chakra-colors-gray-100);}.css-1ombfz0:hover:disabled,.css-1ombfz0[data-hover]:disabled,.css-1ombfz0:hover[disabled],.css-1ombfz0[data-hover][disabled],.css-1ombfz0:hover[aria-disabled=true],.css-1ombfz0[data-hover][aria-disabled=true],.css-1ombfz0:hover[data-disabled],.css-1ombfz0[data-hover][data-disabled]{background:white.500;background-color:var(--chakra-colors-gray-50a);}.css-1ombfz0:focus,.css-1ombfz0[data-focus]{outline:2px solid transparent;outline-offset:2px;background-color:var(--chakra-colors-gray-100);}.css-1ombfz0 .chakra-button__text{padding-left:var(--chakra-space-1);padding-right:var(--chakra-space-1);}.css-1ombfz0 .chakra-button__icon{margin:0px;padding:0px;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;color:var(--chakra-colors-gray-500);}.css-1ombfz0 .chakra-button__icon,.css-1ombfz0 .lucide{width:var(--chakra-sizes-5);height:var(--chakra-sizes-5);}.css-1ombfz0:active,.css-1ombfz0[data-active]{background:white.700;background-color:var(--chakra-colors-gray-200);}.css-r0ozme{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;white-space:nowrap;vertical-align:middle;outline:2px solid transparent;outline-offset:2px;line-height:1.2;border-radius:var(--chakra-radii-md);font-weight:500;transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-normal);gap:var(--chakra-space-2);-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;text-overflow:ellipsis;overflow:hidden;-webkit-transition:all 0.2s;transition:all 0.2s;height:var(--chakra-sizes-10);min-width:var(--chakra-sizes-10);font-size:var(--chakra-fontSizes-md);-webkit-padding-start:var(--chakra-space-4);padding-inline-start:var(--chakra-space-4);-webkit-padding-end:var(--chakra-space-4);padding-inline-end:var(--chakra-space-4);padding-top:var(--chakra-space-2);padding-bottom:var(--chakra-space-2);background:black.500;color:var(--chakra-colors-white);background-color:var(--chakra-colors-gray-950);}.css-r0ozme:focus-visible,.css-r0ozme[data-focus-visible]{box-shadow:0px 0px 0px 2px var(--chakra-colors-boxShadowFocus);outline:2px solid transparent;outline-offset:2px;}.css-r0ozme:disabled,.css-r0ozme[disabled],.css-r0ozme[aria-disabled=true],.css-r0ozme[data-disabled]{opacity:1;cursor:not-allowed;box-shadow:var(--chakra-shadows-none);background-color:var(--chakra-colors-gray-50a);color:var(--chakra-colors-gray-300);}.css-r0ozme:disabled .chakra-button__icon,.css-r0ozme[disabled] .chakra-button__icon,.css-r0ozme[aria-disabled=true] .chakra-button__icon,.css-r0ozme[data-disabled] .chakra-button__icon{color:var(--chakra-colors-gray-300);}.css-r0ozme:disabled:hover,.css-r0ozme[disabled]:hover,.css-r0ozme[aria-disabled=true]:hover,.css-r0ozme[data-disabled]:hover,.css-r0ozme:disabled[data-hover],.css-r0ozme[disabled][data-hover],.css-r0ozme[aria-disabled=true][data-hover],.css-r0ozme[data-disabled][data-hover]{background-color:var(--chakra-colors-gray-50a);}.css-r0ozme:disabled:active,.css-r0ozme[disabled]:active,.css-r0ozme[aria-disabled=true]:active,.css-r0ozme[data-disabled]:active,.css-r0ozme:disabled[data-active],.css-r0ozme[disabled][data-active],.css-r0ozme[aria-disabled=true][data-active],.css-r0ozme[data-disabled][data-active]{background-color:var(--chakra-colors-gray-50a);}.css-r0ozme:disabled:focus,.css-r0ozme[disabled]:focus,.css-r0ozme[aria-disabled=true]:focus,.css-r0ozme[data-disabled]:focus,.css-r0ozme:disabled[data-focus],.css-r0ozme[disabled][data-focus],.css-r0ozme[aria-disabled=true][data-focus],.css-r0ozme[data-disabled][data-focus]{background-color:var(--chakra-colors-gray-50a);}.css-r0ozme:hover,.css-r0ozme[data-hover]{background:black.600;background-color:var(--chakra-colors-gray-800);}.css-r0ozme:hover:disabled,.css-r0ozme[data-hover]:disabled,.css-r0ozme:hover[disabled],.css-r0ozme[data-hover][disabled],.css-r0ozme:hover[aria-disabled=true],.css-r0ozme[data-hover][aria-disabled=true],.css-r0ozme:hover[data-disabled],.css-r0ozme[data-hover][data-disabled]{background:black.500;background-color:var(--chakra-colors-gray-50a);}.css-r0ozme:focus,.css-r0ozme[data-focus]{outline:2px solid transparent;outline-offset:2px;background-color:var(--chakra-colors-gray-800);}.css-r0ozme .chakra-button__text{padding-left:var(--chakra-space-1);padding-right:var(--chakra-space-1);}.css-r0ozme .chakra-button__icon{margin:0px;padding:0px;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;color:var(--chakra-colors-white);}.css-r0ozme .chakra-button__icon,.css-r0ozme .lucide{width:var(--chakra-sizes-5);height:var(--chakra-sizes-5);}.css-r0ozme:active,.css-r0ozme[data-active]{background:black.700;background-color:var(--chakra-colors-gray-900);}.css-1wwab8g{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:0.5rem;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;isolation:isolate;}.css-1pgkvrj{background-color:var(--chakra-colors-white);border-top-color:var(--chakra-colors-chakra-border-color);border-top-width:1px;-webkit-padding-start:0.75rem;padding-inline-start:0.75rem;-webkit-padding-end:0.75rem;padding-inline-end:0.75rem;padding-top:1.5rem;padding-bottom:1.5rem;}@media screen and (min-width: 48em){.css-1pgkvrj{-webkit-padding-start:2rem;padding-inline-start:2rem;-webkit-padding-end:2rem;padding-inline-end:2rem;padding-top:2rem;padding-bottom:2rem;}}.css-bv0bvv{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;max-width:1220px;-webkit-padding-start:0px;padding-inline-start:0px;-webkit-padding-end:0px;padding-inline-end:0px;width:100%;}.css-b90z33{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:1.5rem;}@media screen and (min-width: 48em){.css-b90z33{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:3rem;}}.css-1ufsqbu{letter-spacing:0;line-height:1.45;color:var(--chakra-colors-gray-700);font-size:var(--chakra-fontSizes-xs);font-weight:400;white-space:nowrap;}.css-1rn13ix{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;gap:0.75rem;-webkit-align-self:stretch;-ms-flex-item-align:stretch;align-self:stretch;width:100%;}@media screen and (min-width: 48em){.css-1rn13ix{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:1.25rem;}}.css-1g42d1{transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-fast);transition-timing-function:var(--chakra-transition-easing-ease-out);cursor:pointer;outline:2px solid transparent;outline-offset:2px;color:var(--chakra-colors-primary-500);font-weight:400;font-size:0.75rem;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-text-decoration:none;text-decoration:none;border:0;}.css-1g42d1:hover,.css-1g42d1[data-hover]{-webkit-text-decoration:underline;text-decoration:underline;color:var(--chakra-colors-primary-600);-webkit-animation:dissolve 100ms ease-out;animation:dissolve 100ms ease-out;}.css-1g42d1:focus-visible,.css-1g42d1[data-focus-visible]{box-shadow:0 0 0px 2px var(--chakra-colors-boxShadowFocus);outline:2px solid transparent;outline-offset:2px;}.css-1g42d1 .chakra-icon,.css-1g42d1 .lucide{display:inline-block;vertical-align:middle;}.css-uykjfd{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:1.5rem;}.css-1v0cowj{transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-fast);transition-timing-function:var(--chakra-transition-easing-ease-out);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:2px solid transparent;outline-offset:2px;color:inherit;font-weight:inherit;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:100%;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;border:0;}.css-1v0cowj:hover,.css-1v0cowj[data-hover]{-webkit-text-decoration:underline;text-decoration:underline;color:var(--chakra-colors-primary-500);-webkit-animation:dissolve 100ms ease-out;animation:dissolve 100ms ease-out;}.css-1v0cowj .chakra-icon,.css-1v0cowj .lucide{display:inline-block;vertical-align:middle;}.css-1v0cowj:focus-visible,.css-1v0cowj[data-focus-visible]{box-shadow:0px 0px 0px 2px white,0px 0px 0px 4px var(--chakra-colors-boxShadowFocus);}.css-10ju93e{display:contents;}.css-10ju93e>svg{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;color:#374151;width:1.25rem;height:1.25rem;}.css-1nld6ms{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background:var(--chakra-colors-white);border-bottom-width:1px;border-color:var(--chakra-colors-chakra-border-color);border-style:solid;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:3rem;padding-bottom:var(--chakra-space-6);padding-top:3rem;background-image:none;border-bottom-color:var(--chakra-colors-chakra-border-color);}@media screen and (min-width: 48em){.css-1nld6ms{padding-bottom:var(--chakra-space-12);background-image:linear-gradient(to bottom, #fff, hsl(0 0% 98% / 1));}}.css-h6vlo7{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:3rem;max-width:1080px;width:calc(100vw - (2 * 1rem));}.css-144e9by{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;gap:var(--chakra-space-12);}@media screen and (min-width: 48em){.css-144e9by{-webkit-box-flex-wrap:nowrap;-webkit-flex-wrap:nowrap;-ms-flex-wrap:nowrap;flex-wrap:nowrap;}}.css-zg985e{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:var(--chakra-space-6);}.css-1hpe94n{border:1px solid var(--chakra-colors-gray-200);aspect-ratio:1/1;border-radius:var(--chakra-radii-full);display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;vertical-align:top;--avatar-font-size:calc(var(--avatar-size) / 2.5);width:75px;height:75px;--avatar-size:75px;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(0){z-index:0;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(1){z-index:1;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(2){z-index:2;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(3){z-index:3;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(4){z-index:4;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(5){z-index:5;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(6){z-index:6;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(7){z-index:7;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(8){z-index:8;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(9){z-index:9;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(10){z-index:10;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(11){z-index:11;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(12){z-index:12;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(13){z-index:13;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(14){z-index:14;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(15){z-index:15;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(16){z-index:16;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(17){z-index:17;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(18){z-index:18;}.chakra-avatar__group .css-1hpe94n:nth-last-of-type(19){z-index:19;}@media screen and (min-width: 48em){.css-1hpe94n{width:100px;height:100px;--avatar-size:100px;}}.css-1uqohei{aspect-ratio:1/1;object-fit:cover;border-radius:var(--chakra-radii-full);width:var(--chakra-sizes-full);height:var(--chakra-sizes-full);}.css-enj3l8{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:0px;}.css-um44p3{font-family:var(--chakra-fonts-heading);font-weight:var(--chakra-fontWeights-semibold);letter-spacing:-0.0175rem;font-size:2rem;line-height:1.1;word-break:break-word;}@media screen and (min-width: 48em){.css-um44p3{font-size:3rem;}}.css-1m58msr{letter-spacing:0;line-height:1.45;font-size:var(--chakra-fontSizes-md);font-weight:var(--chakra-fontWeights-medium);}.css-cn3a9x{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:var(--chakra-space-6);-webkit-flex:1;-ms-flex:1;flex:1;}.css-1uodvt1{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:var(--chakra-space-2);}.css-euis13{transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-fast);transition-timing-function:var(--chakra-transition-easing-ease-out);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:2px solid transparent;outline-offset:2px;color:inherit;font-weight:inherit;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;border:0;}.css-euis13:hover,.css-euis13[data-hover]{-webkit-text-decoration:underline;text-decoration:underline;color:var(--chakra-colors-primary-500);-webkit-animation:dissolve 100ms ease-out;animation:dissolve 100ms ease-out;}.css-euis13:focus-visible,.css-euis13[data-focus-visible]{box-shadow:0 0 0px 2px var(--chakra-colors-boxShadowFocus);outline:2px solid transparent;outline-offset:2px;}.css-euis13 .chakra-icon,.css-euis13 .lucide{display:inline-block;vertical-align:middle;}.css-199co4x{display:contents;}.css-199co4x>svg{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;color:#6B7280;width:1em;height:1em;}.css-1tu96jy{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;white-space:nowrap;vertical-align:middle;outline:2px solid transparent;outline-offset:2px;line-height:1.2;border-radius:var(--chakra-radii-md);font-weight:500;transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-normal);gap:var(--chakra-space-2);-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;text-overflow:ellipsis;overflow:hidden;-webkit-transition:all 0.2s;transition:all 0.2s;height:var(--chakra-sizes-8);min-width:var(--chakra-sizes-8);font-size:var(--chakra-fontSizes-sm);-webkit-padding-start:var(--chakra-space-2);padding-inline-start:var(--chakra-space-2);-webkit-padding-end:var(--chakra-space-2);padding-inline-end:var(--chakra-space-2);padding-top:0.375rem;padding-bottom:0.375rem;color:var(--chakra-colors-white);background-color:var(--chakra-colors-gray-950);background:var(--chakra-colors-black);}.css-1tu96jy:focus-visible,.css-1tu96jy[data-focus-visible]{box-shadow:0px 0px 0px 2px var(--chakra-colors-boxShadowFocus);outline:2px solid transparent;outline-offset:2px;}.css-1tu96jy:disabled,.css-1tu96jy[disabled],.css-1tu96jy[aria-disabled=true],.css-1tu96jy[data-disabled]{opacity:1;cursor:not-allowed;box-shadow:var(--chakra-shadows-none);background-color:var(--chakra-colors-gray-50a);color:var(--chakra-colors-gray-300);}.css-1tu96jy:disabled .chakra-button__icon,.css-1tu96jy[disabled] .chakra-button__icon,.css-1tu96jy[aria-disabled=true] .chakra-button__icon,.css-1tu96jy[data-disabled] .chakra-button__icon{color:var(--chakra-colors-gray-300);}.css-1tu96jy:disabled:hover,.css-1tu96jy[disabled]:hover,.css-1tu96jy[aria-disabled=true]:hover,.css-1tu96jy[data-disabled]:hover,.css-1tu96jy:disabled[data-hover],.css-1tu96jy[disabled][data-hover],.css-1tu96jy[aria-disabled=true][data-hover],.css-1tu96jy[data-disabled][data-hover]{background-color:var(--chakra-colors-gray-50a);}.css-1tu96jy:disabled:active,.css-1tu96jy[disabled]:active,.css-1tu96jy[aria-disabled=true]:active,.css-1tu96jy[data-disabled]:active,.css-1tu96jy:disabled[data-active],.css-1tu96jy[disabled][data-active],.css-1tu96jy[aria-disabled=true][data-active],.css-1tu96jy[data-disabled][data-active]{background-color:var(--chakra-colors-gray-50a);}.css-1tu96jy:disabled:focus,.css-1tu96jy[disabled]:focus,.css-1tu96jy[aria-disabled=true]:focus,.css-1tu96jy[data-disabled]:focus,.css-1tu96jy:disabled[data-focus],.css-1tu96jy[disabled][data-focus],.css-1tu96jy[aria-disabled=true][data-focus],.css-1tu96jy[data-disabled][data-focus]{background-color:var(--chakra-colors-gray-50a);}.css-1tu96jy:hover,.css-1tu96jy[data-hover]{background:black.600;background-color:var(--chakra-colors-gray-800);}.css-1tu96jy:hover:disabled,.css-1tu96jy[data-hover]:disabled,.css-1tu96jy:hover[disabled],.css-1tu96jy[data-hover][disabled],.css-1tu96jy:hover[aria-disabled=true],.css-1tu96jy[data-hover][aria-disabled=true],.css-1tu96jy:hover[data-disabled],.css-1tu96jy[data-hover][data-disabled]{background:black.500;background-color:var(--chakra-colors-gray-50a);}.css-1tu96jy:focus,.css-1tu96jy[data-focus]{outline:2px solid transparent;outline-offset:2px;background-color:var(--chakra-colors-gray-800);}.css-1tu96jy .chakra-button__text{padding-left:var(--chakra-space-1);padding-right:var(--chakra-space-1);}.css-1tu96jy .chakra-button__icon{margin:0px;padding:0px;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;color:var(--chakra-colors-white);}.css-1tu96jy .chakra-button__icon,.css-1tu96jy .lucide{width:var(--chakra-sizes-4);height:var(--chakra-sizes-4);}.css-1tu96jy:active,.css-1tu96jy[data-active]{background:black.700;background-color:var(--chakra-colors-gray-900);}.css-1gozx00{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background:var(--chakra-colors-white);border-bottom-width:0;border-color:var(--chakra-colors-chakra-border-color);border-style:solid;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:3rem;padding-bottom:3rem;padding-top:var(--chakra-space-12);}@media screen and (min-width: 48em){.css-1gozx00{padding-bottom:6rem;}}.css-90j4rp{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:var(--chakra-space-4);}.css-18b9je0{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:var(--chakra-space-2);width:var(--chakra-sizes-full);container-type:inline-size;}.css-1bxtuyq{display:grid;grid-gap:var(--chakra-space-1);-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;grid-template-columns:160px 1fr;}@container (max-width: 350px){.css-1bxtuyq{grid-template-columns:1fr;}.css-1bxtuyq >dt{font-weight:var(--chakra-fontWeights-bold);}}.css-vgxdvo{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-align-self:start;-ms-flex-item-align:start;align-self:start;min-height:var(--chakra-sizes-6);}.css-1l9ml90{letter-spacing:0;line-height:1.45;color:var(--chakra-colors-gray-500);font-size:var(--chakra-fontSizes-xs);font-weight:var(--chakra-fontWeights-medium);}.css-t1uzvz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:0px;min-height:var(--chakra-sizes-6);}.css-1os7mvd{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;vertical-align:top;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%;font-weight:var(--chakra-fontWeights-medium);line-height:1.2;outline:2px solid transparent;outline-offset:2px;--tag-color:var(--badge-color);--tag-bg:var(--badge-bg);--tag-shadow:var(--badge-shadow);color:var(--chakra-colors-gray-400);background:var(--chakra-colors-gray-100);box-shadow:var(--tag-shadow);border-radius:var(--chakra-radii-full);min-height:var(--tag-min-height);min-width:var(--tag-min-width);font-size:var(--tag-font-size);-webkit-padding-inline-start:var(--tag-padding);padding-inline-start:var(--tag-padding-inline);-webkit-padding-inline-end:var(--tag-padding);padding-inline-end:var(--tag-padding-inline);--tag-min-height:var(--chakra-sizes-6);--tag-min-width:var(--chakra-sizes-6);--tag-font-size:var(--chakra-fontSizes-sm);--tag-padding-inline:var(--chakra-space-2);--badge-bg:var(--chakra-colors-gray-100);--badge-color:var(--chakra-colors-gray-800);background-color:var(--chakra-colors-primary-50);gap:var(--chakra-space-1);}.css-1os7mvd:focus-visible,.css-1os7mvd[data-focus-visible]{--tag-shadow:var(--chakra-shadows-outline);}.chakra-ui-dark .css-1os7mvd:not([data-theme]),[data-theme=dark] .css-1os7mvd:not([data-theme]),.css-1os7mvd[data-theme=dark]{--badge-bg:rgba(229, 231, 235, 0.16);--badge-color:var(--chakra-colors-gray-200);}.css-16d6gy0{display:contents;}.css-16d6gy0>svg{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;color:#fa5e06;width:1rem;height:1rem;}.css-1rl57da{line-height:1.2;overflow:hidden;color:var(--chakra-colors-gray-950);text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:var(--chakra-line-clamp);--chakra-line-clamp:1;font-size:var(--chakra-fontSizes-xs);font-weight:var(--chakra-fontWeights-medium);}.css-o959d8{letter-spacing:0;line-height:1.45;font-size:var(--chakra-fontSizes-xs);font-weight:var(--chakra-fontWeights-medium);}.css-porbmv{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;gap:var(--chakra-space-2);}.css-1ol2nsm{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;vertical-align:top;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%;font-weight:var(--chakra-fontWeights-medium);line-height:1.2;outline:2px solid transparent;outline-offset:2px;--tag-color:var(--badge-color);--tag-bg:var(--badge-bg);--tag-shadow:var(--badge-shadow);box-shadow:var(--tag-shadow);border-radius:var(--chakra-radii-full);min-height:var(--tag-min-height);min-width:var(--tag-min-width);font-size:var(--tag-font-size);-webkit-padding-inline-start:var(--tag-padding);padding-inline-start:var(--tag-padding-inline);-webkit-padding-inline-end:var(--tag-padding);padding-inline-end:var(--tag-padding-inline);--tag-min-height:var(--chakra-sizes-5);--tag-min-width:var(--chakra-sizes-5);--tag-font-size:var(--chakra-fontSizes-xs);--tag-padding-inline:var(--chakra-space-2);--badge-bg:var(--chakra-colors-gray-100);--badge-color:var(--chakra-colors-gray-800);background:var(--chakra-colors-white);border:1px solid;border-color:var(--chakra-colors-chakra-border-color);color:var(--chakra-colors-gray-950);gap:var(--chakra-space-1);padding-top:var(--chakra-space-0-5);padding-bottom:var(--chakra-space-0-5);word-break:break-word;}.css-1ol2nsm:focus-visible,.css-1ol2nsm[data-focus-visible]{--tag-shadow:var(--chakra-shadows-outline);}.chakra-ui-dark .css-1ol2nsm:not([data-theme]),[data-theme=dark] .css-1ol2nsm:not([data-theme]),.css-1ol2nsm[data-theme=dark]{--badge-bg:rgba(229, 231, 235, 0.16);--badge-color:var(--chakra-colors-gray-200);}.css-1ol2nsm:hover,.css-1ol2nsm[data-hover]{background:var(--chakra-colors-gray-50);}.css-73n1r9{display:contents;}.css-73n1r9>svg{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;color:#000000;width:1rem;height:1rem;}.css-dp0ctz{line-height:1.2;overflow:hidden;color:var(--chakra-colors-gray-950);text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:var(--chakra-line-clamp);--chakra-line-clamp:1;white-space:nowrap;font-size:var(--chakra-fontSizes-xs);font-weight:500;}.css-1skpokq{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;gap:var(--chakra-space-4);}.css-1so5w5b{transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-fast);transition-timing-function:var(--chakra-transition-easing-ease-out);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:2px solid transparent;outline-offset:2px;color:inherit;font-weight:inherit;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:var(--chakra-space-2);border:0;}.css-1so5w5b:hover,.css-1so5w5b[data-hover]{-webkit-text-decoration:underline;text-decoration:underline;color:var(--chakra-colors-primary-500);-webkit-animation:dissolve 100ms ease-out;animation:dissolve 100ms ease-out;}.css-1so5w5b:focus-visible,.css-1so5w5b[data-focus-visible]{box-shadow:0 0 0px 2px var(--chakra-colors-boxShadowFocus);outline:2px solid transparent;outline-offset:2px;}.css-1so5w5b .chakra-icon,.css-1so5w5b .lucide{display:inline-block;vertical-align:middle;}.css-15ua73h{border:1px solid var(--chakra-colors-gray-200);aspect-ratio:1/1;border-radius:var(--chakra-radii-full);display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;vertical-align:top;--avatar-font-size:calc(var(--avatar-size) / 2.5);width:20px;height:20px;--avatar-size:3rem;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(0){z-index:0;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(1){z-index:1;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(2){z-index:2;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(3){z-index:3;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(4){z-index:4;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(5){z-index:5;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(6){z-index:6;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(7){z-index:7;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(8){z-index:8;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(9){z-index:9;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(10){z-index:10;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(11){z-index:11;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(12){z-index:12;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(13){z-index:13;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(14){z-index:14;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(15){z-index:15;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(16){z-index:16;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(17){z-index:17;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(18){z-index:18;}.chakra-avatar__group .css-15ua73h:nth-last-of-type(19){z-index:19;}.css-1dmhezw{letter-spacing:0;line-height:1.45;font-size:var(--chakra-fontSizes-sm);font-weight:var(--chakra-fontWeights-medium);}.css-14ry2m8{opacity:1;border:0;border-color:var(--chakra-colors-gray-200);border-style:solid;border-bottom-width:1px;width:100%;}.css-6bkskg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:var(--chakra-space-8);}.css-93jg2x{font-family:var(--chakra-fonts-heading);line-height:1.2;letter-spacing:-0.0175rem;font-size:var(--chakra-fontSizes-3xl);font-weight:var(--chakra-fontWeights-semibold);}.css-180fw1m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:var(--chakra-space-12);}.css-12vwza8{display:grid;grid-gap:var(--chakra-space-6);grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));}.css-kabsx8{-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;grid-template-columns:2rem 1fr;}.css-wnr2r6{display:grid;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;grid-template-columns:2rem 1fr;}.css-1fh5bdn{display:grid;grid-gap:0px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;grid-column:1/span 2;grid-template-columns:inherit;}.css-14n2vmc{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;width:1rem;height:1rem;border-radius:var(--chakra-radii-full);background-color:var(--chakra-colors-severity-critical);}.css-1wzn9m2{letter-spacing:0;line-height:1.45;font-size:var(--chakra-fontSizes-md);font-weight:var(--chakra-fontWeights-semibold);}.css-17roaq2{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:0px;grid-column:2/2;}.css-9h3ub9{letter-spacing:0;line-height:1.45;color:var(--chakra-colors-gray-500);font-size:var(--chakra-fontSizes-sm);}.css-lutnni{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;width:1rem;height:1rem;border-radius:var(--chakra-radii-full);background-color:var(--chakra-colors-severity-high);}.css-yv6bx6{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;width:1rem;height:1rem;border-radius:var(--chakra-radii-full);background-color:var(--chakra-colors-severity-medium);}.css-1x2krjs{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;width:1rem;height:1rem;border-radius:var(--chakra-radii-full);background-color:var(--chakra-colors-severity-informational);}.css-1f0j1p5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:var(--chakra-space-12);counter-reset:report-severities;}.css-1cyyl4u{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:var(--chakra-space-4);}.css-1vy91a6{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;width:var(--chakra-sizes-4);height:var(--chakra-sizes-4);border-radius:var(--chakra-radii-full);background-color:var(--chakra-colors-severity-critical);}.css-1hlsh2c{font-family:var(--chakra-fonts-heading);line-height:1.2;letter-spacing:-0.0175rem;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;font-size:var(--chakra-fontSizes-2xl);font-weight:var(--chakra-fontWeights-semibold);gap:var(--chakra-space-2);counter-increment:report-severities;}.css-1hlsh2c::before{content:counter(report-severities) ".";}@media screen and (min-width: 48em){.css-1hlsh2c{font-size:var(--chakra-fontSizes-3xl);}}.css-1nvbuct{letter-spacing:0;line-height:1.45;color:var(--chakra-colors-gray-500);}.css-lq80v0{list-style-type:none;-webkit-margin-start:1em;margin-inline-start:1em;margin:0px;counter-reset:report-severity-findings;}.css-lq80v0>*:not(style)~*:not(style){margin-top:var(--chakra-space-8);}.css-1kc89qn{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:var(--chakra-space-6);border:1px solid;border-color:var(--chakra-colors-chakra-border-color);border-radius:var(--chakra-radii-md);padding:var(--chakra-space-8);}.css-thn72w{font-family:var(--chakra-fonts-heading);line-height:1.2;letter-spacing:-0.0175rem;color:var(--chakra-colors-gray-950);font-size:var(--chakra-fontSizes-2xl);font-weight:var(--chakra-fontWeights-semibold);word-break:break-word;counter-increment:report-severity-findings;}.css-thn72w::before{content:counter(report-severities) "." counter(report-severity-findings) " ";}@media screen and (min-width: 48em){.css-thn72w{font-size:var(--chakra-fontSizes-3xl);}}.css-l0e4mh{display:inline-block;font-family:var(--chakra-fonts-mono);background:var(--badge-bg);color:var(--badge-color);box-shadow:var(--badge-shadow);--badge-bg:var(--chakra-colors-gray-100);--badge-color:var(--chakra-colors-gray-800);border-radius:4px;font-size:inherit;-webkit-padding-start:var(--chakra-space-1);padding-inline-start:var(--chakra-space-1);-webkit-padding-end:var(--chakra-space-1);padding-inline-end:var(--chakra-space-1);padding-top:0px;padding-bottom:0px;background-color:var(--chakra-colors-gray-100);}.chakra-ui-dark .css-l0e4mh:not([data-theme]),[data-theme=dark] .css-l0e4mh:not([data-theme]),.css-l0e4mh[data-theme=dark]{--badge-bg:rgba(229, 231, 235, 0.16);--badge-color:var(--chakra-colors-gray-200);}.css-14ge14j{display:grid;grid-gap:var(--chakra-space-1);-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;grid-template-columns:120px 1fr;}@container (max-width: 350px){.css-14ge14j{grid-template-columns:1fr;}.css-14ge14j >dt{font-weight:var(--chakra-fontWeights-bold);}}.css-1lnofw7{vertical-align:top;max-width:100%;font-weight:var(--chakra-fontWeights-medium);outline:2px solid transparent;outline-offset:2px;--tag-color:var(--badge-color);--tag-bg:var(--badge-bg);--tag-shadow:var(--badge-shadow);background:var(--chakra-colors-gray-100);box-shadow:var(--tag-shadow);border-radius:var(--chakra-radii-full);min-height:var(--tag-min-height);min-width:-webkit-fit-content;min-width:-moz-fit-content;min-width:fit-content;font-size:var(--tag-font-size);--tag-min-height:var(--chakra-sizes-5);--tag-min-width:var(--chakra-sizes-5);--tag-font-size:var(--chakra-fontSizes-xs);--tag-padding-inline:var(--chakra-space-2);--badge-bg:var(--chakra-colors-gray-100);--badge-color:var(--chakra-colors-gray-800);-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:var(--chakra-colors-status-bg-fixed);border:1px solid;border-color:var(--chakra-colors-status-bg-fixed);color:var(--chakra-colors-status-fixed);display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;gap:var(--chakra-space-1-5);line-height:1rem;-webkit-padding-start:0.375rem;padding-inline-start:0.375rem;-webkit-padding-end:0.375rem;padding-inline-end:0.375rem;padding-top:0.125rem;padding-bottom:0.125rem;}.css-1lnofw7:focus-visible,.css-1lnofw7[data-focus-visible]{--tag-shadow:var(--chakra-shadows-outline);}.chakra-ui-dark .css-1lnofw7:not([data-theme]),[data-theme=dark] .css-1lnofw7:not([data-theme]),.css-1lnofw7[data-theme=dark]{--badge-bg:rgba(229, 231, 235, 0.16);--badge-color:var(--chakra-colors-gray-200);}.css-101m3ux{display:contents;}.css-101m3ux>svg{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;color:currentColor;width:0.875rem;height:0.875rem;}.css-1l8566{overflow:hidden;font-weight:var(--chakra-fontWeights-medium);text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:var(--chakra-line-clamp);--chakra-line-clamp:1;color:inherit;font-size:inherit;line-height:1rem;text-transform:capitalize;}.css-hyehfz{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;vertical-align:top;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:10rem;font-weight:var(--chakra-fontWeights-medium);line-height:1.2;outline:2px solid transparent;outline-offset:2px;--tag-color:var(--badge-color);--tag-bg:var(--badge-bg);--tag-shadow:var(--badge-shadow);box-shadow:var(--tag-shadow);min-height:var(--tag-min-height);min-width:var(--tag-min-width);font-size:var(--tag-font-size);-webkit-padding-inline-start:var(--tag-padding);padding-inline-start:var(--tag-padding-inline);-webkit-padding-inline-end:var(--tag-padding);padding-inline-end:var(--tag-padding-inline);--tag-min-height:var(--chakra-sizes-5);--tag-min-width:var(--chakra-sizes-5);--tag-font-size:var(--chakra-fontSizes-xs);--tag-padding-inline:var(--chakra-space-2);--badge-bg:var(--chakra-colors-gray-100);--badge-color:var(--chakra-colors-gray-800);background:var(--chakra-colors-white);border:1px solid;border-color:var(--chakra-colors-chakra-border-color);border-radius:var(--chakra-radii-full);color:var(--chakra-colors-gray-950);}.css-hyehfz:focus-visible,.css-hyehfz[data-focus-visible]{--tag-shadow:var(--chakra-shadows-outline);}.chakra-ui-dark .css-hyehfz:not([data-theme]),[data-theme=dark] .css-hyehfz:not([data-theme]),.css-hyehfz[data-theme=dark]{--badge-bg:rgba(229, 231, 235, 0.16);--badge-color:var(--chakra-colors-gray-200);}.css-hyehfz:hover,.css-hyehfz[data-hover]{background:var(--chakra-colors-gray-100);}.css-n1un5q{letter-spacing:0;line-height:1.45;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}.css-ypnwc0{vertical-align:top;max-width:100%;outline:2px solid transparent;outline-offset:2px;--tag-color:var(--badge-color);--tag-bg:var(--badge-bg);--tag-shadow:var(--badge-shadow);color:var(--chakra-colors-gray-400);background:var(--chakra-colors-gray-100);box-shadow:var(--tag-shadow);border-radius:var(--chakra-radii-full);min-height:var(--tag-min-height);min-width:var(--tag-min-width);font-size:var(--tag-font-size);--tag-min-height:var(--chakra-sizes-5);--tag-min-width:var(--chakra-sizes-5);--tag-font-size:var(--chakra-fontSizes-xs);--tag-padding-inline:var(--chakra-space-2);--badge-bg:var(--chakra-colors-gray-100);--badge-color:var(--chakra-colors-gray-800);-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:var(--chakra-colors-transparent);border:1px solid;border-color:var(--chakra-colors-chakra-border-color);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:0.375rem;line-height:1rem;-webkit-padding-start:0.375rem;padding-inline-start:0.375rem;-webkit-padding-end:0.375rem;padding-inline-end:0.375rem;padding-top:0.125rem;padding-bottom:0.125rem;font-weight:600;}.css-ypnwc0:focus-visible,.css-ypnwc0[data-focus-visible]{--tag-shadow:var(--chakra-shadows-outline);}.chakra-ui-dark .css-ypnwc0:not([data-theme]),[data-theme=dark] .css-ypnwc0:not([data-theme]),.css-ypnwc0[data-theme=dark]{--badge-bg:rgba(229, 231, 235, 0.16);--badge-color:var(--chakra-colors-gray-200);}.css-7e8jyl{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;width:0.5rem;height:0.5rem;border-radius:var(--chakra-radii-full);background-color:var(--chakra-colors-severity-critical);}.css-v26npq{overflow:hidden;font-weight:var(--chakra-fontWeights-medium);text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:var(--chakra-line-clamp);--chakra-line-clamp:1;color:var(--chakra-colors-gray-950);font-size:inherit;line-height:1rem;text-transform:capitalize;}.css-phvdpk{letter-spacing:0;line-height:1.45;color:var(--chakra-colors-gray-500);font-size:var(--chakra-fontSizes-xs);}.css-wxyuev{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;width:0.5rem;height:0.5rem;border-radius:var(--chakra-radii-full);background-color:var(--chakra-colors-severity-high);}.css-1e0kj1c{letter-spacing:0;line-height:1.45;font-size:var(--chakra-fontSizes-xs);}.css-1rem1b3{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-self:stretch;-ms-flex-item-align:stretch;align-self:stretch;background:var(--chakra-colors-transparent);-webkit-flex:1;-ms-flex:1;flex:1;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;font-family:var(--chakra-fonts-body);font-size:var(--chakra-fontSizes-sm);position:relative;word-break:break-word;}.css-1rem1b3 code[class*="language-"],.css-1rem1b3 pre[class*="language-"]{color:var(--chakra-colors-codeHighlighting-plain);background:var(--chakra-colors-white);text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;font-family:SFMono-Regular,Menlo,Monaco,Consolas,monospace;font-size:0.75rem;line-height:1.5em;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-1rem1b3 :not(pre)>code[class*="language-"]{white-space:normal;border-radius:0.2em;padding:0.1em;}.css-1rem1b3 pre[class*="language-"]{overflow:auto;position:relative;margin:0.5em 0;padding:1.25em 1em;border:1px solid #ececec;border-radius:4px;}.css-1rem1b3 [class*="language-"] .namespace{opacity:0.7;}.css-1rem1b3 :where(img, svg, video, canvas, audio, iframe, embed, object){display:initial;}.css-1rem1b3 h1{border-bottom-color:var(--chakra-colors-gray-200);}.css-1rem1b3 h2{border-bottom-color:var(--chakra-colors-gray-200);}.css-1rem1b3 .token.tag,.css-1rem1b3 .token.selector,.css-1rem1b3 .token.keyword,.css-1rem1b3 .token.operator,.css-1rem1b3 .token.atrule{color:var(--chakra-colors-codeHighlighting-keyword);}.css-1rem1b3 .token.comment,.css-1rem1b3 .token.prolog,.css-1rem1b3 .token.doctype,.css-1rem1b3 .token.cdata{color:var(--chakra-colors-codeHighlighting-meta);font-style:italic;}.css-1rem1b3 .token.namespace{opacity:0.7;}.css-1rem1b3 .token.string,.css-1rem1b3 .token.attr-value,.css-1rem1b3 .token.attribute,.css-1rem1b3 .token.pseudo-class,.css-1rem1b3 .token.pseudo-element{color:var(--chakra-colors-codeHighlighting-string);}.css-1rem1b3 .token.number,.css-1rem1b3 .token.boolean,.css-1rem1b3 .token.builtin,.css-1rem1b3 .token.entity,.css-1rem1b3 .token.url,.css-1rem1b3 .token.symbol,.css-1rem1b3 .token.variable,.css-1rem1b3 .token.constant,.css-1rem1b3 .token.property,.css-1rem1b3 .token.regex,.css-1rem1b3 .token.attr-name,.css-1rem1b3 .token.unit,.css-1rem1b3 .token.hexcode{color:var(--chakra-colors-codeHighlighting-literal);}.css-1rem1b3 .token.punctuation,.css-1rem1b3 .token.char,.css-1rem1b3 .token.class{color:var(--chakra-colors-codeHighlighting-plain);}.css-1rem1b3 .token.function,.css-1rem1b3 .token.class-name,.css-1rem1b3 .token.function-variable,.css-1rem1b3 .token.id{color:var(--chakra-colors-codeHighlighting-identifier);}.css-1rem1b3 .token.important,.css-1rem1b3 .token.bold{font-weight:var(--chakra-fontWeights-bold);}.css-1rem1b3 .token.italic{font-style:italic;}.css-1rem1b3 .token.deleted{color:var(--chakra-colors-codeHighlighting-diff-deleted);}.css-1rem1b3 .token.inserted{color:var(--chakra-colors-codeHighlighting-diff-inserted);}.css-jg3yxe{font-family:var(--chakra-fonts-heading);font-weight:var(--chakra-fontWeights-semibold);font-size:var(--chakra-fontSizes-4xl);line-height:1.2;letter-spacing:-0.0175rem;margin-bottom:var(--chakra-space-5);}.css-xcnbdp{letter-spacing:0;line-height:1.45;margin-bottom:var(--chakra-space-3);}.css-15y7uvo{transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-fast);transition-timing-function:var(--chakra-transition-easing-ease-out);cursor:pointer;outline:2px solid transparent;outline-offset:2px;color:inherit;font-weight:inherit;-webkit-text-decoration:underline;text-decoration:underline;border:0;}.css-15y7uvo:hover,.css-15y7uvo[data-hover]{-webkit-text-decoration:underline;text-decoration:underline;color:var(--chakra-colors-primary-500);-webkit-animation:dissolve 100ms ease-out;animation:dissolve 100ms ease-out;}.css-15y7uvo:focus-visible,.css-15y7uvo[data-focus-visible]{box-shadow:0 0 0px 2px var(--chakra-colors-boxShadowFocus);outline:2px solid transparent;outline-offset:2px;}.css-15y7uvo .chakra-icon,.css-15y7uvo .lucide{display:inline-block;vertical-align:middle;}.css-1kxrhf3{white-space:pre-wrap;}.css-1dsl60n{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;width:var(--chakra-sizes-4);height:var(--chakra-sizes-4);border-radius:var(--chakra-radii-full);background-color:var(--chakra-colors-severity-high);}.css-mgdx75{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;width:0.5rem;height:0.5rem;border-radius:var(--chakra-radii-full);background-color:var(--chakra-colors-severity-low);}.css-tu0njr{list-style-type:initial;-webkit-margin-start:1em;margin-inline-start:1em;}.css-c8eelt{font-family:var(--chakra-fonts-heading);font-weight:var(--chakra-fontWeights-semibold);font-size:var(--chakra-fontSizes-3xl);line-height:1.2;letter-spacing:0;margin-bottom:var(--chakra-space-4);}.css-1dg6mvm{list-style-type:decimal;-webkit-margin-start:1em;margin-inline-start:1em;}.css-8vzs7e{letter-spacing:0;line-height:1.45;}.css-1f8olwv{font-family:var(--chakra-fonts-heading);font-weight:var(--chakra-fontWeights-semibold);font-size:var(--chakra-fontSizes-2xl);line-height:1.2;letter-spacing:0;margin-bottom:var(--chakra-space-3);}.css-1ucn39k{font-family:var(--chakra-fonts-heading);font-weight:var(--chakra-fontWeights-semibold);font-size:var(--chakra-fontSizes-xl);line-height:1.3;letter-spacing:0;margin-bottom:var(--chakra-space-2);}.css-ylswkg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;width:var(--chakra-sizes-4);height:var(--chakra-sizes-4);border-radius:var(--chakra-radii-full);background-color:var(--chakra-colors-severity-medium);}.css-1s7y7bx{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;width:0.5rem;height:0.5rem;border-radius:var(--chakra-radii-full);background-color:var(--chakra-colors-severity-medium);}.css-11kvcua{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;width:var(--chakra-sizes-4);height:var(--chakra-sizes-4);border-radius:var(--chakra-radii-full);background-color:var(--chakra-colors-severity-informational);}.css-dti5c1{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;width:0.5rem;height:0.5rem;border-radius:var(--chakra-radii-full);background-color:var(--chakra-colors-severity-informational);}</style></head><body><main style="display:flex;flex-direction:column;min-height:100vh"><style>
:root {
  --bprogress-color: var(--chakra-colors-primary-500);
  --bprogress-height: 2px;
  --bprogress-spinner-size: 18px;
  --bprogress-spinner-animation-duration: 400ms;
  --bprogress-spinner-border-size: 2px;
  --bprogress-box-shadow: 0 0 10px var(--chakra-colors-primary-500), 0 0 5px var(--chakra-colors-primary-500);
  --bprogress-z-index: 99999;
  --bprogress-spinner-top: 15px;
  --bprogress-spinner-bottom: auto;
  --bprogress-spinner-right: 15px;
  --bprogress-spinner-left: auto;
}

.bprogress {
  pointer-events: none;
  z-index: var(--bprogress-z-index);
}

.bprogress .bar {
  background: var(--bprogress-color);
  position: fixed;
  z-index: var(--bprogress-z-index);
  top: 0;
  left: 0;
  width: 100%;
  height: var(--bprogress-height);
}

/* Fancy blur effect */
.bprogress .peg {
  display: block;
  position: absolute;
  right: 0;
  width: 100px;
  height: 100%;
  box-shadow: var(--bprogress-box-shadow);
  opacity: 1.0;
  transform: rotate(3deg) translate(0px, -4px);
}

/* Remove these to get rid of the spinner */
.bprogress .spinner {
  display: block;
  position: fixed;
  z-index: var(--bprogress-z-index);
  top: var(--bprogress-spinner-top);
  bottom: var(--bprogress-spinner-bottom);
  right: var(--bprogress-spinner-right);
  left: var(--bprogress-spinner-left);
}

.bprogress .spinner-icon {
  width: var(--bprogress-spinner-size);
  height: var(--bprogress-spinner-size);
  box-sizing: border-box;
  border: solid var(--bprogress-spinner-border-size) transparent;
  border-top-color: var(--bprogress-color);
  border-left-color: var(--bprogress-color);
  border-radius: 50%;
  -webkit-animation: bprogress-spinner var(--bprogress-spinner-animation-duration) linear infinite;
  animation: bprogress-spinner var(--bprogress-spinner-animation-duration) linear infinite;
}

.bprogress-custom-parent {
  overflow: hidden;
  position: relative;
}

.bprogress-custom-parent .bprogress .spinner,
.bprogress-custom-parent .bprogress .bar {
  position: absolute;
}

.bprogress .indeterminate {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: var(--bprogress-height);
  overflow: hidden;
}

.bprogress .indeterminate .inc,
.bprogress .indeterminate .dec {
  position: absolute;
  top: 0;
  height: 100%;
  background-color: var(--bprogress-color);
}

.bprogress .indeterminate .inc {
  animation: bprogress-indeterminate-increase 2s infinite;
}

.bprogress .indeterminate .dec {
  animation: bprogress-indeterminate-decrease 2s 0.5s infinite;
}

@-webkit-keyframes bprogress-spinner {
  0%   { -webkit-transform: rotate(0deg); transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); transform: rotate(360deg); }
}

@keyframes bprogress-spinner {
  0%   { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

@keyframes bprogress-indeterminate-increase {
  from { left: -5%; width: 5%; }
  to { left: 130%; width: 100%; }
}

@keyframes bprogress-indeterminate-decrease {
  from { left: -80%; width: 80%; }
  to { left: 110%; width: 10%; }
}
</style><!--$--><!--/$--><section class="css-1akmemn"><nav class="chakra-stack css-16vni6q"><div class="chakra-stack css-18r1sh1"><a rel="nofollow" class="chakra-link css-128ezeu" href="/"><svg viewBox="0 0 48 48" class="css-10xqgwl"><g><path d="M23.9984 0C17.597 0 11.5653 2.57373 7.01835 7.24603C2.49124 11.8952 0 18.0491 0 24.5758V45.0006C0 46.657 1.34296 48 2.99938 48C4.65581 48 5.99876 46.657 5.99876 45.0006V24.5758C5.99876 19.623 7.88616 14.954 11.3178 11.43C14.7263 7.92906 19.2304 5.99876 23.9984 5.99876C28.7663 5.99876 33.2704 7.92576 36.6789 11.43C40.1072 14.954 41.9979 19.623 41.9979 24.5758V45.0006C41.9979 46.657 43.3409 48 44.9973 48C46.6537 48 47.9967 46.657 47.9967 45.0006V24.5758C47.9967 18.0491 45.5055 11.8952 40.9783 7.24603C36.4347 2.57373 30.403 0 23.9984 0Z" fill="black"></path><path d="M23.9983 23.9984C22.3419 23.9984 20.999 25.3413 20.999 26.9977V44.9973C20.999 46.6537 22.3419 47.9967 23.9983 47.9967C25.6548 47.9967 26.9977 46.6537 26.9977 44.9973V26.9977C26.9977 25.3413 25.6548 23.9984 23.9983 23.9984Z" fill="var(--chakra-colors-primary-500)"></path></g></svg></a><nav aria-label="breadcrumb" class="chakra-breadcrumb css-18jx1zi"><ol class="chakra-breadcrumb__list css-70qvj9"></ol></nav><div class="chakra-stack css-5uedcu"><div class="chakra-tabs css-1lb2iqg"><div role="tablist" aria-orientation="horizontal" class="chakra-tabs__tablist css-vtap6t"><a type="button" aria-disabled="false" id="tabs-:R3aj6dt4lbqnb:--tab--1" role="tab" tabindex="0" aria-selected="true" aria-controls="tabs-:R3aj6dt4lbqnb:--tabpanel--1" class="chakra-tabs__tab css-19wynbg" href="/opportunities"><span class="chakra-stack css-iv50s2"><span class="chakra-text css-1i65up9" data-text="Opportunities">Opportunities</span></span></a><a type="button" aria-disabled="false" id="tabs-:R3aj6dt4lbqnb:--tab--1" role="tab" tabindex="0" aria-selected="true" aria-controls="tabs-:R3aj6dt4lbqnb:--tabpanel--1" class="chakra-tabs__tab css-19wynbg" href="/leaderboard"><span class="chakra-stack css-iv50s2"><span class="chakra-text css-1i65up9" data-text="Leaderboard">Leaderboard</span></span></a><a type="button" aria-disabled="false" id="tabs-:R3aj6dt4lbqnb:--tab--1" role="tab" tabindex="0" aria-selected="true" aria-controls="tabs-:R3aj6dt4lbqnb:--tabpanel--1" class="chakra-tabs__tab css-19wynbg" href="/welcome"><span class="chakra-stack css-iv50s2"><span class="chakra-text css-1i65up9" data-text="Discover Cantina">Discover Cantina</span></span></a></div></div></div></div><div class="chakra-stack css-8pmr8q"><div class="chakra-stack css-8pmr8q"><a class="chakra-button css-1ombfz0" href="/login">Log in</a><a class="chakra-button css-r0ozme" href="/signup">Sign up</a></div></div></nav><div class="chakra-stack css-1wwab8g"><section class="css-1nld6ms"><div class="css-h6vlo7"><div class="chakra-stack css-144e9by"><div class="chakra-stack css-zg985e"><div data-test-id="mask" aria-label="Logo of PaintSwap" class="css-1hpe94n"><img alt="PaintSwap" width="128" height="128" decoding="async" data-nimg="1" class="no-dark-mode css-1uqohei" style="color:transparent" srcSet="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F7a499fdf-33f5-465b-70cf-0d96eb6f9700%2Fpublic&amp;w=128&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F7a499fdf-33f5-465b-70cf-0d96eb6f9700%2Fpublic&amp;w=256&amp;q=75 2x" src="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F7a499fdf-33f5-465b-70cf-0d96eb6f9700%2Fpublic&amp;w=256&amp;q=75"/></div><div class="chakra-stack css-enj3l8"><h1 class="chakra-heading css-um44p3">Sonic Airdrop Contracts</h1><p class="chakra-text css-1m58msr">Cantina Security Report</p></div></div><div class="chakra-stack css-cn3a9x"><div class="chakra-stack css-1uodvt1"><a target="_blank" rel="noopener nofollow" class="chakra-link css-euis13" href="https://paintswap.finance/"><span class="css-199co4x"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="#6B7280" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-globe" aria-hidden="true"><circle cx="12" cy="12" r="10"></circle><path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"></path><path d="M2 12h20"></path></svg></span></a></div><button type="button" class="chakra-button css-1tu96jy">Download Report</button></div></div></div></section><section class="css-1gozx00"><div class="css-h6vlo7"><div class="chakra-stack css-90j4rp"><dl class="chakra-stack css-18b9je0"><div class="css-1bxtuyq"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">Organization</p></dt><dd class="chakra-stack css-t1uzvz"><a class="css-1os7mvd" href="/u/PaintSwap"><span class="css-16d6gy0"><svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 24 24" fill="none" stroke="#fa5e06" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-badge-check" aria-hidden="true"><path d="M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z"></path><path d="m9 12 2 2 4-4"></path></svg></span><span class="css-1rl57da">@<!-- -->PaintSwap</span></a></dd></div><div class="css-1bxtuyq"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">Engagement Type</p></dt><dd class="chakra-stack css-t1uzvz"><p class="chakra-text css-o959d8">Cantina Reviews</p></dd></div><div class="css-1bxtuyq"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">Period</p></dt><dd class="chakra-stack css-t1uzvz"><p class="chakra-text css-o959d8"><time dateTime="2025-07-25">25 July 2025</time> - <time dateTime="2025-07-30">30 July 2025</time></p></dd></div><div class="css-1bxtuyq"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">Repositories</p></dt><dd class="chakra-stack css-t1uzvz"><div class="chakra-stack css-porbmv"><a href="https://github.com/PaintSwap/sonic-airdrop-contracts" rel="noopener noreferrer" target="_blank" class="css-1ol2nsm"><span class="css-73n1r9"><svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" fill="#000000" viewBox="0 0 24 24" stroke-width="1.5"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></span><span class="css-dp0ctz">PaintSwap/sonic-airdrop-contracts</span></a></div></dd></div><div class="css-1bxtuyq"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">Researchers</p></dt><dd class="chakra-stack css-t1uzvz"><div class="chakra-stack css-1skpokq"><a rel="nofollow" class="chakra-link css-1so5w5b" href="/u/Saw-mon-and-Natalie"><div data-test-id="mask" class="css-15ua73h"><img alt="" width="128" height="128" decoding="async" data-nimg="1" class="no-dark-mode css-1uqohei" style="color:transparent" srcSet="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=128&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=256&amp;q=75 2x" src="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=256&amp;q=75"/></div><p class="chakra-text css-1dmhezw">Saw-mon and Natalie</p></a><a rel="nofollow" class="chakra-link css-1so5w5b" href="/u/thereksfour"><div data-test-id="mask" class="css-15ua73h"><img alt="" width="128" height="128" decoding="async" data-nimg="1" class="no-dark-mode css-1uqohei" style="color:transparent" srcSet="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2Fd5e6d378-e0c9-47e8-66eb-fba7e9ce9700%2Fpublic&amp;w=128&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2Fd5e6d378-e0c9-47e8-66eb-fba7e9ce9700%2Fpublic&amp;w=256&amp;q=75 2x" src="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2Fd5e6d378-e0c9-47e8-66eb-fba7e9ce9700%2Fpublic&amp;w=256&amp;q=75"/></div><p class="chakra-text css-1dmhezw">cccz</p></a></div></dd></div></dl></div><hr aria-orientation="horizontal" class="chakra-divider css-14ry2m8"/><section class="chakra-stack css-6bkskg"><h2 class="chakra-heading css-93jg2x">Findings</h2><div class="chakra-stack css-180fw1m"><div class="css-12vwza8"><div class="css-wnr2r6"><div class="css-1fh5bdn"><div class="css-14n2vmc"></div><p class="chakra-text css-1wzn9m2">Critical Risk</p></div><div class="chakra-stack css-17roaq2"><p class="chakra-text css-9h3ub9">1<!-- --> findings</p><p class="chakra-text css-9h3ub9">1<!-- --> fixed</p><p class="chakra-text css-9h3ub9">0<!-- --> acknowledged</p></div></div><div class="css-wnr2r6"><div class="css-1fh5bdn"><div class="css-lutnni"></div><p class="chakra-text css-1wzn9m2">High Risk</p></div><div class="chakra-stack css-17roaq2"><p class="chakra-text css-9h3ub9">1<!-- --> findings</p><p class="chakra-text css-9h3ub9">1<!-- --> fixed</p><p class="chakra-text css-9h3ub9">0<!-- --> acknowledged</p></div></div><div class="css-wnr2r6"><div class="css-1fh5bdn"><div class="css-yv6bx6"></div><p class="chakra-text css-1wzn9m2">Medium Risk</p></div><div class="chakra-stack css-17roaq2"><p class="chakra-text css-9h3ub9">3<!-- --> findings</p><p class="chakra-text css-9h3ub9">3<!-- --> fixed</p><p class="chakra-text css-9h3ub9">0<!-- --> acknowledged</p></div></div><div class="css-wnr2r6"><div class="css-1fh5bdn"><div class="css-1x2krjs"></div><p class="chakra-text css-1wzn9m2">Informational</p></div><div class="chakra-stack css-17roaq2"><p class="chakra-text css-9h3ub9">2<!-- --> findings</p><p class="chakra-text css-9h3ub9">2<!-- --> fixed</p><p class="chakra-text css-9h3ub9">0<!-- --> acknowledged</p></div></div></div><hr aria-orientation="horizontal" class="chakra-divider css-14ry2m8"/><div class="chakra-stack css-1f0j1p5"><section class="chakra-stack css-1cyyl4u"><div class="chakra-stack css-1skpokq"><div class="css-1vy91a6"></div><h3 class="chakra-heading css-1hlsh2c">Critical Risk<span class="chakra-text css-1nvbuct">1<!-- --> <!-- -->finding</span></h3></div><ol role="list" class="css-lq80v0"><li class="css-0"><section class="chakra-stack css-1kc89qn"><h4 class="chakra-heading css-thn72w"><span class="chakra-code css-l0e4mh">isBudgetConstrainedBuyingLimitReached</span> should be set as soon as the remaining budget cannot afford the full order cost</h4><dl class="chakra-stack css-18b9je0"><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">State</p></dt><dd class="chakra-stack css-t1uzvz"><div class="chakra-stack css-porbmv"><span class="css-1lnofw7"><span class="css-101m3ux"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2px" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-wrench" aria-hidden="true" color="currentColor"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path></svg></span><span class="css-1l8566">Fixed</span></span><a href="https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106" target="_blank" class="css-hyehfz"><p class="chakra-text css-n1un5q">PR #106</p></a></div></dd></div><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">Severity</p></dt><dd class="chakra-stack css-t1uzvz"><div class="chakra-stack css-porbmv"><span class="css-ypnwc0"><div class="css-7e8jyl"></div><span class="css-v26npq">Severity<!-- -->: <!-- -->Critical</span></span><p class="chakra-text css-phvdpk">≈</p><span class="css-ypnwc0"><div class="css-wxyuev"></div><span class="css-v26npq">Likelihood<!-- -->: <!-- -->High</span></span><p class="chakra-text css-phvdpk">×</p><span class="css-ypnwc0"><div class="css-wxyuev"></div><span class="css-v26npq">Impact<!-- -->: <!-- -->High</span></span></div></dd></div><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">Submitted by</p></dt><dd class="chakra-stack css-t1uzvz"><a rel="nofollow" class="chakra-link css-1so5w5b" href="/u/Saw-mon-and-Natalie"><div data-test-id="mask" class="css-15ua73h"><img alt="" width="128" height="128" decoding="async" data-nimg="1" class="no-dark-mode css-1uqohei" style="color:transparent" srcSet="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=128&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=256&amp;q=75 2x" src="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=256&amp;q=75"/></div><p class="chakra-text css-1e0kj1c"> <!-- -->Saw-mon and Natalie</p></a></dd></div></dl><hr aria-orientation="horizontal" class="chakra-divider css-14ry2m8"/><div class="markdown-body css-1rem1b3"><h2 class="chakra-heading css-jg3yxe" id="description" node="[object Object]">Description</h2>
<p class="chakra-text css-xcnbdp" node="[object Object]"><code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">isBudgetConstrainedBuyingLimitReached</span></span></code> should be set as soon as the remaining budget cannot afford the full order cost. Here is why this is an issue currently. If we can only partially afford to fill the current order to be consumed, ie <a target="_blank" rel="noopener nofollow" class="chakra-link css-15y7uvo" href="https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L842" node="[object Object]"><code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">maxAffordableQuantity</span></span></code></a> (quantised) is not-zero and we partially fill the order, then the implementation moves on to the next order. Most likely in the next iteration, one cannot fill any of the next order, since the <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">remainingBudget</span></span></code> would be really small and <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">bestPrice</span></span></code> potentially could be even higher (in budget-constrained market buy orders, best prices increment up as we fill/match orders):</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">⌊</mo><mfrac><mrow><mi mathvariant="normal">Δ</mi><mi>q</mi><msub><mi>p</mi><msup><mi>b</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub></mrow><msup><mn>10</mn><mi>d</mi></msup></mfrac><mo fence="true">⌋</mo></mrow><mo>&gt;</mo><mfrac><mrow><mo stretchy="false">(</mo><msub><mi>ϵ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>ϵ</mi><mn>1</mn></msub><mi mathvariant="normal">Δ</mi><mi>q</mi><mo stretchy="false">)</mo><msub><mi>p</mi><mi>b</mi></msub></mrow><msup><mn>10</mn><mi>d</mi></msup></mfrac><mo>+</mo><msub><mi>ϵ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\left\lfloor
\frac{\Delta q p_{b&#x27;}}{10^d} 
\right\rfloor
&gt; \frac{(\epsilon_0 + \epsilon_1 \Delta q) p_b}{10^d} + \epsilon_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size3">⌊</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7751em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size3">⌋</span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7751em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>
<p class="chakra-text css-xcnbdp" node="[object Object]">In this scenario, after the first budget-constrained partial fill, if one queries for the next order to potentially match, if it ends up matching <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">0</span></span></code> amount. We would hit <a target="_blank" rel="noopener nofollow" class="chakra-link css-15y7uvo" href="https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L845-L850" node="[object Object]">this branch</a>:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">maxAffordableQuantity </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">==</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">  </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// Can&#x27;t afford any of this order, stop here</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">  params</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">isBudgetConstrainedBuyingLimitReached </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token boolean" style="color:var(--chakra-colors-codeHighlighting-literal)">true</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">  </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    segment</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// ordersConsumed</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token plain"> </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// quantityNFTClaimable</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">  </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span></span></code></pre></div>
<p class="chakra-text css-xcnbdp" node="[object Object]">Note that we have queried <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">2</span></span></code> orders so far and for both one <a target="_blank" rel="noopener nofollow" class="chakra-link css-15y7uvo" href="https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L805" node="[object Object]"><code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">ordersConsumed</span></span></code></a> has been <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">0</span></span></code>. At this point we have:</p>





















<table><thead><tr><th>parameter</th><th>value</th></tr></thead><tbody><tr><td><a target="_blank" rel="noopener nofollow" class="chakra-link css-15y7uvo" href="https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L803" node="[object Object]"><code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">segment</span></span></code></a></td><td>the segment that includes the last skipped order</td></tr><tr><td><a target="_blank" rel="noopener nofollow" class="chakra-link css-15y7uvo" href="https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L773" node="[object Object]"><code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">lastConsumedSegmentIndex</span></span></code></a></td><td>might be potentially the same as the first order or pointing to the next segment since we have quried 2 orders</td></tr><tr><td><a target="_blank" rel="noopener nofollow" class="chakra-link css-15y7uvo" href="https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L820" node="[object Object]"><code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">numOrdersFullyConsumed</span></span></code></a></td><td>does not count for the last orders: the one that was partially matched and also the one that was skipped since <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">maxAffordableQuantity</span></span></code> ends up being <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">0</span></span></code></td></tr></tbody></table>
<p class="chakra-text css-xcnbdp" node="[object Object]">Now, let&#x27;s analyse this portion of the <a target="_blank" rel="noopener nofollow" class="chakra-link css-15y7uvo" href="https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L937-L951" node="[object Object]"><code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_updateSegmentsAndTree</span></span></code></a>:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// if the order skipped after the partial order match was on the next segement</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// the value for `lastSegmentDeleted` would be `false`</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">bool</span><span class="token plain"> lastSegmentDeleted </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> lastSegmentIndex </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">&lt;</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">oldTombstoneOffset </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">+</span><span class="token plain"> numSegmentsFullyConsumed</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">!</span><span class="token plain">lastSegmentDeleted</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// `numOrdersWithinLastSegmentFullyConsumed` would be number of orders fully consumed</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// in before querying the partial or skipped order. Might be the come from the </span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// segment the partial order was on or before</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">numOrdersWithinLastSegmentFullyConsumed </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">!=</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">uint256</span><span class="token plain"> i</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"> i </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">&lt;</span><span class="token plain"> numOrdersWithinLastSegmentFullyConsumed</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"> </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">++</span><span class="token plain">i</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// potentailly wrong segment is updated, since the assumed fully </span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// matched orders might not be on the same segment as the</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// last order which was skipped</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            lastSegment </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> lastSegment</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">clearSlot</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">uint256</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">lastSegment</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">==</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// All orders in the last segment are consumed, delete from tree</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        tree</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">remove</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">bestPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// Don&#x27;t pop segment for gas efficiency, instead just write zeros</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// segments gets updated incorrectly</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    segments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token plain">lastSegmentIndex</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token plain"> </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> lastSegment</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span></span></code></pre></div>
<p class="chakra-text css-xcnbdp" node="[object Object]">Let&#x27;s follow all this with an example from transaction <a target="_blank" rel="noopener nofollow" class="chakra-link css-15y7uvo" href="https://www.tdly.co/tx/0xd1945911cce9d105b4503d3ab378e735c754ae1c5d5df62fe4b824b884c2b3c1" node="[object Object]">0xd1945911cce9d105b4503d3ab378e735c754ae1c5d5df62fe4b824b884c2b3c1</a>:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token plain">(10, 40416) (10, 40415) (10, 40414)</span></span><span class="token-line" style="display:block"><span class="token plain">(10, 40419) (10, 40418) (10, 40417)</span></span></code></pre></div>
<p class="chakra-text css-xcnbdp" node="[object Object]">with <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">maxCost</span></span></code> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>=</mo><mn>31500</mn></mrow><annotation encoding="application/x-tex">c_{max} = 31500</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">31500</span></span></span></span>. The transaction fully consumed the orders <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">40414</span></span></code> and <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">40415</span></span></code> and at this point the <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">params.currentCost</span></span></code> would be <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>c</mi><mi>u</mi><mi>r</mi><mi>r</mi></mrow></msub><mo>=</mo><mn>31490</mn></mrow><annotation encoding="application/x-tex">c_{curr} = 31490</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight" style="margin-right:0.02778em">rr</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">31490</span></span></span></span> and the remaining budget would be <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>r</mi></msub><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">c_r = 10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">10</span></span></span></span>, the quantised <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">maxAffordableQuantity</span></span></code> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>=</mo><mn>2</mn><mi mathvariant="normal">Δ</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">q_{max} = 2 \Delta q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord">2Δ</span><span class="mord mathnormal" style="margin-right:0.03588em">q</span></span></span></span> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">\Delta q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em">q</span></span></span></span> being the <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">QUANTITY_TICK</span></span></code>). Order <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">40416</span></span></code> gets partialy filled and the slot (in stack) gets updated to <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">(8, 40416)</span></span></code>. Since we have not set the <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">isBudgetConstrainedBuyingLimitReached</span></span></code> and the other conditions are satisfied (there is a remaining budget and we have not hit the limit price, ...), querying over the orders continues. At this point we have <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>c</mi><mi>u</mi><mi>r</mi><mi>r</mi></mrow></msub><mo>=</mo><mn>31498</mn></mrow><annotation encoding="application/x-tex">c_{curr} = 31498</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight" style="margin-right:0.02778em">rr</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">31498</span></span></span></span> and thus <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>r</mi></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">c_r = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">2</span></span></span></span> this time <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">q_{max}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> ends up being <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> and this <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">isBudgetConstrainedBuyingLimitReached</span></span></code> gets set. The value of <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">segment</span></span></code> ends up being:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token plain">(10, 40419) (10, 40418) (10, 40417) segment</span></span></code></pre></div>
<p class="chakra-text css-xcnbdp" node="[object Object]">The storage update in <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_updateSegmentsAndTree</span></span></code> performs cleaning on the above segment and since <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">numOrdersFullyConsumed</span></span></code> did not account for the partial order and the skipped order the <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">tombstone</span></span></code> also lags behind and we end up with the following segment structure:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token plain">(10, 40416) (10, 40415) (10, 40414) &lt;-- tombstone offset</span></span><span class="token-line" style="display:block"><span class="token plain">(10, 40419) ( 0,     0) ( 0,     0)</span></span></code></pre></div>
<p class="chakra-text css-xcnbdp" node="[object Object]">Note that instead of clearning out the orders <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">40415</span></span></code> and <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">40414</span></span></code> which were fully matched the orders <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">40418</span></span></code> and <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">40417</span></span></code> get cleared out and the order <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">40416</span></span></code> does not even get updated although it was partially matched.</p>
<h2 class="chakra-heading css-jg3yxe" id="poc" node="[object Object]">PoC</h2>
<p class="chakra-text css-xcnbdp" node="[object Object]">Apply the following patch which will be needed in the test cases:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token plain">diff --git a/test/sonicOrderBook/utils.ts b/test/sonicOrderBook/utils.ts</span></span><span class="token-line" style="display:block"><span class="token plain">index be0608f..845dea0 100644</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token coord">--- a/test/sonicOrderBook/utils.ts</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token coord">+++ b/test/sonicOrderBook/utils.ts</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">@@ -59,6 +59,7 @@ export async function deployContractsFixture() {</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  return {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    orderBook,</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    sonicOrderBookLibrary,</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    sonicAirdropNFT,</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    wS,</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    quoteToken,</span></span></code></pre></div>
<p class="chakra-text css-xcnbdp" node="[object Object]">Then create the file <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">test/sonicOrderBook/isBudgetConstrainedBuyingLimitReached.bug.ts</span></span></code> with the following content:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain">loadFixture</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">from</span><span class="token plain"> </span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;@nomicfoundation/hardhat-toolbox/network-helpers&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">import</span><span class="token plain"> hre</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain">ethers</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> upgrades</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">from</span><span class="token plain"> </span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;hardhat&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain">expect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">from</span><span class="token plain"> </span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;chai&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain">SonicOrderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">from</span><span class="token plain"> </span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;../../typechain-types&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain">Order</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">from</span><span class="token plain"> </span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;@paintswap/sonic-airdrop-definitions/types&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain">deployContractsFixture</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> calcFees</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token constant" style="color:var(--chakra-colors-codeHighlighting-literal)">ONE_ETHER</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token constant" style="color:var(--chakra-colors-codeHighlighting-literal)">RETURN_WRAPPED_SONIC</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">from</span><span class="token plain"> </span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;./utils&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain">initializerSlot</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">from</span><span class="token plain"> </span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;../utils&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain">BigNumberish</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> Block</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">from</span><span class="token plain"> </span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;ethers&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain">deploySonicOrderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> deploySonicOrderBookLibrary</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">from</span><span class="token plain"> </span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;../../scripts/deployHelpers&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"> HardhatEthersSigner </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">from</span><span class="token plain"> </span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;@nomicfoundation/hardhat-ethers/signers&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// Uses a plain ERC20 token with 18 decimals</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">describe</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;SonicOrderBook&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">function</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">  </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">describe</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;Market orders with useExactQuantity: false&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">function</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">describe</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;Budget-constrained buying&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">function</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">async</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">function</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">setup</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          sonicAirdropNFT</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          wS</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          sonicOrderBookLibrary</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          quoteToken</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          alice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          bob</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          dev</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          initialCoins</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          maxOrdersPerPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          </span><span class="token constant" style="color:var(--chakra-colors-codeHighlighting-literal)">QUANTITY_TICK</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"> </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">loadFixture</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">deployContractsFixture</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> quoteToken</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">connect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">bob</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">mint</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">bob</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> initialCoins</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> orderBook </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">deploySonicOrderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">sonicAirdropNFT</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> quoteToken</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> wS</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> sonicOrderBookLibrary</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// set approvals</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> quoteToken</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">approve</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> initialCoins</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> quoteToken</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">connect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">alice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">approve</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> initialCoins</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> sonicAirdropNFT</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">setApprovalForAll</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token boolean" style="color:var(--chakra-colors-codeHighlighting-literal)">true</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> sonicAirdropNFT</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">connect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">alice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">setApprovalForAll</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token boolean" style="color:var(--chakra-colors-codeHighlighting-literal)">true</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> quoteToken</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">connect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">bob</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">approve</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> initialCoins</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> priceTick </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">100n</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> minQuantity </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">10n</span><span class="token plain"> </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">*</span><span class="token plain"> </span><span class="token constant" style="color:var(--chakra-colors-codeHighlighting-literal)">QUANTITY_TICK</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> isTradeable </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token boolean" style="color:var(--chakra-colors-codeHighlighting-literal)">true</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> makerFeeBps </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">40n</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"> </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// 0.2% fee for makers</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> takerFeeBps </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">60n</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"> </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// 0.3% fee for takers</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">setAdminVars</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            dev</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            makerFeeBps</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            takerFeeBps</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            maxOrdersPerPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token plain">tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain">priceTick</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> minQuantity</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> isTradeable</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          quoteToken</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          alice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          bob</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          dev</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          initialCoins</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          maxOrdersPerPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          </span><span class="token constant" style="color:var(--chakra-colors-codeHighlighting-literal)">QUANTITY_TICK</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          priceTick</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          minQuantity</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">it</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;6 orders&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">async</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">function</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          quoteToken</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          alice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          bob</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          maxOrdersPerPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          </span><span class="token constant" style="color:var(--chakra-colors-codeHighlighting-literal)">QUANTITY_TICK</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          priceTick</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          minQuantity</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"> </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">loadFixture</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">setup</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> limitPrice </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">4n</span><span class="token plain"> </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">*</span><span class="token plain"> priceTick</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> quantity </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> minQuantity</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> totalOrders </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">6</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">placeNLimitOrders</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          alice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          totalOrders</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">Sell</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          limitPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          quantity</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          </span><span class="token boolean" style="color:var(--chakra-colors-codeHighlighting-literal)">true</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          </span><span class="token boolean" style="color:var(--chakra-colors-codeHighlighting-literal)">true</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">logSegments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">Sell</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> limitPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;segments before calling placeMarketOrder :&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> nodeBefore </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">getNode</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">Sell</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> limitPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">expect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">nodeBefore</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">tombstoneSegmentOffset</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">to</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">be</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">equal</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> segmentsBefore </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">getSegments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">Sell</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> limitPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">expect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">segmentsBefore</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">to</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">be</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">equal</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;0x00000000000a0000000000030000000a0000000000020000000a000000000001&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">expect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">segmentsBefore</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">1</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">to</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">be</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">equal</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;0x00000000000a0000000000060000000a0000000000050000000a000000000004&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// each order is worth 40, so in total with a budget of 101</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// we should afford 2 full orders and a partial order (1/2 of an order)</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// this would cost 100, the extra budget of 1 is here to make sure</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// after we partially match the 3rd order we would not reach the `maxCost`</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// so the loop would continue to trigger the bug</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> budget </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">101</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">connect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">bob</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">placeMarketOrder</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            side</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">Buy</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            totalCost</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> budget</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            quantity</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            useExactQuantity</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> </span><span class="token boolean" style="color:var(--chakra-colors-codeHighlighting-literal)">false</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          </span><span class="token constant" style="color:var(--chakra-colors-codeHighlighting-literal)">RETURN_WRAPPED_SONIC</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">logSegments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">Sell</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> limitPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;segments after calling placeMarketOrder :&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> nodeAfter </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">getNode</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">Sell</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> limitPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">expect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">nodeAfter</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">tombstoneSegmentOffset</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">to</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">be</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">equal</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> segmentsAfter</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">getSegments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">Sell</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> limitPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">expect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">segmentsAfter</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">to</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">be</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">equal</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;0x0000000000050000000000030000000000000000000000000000000000000000&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">expect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">segmentsAfter</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">1</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">to</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">be</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">equal</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;0x00000000000a0000000000060000000a0000000000050000000a000000000004&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">it</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;4 orders&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">async</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">function</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          quoteToken</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          alice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          bob</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          maxOrdersPerPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          </span><span class="token constant" style="color:var(--chakra-colors-codeHighlighting-literal)">QUANTITY_TICK</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          priceTick</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          minQuantity</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"> </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">loadFixture</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">setup</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> limitPrice </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">4n</span><span class="token plain"> </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">*</span><span class="token plain"> priceTick</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> quantity </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> minQuantity</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> totalOrders </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">4</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">placeNLimitOrders</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          alice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          totalOrders</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">Sell</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          limitPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          quantity</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          </span><span class="token boolean" style="color:var(--chakra-colors-codeHighlighting-literal)">true</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          </span><span class="token boolean" style="color:var(--chakra-colors-codeHighlighting-literal)">true</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">logSegments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">Sell</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> limitPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;segments before calling placeMarketOrder :&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> nodeBefore </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">getNode</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">Sell</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> limitPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">expect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">nodeBefore</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">tombstoneSegmentOffset</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">to</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">be</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">equal</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> segmentsBefore </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">getSegments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">Sell</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> limitPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">expect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">segmentsBefore</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">to</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">be</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">equal</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;0x00000000000a0000000000030000000a0000000000020000000a000000000001&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">expect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">segmentsBefore</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">1</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">to</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">be</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">equal</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;0x000000000000000000000000000000000000000000000000000a000000000004&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// each order is worth 40, so in total with a budget of 101</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// we should afford 2 full orders and a partial order (1/2 of an order)</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// this would cost 100, the extra budget of 1 is here to make sure</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// after we partially match the 3rd order we would not reach the `maxCost`</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// so the loop would continue to trigger the bug</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> budget </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">101</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">connect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">bob</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">placeMarketOrder</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            side</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">Buy</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            totalCost</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> budget</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            quantity</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            useExactQuantity</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> </span><span class="token boolean" style="color:var(--chakra-colors-codeHighlighting-literal)">false</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          </span><span class="token constant" style="color:var(--chakra-colors-codeHighlighting-literal)">RETURN_WRAPPED_SONIC</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">logSegments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">Sell</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> limitPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;segments after calling placeMarketOrder :&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> nodeAfter </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">getNode</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">Sell</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> limitPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">expect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">nodeAfter</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">tombstoneSegmentOffset</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">to</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">be</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">equal</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> segmentsAfter</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">getSegments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">Sell</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> limitPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">expect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">segmentsAfter</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">to</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">be</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">equal</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;0x0000000000050000000000030000000000000000000000000000000000000000&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">expect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">segmentsAfter</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">1</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">to</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">be</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">equal</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;0x000000000000000000000000000000000000000000000000000a000000000004&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">  </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">  </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">async</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">function</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">getNextOrderId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> SonicOrderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> nextOrderIdSlot </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> packedSlot </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">provider</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">getStorage</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> nextOrderIdSlot</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">return</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">parseInt</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">packedSlot</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">slice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">2</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">14</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">16</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">  </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">  </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">async</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">function</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">placeNLimitOrders</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    orderbook</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> SonicOrderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    user</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> HardhatEthersSigner</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    totalOrders</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> </span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">number</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    side</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    tokenId</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> BigNumberish</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    price</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> BigNumberish</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    quantity</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> BigNumberish</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    onlyPost</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> </span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">boolean</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    onlyExactPriceIfMaker</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> </span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">boolean</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">  </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">for</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">let</span><span class="token plain"> i </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"> i </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">&lt;</span><span class="token plain"> totalOrders</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"> i</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">++</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> orderbook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">connect</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">user</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">placeLimitOrders</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          side</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> side</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          tokenId</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          price</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> price</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          quantity</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          onlyPost</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> onlyPost</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          onlyExactPriceIfMaker</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> onlyExactPriceIfMaker</span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token constant" style="color:var(--chakra-colors-codeHighlighting-literal)">RETURN_WRAPPED_SONIC</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">  </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">  </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">async</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">function</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">logSegments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> SonicOrderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> side</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> tokenId</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> BigNumberish</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> price</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> BigNumberish</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> message</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> </span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">string</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> segmentsAfter </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">getSegments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> side</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> price</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">console</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">log</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">message</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">console</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">log</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">segmentsAfter</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">  </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">  </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">async</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">function</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">getSegments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> SonicOrderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> side</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> OrderSide</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> tokenId</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> BigNumberish</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> price</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> BigNumberish</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// Storage slot assignments based on contract layout:</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// slot 0: packed variables (_devAddr, _devFeeBps, _maxOrdersPerPrice, _nextOrderId)</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// slot 1: _tokenIdInfos mapping</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// slot 2: _asks mapping</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// slot 3: _bids mapping</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// slot 4: _asksAtPrice mapping</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// slot 5: _bidsAtPrice mapping</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> baseSlot </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> side </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">===</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token plain"> </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">?</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">5</span><span class="token plain"> </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">:</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">4</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"> </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// 0 = Buy (bids), 1 = Sell (asks)</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// Calculate slot for tokenId in the outer mapping</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> tokenIdSlot </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">solidityPackedKeccak256</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;uint256&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;uint256&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token plain">tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> baseSlot</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// Calculate slot for price in the inner mapping</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> priceSlot </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">solidityPackedKeccak256</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;uint256&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;bytes32&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token plain">price</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> tokenIdSlot</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// Read array length from the calculated slot</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> lengthHex </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">provider</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">getStorage</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> priceSlot</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> length </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">parseInt</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">lengthHex</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">16</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">length </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">===</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// For dynamic arrays, elements start at keccak256(slot)</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> arrayStartSlot </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">solidityPackedKeccak256</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token string" style="color:var(--chakra-colors-codeHighlighting-string)">&quot;bytes32&quot;</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token plain">priceSlot</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// Read each segment (bytes32 elements)</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> segments </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">let</span><span class="token plain"> i </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"> i </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">&lt;</span><span class="token plain"> length</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"> i</span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">++</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> elementSlot </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">BigInt</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">arrayStartSlot</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">+</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">BigInt</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">const</span><span class="token plain"> segment </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">await</span><span class="token plain"> ethers</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">provider</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">getStorage</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderBook</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> elementSlot</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      segments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">push</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">segment</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">return</span><span class="token plain"> segments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">  </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span></span></code></pre></div>
<p class="chakra-text css-xcnbdp" node="[object Object]">then run:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">yarn</span><span class="token plain"> </span><span class="token builtin class-name" style="color:var(--chakra-colors-codeHighlighting-identifier)">test</span><span class="token plain"> -- test/sonicOrderBook/isBudgetConstrainedBuyingLimitReached.bug.ts</span></span></code></pre></div>
<p class="chakra-text css-xcnbdp" node="[object Object]">The tests should fail without the fix applied and pass with the fixes applied.</p>
<p class="chakra-text css-xcnbdp" node="[object Object]">logs:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token plain">segments before calling placeMarketOrder :</span></span><span class="token-line" style="display:block"><span class="token plain">[</span></span><span class="token-line" style="display:block"><span class="token plain">  &#x27;0x00000000000a0000000000030000000a0000000000020000000a000000000001&#x27;,</span></span><span class="token-line" style="display:block"><span class="token plain">  &#x27;0x00000000000a0000000000060000000a0000000000050000000a000000000004&#x27;</span></span><span class="token-line" style="display:block"><span class="token plain">]</span></span><span class="token-line" style="display:block"><span class="token plain">segments after calling placeMarketOrder :</span></span><span class="token-line" style="display:block"><span class="token plain">[</span></span><span class="token-line" style="display:block"><span class="token plain">  &#x27;0x00000000000a0000000000030000000a0000000000020000000a000000000001&#x27;,</span></span><span class="token-line" style="display:block"><span class="token plain">  &#x27;0x00000000000a0000000000060000000000000000000000000000000000000000&#x27;</span></span><span class="token-line" style="display:block"><span class="token plain">]</span></span><span class="token-line" style="display:block"><span class="token plain">        1) 6 orders</span></span><span class="token-line" style="display:block"><span class="token plain">segments before calling placeMarketOrder :</span></span><span class="token-line" style="display:block"><span class="token plain">[</span></span><span class="token-line" style="display:block"><span class="token plain">  &#x27;0x00000000000a0000000000030000000a0000000000020000000a000000000001&#x27;,</span></span><span class="token-line" style="display:block"><span class="token plain">  &#x27;0x000000000000000000000000000000000000000000000000000a000000000004&#x27;</span></span><span class="token-line" style="display:block"><span class="token plain">]</span></span><span class="token-line" style="display:block"><span class="token plain">segments after calling placeMarketOrder :</span></span><span class="token-line" style="display:block"><span class="token plain">[</span></span><span class="token-line" style="display:block"><span class="token plain">  &#x27;0x00000000000a0000000000030000000a0000000000020000000a000000000001&#x27;,</span></span><span class="token-line" style="display:block"><span class="token plain">  &#x27;0x0000000000000000000000000000000000000000000000000000000000000000&#x27;</span></span><span class="token-line" style="display:block"><span class="token plain">]</span></span><span class="token-line" style="display:block"><span class="token plain">        2) 4 orders</span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">  0 passing (321ms)</span></span><span class="token-line" style="display:block"><span class="token plain">  2 failing</span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">  1) SonicOrderBook</span></span><span class="token-line" style="display:block"><span class="token plain">       Market orders with useExactQuantity: false</span></span><span class="token-line" style="display:block"><span class="token plain">         Budget-constrained buying</span></span><span class="token-line" style="display:block"><span class="token plain">           6 orders:</span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">      AssertionError: expected &#x27;0x00000000000a0000000000030000000a000…&#x27; to equal &#x27;0x00000000000500000000000300000000000…&#x27;</span></span><span class="token-line" style="display:block"><span class="token plain">      + expected - actual</span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">      -0x00000000000a0000000000030000000a0000000000020000000a000000000001</span></span><span class="token-line" style="display:block"><span class="token plain">      +0x0000000000050000000000030000000000000000000000000000000000000000</span></span><span class="token-line" style="display:block"><span class="token plain">      </span></span><span class="token-line" style="display:block"><span class="token plain">      at Context.&lt;anonymous&gt; (test/sonicOrderBook/isBudgetConstrainedBuyingLimitReached.bug.ts:133:40)</span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">  2) SonicOrderBook</span></span><span class="token-line" style="display:block"><span class="token plain">       Market orders with useExactQuantity: false</span></span><span class="token-line" style="display:block"><span class="token plain">         Budget-constrained buying</span></span><span class="token-line" style="display:block"><span class="token plain">           4 orders:</span></span><span class="token-line" style="display:block"><span class="token plain">     Error: VM Exception while processing transaction: reverted with custom error &#x27;KeyDoesntExist()&#x27;</span></span><span class="token-line" style="display:block"><span class="token plain">    at SonicOrderBook.getNode (contracts/libraries/BokkyPooBahsRedBlackTreeLibrary.sol:71)</span></span><span class="token-line" style="display:block"><span class="token plain">    at SonicOrderBook.getNode (contracts/SonicOrderBook.sol:519)</span></span><span class="token-line" style="display:block"><span class="token plain">    at &lt;UnrecognizedContract&gt;.&lt;unknown&gt; (0xa51c1fc2f0d1a1b8494ed1fe312d7c3a78ed91c0)</span></span><span class="token-line" style="display:block"><span class="token plain">    at EdrProviderWrapper.request (node_modules/hardhat/src/internal/hardhat-network/provider/provider.ts:398:41)</span></span><span class="token-line" style="display:block"><span class="token plain">    at async staticCallResult (node_modules/ethers/src.ts/contract/contract.ts:337:22)</span></span><span class="token-line" style="display:block"><span class="token plain">    at async staticCall (node_modules/ethers/src.ts/contract/contract.ts:303:24)</span></span><span class="token-line" style="display:block"><span class="token plain">    at async Proxy.getNode (node_modules/ethers/src.ts/contract/contract.ts:351:41)</span></span><span class="token-line" style="display:block"><span class="token plain">    at async Context.&lt;anonymous&gt; (test/sonicOrderBook/isBudgetConstrainedBuyingLimitReached.bug.ts:195:27)</span></span></code></pre></div>
<h2 class="chakra-heading css-jg3yxe" id="recommendation" node="[object Object]">Recommendation</h2>
<p class="chakra-text css-xcnbdp" node="[object Object]">Apply the following patch to stop querying more orders as soon as one cannot afford a full order in the budget-constrained market buy order:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token plain">diff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol</span></span><span class="token-line" style="display:block"><span class="token plain">index 31b5486..1a4c724 100644</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token coord">--- a/contracts/SonicOrderBook.sol</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token coord">+++ b/contracts/SonicOrderBook.sol</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">@@ -836,13 +836,13 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uint256 remainingBudget = params.maxCost - params.currentCost;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      if (fullOrderCost &gt; remainingBudget) {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // Can&#x27;t afford a full order, stop here</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        params.isBudgetConstrainedBuyingLimitReached = true;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        // Check if we can afford partial order</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        uint256 maxAffordableQuantity = (remainingBudget * BASE_DECIMAL_DIVISOR) / params.bestPrice;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        // Floor to QUANTITY_TICK to ensure proper alignment</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        maxAffordableQuantity = (maxAffordableQuantity / QUANTITY_TICK) * QUANTITY_TICK;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        if (maxAffordableQuantity == 0) {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">          // Can&#x27;t afford any of this order, stop here</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">          params.isBudgetConstrainedBuyingLimitReached = true;</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">          return (</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">            segment,</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">            0, // ordersConsumed</span></span></code></pre></div></div></section></li></ol></section><section class="chakra-stack css-1cyyl4u"><div class="chakra-stack css-1skpokq"><div class="css-1dsl60n"></div><h3 class="chakra-heading css-1hlsh2c">High Risk<span class="chakra-text css-1nvbuct">1<!-- --> <!-- -->finding</span></h3></div><ol role="list" class="css-lq80v0"><li class="css-0"><section class="chakra-stack css-1kc89qn"><h4 class="chakra-heading css-thn72w">Invariants of Price Segments (version 2)</h4><dl class="chakra-stack css-18b9je0"><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">State</p></dt><dd class="chakra-stack css-t1uzvz"><div class="chakra-stack css-porbmv"><span class="css-1lnofw7"><span class="css-101m3ux"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2px" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-wrench" aria-hidden="true" color="currentColor"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path></svg></span><span class="css-1l8566">Fixed</span></span><a href="https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106" target="_blank" class="css-hyehfz"><p class="chakra-text css-n1un5q">PR #106</p></a></div></dd></div><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">Severity</p></dt><dd class="chakra-stack css-t1uzvz"><div class="chakra-stack css-porbmv"><span class="css-ypnwc0"><div class="css-wxyuev"></div><span class="css-v26npq">Severity<!-- -->: <!-- -->High</span></span><p class="chakra-text css-phvdpk">≈</p><span class="css-ypnwc0"><div class="css-mgdx75"></div><span class="css-v26npq">Likelihood<!-- -->: <!-- -->Low</span></span><p class="chakra-text css-phvdpk">×</p><span class="css-ypnwc0"><div class="css-wxyuev"></div><span class="css-v26npq">Impact<!-- -->: <!-- -->High</span></span></div></dd></div><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">Submitted by</p></dt><dd class="chakra-stack css-t1uzvz"><a rel="nofollow" class="chakra-link css-1so5w5b" href="/u/Saw-mon-and-Natalie"><div data-test-id="mask" class="css-15ua73h"><img alt="" width="128" height="128" decoding="async" data-nimg="1" class="no-dark-mode css-1uqohei" style="color:transparent" srcSet="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=128&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=256&amp;q=75 2x" src="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=256&amp;q=75"/></div><p class="chakra-text css-1e0kj1c"> <!-- -->Saw-mon and Natalie</p></a></dd></div></dl><hr aria-orientation="horizontal" class="chakra-divider css-14ry2m8"/><div class="markdown-body css-1rem1b3"><h2 class="chakra-heading css-jg3yxe" id="description" node="[object Object]">Description</h2>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left right left" columnspacing="0em 1em 0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><mtext> </mtext><mrow><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mrow><mspace width="2em"></mspace><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">□</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>⋯</mo><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi><mo>⋯</mo><mi mathvariant="normal">□</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mo lspace="0em" rspace="0em">←</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext> </mtext><msub><mi>o</mi><mi>t</mi></msub><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">■</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>⋯</mo><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mi mathvariant="normal">□</mi><mo>⋯</mo><mi mathvariant="normal">□</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mo lspace="0em" rspace="0em">←</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext> </mtext><msub><mi>o</mi><mi>t</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">■</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>⋯</mo><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mo>⋯</mo><mi mathvariant="normal">■</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><mtext> </mtext><mrow><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mrow><mspace width="2em"></mspace><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">■</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>⋯</mo><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mstyle mathcolor="red"><mi mathvariant="normal">■</mi></mstyle><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mo>⋯</mo><mi mathvariant="normal">■</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><mtext> </mtext><mrow><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mrow><mspace width="2em"></mspace><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">□</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>⋯</mo><mi mathvariant="normal">□</mi><mstyle mathcolor="green"><mi mathvariant="normal">■</mi></mstyle><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mo>⋯</mo><mi mathvariant="normal">■</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mo lspace="0em" rspace="0em">←</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext> seg len</mtext><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">□</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>⋯</mo><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi><mo>⋯</mo><mi mathvariant="normal">□</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mo lspace="0em" rspace="0em">←</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext> seg len</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><mtext> </mtext><mrow><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mrow><mspace width="2em"></mspace><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
&amp; \qquad \quad \space \vdots \qquad \quad &amp; \\
\square &amp; \cdots \square \square \square \square\square \square \cdots \square &amp; \leftarrow &amp; \space o_t - 1 \\
\blacksquare &amp; \cdots \blacksquare \blacksquare \blacksquare \blacksquare\blacksquare \square \cdots \square &amp; \leftarrow &amp; \space o_t \\
\blacksquare &amp; \cdots \blacksquare \blacksquare \blacksquare \blacksquare\blacksquare\blacksquare \cdots \blacksquare &amp; &amp; \\
&amp; \qquad \quad \space \vdots \qquad \quad &amp;  &amp; \\
\blacksquare &amp; \cdots \blacksquare \blacksquare \blacksquare \bgroup\color{red}{\blacksquare}\egroup\blacksquare\blacksquare \cdots \blacksquare &amp; &amp; \\
&amp; \qquad \quad \space \vdots \qquad \quad &amp;   &amp; \\
\square &amp; \cdots  \square \bgroup\color{green}{\blacksquare}\egroup \blacksquare \blacksquare\blacksquare\blacksquare \cdots \blacksquare &amp; \leftarrow &amp; \space \text{seg len} - 1\\
\square &amp; \cdots \square \square \square \square\square \square \cdots \square &amp; \leftarrow &amp; \space \text{seg len} \\
&amp; \qquad \quad \space \vdots \qquad \quad &amp;   &amp; \\
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:17.64em;vertical-align:-8.57em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.07em"><span style="top:-11.07em"><span class="pstrut" style="height:3.5em"></span><span class="mord"></span></span><span style="top:-9.57em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mord amsrm">□</span></span></span><span style="top:-8.07em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mord amsrm">■</span></span></span><span style="top:-6.57em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mord amsrm">■</span></span></span><span style="top:-4.41em"><span class="pstrut" style="height:3.5em"></span><span class="mord"></span></span><span style="top:-2.91em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mord amsrm">■</span></span></span><span style="top:-0.75em"><span class="pstrut" style="height:3.5em"></span><span class="mord"></span></span><span style="top:0.75em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mord amsrm">□</span></span></span><span style="top:2.25em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mord amsrm">□</span></span></span><span style="top:4.41em"><span class="pstrut" style="height:3.5em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:8.57em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.07em"><span style="top:-11.2575em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace"> </span><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em"></span></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:1em"></span></span></span><span style="top:-9.7575em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">□□□□□□</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">□</span></span></span><span style="top:-8.2575em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">■■■■■□</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">□</span></span></span><span style="top:-6.7575em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">■■■■■■</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">■</span></span></span><span style="top:-4.5975em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace"> </span><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em"></span></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:1em"></span></span></span><span style="top:-3.0975em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">■■■</span><span class="mord"><span class="mord" style="color:red"><span class="mord amsrm" style="color:red">■</span></span></span><span class="mord amsrm">■■</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">■</span></span></span><span style="top:-0.9375em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace"> </span><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em"></span></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:1em"></span></span></span><span style="top:0.5625em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">□</span><span class="mord"><span class="mord" style="color:green"><span class="mord amsrm" style="color:green">■</span></span></span><span class="mord amsrm">■■■■</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">■</span></span></span><span style="top:2.0625em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">□□□□□□</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">□</span></span></span><span style="top:4.2225em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace"> </span><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em"></span></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:1em"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:8.57em"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:9.07em"><span style="top:-11.07em"><span class="pstrut" style="height:3.5em"></span><span class="mord"></span></span><span style="top:-9.57em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mrel">←</span></span></span><span style="top:-8.07em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mrel">←</span></span></span><span style="top:-6.57em"><span class="pstrut" style="height:3.5em"></span><span class="mord"></span></span><span style="top:-4.41em"><span class="pstrut" style="height:3.5em"></span><span class="mord"></span></span><span style="top:-2.91em"><span class="pstrut" style="height:3.5em"></span><span class="mord"></span></span><span style="top:-0.75em"><span class="pstrut" style="height:3.5em"></span><span class="mord"></span></span><span style="top:0.75em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mrel">←</span></span></span><span style="top:2.25em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mrel">←</span></span></span><span style="top:4.41em"><span class="pstrut" style="height:3.5em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:8.57em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.91em"><span style="top:-9.57em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span></span></span><span style="top:-8.07em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-6.57em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mord"></span></span></span><span style="top:-4.41em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mord"></span></span></span><span style="top:-2.91em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mord"></span></span></span><span style="top:-0.75em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mord"></span></span></span><span style="top:0.75em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord text"><span class="mord">seg len</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span></span></span><span style="top:2.25em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mord"></span><span class="mspace"> </span><span class="mord text"><span class="mord">seg len</span></span></span></span><span style="top:4.41em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mord"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:8.57em"><span></span></span></span></span></span></span></span></span></span></span></span>
<ul role="list" node="[object Object]" class="css-tu0njr"><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">□</mi></mrow><annotation encoding="application/x-tex">\square</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.675em"></span><span class="mord amsrm">□</span></span></span></span> represents empty orders with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> order id and normalized quantity.</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">■</mi></mrow><annotation encoding="application/x-tex">\blacksquare</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.675em"></span><span class="mord amsrm">■</span></span></span></span> represent orders where both the order id and the normalized quantity are non-zero.</li></ul>
<h3 class="chakra-heading css-c8eelt" id="invariants" node="[object Object]">Invariants</h3>
<ol role="list" node="[object Object]" class="css-1dg6mvm"><li>
<p class="chakra-text css-xcnbdp" node="[object Object]">the following configuration in the active area of the segments when all orders are drawn on a line should also not be allowed <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋯</mo><mi mathvariant="normal">■</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">■</mi><mo>⋯</mo></mrow><annotation encoding="application/x-tex">\cdots \blacksquare\square\blacksquare \cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.675em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">■□■</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span></span></span></span>, it should be proved that this cannot happen. We call these empty slots <strong class="chakra-text css-8vzs7e" node="[object Object]">holes</strong>.</p>
</li><li>
<p class="chakra-text css-xcnbdp" node="[object Object]">If an order has an order id <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> then its normalized quantity should also be <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> (◧ is not allowed) and vice versa (◨ is not allowed)</p>
</li><li>
<p class="chakra-text css-xcnbdp" node="[object Object]">Orders are inserted/added at the end.</p>
</li><li>
<p class="chakra-text css-xcnbdp" node="[object Object]">Orders are matched based on their order id. The smaller order ids get matched first (FIFO).</p>
</li><li>
<p class="chakra-text css-xcnbdp" node="[object Object]">The last segment of an existing price node <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>∈</mo><msub><mi>T</mi><mrow><mi>t</mi><mi>i</mi><mi>d</mi><mo separator="true">,</mo><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">p \in T_{tid, s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span> has at least one non-empty order:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo>⋯</mo><mi mathvariant="normal">■</mi><mo>⋯</mo><mo>←</mo><mtext>seg len</mtext><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\cdots \blacksquare \cdots \leftarrow \text{seg len} - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.675em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">■</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord text"><span class="mord">seg len</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span></span>
<p class="chakra-text css-xcnbdp" node="[object Object]">For the case of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">3</span></span></span></span> slots per segment the following cases are possible:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>←</mo><mtext>seg len</mtext><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">□</mi><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>←</mo><mtext>seg len</mtext><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">■</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>←</mo><mtext>seg len</mtext><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mi mathvariant="normal">□</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>←</mo><mtext>seg len</mtext><mo>−</mo><mn>1</mn><mo>=</mo><msub><mi>o</mi><mi>t</mi></msub></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">□</mi><mi mathvariant="normal">■</mi><mi mathvariant="normal">□</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>←</mo><mtext>seg len</mtext><mo>−</mo><mn>1</mn><mo>=</mo><msub><mi>o</mi><mi>t</mi></msub></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">■</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>←</mo><mtext>seg len</mtext><mo>−</mo><mn>1</mn><mo>=</mo><msub><mi>o</mi><mi>t</mi></msub></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
    \blacksquare \blacksquare   \blacksquare    &amp; \leftarrow \text{seg len} - 1         \\
    \square      \blacksquare   \blacksquare    &amp; \leftarrow \text{seg len} - 1         \\
    \square      \square        \blacksquare    &amp; \leftarrow \text{seg len} - 1         \\
    \blacksquare \blacksquare   \square         &amp; \leftarrow \text{seg len} - 1 = o_t   \\
    \square      \blacksquare   \square         &amp; \leftarrow \text{seg len} - 1 = o_t   \\
    \blacksquare \square        \square         &amp; \leftarrow \text{seg len} - 1 = o_t   \\
    
\end{align}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9em;vertical-align:-4.25em"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.75em"><span style="top:-6.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord amsrm">■■■</span></span></span><span style="top:-5.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord amsrm">□■■</span></span></span><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord amsrm">□□■</span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord amsrm">■■□</span></span></span><span style="top:-0.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord amsrm">□■□</span></span></span><span style="top:0.59em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord amsrm">■□□</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.25em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.75em"><span style="top:-6.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">seg len</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span></span></span><span style="top:-5.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">seg len</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span></span></span><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">seg len</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">seg len</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-0.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">seg len</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:0.59em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">seg len</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.25em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.75em"><span style="top:-6.75em"><span class="pstrut" style="height:2.84em"></span><span class="eqn-num"></span></span><span style="top:-5.25em"><span class="pstrut" style="height:2.84em"></span><span class="eqn-num"></span></span><span style="top:-3.75em"><span class="pstrut" style="height:2.84em"></span><span class="eqn-num"></span></span><span style="top:-2.25em"><span class="pstrut" style="height:2.84em"></span><span class="eqn-num"></span></span><span style="top:-0.75em"><span class="pstrut" style="height:2.84em"></span><span class="eqn-num"></span></span><span style="top:0.75em"><span class="pstrut" style="height:2.84em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.25em"><span></span></span></span></span></span></span></span></span>
</li><li>
<p class="chakra-text css-xcnbdp" node="[object Object]">The segment pointed to by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>o</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">o_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> (<code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">tombstoneOffset</span></span></code>) if the price node exists <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>∈</mo><msub><mi>T</mi><mrow><mi>t</mi><mi>i</mi><mi>d</mi><mo separator="true">,</mo><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">p \in T_{tid, s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span> in the tree, then this segment would have at least one non-empty order:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo>⋯</mo><mi mathvariant="normal">■</mi><mo>⋯</mo><mo>←</mo><msub><mi>o</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\cdots \blacksquare \cdots \leftarrow o_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.675em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">■</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>
<p class="chakra-text css-xcnbdp" node="[object Object]">For the case of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">3</span></span></span></span> slots per segment the following cases are possible:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>←</mo><msub><mi>o</mi><mi>t</mi></msub></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mi mathvariant="normal">□</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>←</mo><msub><mi>o</mi><mi>t</mi></msub></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">■</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>←</mo><msub><mi>o</mi><mi>t</mi></msub></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">□</mi><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>←</mo><msub><mi>o</mi><mi>t</mi></msub><mo>=</mo><mtext>seg len</mtext><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">□</mi><mi mathvariant="normal">■</mi><mi mathvariant="normal">□</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>←</mo><msub><mi>o</mi><mi>t</mi></msub><mo>=</mo><mtext>seg len</mtext><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">■</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>←</mo><msub><mi>o</mi><mi>t</mi></msub><mo>=</mo><mtext>seg len</mtext><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex"> \begin{align}
     \blacksquare \blacksquare   \blacksquare    &amp; \leftarrow o_t                        \tag{1}\\
     \blacksquare \blacksquare   \square         &amp; \leftarrow o_t                        \tag{2}\\
     \blacksquare \square        \square         &amp; \leftarrow o_t                        \tag{3}\\
     \square      \blacksquare   \blacksquare    &amp; \leftarrow o_t = \text{seg len} - 1   \tag{4}\\
     \square      \blacksquare   \square         &amp; \leftarrow o_t = \text{seg len} - 1   \tag{5}\\
     \square      \square        \blacksquare    &amp; \leftarrow o_t = \text{seg len} - 1   \tag{6}\\
 \end{align}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9em;vertical-align:-4.25em"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.75em"><span style="top:-6.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord amsrm">■■■</span></span></span><span style="top:-5.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord amsrm">■■□</span></span></span><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord amsrm">■□□</span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord amsrm">□■■</span></span></span><span style="top:-0.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord amsrm">□■□</span></span></span><span style="top:0.59em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord amsrm">□□■</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.25em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.75em"><span style="top:-6.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-5.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">seg len</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span></span></span><span style="top:-0.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">seg len</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span></span></span><span style="top:0.59em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">seg len</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.25em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.75em"><span style="top:-6.91em"><span class="pstrut" style="height:3em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1</span></span><span class="mord">)</span></span></span></span><span style="top:-5.41em"><span class="pstrut" style="height:3em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">2</span></span><span class="mord">)</span></span></span></span><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">3</span></span><span class="mord">)</span></span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">4</span></span><span class="mord">)</span></span></span></span><span style="top:-0.91em"><span class="pstrut" style="height:3em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">5</span></span><span class="mord">)</span></span></span></span><span style="top:0.59em"><span class="pstrut" style="height:3em"></span><span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">6</span></span><span class="mord">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.25em"><span></span></span></span></span></span></span></span></span>
</li><li>
<p class="chakra-text css-xcnbdp" node="[object Object]">For price nodes that do not belong to the tree <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo mathvariant="normal">∉</mo><msub><mi>T</mi><mrow><mi>t</mi><mi>i</mi><mi>d</mi><mo separator="true">,</mo><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">p\notin T_{tid,s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel"><span class="mord"><span class="mrel">∈</span></span><span class="mord vbox"><span class="thinbox"><span class="llap"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right:0.0556em"></span></span></span><span class="fix"></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span>, we should have the following configuration:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">□</mi><mo>⋯</mo><mi mathvariant="normal">□</mi><mo>←</mo><msub><mi>o</mi><mi>t</mi></msub><mo>=</mo><mtext>seg len</mtext></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
    \square \cdots \square \leftarrow o_t = \text{seg len}
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5em;vertical-align:-0.5em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em"><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord amsrm">□</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">□</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">seg len</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p class="chakra-text css-xcnbdp" node="[object Object]">ie. all the orders belonging to the segment pointed to by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>o</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">o_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>, they should all be empty orders.</p>
</li><li>
<p class="chakra-text css-xcnbdp" node="[object Object]">Either <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>o</mi><mi>t</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">o_t = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> or if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>o</mi><mi>t</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">o_t &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> all the slots before <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>o</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">o_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> are empty slots:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>←</mo><msub><mi>o</mi><mi>t</mi></msub><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
    \vdots &amp; \\
    \square \square \square    &amp; \\
    \square \square \square    &amp; \leftarrow o_t - 1
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.16em;vertical-align:-2.33em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.83em"><span style="top:-5.0175em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em"></span></span></span></span><span style="top:-3.5175em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord amsrm">□□□</span></span></span><span style="top:-2.0175em"><span class="pstrut" style="height:3.6875em"></span><span class="mord"><span class="mord amsrm">□□□</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.33em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.83em"><span style="top:-4.83em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mord"></span></span></span><span style="top:-3.33em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mord"></span></span></span><span style="top:-1.83em"><span class="pstrut" style="height:3.5em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.33em"><span></span></span></span></span></span></span></span></span></span></span></span>
</li><li>
<p class="chakra-text css-xcnbdp" node="[object Object]">Orders belonging to segments pointed to by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>≥</mo><mtext>seg len</mtext></mrow><annotation encoding="application/x-tex">k \geq \text{seg len}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord text"><span class="mord">seg len</span></span></span></span></span> should all be empty orders (⚠️ unless there is a storage collision if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> is a  really big number). This is a more general invariant compared to Inv 8.:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">□</mi><mo>⋯</mo><mi mathvariant="normal">□</mi><mo>←</mo><mi>k</mi><mo>≥</mo><mtext>seg len</mtext></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
    \square \cdots \square \leftarrow k \geq \text{seg len}
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5em;vertical-align:-0.5em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em"><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord amsrm">□</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">□</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">seg len</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em"><span></span></span></span></span></span></span></span></span></span></span></span>
</li><li>
<p class="chakra-text css-xcnbdp" node="[object Object]">The active orders in the price segments are arranged in a monotonically increasing fashion based on their order ids (this is a more stricted version of Inv 1.)</p>
</li></ol>

























































<table><thead><tr><th>method</th><th>Inv 1.</th><th>Inv 2.</th><th>Inv 3.</th><th>Inv 4.</th><th>Inv 5.</th><th>Inv 6.</th><th>Inv 7.</th><th>Inv. 8</th><th>Inv. 9</th><th>Inv 10.</th></tr></thead><tbody><tr><td>canceling orders</td><td>✅</td><td>✅</td><td>N/A</td><td>N/A</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>placing limit orders</td><td>✅</td><td>✅</td><td>✅</td><td>N/A</td><td>✅</td><td>✅</td><td>N/A</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>matching orders</td><td></td><td></td><td>N/A</td><td></td><td></td><td>❌</td><td></td><td></td><td></td><td></td></tr></tbody></table>
<p class="chakra-text css-xcnbdp" node="[object Object]">The ✅ above means that if the invariant was satisfied before calling the method, it will be satisfied after the call has been done (in some edge cases it would only mean the invariant is satisfied after the call has been done, but it might not be before the call for example at the very beginning.)</p>
<ul role="list" node="[object Object]" class="css-tu0njr"><li>
<p class="chakra-text css-xcnbdp" node="[object Object]"><strong class="chakra-text css-8vzs7e" node="[object Object]">canceling orders</strong>: We should have <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>∈</mo><msub><mi>T</mi><mrow><mi>t</mi><mi>i</mi><mi>d</mi><mo separator="true">,</mo><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">p \in T_{tid,s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">d</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span> otherwise the call should fail. First the order&#x27;s position in the price segment should be found using <a target="_blank" rel="noopener nofollow" class="chakra-link css-15y7uvo" href="https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/SonicOrderBook.sol#L1006" node="[object Object]"><code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_find</span></span></code></a>. The <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_find</span></span></code> flow relies on the fact that there are no holes (inv 1.) in the price segments and orders are placed in a monotonically increasing fashion (Inv 10.). The invariant checks need to be performed for each branch in <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_cancelOrder</span></span></code>:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">isFinalSegment </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">&amp;&amp;</span><span class="token plain"> isOnlyOrderInSegment</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// branch A</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// Branch B: this branch has many sub-branches</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">/* ... */</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">nextSlot </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">==</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// this branch should only be hit on the last segment,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// ie, when `currentOrNextSegment == segments.length - 1`</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// one can add a require statement. 🟡</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// Branch B1: `for` loop gets skipped (`absoluteSlotIndexToRemove == totalOrders`)</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// Branch B2: `for` loop is entered   (`absoluteSlotIndexToRemove  &lt; totalOrders`)</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span></span></code></pre></div>

























































<table><thead><tr><th>method</th><th>Inv 1.</th><th>Inv 2.</th><th>Inv 3.</th><th>Inv 4.</th><th>Inv 5.</th><th>Inv 6.</th><th>Inv 7.</th><th>Inv. 8</th><th>Inv. 9</th><th>Inv 10.</th></tr></thead><tbody><tr><td>canceling orders (branch A)</td><td>✅</td><td>✅</td><td>N/A</td><td>N/A</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>canceling orders (branch B1)</td><td>✅</td><td>✅</td><td>N/A</td><td>N/A</td><td>✅</td><td>✅</td><td>N/A</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>canceling orders (branch B2)</td><td>✅</td><td>✅</td><td>N/A</td><td>N/A</td><td>✅</td><td>✅</td><td>N/A</td><td>✅</td><td>✅</td><td>✅</td></tr></tbody></table>
</li><li>
<p class="chakra-text css-xcnbdp" node="[object Object]"><strong class="chakra-text css-8vzs7e" node="[object Object]">placing limit orders</strong> (adding to the book): It is very important that:</p>
<ol role="list" node="[object Object]" class="css-1dg6mvm"><li><code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_tokenIdInfos[order.tokenId].minQuantity</span></span></code> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>q</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow><mrow><mi>t</mi><mi>i</mi><mi>d</mi></mrow></msubsup><mo mathvariant="normal">≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">q_{min}^{tid} \neq 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1078em;vertical-align:-0.2587em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>. When an admin makes a token id <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>i</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">tid</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span></span></span></span> tradable <a target="_blank" rel="noopener nofollow" class="chakra-link css-15y7uvo" href="https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/libraries/SonicOrderBookLibrary.sol#L55-L57" node="[object Object]">it has been checked</a> that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>q</mi><mi mathvariant="normal">∣</mi><msubsup><mi>q</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow><mrow><mi>t</mi><mi>i</mi><mi>d</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">\Delta q | q_{min}^{tid}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1078em;vertical-align:-0.2587em"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>q</mi><mo>≤</mo><msubsup><mi>q</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow><mrow><mi>t</mi><mi>i</mi><mi>d</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">\Delta q \leq q_{min}^{tid}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1078em;vertical-align:-0.2587em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em"><span></span></span></span></span></span></span></span></span></span>.</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mi>o</mi></msub></mrow><annotation encoding="application/x-tex">q_o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">order.quantity</span></span></code> is quantised by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">\Delta q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em">q</span></span></span></span> and is non-zero. This has been checked.</li><li><code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">quantityFulfilled</span></span></code> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">q_f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span> is also quantised by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">\Delta q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em">q</span></span></span></span>. This can be proved by induction/recursion in <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_parseOrder</span></span></code>.</li></ol>
<p class="chakra-text css-xcnbdp" node="[object Object]">And thus one can deduce that in the branch where <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_addToBook(...)</span></span></code> is called, <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">quantityRemaining</span></span></code> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">q_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> is also quantised by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">\Delta q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em">q</span></span></span></span> and is non-zero.</p>
<p class="chakra-text css-xcnbdp" node="[object Object]">This is very important as it would guarantee one would not add slots to the price segment with a non-zero order id but with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> quantised/normalised quantities, ie adding a slot of the form <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0, i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span> should not be possible as this would break (Inv 2.).</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">_addOrderToEndOfSegments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">private</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">segments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">length </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">!=</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">lastSegmentIndex </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">&gt;=</span><span class="token plain"> node</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">tombstoneSegmentOffset</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// Branch A: If there is space at the end of last segment</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">//           and if this last segment is in the active aread of the price segment</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">            </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">//           add the order slot here and `return`</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// Branch B: push a new segment [(0,0), (0,0), (qn, oid)] to price segment</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">//           as the last segment is full.</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">bytes32</span><span class="token plain"> segment </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> SlotLibrary</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">createSlotAsBytes32</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> normalizedQuantity</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    segments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">push</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">segment</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span></span></code></pre></div>












































<table><thead><tr><th>method</th><th>Inv 1.</th><th>Inv 2.</th><th>Inv 3.</th><th>Inv 4.</th><th>Inv 5.</th><th>Inv 6.</th><th>Inv 7.</th><th>Inv. 8</th><th>Inv. 9</th><th>Inv 10.</th></tr></thead><tbody><tr><td>placing limit orders (branch A)</td><td>✅</td><td>✅</td><td>✅</td><td>N/A</td><td>✅</td><td>✅</td><td>N/A</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>placing limit orders (branch B)</td><td>✅</td><td>✅</td><td>✅</td><td>N/A</td><td>✅</td><td>✅</td><td>N/A</td><td>✅</td><td>✅</td><td>✅</td></tr></tbody></table>
</li><li>
<p class="chakra-text css-xcnbdp" node="[object Object]"><strong class="chakra-text css-8vzs7e" node="[object Object]">matching orders</strong>: If the last segment is not deleted but all its orders get consumed, this last segment is not popped out instead just set to <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">bytes32(0)</span></span></code> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi></mrow><annotation encoding="application/x-tex">\square \square \square</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.675em"></span><span class="mord amsrm">□□□</span></span></span></span> (<a target="_blank" rel="noopener nofollow" class="chakra-link css-15y7uvo" href="https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/SonicOrderBook.sol#L948-L950" node="[object Object]">ref</a>).</p>
</li></ul>
<p class="chakra-text css-xcnbdp" node="[object Object]">The invariants broken ❌</p>
<h2 class="chakra-heading css-jg3yxe" id="recommendation" node="[object Object]">Recommendation</h2>
<p class="chakra-text css-xcnbdp" node="[object Object]">Invariant checks after applying the suggested patches:</p>

























































<table><thead><tr><th>method</th><th>Inv 1.</th><th>Inv 2.</th><th>Inv 3.</th><th>Inv 4.</th><th>Inv 5.</th><th>Inv 6.</th><th>Inv 7.</th><th>Inv. 8</th><th>Inv. 9</th><th>Inv 10.</th></tr></thead><tbody><tr><td>canceling orders</td><td>✅</td><td>✅</td><td>N/A</td><td>N/A</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>placing limit orders</td><td>✅</td><td>✅</td><td>✅</td><td>N/A</td><td>✅</td><td>✅</td><td>N/A</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>matching orders</td><td></td><td>✅</td><td>N/A</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td></tr></tbody></table>
<h3 class="chakra-heading css-c8eelt" id="matching-orders" node="[object Object]">matching orders</h3>
<p class="chakra-text css-xcnbdp" node="[object Object]">The fix for <a class="chakra-link css-15y7uvo" node="[object Object]" href="https://cantina.xyz/code/533c3043-fa7a-4275-8bae-e2313e1b5d18/findings?finding=4">#Finding #4</a> needs to be applied as well is:</p>
<h4 class="chakra-heading css-1f8olwv" id="inv-6" node="[object Object]">Inv 6.</h4>
<p class="chakra-text css-xcnbdp" node="[object Object]">Currently the Inv 6. is broken, apply the patch below to fix:</p>
<details><summary>📝 Click here to view patch</summary>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token plain">diff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol</span></span><span class="token-line" style="display:block"><span class="token plain">index 31b5486..e690a23 100644</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token coord">--- a/contracts/SonicOrderBook.sol</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token coord">+++ b/contracts/SonicOrderBook.sol</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">@@ -108,6 +108,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  error SellMustUseExactQuantity();</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  error MakerPriceMustMatch(uint256 expectedPrice, uint256 actualPrice);</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  // Errors related to price segment invariants being broken</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  error PriceSegmentHasAHole();</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  error IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset();</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  enum OrderSide {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    Buy,</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    Sell</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">@@ -915,39 +919,126 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uint256 lastSegmentIndex,</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uint256 numOrdersFullyConsumed</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  ) private {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // `segments.length &gt; lastSegmentIndex &gt;= oldTombstoneOffset`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // `numOrdersFullyConsumed` should be the number of order slots fully consumed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // yet not modified but the cursor passed over it to the next order slot.</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // Assumptions:</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    //    1. `numSegmentsFullyConsumed` is calculated correctly, it should be the number of</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    //       slots fully consumed or skipped if the slot was EMPTY (0)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    //    2. `lastSegmentIndex` points to the last segment consumed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    //    3. `lastSegment` is the segment pointed to by `lastSegmentIndex`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // [CHECK LIST] One should enforce the following for `lastSegment` (the last segment consumed):</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // (o: an EMPTY slot, x: a non-EMPTY slot)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    //</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // o o o - last consumed segment - ALLOWED (only if the price node gets removed from the tree)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // o o x - last consumed segment - ALLOWED (check `ot` &amp; `seg.len - 1` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // o x o - last consumed segment - ALLOWED (check `ot` &amp; `seg.len - 1` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // o x x - last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // x o o - last consumed segment - ALLOWED (check `ot` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // x o x - last consumed segment - CATCH - no hole in the middle allowed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // x x o - last consumed segment - ALLOWED (check `ot` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // x x x - last consumed segment - ALLOWED</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uint256 numSegmentsFullyConsumed = numOrdersFullyConsumed / NUM_SLOTS_PER_SEGMENT;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">    uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    uint256 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">    uint56 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">    if (numSegmentsFullyConsumed != 0) {</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      // Cleanup segments to get a gas refund</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      for (uint256 i = 0; i &lt; numSegmentsFullyConsumed; ++i) {</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">        delete segments[oldTombstoneOffset + i];</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      }</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    if (lastSegmentIndex == newTombstoneSegmentOffset) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // At this branch we know `segments.length &gt; lastSegmentIndex &gt;= newTombstoneSegmentOffset`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      lastSegment = lastSegment.clearUpToSlot(numOrdersWithinLastSegmentFullyConsumed);</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      if (uint256(lastSegment) == 0) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // `lastSegment` has this property/assumption that either:</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // A1. An other was partially matched in this segment or</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // A2. We had reached the last segment in the active area of the price segments which</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //     has some zero slots (`if (remainingSegment == 0)` branch in `_consumePriceSegments`)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // Moreover, there is an assumption here that if `lastSegment` that was touched during the</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // matching/filling process ends up being `0` then that would mean, there are no orders</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // left in the price segments since A1 would not be possible and so for A2:</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // 1. any order slot before this segment should have been fully filled/matched and thus</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //    should have been zeroed out in the previous `if (numSegmentsFullyConsumed != 0)`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //    block.</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // 2. There could not be any non-zero order slot past this segment since otherwise,</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //    that would indicate there would have been holes in the price segments previously</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //    breaking (Inv 1.)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        newTombstoneSegmentOffset = lastSegmentIndex + 1;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // so we would have:</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // `segments.length &gt;= newTombstoneSegmentOffset == lastSegmentIndex + 1`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // `newTombstoneSegmentOffset == lastSegmentIndex + 1 &gt; oldTombstoneOffset`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // thus below `lastSegment` shuold get deleted</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // o o o - last consumed segment - ALLOWED - it will get deleted and the new tombstone offset</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //                                           points to the following segment</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // The checks from the [CHECK LIST] are not required since if one hits this branch and continue</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // without reverting, the last segment consumed would be removed from the price segments</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // and the new tombstone offset would point to the following segment.</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      } else {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // At this branch we know `segments.length &gt; lastSegmentIndex &gt;= newTombstoneSegmentOffset`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // and `lastSegment` is non-zero, so at the end `bestPrice` would not get removed from the `tree`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      // Consumed all orders at this price level, so remove it from the tree</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      if (newTombstoneSegmentOffset == segments.length) {</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">        tree.remove(bestPrice);</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      }</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">    }</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">    bool lastSegmentDeleted = lastSegmentIndex &lt; (oldTombstoneOffset + numSegmentsFullyConsumed);</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">    if (!lastSegmentDeleted) {</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      if (numOrdersWithinLastSegmentFullyConsumed != 0) {</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">        for (uint256 i; i &lt; numOrdersWithinLastSegmentFullyConsumed; ++i) {</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">          lastSegment = lastSegment.clearSlot(i);</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // s2 s1 s0 : cs(bits) : lastSegment &lt;-- (lastSegmentIndex == newTombstoneSegmentOffset)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // --------------------------------(si: the `i`th slot, cs: compressed status)-------</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  o  o  o :      111 : last consumed segment - ALLOWED (only if the price node gets removed from the tree)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  o  o  x :      110 : last consumed segment - ALLOWED (check `ot` &amp; `seg.len - 1` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  o  x  o :      101 : last consumed segment - ALLOWED (check `ot` &amp; `seg.len - 1` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  o  x  x :      100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  x  o  o :      011 : last consumed segment - ALLOWED (check `ot` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  x  o  x :      010 : last consumed segment - CATCH - no hole in the middle allowed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  x  x  o :      001 : last consumed segment - ALLOWED (check `ot` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  x  x  x :      000 : last consumed segment - ALLOWED</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        uint256 compressedStatus = lastSegment.compressedStatus();</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  o  o  o : 111 : one would not enter this branch for this case</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  x  o  x : 010 : last consumed segment - CATCH - no hole in the middle allowed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        require(compressedStatus != 2, PriceSegmentHasAHole());</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        if (compressedStatus &gt; 3) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          //  o  x  x : 100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          //  o  x  o : 101 : last consumed segment - ALLOWED (check `ot` &amp; `seg.len - 1` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          //  o  o  x : 110 : last consumed segment - ALLOWED (check `ot` &amp; `seg.len - 1` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          require(lastSegmentIndex == segments.length - 1, PriceSegmentHasAHole());</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      }</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      if (uint256(lastSegment) == 0) {</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">        // All orders in the last segment are consumed, delete from tree</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">        tree.remove(bestPrice);</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">        // Don&#x27;t pop segment for gas efficiency, instead just write zeros</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        segments[lastSegmentIndex] = lastSegment;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      segments[lastSegmentIndex] = lastSegment;</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    } else {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // if `lastSegmentIndex =/= newTombstoneSegmentOffset` that would mean the matching process had ended up</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // with ( - dashes the slot can be 0 or not, c means that it was consumed):</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // ...</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // x(c) -(c) -(c) : lastSegmentIndex</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // where in the last segment, the last slot was fully filled and thus we would end up with:</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // ...</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // x(c) -(c) -(c) : lastSegmentIndex</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      //   -  -    -    : newTombstoneSegmentOffset</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // So these values can only be off by `1`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      require(lastSegmentIndex + 1 == newTombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset());</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // The checks from the [CHECK LIST] are not required since if one hits this branch and continue</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // without reverting, the last segment consumed would be removed from the price segments</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // and the new tombstone offset would point to the following segment.</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // Cleanup segments to get a gas refund</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    for (uint256 i = oldTombstoneOffset; i &lt; newTombstoneSegmentOffset; ++i) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      delete segments[i];</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    if (newTombstoneSegmentOffset != oldTombstoneOffset) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // below one can add an extra branch for `newTombstoneSegmentOffset &gt; segments.length`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // and possibly revert since that would mean some invariant was broken.</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    if (newTombstoneSegmentOffset &gt;= segments.length) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      tree.remove(bestPrice);</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">diff --git a/contracts/libraries/SegmentLibrary.sol b/contracts/libraries/SegmentLibrary.sol</span></span><span class="token-line" style="display:block"><span class="token plain">index d884717..e7c91a2 100644</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token coord">--- a/contracts/libraries/SegmentLibrary.sol</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token coord">+++ b/contracts/libraries/SegmentLibrary.sol</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">@@ -43,6 +43,39 @@ library SegmentLibrary {</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    return bytes10(uint80((uint256(segment) &gt;&gt; (slotIndex * SEGMENT_SIZE)) &amp; SEGMENT_MASK));</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  /// @notice Compresses the segment into 3 indicator bits</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  /// @param segment The segment to read from</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  /// @return status with only 3 bits sets each indicating whether the corresponding</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  //                 slot in the segment is EMPTY or not.</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  function compressedStatus(bytes32 segment) internal pure returns (uint256 status) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    uint256 MASK = SEGMENT_MASK;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    uint256 SIZE = SEGMENT_SIZE;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    assembly (&quot;memory-safe&quot;) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // s2 s1 s0 : segment</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      status := iszero(and(segment, MASK))</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      segment := shr(SIZE, segment)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      //  0 s2 s1 : segment</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      status := or(</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        shl(1, iszero(and(segment, MASK))),</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        status</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      )</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      segment := shr(SIZE, segment)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      //  0  0 s2 : segment</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      status := or(</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        shl(2, iszero(and(segment, MASK))), // still mask in case segment has dirty uppper bits</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        status</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      )</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // b2 b1 b0 : status bits (it would only have 3 set bits)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // b2       : is 1 if s2 the 3rd slot of original segment was EMPTY</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      //    b1    : is 1 if s1 the 2nd slot of original segment was EMPTY</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      //       b0 : is 1 if s0 the 1st slot of original segment was EMPTY</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  /// @notice Checks if the segment only contains data in the specified slot</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  /// @dev Returns true if all other slots in the segment are empty (zero)</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  /// @param segment The segment to check</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">@@ -60,6 +93,19 @@ library SegmentLibrary {</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    return bytes32(uint256(segment) &amp; ~(uint256(SEGMENT_MASK) &lt;&lt; (slotIndex * SEGMENT_SIZE)));</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  /// @notice Clears slots up to the specified index, setting all its bits to zero</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  /// @param segment The segment to modify</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  /// @param slotIndex The index of the slot to clear up to (0, 1, or 2)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  /// @return newSegment The updated segment with the right most slots cleared up to `slotIndex`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  function clearUpToSlot(bytes32 segment, uint256 slotIndex) internal pure returns (bytes32 newSegment) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    if (slotIndex == 0) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      return segment;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    uint256 shiftAmount = slotIndex * SEGMENT_SIZE;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    return bytes32((uint256(segment) &gt;&gt; (shiftAmount)) &lt;&lt; shiftAmount);</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  /// @notice Returns the remaining segment data after the specified slot index</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  /// @dev Shifts the segment right to remove all slots up to and including the specified index.</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  ///      Useful for iterating through higher-indexed slots or processing remaining data.</span></span></code></pre></div>
</details>
<p class="chakra-text css-xcnbdp" node="[object Object]">This patch makes reasoning about other invariants easier due to the modification for <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_updateSegmentsAndTree</span></span></code>.</p>
<details>
<summary>Modifications of <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_updateSegmentsAndTree</span></span></code> with comments removed</summary>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">function</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">_updateSegmentsAndTree</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    BokkyPooBahsRedBlackTreeLibrary</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">Tree </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">storage</span><span class="token plain"> tree</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    BokkyPooBahsRedBlackTreeLibrary</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">Node </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">storage</span><span class="token plain"> bestPriceNode</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">bytes32</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">storage</span><span class="token plain"> segments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">uint64</span><span class="token plain"> bestPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">bytes32</span><span class="token plain"> lastSegment</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">uint256</span><span class="token plain"> lastSegmentIndex</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">uint256</span><span class="token plain"> numOrdersFullyConsumed</span></span><span class="token-line" style="display:block"><span class="token plain">  </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">private</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">uint256</span><span class="token plain"> numSegmentsFullyConsumed </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> numOrdersFullyConsumed </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">/</span><span class="token plain"> NUM_SLOTS_PER_SEGMENT</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">uint256</span><span class="token plain"> oldTombstoneOffset </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> bestPriceNode</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">tombstoneSegmentOffset</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">uint256</span><span class="token plain"> newTombstoneSegmentOffset </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> oldTombstoneOffset </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">+</span><span class="token plain"> numSegmentsFullyConsumed</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">lastSegmentIndex </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">==</span><span class="token plain"> newTombstoneSegmentOffset</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">uint256</span><span class="token plain"> numOrdersWithinLastSegmentFullyConsumed </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> numOrdersFullyConsumed </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">%</span><span class="token plain"> NUM_SLOTS_PER_SEGMENT</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      lastSegment </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> lastSegment</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">clearUpToSlot</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">numOrdersWithinLastSegmentFullyConsumed</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">uint256</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">lastSegment</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">==</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        newTombstoneSegmentOffset </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> lastSegmentIndex </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">+</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">1</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">uint256</span><span class="token plain"> compressedStatus </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> lastSegment</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">compressedStatus</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">require</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">compressedStatus </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">!=</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">2</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">PriceSegmentHasAHole</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">compressedStatus </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">3</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">          </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">require</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">lastSegmentIndex </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">==</span><span class="token plain"> segments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">length </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">-</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">1</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">PriceSegmentHasAHole</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">        segments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token plain">lastSegmentIndex</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token plain"> </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> lastSegment</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">require</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">lastSegmentIndex </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">+</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">1</span><span class="token plain"> </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">==</span><span class="token plain"> newTombstoneSegmentOffset</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">uint256</span><span class="token plain"> i </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> oldTombstoneOffset</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"> i </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">&lt;</span><span class="token plain"> newTombstoneSegmentOffset</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"> </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">++</span><span class="token plain">i</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">delete</span><span class="token plain"> segments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">newTombstoneSegmentOffset </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">!=</span><span class="token plain"> oldTombstoneOffset</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      tree</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">edit</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">bestPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">uint56</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">newTombstoneSegmentOffset</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">newTombstoneSegmentOffset </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">&gt;=</span><span class="token plain"> segments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">length</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      tree</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">remove</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">bestPrice</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">  </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span></span></code></pre></div>
</details>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">function</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">_updateSegmentsAndTree</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">private</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// ...</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">lastSegmentIndex </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">==</span><span class="token plain"> newTombstoneSegmentOffset</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// ...</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">uint256</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">lastSegment</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">==</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// ...</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        newTombstoneSegmentOffset </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> lastSegmentIndex </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">+</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">1</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// Branch A</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// ...</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        segments</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">[</span><span class="token plain">lastSegmentIndex</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">]</span><span class="token plain"> </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> lastSegment</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">        </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// Branch B</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"> </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">require</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">lastSegmentIndex </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">+</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">1</span><span class="token plain"> </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">==</span><span class="token plain"> newTombstoneSegmentOffset</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">      </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// Branch C</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="display:block"><span class="token plain">    </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// ...</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">  </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span></span></code></pre></div>

























































<table><thead><tr><th>method</th><th>Inv 1.</th><th>Inv 2.</th><th>Inv 3.</th><th>Inv 4.</th><th>Inv 5.</th><th>Inv 6.</th><th>Inv 7.</th><th>Inv. 8</th><th>Inv. 9</th><th>Inv 10.</th></tr></thead><tbody><tr><td>matching orders (patch above) Branch A</td><td>🌓</td><td>✅</td><td>N/A</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>matching orders (patch above) Branch B</td><td>🌓</td><td>🌓</td><td>N/A</td><td>✅</td><td>✅</td><td>✅</td><td>N/A</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>matching orders (patch above) Branch C</td><td>🌓</td><td>✅</td><td>N/A</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td><td>✅</td></tr></tbody></table>
<ul role="list" node="[object Object]" class="css-tu0njr"><li>🌓 (Branch A, Inv 1.): If the a hole was about to get introduced it will be ignored. The final price segment would not end up having a hole.</li><li>🌓 (Branch C, Inv 1.): If the a hole was about to get introduced it will be ignored. The final price segment would not end up having a hole.</li><li>🌓 (Branch B, Inv 1.): If the a hole was about to get introduced it will be ignored the transaction would revert with <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">PriceSegmentHasAHole()</span></span></code>. One still need to check the upstream flow in <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_consumePriceSegments --&gt; loops --&gt; _parseOrder</span></span></code> to make sure one would not hit error. The upside is the new approach would prevent price segmements having holes and in case of an error one needs to check the upstream logic.</li></ul>
<ol role="list" node="[object Object]" class="css-1dg6mvm"><li>
<p class="chakra-text css-xcnbdp" node="[object Object]">One can prove that <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_parseOrder</span></span></code> preserves the compressed status (ie the shape) of a segment and thus througout the loops in <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_consumePriceSegments</span></span></code> up to the point were one enters <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_updateSegmentsAndTree</span></span></code> the compressed status (the shape) if the price segment stays the same. Thus the shapes used for invariants 1, 2, 5, 6, 8, 9 are not modified while parsing through the price segment slots.</p>
</li><li>
<p class="chakra-text css-xcnbdp" node="[object Object]">In this whole flow it is important that once one partially matches a slot, the loops should terminate and the paramters <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">numOrdersFullyConsumed</span></span></code>, <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">segment</span></span></code> and <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">lastConsumedSegmentIndex</span></span></code> should not change after this point on (🚨).</p>
<p class="chakra-text css-xcnbdp" node="[object Object]">Checking and proving the above points 1. and 2. should prove that <strong class="chakra-text css-8vzs7e" node="[object Object]">invariant 1</strong> is satisfied for the matching order flow (before and after jumping in <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_updateSegmentsAndTree</span></span></code>).</p>
</li></ol>
<ul role="list" node="[object Object]" class="css-tu0njr"><li>🌓 (Branch B, Inv 2.): <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_parseOrder</span></span></code> needs to be verified to not break this invariant. It has already been checked that the slot being parsed in <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_parseOrder</span></span></code> has a non-zero <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">orderId</span></span></code> before <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_parseOrder</span></span></code> gets called. So we just need to make sure the normalised quantity does not end up being <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> for this slot (✅ proof below).</li></ul>
<h5 class="chakra-heading css-1ucn39k" id="case-1-budget-constrained-buy-market-orders" node="[object Object]">Case 1. budget-constrained buy market orders</h5>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>&lt;</mo><msub><mi>q</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>∧</mo><mo stretchy="false">(</mo><msub><mi>c</mi><mi>r</mi></msub><mo>&lt;</mo><mrow><mo fence="true">⌊</mo><mfrac><mrow><msub><mi>q</mi><mi>n</mi></msub><mo>⋅</mo><mi mathvariant="normal">Δ</mi><mi>q</mi><mo>⋅</mo><msub><mi>p</mi><mi>b</mi></msub></mrow><msup><mn>10</mn><mi>d</mi></msup></mfrac><mo fence="true">⌋</mo></mrow><mo stretchy="false">)</mo><mo>⇒</mo><msub><mi>q</mi><mi>n</mi></msub><mo>−</mo><mrow><mo fence="true">⌊</mo><mfrac><mrow><mo fence="true">⌊</mo><mfrac><mrow><msub><mi>c</mi><mi>r</mi></msub><mo>⋅</mo><msup><mn>10</mn><mi>d</mi></msup></mrow><msub><mi>p</mi><mi>b</mi></msub></mfrac><mo fence="true">⌋</mo></mrow><mrow><mi mathvariant="normal">Δ</mi><mi>q</mi></mrow></mfrac><mo fence="true">⌋</mo></mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">(0 &lt; q_n) \land (c_r &lt; \left\lfloor \frac{q_n \cdot \Delta q \cdot p_b}{10^d} \right\rfloor)
\Rightarrow 
q_n - \left\lfloor \frac{
    \left\lfloor \frac{c_r \cdot 10^{d}}{p_b} \right\rfloor
}{\Delta q} \right\rfloor &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size3">⌊</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7751em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size3">⌋</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:3.74em;vertical-align:-1.55em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.05em"><span class="pstrut" style="height:5.6em"></span><span style="width:0.667em;height:3.600em"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M319 602 V0 H403 V602 v1200 v1715 h263 v84 H319z
MM319 602 V0 H403 V602 v1200 v1715 H319z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.19em"><span style="top:-2.464em"><span class="pstrut" style="height:3.15em"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em">q</span></span></span><span style="top:-3.38em"><span class="pstrut" style="height:3.15em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-4.19em"><span class="pstrut" style="height:3.15em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size2">⌊</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.059em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4101em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mbin mtight">⋅</span><span class="mord mtight">1</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.927em"><span style="top:-2.931em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size2">⌋</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.05em"><span class="pstrut" style="height:5.6em"></span><span style="width:0.667em;height:3.600em"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M319 602 V0 H403 V602 v1200 v1799 H0 v-84 H319z
MM319 602 V0 H403 V602 v1200 v1715 H319z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span></span>
<p class="chakra-text css-xcnbdp" node="[object Object]">One can prove:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>0</mn><mo>≤</mo><mrow><mo fence="true">(</mo><mfrac><msup><mn>10</mn><mi>d</mi></msup><mrow><mi mathvariant="normal">Δ</mi><mi>q</mi><mo>⋅</mo><msub><mi>p</mi><mi>b</mi></msub></mrow></mfrac><mo fence="true">)</mo></mrow><msub><mi>ϵ</mi><mn>0</mn></msub><mo>+</mo><mrow><mo fence="true">(</mo><mfrac><mn>1</mn><mrow><mi mathvariant="normal">Δ</mi><mi>q</mi></mrow></mfrac><mo fence="true">)</mo></mrow><msub><mi>ϵ</mi><mn>1</mn></msub><mo>+</mo><msub><mi>ϵ</mi><mn>2</mn></msub><mo>&lt;</mo><msub><mi>q</mi><mi>n</mi></msub><mo>−</mo><mrow><mo fence="true">⌊</mo><mfrac><mrow><mo fence="true">⌊</mo><mfrac><mrow><msub><mi>c</mi><mi>r</mi></msub><mo>⋅</mo><msup><mn>10</mn><mi>d</mi></msup></mrow><msub><mi>p</mi><mi>b</mi></msub></mfrac><mo fence="true">⌋</mo></mrow><mrow><mi mathvariant="normal">Δ</mi><mi>q</mi></mrow></mfrac><mo fence="true">⌋</mo></mrow></mrow><annotation encoding="application/x-tex">0 \leq 
\left(\frac{10^d}{\Delta q \cdot p_b}\right)\epsilon_0 +
\left(\frac{1}{\Delta q}\right)\epsilon_1 +
\epsilon_2 &lt;

q_n - \left\lfloor \frac{
    \left\lfloor \frac{c_r \cdot 10^{d}}{p_b} \right\rfloor
}{\Delta q} \right\rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.4761em;vertical-align:-0.95em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5261em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em">q</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:3.74em;vertical-align:-1.55em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.05em"><span class="pstrut" style="height:5.6em"></span><span style="width:0.667em;height:3.600em"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M319 602 V0 H403 V602 v1200 v1715 h263 v84 H319z
MM319 602 V0 H403 V602 v1200 v1715 H319z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.19em"><span style="top:-2.464em"><span class="pstrut" style="height:3.15em"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em">q</span></span></span><span style="top:-3.38em"><span class="pstrut" style="height:3.15em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-4.19em"><span class="pstrut" style="height:3.15em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size2">⌊</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.059em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4101em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mbin mtight">⋅</span><span class="mord mtight">1</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.927em"><span style="top:-2.931em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size2">⌋</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.05em"><span class="pstrut" style="height:5.6em"></span><span style="width:0.667em;height:3.600em"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M319 602 V0 H403 V602 v1200 v1799 H0 v-84 H319z
MM319 602 V0 H403 V602 v1200 v1715 H319z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p class="chakra-text css-xcnbdp" node="[object Object]">where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>ϵ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>ϵ</mi><mn>2</mn></msub><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\epsilon_0, \epsilon_1, \epsilon_2 \in [0,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p>
<h5 class="chakra-heading css-1ucn39k" id="case-2-all-other-cases" node="[object Object]">case 2. all other cases</h5>
<p class="chakra-text css-xcnbdp" node="[object Object]">This is obvious based on <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">if</span></span></code>/<code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">else</span></span></code> branch conditions.</p>
<h3 class="chakra-heading css-c8eelt" id="canceling-orders" node="[object Object]">canceling orders</h3>
<p class="chakra-text css-xcnbdp" node="[object Object]">Applying the recommendation in <a class="chakra-link css-15y7uvo" node="[object Object]" href="https://cantina.xyz/code/533c3043-fa7a-4275-8bae-e2313e1b5d18/findings?finding=1">Finding #1</a> is recommended.</p>
<h2 class="chakra-heading css-jg3yxe" id="summary" node="[object Object]">Summary</h2>
<p class="chakra-text css-xcnbdp" node="[object Object]">Apply the following patch. This would cover the changes required for:</p>
<ul role="list" node="[object Object]" class="css-tu0njr"><li>Finding 1</li><li>Finding 2</li><li>Finding 3</li><li>Finding 5 (make sure price ticks are multiple of 100)</li><li>Finding 6 (patch above plus some improvements)</li><li>Finding 7 (order cancelation flow checks, order addition checks needs another patch)</li></ul>
<details>
<summary>📝 Click here to view the patch.</summary>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token plain">diff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol</span></span><span class="token-line" style="display:block"><span class="token plain">index 31b5486..cd40406 100644</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token coord">--- a/contracts/SonicOrderBook.sol</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token coord">+++ b/contracts/SonicOrderBook.sol</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">@@ -108,6 +108,12 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  error SellMustUseExactQuantity();</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  error MakerPriceMustMatch(uint256 expectedPrice, uint256 actualPrice);</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  // Errors related to price segment invariants being broken</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  error PriceSegmentHasAHole();</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  error IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset();</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  error LastPriceSegmentCannotBeEmpty();</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  error OnlyTheTombstoneSegmentCanStartWithEmptySlots();</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  enum OrderSide {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    Buy,</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    Sell</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">@@ -158,7 +164,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uint256 currentCost;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uint256 fee;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uint256 numberOfOrdersTraded;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">    bool isBudgetConstrainedBuyingLimitReached;</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    bool stopConsumingMoreOrders;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  // A helper type for a view function to return orders. Packing doesn&#x27;t matter</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">@@ -681,7 +687,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  function _shouldTakeMoreFromOrderBook(TakeFromOrderBookParams memory params) internal pure returns (bool) {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">    if (params.isBudgetConstrainedBuyingLimitReached) {</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    if (params.stopConsumingMoreOrders) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      return false;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">@@ -773,7 +779,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uint256 lastConsumedSegmentIndex;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uint16 devFeeTakerBps = _devFeeTakerBps;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">    for (uint256 i = node.tombstoneSegmentOffset; i &lt; segments.length &amp;&amp; _shouldTakeMoreFromOrderBook(params); ++i) {</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    uint256 segmentsLength = segments.length;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    uint256 tombstoneSegmentOffset = node.tombstoneSegmentOffset;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    for (uint256 i = tombstoneSegmentOffset; i &lt; segmentsLength &amp;&amp; _shouldTakeMoreFromOrderBook(params); ++i) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      lastConsumedSegmentIndex = i;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      segment = segments[i];</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">@@ -786,15 +795,67 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        bytes32 remainingSegment = segment.getRemainingSegment(slotIndex);</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        if (remainingSegment == 0) {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">          // Should only hit this branch on the last segment</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // but if for some reason we hit this branch before</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // the last segment we add the count of slots skipped</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          if (i &lt; segmentsLength - 1) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // This branch which should not be reachable</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            revert PriceSegmentHasAHole();</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          } else {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // we are processing the last price segment in this branch</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // the possibilities are (o: an empty slot, s: slotIndex):</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // o    o    o(s) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // o    o(s) ...  - skip incrementing `numOrdersFullyConsumed`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // o(s) ...  ...  - skip incrementing `numOrdersFullyConsumed`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            if (slotIndex == 0) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">              // This branch which should not be reachable</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">              // the last segment in the active area of the price segment</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">              // only has empty slots</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">              // o    o    o(s) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">              revert LastPriceSegmentCannotBeEmpty();</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">          break;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        bytes10 slot = segment.getSlot(slotIndex);</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        uint48 orderId = slot.getOrderId();</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        if (orderId == 0) {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">          // Skip this order in the segment as it&#x27;s been deleted</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">          ++numOrdersFullyConsumed;</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">          continue;</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // we should only hit this branch at the very beginning of the</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // active area of the price segment pointed to by the `tombstoneSegmentOffset`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // Possible configurations of this segment should be of the form:</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // (o: an empty slot, x: a non empty slot, s: slotIndex, ot = tombstoneSegmentOffset)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // x o    o(s)  &lt;-- (i === ot) - allowed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // x o(s) o     &lt;-- (i === ot) - allowed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // x x    o(s)  &lt;-- (i === ot) - allowed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          //</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // x o    o(s)  &lt;-- (i =/= ot) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // x o(s) o     &lt;-- (i =/= ot) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // x x    o(s)  &lt;-- (i =/= ot) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // x o(s) x     &lt;-- (i  &gt;= ot) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          if (i == tombstoneSegmentOffset) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // x o    o(s)  &lt;-- (i === ot) - allowed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // x o(s) o     &lt;-- (i === ot) - allowed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // x x    o(s)  &lt;-- (i === ot) - allowed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            //</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // @dev we are allowing this potentially unreachable state below to pass through</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            //      and just increment `numOrdersFullyConsumed`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // x o(s) x     &lt;-- (i  == ot) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // Skip this order in the segment as it&#x27;s been deleted</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            ++numOrdersFullyConsumed;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            continue;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          } else {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // this branch should be unreachable if all invariants are satisfied</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // x o    o(s)  &lt;-- (i =/= ot) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // x o(s) o     &lt;-- (i =/= ot) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // x x    o(s)  &lt;-- (i =/= ot) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // x o(s) x     &lt;-- (i =/= ot) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            revert OnlyTheTombstoneSegmentCanStartWithEmptySlots();</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        uint256 ordersConsumed = 0;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">@@ -836,13 +897,13 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uint256 remainingBudget = params.maxCost - params.currentCost;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      if (fullOrderCost &gt; remainingBudget) {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // // Can&#x27;t afford a full order, stop here as the slot will be potentially partially touched.</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        params.stopConsumingMoreOrders = true;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        // Check if we can afford partial order</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        uint256 maxAffordableQuantity = (remainingBudget * BASE_DECIMAL_DIVISOR) / params.bestPrice;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        // Floor to QUANTITY_TICK to ensure proper alignment</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        maxAffordableQuantity = (maxAffordableQuantity / QUANTITY_TICK) * QUANTITY_TICK;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        if (maxAffordableQuantity == 0) {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">          // Can&#x27;t afford any of this order, stop here</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">          params.isBudgetConstrainedBuyingLimitReached = true;</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">          return (</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">            segment,</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">            0, // ordersConsumed</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">@@ -880,6 +941,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        slot = slot.setQuantity(uint88(quantityL3 - quantityRemaining));</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        segment = segment.setSlot(slotIndex, slot);</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        quantityNFTClaimable = quantityRemaining;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        params.stopConsumingMoreOrders = true;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      // at this point one should be able to prove that:</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">@@ -915,39 +977,126 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uint256 lastSegmentIndex,</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uint256 numOrdersFullyConsumed</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  ) private {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // `segments.length &gt; lastSegmentIndex &gt;= oldTombstoneOffset`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // `numOrdersFullyConsumed` should be the number of order slots fully consumed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // yet not modified but the cursor passed over it to the next order slot.</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // Assumptions:</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    //    1. `numSegmentsFullyConsumed` is calculated correctly, it should be the number of</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    //       slots fully consumed or skipped if the slot was EMPTY (0)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    //    2. `lastSegmentIndex` points to the last segment consumed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    //    3. `lastSegment` is the segment pointed to by `lastSegmentIndex`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // [CHECK LIST] One should enforce the following for `lastSegment` (the last segment consumed):</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // (o: an EMPTY slot, x: a non-EMPTY slot)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    //</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // o o o - last consumed segment - ALLOWED (only if the price node gets removed from the tree)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // o o x - last consumed segment - ALLOWED (check `ot` &amp; `seg.len - 1` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // o x o - last consumed segment - ALLOWED (check `ot` &amp; `seg.len - 1` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // o x x - last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // x o o - last consumed segment - ALLOWED (check `ot` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // x o x - last consumed segment - CATCH - no hole in the middle allowed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // x x o - last consumed segment - ALLOWED (check `ot` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // x x x - last consumed segment - ALLOWED</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uint256 numSegmentsFullyConsumed = numOrdersFullyConsumed / NUM_SLOTS_PER_SEGMENT;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">    uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    uint256 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">    uint56 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">    if (numSegmentsFullyConsumed != 0) {</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      // Cleanup segments to get a gas refund</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      for (uint256 i = 0; i &lt; numSegmentsFullyConsumed; ++i) {</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">        delete segments[oldTombstoneOffset + i];</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      }</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    if (lastSegmentIndex == newTombstoneSegmentOffset) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // At this branch we know `segments.length &gt; lastSegmentIndex &gt;= newTombstoneSegmentOffset`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      lastSegment = lastSegment.clearUpToSlot(numOrdersWithinLastSegmentFullyConsumed);</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      if (uint256(lastSegment) == 0) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // `lastSegment` has this property/assumption that either:</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // A1. An other was partially matched in this segment or</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // A2. We had reached the last segment in the active area of the price segments which</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //     has some zero slots (`if (remainingSegment == 0)` branch in `_consumePriceSegments`)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // Moreover, there is an assumption here that if `lastSegment` that was touched during the</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // matching/filling process ends up being `0` then that would mean, there are no orders</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // left in the price segments since A1 would not be possible and so for A2:</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // 1. any order slot before this segment should have been fully filled/matched and thus</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //    should have been zeroed out in the previous `if (numSegmentsFullyConsumed != 0)`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //    block.</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // 2. There could not be any non-zero order slot past this segment since otherwise,</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //    that would indicate there would have been holes in the price segments previously</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //    breaking (Inv 1.)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        newTombstoneSegmentOffset = lastSegmentIndex + 1;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // so we would have:</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // `segments.length &gt;= newTombstoneSegmentOffset == lastSegmentIndex + 1`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // `newTombstoneSegmentOffset == lastSegmentIndex + 1 &gt; oldTombstoneOffset`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // thus below `lastSegment` shuold get deleted</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // o o o - last consumed segment - ALLOWED - it will get deleted and the new tombstone offset</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //                                           points to the following segment</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // The checks from the [CHECK LIST] are not required since if one hits this branch and continue</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // without reverting, the last segment consumed would be removed from the price segments</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // and the new tombstone offset would point to the following segment.</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      } else {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // At this branch we know `segments.length &gt; lastSegmentIndex &gt;= newTombstoneSegmentOffset`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // and `lastSegment` is non-zero, so at the end `bestPrice` would not get removed from the `tree`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      // Consumed all orders at this price level, so remove it from the tree</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      if (newTombstoneSegmentOffset == segments.length) {</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">        tree.remove(bestPrice);</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      }</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">    }</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">    bool lastSegmentDeleted = lastSegmentIndex &lt; (oldTombstoneOffset + numSegmentsFullyConsumed);</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">    if (!lastSegmentDeleted) {</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      if (numOrdersWithinLastSegmentFullyConsumed != 0) {</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">        for (uint256 i; i &lt; numOrdersWithinLastSegmentFullyConsumed; ++i) {</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">          lastSegment = lastSegment.clearSlot(i);</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // s2 s1 s0 : cs(bits) : lastSegment &lt;-- (lastSegmentIndex == newTombstoneSegmentOffset)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // --------------------------------(si: the `i`th slot, cs: compressed status)-------</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  o  o  o :      111 : last consumed segment - ALLOWED (only if the price node gets removed from the tree)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  o  o  x :      110 : last consumed segment - ALLOWED (check `ot` &amp; `seg.len - 1` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  o  x  o :      101 : last consumed segment - ALLOWED (check `ot` &amp; `seg.len - 1` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  o  x  x :      100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  x  o  o :      011 : last consumed segment - ALLOWED (check `ot` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  x  o  x :      010 : last consumed segment - CATCH - no hole in the middle allowed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  x  x  o :      001 : last consumed segment - ALLOWED (check `ot` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  x  x  x :      000 : last consumed segment - ALLOWED</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        uint256 compressedStatus = lastSegment.compressedStatus();</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  o  o  o : 111 : one would not enter this branch for this case</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        //  x  o  x : 010 : last consumed segment - CATCH - no hole in the middle allowed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        require(compressedStatus != 2, PriceSegmentHasAHole());</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        if (compressedStatus &gt; 3) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          //  o  x  x : 100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          //  o  x  o : 101 : last consumed segment - ALLOWED (check `ot` &amp; `seg.len - 1` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          //  o  o  x : 110 : last consumed segment - ALLOWED (check `ot` &amp; `seg.len - 1` point to this slot too)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          require(lastSegmentIndex == segments.length - 1, PriceSegmentHasAHole());</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      }</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      if (uint256(lastSegment) == 0) {</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">        // All orders in the last segment are consumed, delete from tree</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">        tree.remove(bestPrice);</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">        // Don&#x27;t pop segment for gas efficiency, instead just write zeros</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        segments[lastSegmentIndex] = lastSegment;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      segments[lastSegmentIndex] = lastSegment;</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    } else {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // if `lastSegmentIndex =/= newTombstoneSegmentOffset` that would mean the matching process had ended up</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // with ( - dashes the slot can be 0 or not, c means that it was consumed):</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // ...</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // x(c) -(c) -(c) : lastSegmentIndex</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // where in the last segment, the last slot was fully filled and thus we would end up with:</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // ...</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // x(c) -(c) -(c) : lastSegmentIndex</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      //   -  -    -    : newTombstoneSegmentOffset</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // So these values can only be off by `1`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      require(lastSegmentIndex + 1 == newTombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset());</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // The checks from the [CHECK LIST] are not required since if one hits this branch and continue</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // without reverting, the last segment consumed would be removed from the price segments</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // and the new tombstone offset would point to the following segment.</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // Cleanup segments to get a gas refund</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    for (uint256 i = oldTombstoneOffset; i &lt; newTombstoneSegmentOffset; ++i) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      delete segments[i];</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    if (newTombstoneSegmentOffset != oldTombstoneOffset) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // below one can add an extra branch for `newTombstoneSegmentOffset &gt; segments.length`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    // and possibly revert since that would mean some invariant was broken.</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    if (newTombstoneSegmentOffset &gt;= segments.length) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      tree.remove(bestPrice);</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">@@ -1000,7 +1149,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    bytes32[] storage segments,</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    BokkyPooBahsRedBlackTreeLibrary.Tree storage tree</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  ) private returns (uint88 quantity) {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">    BokkyPooBahsRedBlackTreeLibrary.Node storage node = tree.getNodeUnsafe(price);</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    BokkyPooBahsRedBlackTreeLibrary.Node storage node = tree.getNode(price);</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uint256 tombstoneSegmentOffset = node.tombstoneSegmentOffset;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    (uint256 segmentIndex, uint256 slotIndex) = _find(segments, tombstoneSegmentOffset, segments.length, orderId);</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">@@ -1058,7 +1207,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      currentCost: 0,</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      fee: 0,</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      numberOfOrdersTraded: 0,</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      isBudgetConstrainedBuyingLimitReached: false</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      stopConsumingMoreOrders: false</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    });</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    _takeFromOrderBook(params, orderIdsPool, quantitiesPool, pricesPool);</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">@@ -1105,7 +1254,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      params.currentCost = 0;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      params.fee = 0;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      params.numberOfOrdersTraded = 0;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">      params.isBudgetConstrainedBuyingLimitReached = false;</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      params.stopConsumingMoreOrders = false;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    _takeFromOrderBook(params, orderIdsPool, quantitiesPool, pricesPool);</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">@@ -1409,6 +1558,17 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        bytes32 currentSegment = segments[currentSegmentIndex];</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        bytes10 nextSlot = currentOrNextSegment.getSlot(nextSlotIndex);</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        if (nextSlot == 0) {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // When reaching a hole, make sure it has iterated to the last order.</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // Must iterate to the last seg</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          require(nextSegmentIndex == segments.length - 1, PriceSegmentHasAHole());</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // nextSlot and subsequent slots must be empty</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          require(currentOrNextSegment.getRemainingSegment(nextSlotIndex) == 0, PriceSegmentHasAHole());</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // The last non-empty order must be in `seg[seg.len-1]` (`seg.len-1` cannot point to an empty segment).</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          require(nextSlotIndex &gt; 0, LastPriceSegmentCannotBeEmpty());</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">          // There are no more orders left, reset back to the currently iterated order as the last</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">          nextSegmentIndex = currentSegmentIndex;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">          nextSlotIndex = currentSlotIndex;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">diff --git a/contracts/libraries/SegmentLibrary.sol b/contracts/libraries/SegmentLibrary.sol</span></span><span class="token-line" style="display:block"><span class="token plain">index d884717..e7c91a2 100644</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token coord">--- a/contracts/libraries/SegmentLibrary.sol</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token coord">+++ b/contracts/libraries/SegmentLibrary.sol</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">@@ -43,6 +43,39 @@ library SegmentLibrary {</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    return bytes10(uint80((uint256(segment) &gt;&gt; (slotIndex * SEGMENT_SIZE)) &amp; SEGMENT_MASK));</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  /// @notice Compresses the segment into 3 indicator bits</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  /// @param segment The segment to read from</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  /// @return status with only 3 bits sets each indicating whether the corresponding</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  //                 slot in the segment is EMPTY or not.</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  function compressedStatus(bytes32 segment) internal pure returns (uint256 status) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    uint256 MASK = SEGMENT_MASK;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    uint256 SIZE = SEGMENT_SIZE;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    assembly (&quot;memory-safe&quot;) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // s2 s1 s0 : segment</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      status := iszero(and(segment, MASK))</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      segment := shr(SIZE, segment)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      //  0 s2 s1 : segment</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      status := or(</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        shl(1, iszero(and(segment, MASK))),</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        status</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      )</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      segment := shr(SIZE, segment)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      //  0  0 s2 : segment</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      status := or(</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        shl(2, iszero(and(segment, MASK))), // still mask in case segment has dirty uppper bits</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        status</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      )</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // b2 b1 b0 : status bits (it would only have 3 set bits)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      // b2       : is 1 if s2 the 3rd slot of original segment was EMPTY</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      //    b1    : is 1 if s1 the 2nd slot of original segment was EMPTY</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      //       b0 : is 1 if s0 the 1st slot of original segment was EMPTY</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  /// @notice Checks if the segment only contains data in the specified slot</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  /// @dev Returns true if all other slots in the segment are empty (zero)</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  /// @param segment The segment to check</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">@@ -60,6 +93,19 @@ library SegmentLibrary {</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    return bytes32(uint256(segment) &amp; ~(uint256(SEGMENT_MASK) &lt;&lt; (slotIndex * SEGMENT_SIZE)));</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  /// @notice Clears slots up to the specified index, setting all its bits to zero</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  /// @param segment The segment to modify</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  /// @param slotIndex The index of the slot to clear up to (0, 1, or 2)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  /// @return newSegment The updated segment with the right most slots cleared up to `slotIndex`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  function clearUpToSlot(bytes32 segment, uint256 slotIndex) internal pure returns (bytes32 newSegment) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    if (slotIndex == 0) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      return segment;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    uint256 shiftAmount = slotIndex * SEGMENT_SIZE;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    return bytes32((uint256(segment) &gt;&gt; (shiftAmount)) &lt;&lt; shiftAmount);</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  /// @notice Returns the remaining segment data after the specified slot index</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  /// @dev Shifts the segment right to remove all slots up to and including the specified index.</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  ///      Useful for iterating through higher-indexed slots or processing remaining data.</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">diff --git a/contracts/libraries/SonicOrderBookLibrary.sol b/contracts/libraries/SonicOrderBookLibrary.sol</span></span><span class="token-line" style="display:block"><span class="token plain">index de229f7..08cd374 100644</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token coord">--- a/contracts/libraries/SonicOrderBookLibrary.sol</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token coord">+++ b/contracts/libraries/SonicOrderBookLibrary.sol</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">@@ -31,6 +31,7 @@ library SonicOrderBookLibrary {</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  error DevFeeTooHigh();</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  error DevFeeNotSet();</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  error MaxOrdersNotMultipleOfOrdersInSegment();</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  error PriceTickShouldBeAMutipleOf100();</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uint256 private constant SET_TRADEABLE_THRESHOLD_LOCKED_BURN_TIME = 7 days;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">@@ -57,6 +58,7 @@ library SonicOrderBookLibrary {</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      require(existingTick == 0 || existingTick == newTick, PriceTickCannotBeChanged());</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      require(newTick != 0, PriceTickCannotBeZero());</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      require(newTick % 100 == 0, PriceTickShouldBeAMutipleOf100());</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      SeasonData memory seasonData = nft.getSeasonData(Season(tokenId));</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      if (seasonData.startTime != 0 &amp;&amp; tokenIdInfos[i].isTradeable) {</span></span></code></pre></div>
</details></div></section></li></ol></section><section class="chakra-stack css-1cyyl4u"><div class="chakra-stack css-1skpokq"><div class="css-ylswkg"></div><h3 class="chakra-heading css-1hlsh2c">Medium Risk<span class="chakra-text css-1nvbuct">3<!-- --> <!-- -->findings</span></h3></div><ol role="list" class="css-lq80v0"><li class="css-0"><section class="chakra-stack css-1kc89qn"><h4 class="chakra-heading css-thn72w">unsafe node check in <span class="chakra-code css-l0e4mh">_cancelOrdersSide</span></h4><dl class="chakra-stack css-18b9je0"><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">State</p></dt><dd class="chakra-stack css-t1uzvz"><div class="chakra-stack css-porbmv"><span class="css-1lnofw7"><span class="css-101m3ux"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2px" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-wrench" aria-hidden="true" color="currentColor"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path></svg></span><span class="css-1l8566">Fixed</span></span><a href="https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106" target="_blank" class="css-hyehfz"><p class="chakra-text css-n1un5q">PR #106</p></a></div></dd></div><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">Severity</p></dt><dd class="chakra-stack css-t1uzvz"><div class="chakra-stack css-porbmv"><span class="css-ypnwc0"><div class="css-1s7y7bx"></div><span class="css-v26npq">Severity<!-- -->: <!-- -->Medium</span></span><p class="chakra-text css-phvdpk">≈</p><span class="css-ypnwc0"><div class="css-mgdx75"></div><span class="css-v26npq">Likelihood<!-- -->: <!-- -->Low</span></span><p class="chakra-text css-phvdpk">×</p><span class="css-ypnwc0"><div class="css-wxyuev"></div><span class="css-v26npq">Impact<!-- -->: <!-- -->High</span></span></div></dd></div><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">Submitted by</p></dt><dd class="chakra-stack css-t1uzvz"><a rel="nofollow" class="chakra-link css-1so5w5b" href="/u/Saw-mon-and-Natalie"><div data-test-id="mask" class="css-15ua73h"><img alt="" width="128" height="128" decoding="async" data-nimg="1" class="no-dark-mode css-1uqohei" style="color:transparent" srcSet="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=128&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=256&amp;q=75 2x" src="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=256&amp;q=75"/></div><p class="chakra-text css-1e0kj1c"> <!-- -->Saw-mon and Natalie</p></a></dd></div></dl><hr aria-orientation="horizontal" class="chakra-divider css-14ry2m8"/><div class="markdown-body css-1rem1b3"><h2 class="chakra-heading css-jg3yxe" id="description" node="[object Object]">Description</h2>
<p class="chakra-text css-xcnbdp" node="[object Object]">The price <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">node</span></span></code> queries from the price <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">tree</span></span></code> uses the <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">getNodeUnsafe</span></span></code> which omits checking whether the price <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">node</span></span></code> belongs to the <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">tree</span></span></code>. Ommitting this check was added to save some gas during the cancellation process but creates big risk in terms of making assumptions about the structure of the price segments. The assumption is that if the price <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">node</span></span></code> did not belong the the <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">tree</span></span></code> then the <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">node</span></span></code>&#x27;s tombstone offset should be equal to greater than the price segments length:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>o</mi><mi>t</mi></msub><mo>≥</mo><mtext mathvariant="monospace">seg.len</mtext></mrow><annotation encoding="application/x-tex">o_t \geq \texttt{seg.len}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.2222em"></span><span class="mord text"><span class="mord texttt">seg.len</span></span></span></span></span></span>
<p class="chakra-text css-xcnbdp" node="[object Object]">Thus when one calls <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_find</span></span></code> the order should not be found and <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">type(uint256).max</span></span></code> should be returned for the segment and slot indexes, and so instead one would hit the custom error <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">OrderNotFound(orderId))</span></span></code> below:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">require</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">segmentIndex </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">!=</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">type</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">uint</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">max</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">OrderNotFound</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span></span></code></pre></div>
<p class="chakra-text css-xcnbdp" node="[object Object]">One is creating assumptions about distant parts of the codebase using an optimistic approach about supposed invariants.</p>
<h2 class="chakra-heading css-jg3yxe" id="recommendation" node="[object Object]">Recommendation</h2>
<p class="chakra-text css-xcnbdp" node="[object Object]">This is a critical flow for orderbook and minimising assumptions to reduce the risk of accounting imbalances would be the recommended suggestion. Thus it would be best to revert back to the original logic of querying the <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">node</span></span></code> in a safe way:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token plain">BokkyPooBahsRedBlackTreeLibrary</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">Node </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">storage</span><span class="token plain"> node </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> tree</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">getNode</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">price</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span></span></code></pre></div>
<p class="chakra-text css-xcnbdp" node="[object Object]">Thus would make it harder to cancel a potentially malicious non-existent order and steal funds from the orderbook and it is a more defensive approach about safeguarding the contract balances.</p></div></section></li><li class="css-0"><section class="chakra-stack css-1kc89qn"><h4 class="chakra-heading css-thn72w">Add invariant checks to the <span class="chakra-code css-l0e4mh">_consumePriceSegments</span> and make it less prone to malfunction</h4><dl class="chakra-stack css-18b9je0"><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">State</p></dt><dd class="chakra-stack css-t1uzvz"><div class="chakra-stack css-porbmv"><span class="css-1lnofw7"><span class="css-101m3ux"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2px" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-wrench" aria-hidden="true" color="currentColor"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path></svg></span><span class="css-1l8566">Fixed</span></span><a href="https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106" target="_blank" class="css-hyehfz"><p class="chakra-text css-n1un5q">PR #106</p></a></div></dd></div><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">Severity</p></dt><dd class="chakra-stack css-t1uzvz"><div class="chakra-stack css-porbmv"><span class="css-ypnwc0"><div class="css-1s7y7bx"></div><span class="css-v26npq">Severity<!-- -->: <!-- -->Medium</span></span><p class="chakra-text css-phvdpk">≈</p><span class="css-ypnwc0"><div class="css-mgdx75"></div><span class="css-v26npq">Likelihood<!-- -->: <!-- -->Low</span></span><p class="chakra-text css-phvdpk">×</p><span class="css-ypnwc0"><div class="css-wxyuev"></div><span class="css-v26npq">Impact<!-- -->: <!-- -->High</span></span></div></dd></div><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">Submitted by</p></dt><dd class="chakra-stack css-t1uzvz"><a rel="nofollow" class="chakra-link css-1so5w5b" href="/u/Saw-mon-and-Natalie"><div data-test-id="mask" class="css-15ua73h"><img alt="" width="128" height="128" decoding="async" data-nimg="1" class="no-dark-mode css-1uqohei" style="color:transparent" srcSet="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=128&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=256&amp;q=75 2x" src="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=256&amp;q=75"/></div><p class="chakra-text css-1e0kj1c"> <!-- -->Saw-mon and Natalie</p></a></dd></div></dl><hr aria-orientation="horizontal" class="chakra-divider css-14ry2m8"/><div class="markdown-body css-1rem1b3"><h2 class="chakra-heading css-jg3yxe" id="description" node="[object Object]">Description</h2>
<p class="chakra-text css-xcnbdp" node="[object Object]">There are currently two main spots in <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_consumePriceSegments</span></span></code> which makes certain assumptions about the structure of the price segments. Mainly:</p>
<ol role="list" node="[object Object]" class="css-1dg6mvm"><li>
<p class="chakra-text css-xcnbdp" node="[object Object]">only the beginning of the active area of the price segments can have empty slots</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo>⋯</mo><mi mathvariant="normal">■</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi><mo><mover><mo><mo>⋯</mo></mo><mo lspace="0em" rspace="0em">←</mo></mover></mo></mrow><annotation encoding="application/x-tex">\cdots
\blacksquare \square\square \stackrel{\leftarrow}{\cdots}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8698em;vertical-align:-0.0015em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">■□□</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8683em"><span style="top:-2.9985em"><span class="pstrut" style="height:3em"></span><span><span class="mop">⋯</span></span></span><span style="top:-3.5115em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">←</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.0015em"><span></span></span></span></span></span></span></span></span></span></span>
<p class="chakra-text css-xcnbdp" node="[object Object]">which is assumed in the <a target="_blank" rel="noopener nofollow" class="chakra-link css-15y7uvo" href="https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/SonicOrderBook.sol#L792-L798" node="[object Object]">snippet below</a>:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">bytes10</span><span class="token plain"> slot </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> segment</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">getSlot</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">slotIndex</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">uint48</span><span class="token plain"> orderId </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> slot</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">getOrderId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">orderId </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">==</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">   </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// Skip this order in the segment as it&#x27;s been deleted</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">   </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">++</span><span class="token plain">numOrdersFullyConsumed</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">   </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">continue</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span></span></code></pre></div>
</li><li>
<p class="chakra-text css-xcnbdp" node="[object Object]">only the end the of the active area of the price segments can have empty slots</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo>⋯</mo><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">■</mi><mo><mover><mo><mo>⋯</mo></mo><mo lspace="0em" rspace="0em">←</mo></mover></mo></mrow><annotation encoding="application/x-tex">\cdots \square\square \blacksquare \stackrel{\leftarrow}{\cdots}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8698em;vertical-align:-0.0015em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">□□■</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8683em"><span style="top:-2.9985em"><span class="pstrut" style="height:3em"></span><span><span class="mop">⋯</span></span></span><span style="top:-3.5115em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">←</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.0015em"><span></span></span></span></span></span></span></span></span></span></span>
<p class="chakra-text css-xcnbdp" node="[object Object]">which is assumed in the <a target="_blank" rel="noopener nofollow" class="chakra-link css-15y7uvo" href="https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/SonicOrderBook.sol#L786-L790" node="[object Object]">snippet below</a>:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token builtin" style="color:var(--chakra-colors-codeHighlighting-literal)">bytes32</span><span class="token plain"> remainingSegment </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">=</span><span class="token plain"> segment</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">getRemainingSegment</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">slotIndex</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">remainingSegment </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">==</span><span class="token plain"> </span><span class="token number" style="color:var(--chakra-colors-codeHighlighting-literal)">0</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">{</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">   </span><span class="token comment" style="color:var(--chakra-colors-codeHighlighting-meta);font-style:italic">// Should only hit this branch on the last segment</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">   </span><span class="token keyword" style="color:var(--chakra-colors-codeHighlighting-keyword)">break</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">}</span></span></code></pre></div>
</li><li>
<p class="chakra-text css-xcnbdp" node="[object Object]">There are no holes / empty slots in the middle. Configurations like below should not be present:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo>⋯</mo><mi mathvariant="normal">■</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">■</mi><mo><mover><mo><mo>⋯</mo></mo><mo lspace="0em" rspace="0em">←</mo></mover></mo><mspace width="1em"></mspace><mtext>invariant is broken</mtext></mrow><annotation encoding="application/x-tex">\cdots \blacksquare \square \blacksquare \stackrel{\leftarrow}{\cdots} \quad \text{invariant is broken}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8698em;vertical-align:-0.0015em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">■□■</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8683em"><span style="top:-2.9985em"><span class="pstrut" style="height:3em"></span><span><span class="mop">⋯</span></span></span><span style="top:-3.5115em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">←</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.0015em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord text"><span class="mord">invariant is broken</span></span></span></span></span></span>
<p class="chakra-text css-xcnbdp" node="[object Object]">In a presence of holes <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">numOrdersFullyConsumed</span></span></code> would not get updated correctly which eventually in <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_updateSegmentsAndTree</span></span></code> would cause the price segment and tree get updated in correctly in the storage.</p>
</li></ol>
<p class="chakra-text css-xcnbdp" node="[object Object]">ie, if we lined up all the slots of the active area of the price segment it would look like:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo>⋯</mo><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">■</mi><mo>⋯</mo><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mo>⋯</mo><mi mathvariant="normal">■</mi><mi mathvariant="normal">■</mi><mo>⋯</mo><mi mathvariant="normal">■</mi><mi mathvariant="normal">□</mi><mi mathvariant="normal">□</mi><mo><mover><mo><mo>⋯</mo></mo><mo lspace="0em" rspace="0em">←</mo></mover></mo></mrow><annotation encoding="application/x-tex">\cdots \square\square \blacksquare \cdots 
\blacksquare\blacksquare \cdots \blacksquare\blacksquare
\cdots
\blacksquare \square\square \stackrel{\leftarrow}{\cdots}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8698em;vertical-align:-0.0015em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">□□■</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">■■</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">■■</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord amsrm">■□□</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8683em"><span style="top:-2.9985em"><span class="pstrut" style="height:3em"></span><span><span class="mop">⋯</span></span></span><span style="top:-3.5115em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">←</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.0015em"><span></span></span></span></span></span></span></span></span></span></span>
<p class="chakra-text css-xcnbdp" node="[object Object]">Proving the above invariant as well as showing that the order ids of the non-empty slots <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">■</mi></mrow><annotation encoding="application/x-tex">\blacksquare</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.675em"></span><span class="mord amsrm">■</span></span></span></span> increase monotonically involves many edge cases from different lines of the order book contract.  But this these are very important invariants and in case they get broken, many of the endpoints and storage updates would not act as intended or get modified correctly.</p>
<h2 class="chakra-heading css-jg3yxe" id="recommendation" node="[object Object]">Recommendation</h2>
<p class="chakra-text css-xcnbdp" node="[object Object]">It would be best to add invariant checks to the <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_consumePriceSegments</span></span></code> and make it less prone to malfunction in the presence of holes in price segments:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token plain">diff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol</span></span><span class="token-line" style="display:block"><span class="token plain">index 31b5486..13064b8 100644</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token coord">--- a/contracts/SonicOrderBook.sol</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token coord">+++ b/contracts/SonicOrderBook.sol</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">@@ -108,6 +108,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  error SellMustUseExactQuantity();</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  error MakerPriceMustMatch(uint256 expectedPrice, uint256 actualPrice);</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  // Errors that indicate invariants are broken</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  error LastPriceSegmentCannotBeEmpty();</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  error OnlyTheTombstoneSegmentCanStartWithEmptySlots();</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  enum OrderSide {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    Buy,</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    Sell</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">@@ -773,7 +777,9 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uint256 lastConsumedSegmentIndex;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uint16 devFeeTakerBps = _devFeeTakerBps;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">    for (uint256 i = node.tombstoneSegmentOffset; i &lt; segments.length &amp;&amp; _shouldTakeMoreFromOrderBook(params); ++i) {</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    uint256 segmentsLength = segments.length;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    uint256 tombstoneSegmentOffset = node.tombstoneSegmentOffset;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">    for (uint256 i = tombstoneSegmentOffset; i &lt; segmentsLength &amp;&amp; _shouldTakeMoreFromOrderBook(params); ++i) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      lastConsumedSegmentIndex = i;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      segment = segments[i];</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">@@ -786,15 +792,74 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        bytes32 remainingSegment = segment.getRemainingSegment(slotIndex);</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        if (remainingSegment == 0) {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">          // Should only hit this branch on the last segment</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // but if for some reason we hit this branch before</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // the last segment we add the count of slots skipped</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          if (i &lt; segmentsLength - 1) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // This branch which should not be reachable</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // But if it does hit we can be proactive and skip the remaining slots</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // but still add them to `numOrdersFullyConsumed`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // `s` is the `slotIndex` and `o` represent an empty slot:</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // o    o    o(s) - +3</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // o    o(s) ...  - +2</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // o(s) ...  ...  - +1</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            //</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // @dev one can also decide to REVERT below instead of accounting for the</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            //      holes (empty slots) in this scenario</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            numOrdersFullyConsumed += NUM_SLOTS_PER_SEGMENT - slotIndex;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          } else {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // we are processing the last price segment in this branch</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // the possibilities are (o: an empty slot, s: slotIndex):</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // o    o    o(s) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // o    o(s) ...  - skip incrementing `numOrdersFullyConsumed`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // o(s) ...  ...  - skip incrementing `numOrdersFullyConsumed`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            if (slotIndex == 0) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">              // This branch which should not be reachable</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">              // the last segment in the active area of the price segment</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">              // only has empty slots</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">              // o    o    o(s) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">              revert LastPriceSegmentCannotBeEmpty();</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">          break;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        bytes10 slot = segment.getSlot(slotIndex);</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        uint48 orderId = slot.getOrderId();</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        if (orderId == 0) {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">          // Skip this order in the segment as it&#x27;s been deleted</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">          ++numOrdersFullyConsumed;</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token deleted-sign deleted prefix deleted" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">-</span><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)">          continue;</span></span><span class="token-line" style="display:block"><span class="token deleted-sign deleted line" style="color:var(--chakra-colors-codeHighlighting-diff-deleted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // we should only hit this branch at the very beginning of the</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // active area of the price segment pointed to by the `tombstoneSegmentOffset`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // Possible configurations of this segment should be of the form:</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // (o: an empty slot, x: a non empty slot, s: slotIndex, ot = tombstoneSegmentOffset)</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // x o    o(s)  &lt;-- (i === ot) - allowed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // x o(s) o     &lt;-- (i === ot) - allowed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // x x    o(s)  &lt;-- (i === ot) - allowed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          //</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // x o    o(s)  &lt;-- (i =/= ot) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // x o(s) o     &lt;-- (i =/= ot) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // x x    o(s)  &lt;-- (i =/= ot) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // x o(s) x     &lt;-- (i  &gt;= ot) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          if (i == tombstoneSegmentOffset) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // x o    o(s)  &lt;-- (i === ot) - allowed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // x o(s) o     &lt;-- (i === ot) - allowed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // x x    o(s)  &lt;-- (i === ot) - allowed</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            //</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // @dev we are allowing this potentially unreachable state below to pass through</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            //      and just increment `numOrdersFullyConsumed`</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // x o(s) x     &lt;-- (i  == ot) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // Skip this order in the segment as it&#x27;s been deleted</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            ++numOrdersFullyConsumed;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            continue;</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          } else {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // this branch should be unreachable if all invariants are satisfied</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // x o    o(s)  &lt;-- (i =/= ot) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // x o(s) o     &lt;-- (i =/= ot) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // x x    o(s)  &lt;-- (i =/= ot) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // x o(s) x     &lt;-- (i =/= ot) - BAD</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            revert OnlyTheTombstoneSegmentCanStartWithEmptySlots();</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        uint256 ordersConsumed = 0;</span></span></code></pre></div>
<p class="chakra-text css-xcnbdp" node="[object Object]">In the branch where on is performing:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token plain">numOrdersFullyConsumed </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">+=</span><span class="token plain"> NUM_SLOTS_PER_SEGMENT </span><span class="token operator" style="color:var(--chakra-colors-codeHighlighting-keyword)">-</span><span class="token plain"> slotIndex</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span></span></code></pre></div>
<p class="chakra-text css-xcnbdp" node="[object Object]">One can instead revert, since it would indicate the precense of holes. But the above make <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_consumePriceSegments</span></span></code> hole-resistant (ie, in the presence of holes this function would not get broken and act as expected, although the other flows make suffer from the holes such as <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_find</span></span></code> or <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_cancelOrder</span></span></code>, ...). Another options would be to instead <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">revert</span></span></code> here:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token plain">revert </span><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">PriceSegmentHasAHole</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span></span></code></pre></div></div></section></li><li class="css-0"><section class="chakra-stack css-1kc89qn"><h4 class="chakra-heading css-thn72w">quote tokens received by the orderbook versus to-be-claimed quote tokens by sellers</h4><dl class="chakra-stack css-18b9je0"><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">State</p></dt><dd class="chakra-stack css-t1uzvz"><div class="chakra-stack css-porbmv"><span class="css-1lnofw7"><span class="css-101m3ux"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2px" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-wrench" aria-hidden="true" color="currentColor"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path></svg></span><span class="css-1l8566">Fixed</span></span><a href="https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106" target="_blank" class="css-hyehfz"><p class="chakra-text css-n1un5q">PR #106</p></a></div></dd></div><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">Severity</p></dt><dd class="chakra-stack css-t1uzvz"><div class="chakra-stack css-porbmv"><span class="css-ypnwc0"><div class="css-1s7y7bx"></div><span class="css-v26npq">Severity<!-- -->: <!-- -->Medium</span></span></div></dd></div><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">Submitted by</p></dt><dd class="chakra-stack css-t1uzvz"><a rel="nofollow" class="chakra-link css-1so5w5b" href="/u/Saw-mon-and-Natalie"><div data-test-id="mask" class="css-15ua73h"><img alt="" width="128" height="128" decoding="async" data-nimg="1" class="no-dark-mode css-1uqohei" style="color:transparent" srcSet="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=128&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=256&amp;q=75 2x" src="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=256&amp;q=75"/></div><p class="chakra-text css-1e0kj1c"> <!-- -->Saw-mon and Natalie</p></a></dd></div></dl><hr aria-orientation="horizontal" class="chakra-divider css-14ry2m8"/><div class="markdown-body css-1rem1b3"><h2 class="chakra-heading css-jg3yxe" id="description" node="[object Object]">Description</h2>
<p class="chakra-text css-xcnbdp" node="[object Object]">When a sell order is partially matched a few times the amount of quote tokens received by the orderbook would be:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munder><mo>∑</mo><mi>j</mi></munder><mrow><mo fence="true">⌊</mo><mfrac><mrow><msub><mi>q</mi><mi>j</mi></msub><mo>⋅</mo><msub><mi>p</mi><mi>o</mi></msub></mrow><msup><mn>10</mn><mi>d</mi></msup></mfrac><mo fence="true">⌋</mo></mrow></mrow><annotation encoding="application/x-tex">\sum_{j} \left\lfloor \frac{q_j \cdot p_o}{10^d} \right\rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.5638em;vertical-align:-1.4138em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size2">⌊</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1215em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7751em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size2">⌋</span></span></span></span></span></span></span>
<p class="chakra-text css-xcnbdp" node="[object Object]">where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05724em">j</span></span></span></span> iterates over the partial match events of one specific order <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi></mrow><annotation encoding="application/x-tex">o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">o</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>o</mi></msub></mrow><annotation encoding="application/x-tex">p_o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> is the price for this order, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">q_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span> are the partial quantities filled. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">d</span></span></span></span> is the decimal of the <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">NFT</span></span></code> contract which in this case would be <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>18</mn></mrow><annotation encoding="application/x-tex">18</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">18</span></span></span></span>.</p>
<p class="chakra-text css-xcnbdp" node="[object Object]">When the user wants to claim these partial matches in <a target="_blank" rel="noopener nofollow" class="chakra-link css-15y7uvo" href="https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L360-L383" node="[object Object]"><code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_claimTokens</span></span></code></a> and <a target="_blank" rel="noopener nofollow" class="chakra-link css-15y7uvo" href="https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L1314-L1334" node="[object Object]"><code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_calculateClaimableTokens</span></span></code></a> the amount to be claimed and sent to the <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">maker</span></span></code> and the <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">dev</span></span></code> would be:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">⌊</mo><mfrac><mrow><mo stretchy="false">(</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>q</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>p</mi><mi>o</mi></msub></mrow><msup><mn>10</mn><mi>d</mi></msup></mfrac><mo fence="true">⌋</mo></mrow><annotation encoding="application/x-tex">\left\lfloor \frac{(\sum_j q_j) \cdot p_o}{10^d} \right\rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.5258em;vertical-align:-0.95em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size3">⌊</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5758em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7751em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8258em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size3">⌋</span></span></span></span></span></span></span>
<p class="chakra-text css-xcnbdp" node="[object Object]">But we have:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">⌊</mo><mfrac><mrow><mo stretchy="false">(</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>q</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>p</mi><mi>o</mi></msub></mrow><msup><mn>10</mn><mi>d</mi></msup></mfrac><mo fence="true">⌋</mo></mrow><mo>≥</mo><munder><mo>∑</mo><mi>j</mi></munder><mrow><mo fence="true">⌊</mo><mfrac><mrow><msub><mi>q</mi><mi>j</mi></msub><mo>⋅</mo><msub><mi>p</mi><mi>o</mi></msub></mrow><msup><mn>10</mn><mi>d</mi></msup></mfrac><mo fence="true">⌋</mo></mrow></mrow><annotation encoding="application/x-tex">\left\lfloor \frac{(\sum_j q_j) \cdot p_o}{10^d} \right\rfloor \geq \sum_{j} \left\lfloor \frac{q_j \cdot p_o}{10^d} \right\rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.5258em;vertical-align:-0.95em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size3">⌊</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5758em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7751em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8258em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size3">⌋</span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.5638em;vertical-align:-1.4138em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size2">⌊</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1215em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7751em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size2">⌋</span></span></span></span></span></span></span>
<p class="chakra-text css-xcnbdp" node="[object Object]">Thus if these divisions are not exact, the orderbook would not have enough quote tokens to compensate for the claims.</p>
<h2 class="chakra-heading css-jg3yxe" id="recommendation" node="[object Object]">Recommendation</h2>
<p class="chakra-text css-xcnbdp" node="[object Object]">Either one needs to make sure the divisions are exact by setting restrictions on the <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">priceTicks</span></span></code> and quantity ticks to make sure their product would be division by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>10</mn><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">10^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span>. Moreover one needs to throughout the codebase make sure that the invariant of</p>
<ol role="list" node="[object Object]" class="css-1dg6mvm"><li>prices being divisible by <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">priceTick</span></span></code></li><li>quantities being divisible by quantity tick</li></ol>
<p class="chakra-text css-xcnbdp" node="[object Object]">to be satisfied.</p>
<p class="chakra-text css-xcnbdp" node="[object Object]">For the above apply this patch:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token plain">diff --git a/contracts/libraries/SonicOrderBookLibrary.sol b/contracts/libraries/SonicOrderBookLibrary.sol</span></span><span class="token-line" style="display:block"><span class="token plain">index de229f7..08cd374 100644</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token coord">--- a/contracts/libraries/SonicOrderBookLibrary.sol</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token coord">+++ b/contracts/libraries/SonicOrderBookLibrary.sol</span><span class="token plain"></span></span><span class="token-line" style="display:block"><span class="token plain">@@ -31,6 +31,7 @@ library SonicOrderBookLibrary {</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  error DevFeeTooHigh();</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  error DevFeeNotSet();</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  error MaxOrdersNotMultipleOfOrdersInSegment();</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">  error PriceTickShouldBeAMultipleOf100();</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uint256 private constant SET_TRADEABLE_THRESHOLD_LOCKED_BURN_TIME = 7 days;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">@@ -57,6 +58,7 @@ library SonicOrderBookLibrary {</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      require(existingTick == 0 || existingTick == newTick, PriceTickCannotBeChanged());</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      require(newTick != 0, PriceTickCannotBeZero());</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      require(newTick % 100 == 0, PriceTickShouldBeAMultipleOf100());</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      SeasonData memory seasonData = nft.getSeasonData(Season(tokenId));</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      if (seasonData.startTime != 0 &amp;&amp; tokenIdInfos[i].isTradeable) {</span></span></code></pre></div>
<p class="chakra-text css-xcnbdp" node="[object Object]">Another solution would be to simply overestimate the case (this would not require checking for the above conditions at least for cost related issues). Overestimating would guarantee that for partially matching a specific order multiple times we would have:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">⌈</mo><mfrac><mrow><mo stretchy="false">(</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>q</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>p</mi><mi>o</mi></msub></mrow><msup><mn>10</mn><mi>d</mi></msup></mfrac><mo fence="true">⌉</mo></mrow><mo>≤</mo><munder><mo>∑</mo><mi>j</mi></munder><mrow><mo fence="true">⌈</mo><mfrac><mrow><msub><mi>q</mi><mi>j</mi></msub><mo>⋅</mo><msub><mi>p</mi><mi>o</mi></msub></mrow><msup><mn>10</mn><mi>d</mi></msup></mfrac><mo fence="true">⌉</mo></mrow></mrow><annotation encoding="application/x-tex">\left\lceil \frac{(\sum_j q_j) \cdot p_o}{10^d} \right\rceil \leq \sum_{j} \left\lceil \frac{q_j \cdot p_o}{10^d} \right\rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.5258em;vertical-align:-0.95em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size3">⌈</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5758em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7751em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8258em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size3">⌉</span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.5638em;vertical-align:-1.4138em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size2">⌈</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1215em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7751em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size2">⌉</span></span></span></span></span></span></span>
<p class="chakra-text css-xcnbdp" node="[object Object]">ie, in this case the orderbook should have enough quote tokens to cover the cost of a maker whose sell orders get partially filled a few times.</p>
<p class="chakra-text css-xcnbdp" node="[object Object]">So in summary:</p>
<ul role="list" node="[object Object]" class="css-tu0njr"><li>overestimate the cost for matching into sell orders</li><li>underestimate the cost for matching into buy orders</li><li>overestimate the cost for placing buy limit orders</li></ul></div></section></li></ol></section><section class="chakra-stack css-1cyyl4u"><div class="chakra-stack css-1skpokq"><div class="css-11kvcua"></div><h3 class="chakra-heading css-1hlsh2c">Informational<span class="chakra-text css-1nvbuct">2<!-- --> <!-- -->findings</span></h3></div><ol role="list" class="css-lq80v0"><li class="css-0"><section class="chakra-stack css-1kc89qn"><h4 class="chakra-heading css-thn72w">Add invariant checks when adding and canceling orders</h4><dl class="chakra-stack css-18b9je0"><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">State</p></dt><dd class="chakra-stack css-t1uzvz"><div class="chakra-stack css-porbmv"><span class="css-1lnofw7"><span class="css-101m3ux"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2px" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-wrench" aria-hidden="true" color="currentColor"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path></svg></span><span class="css-1l8566">Fixed</span></span><a href="https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106" target="_blank" class="css-hyehfz"><p class="chakra-text css-n1un5q">PR #106</p></a></div></dd></div><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">Severity</p></dt><dd class="chakra-stack css-t1uzvz"><div class="chakra-stack css-porbmv"><span class="css-ypnwc0"><div class="css-dti5c1"></div><span class="css-v26npq">Severity<!-- -->: <!-- -->Informational</span></span></div></dd></div><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">Submitted by</p></dt><dd class="chakra-stack css-t1uzvz"><a rel="nofollow" class="chakra-link css-1so5w5b" href="/u/thereksfour"><div data-test-id="mask" class="css-15ua73h"><img alt="" width="128" height="128" decoding="async" data-nimg="1" class="no-dark-mode css-1uqohei" style="color:transparent" srcSet="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2Fd5e6d378-e0c9-47e8-66eb-fba7e9ce9700%2Fpublic&amp;w=128&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2Fd5e6d378-e0c9-47e8-66eb-fba7e9ce9700%2Fpublic&amp;w=256&amp;q=75 2x" src="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2Fd5e6d378-e0c9-47e8-66eb-fba7e9ce9700%2Fpublic&amp;w=256&amp;q=75"/></div><p class="chakra-text css-1e0kj1c"> <!-- -->cccz</p></a></dd></div></dl><hr aria-orientation="horizontal" class="chakra-divider css-14ry2m8"/><div class="markdown-body css-1rem1b3"><h2 class="chakra-heading css-jg3yxe" id="description" node="[object Object]">Description</h2>
<p class="chakra-text css-xcnbdp" node="[object Object]">The protocol modifies segments when adding/canceling/matching orders.</p>
<p class="chakra-text css-xcnbdp" node="[object Object]">When matching orders, <a class="chakra-link css-15y7uvo" node="[object Object]" href="https://cantina.xyz/code/533c3043-fa7a-4275-8bae-e2313e1b5d18/findings/3">Finding #3</a> checks segments in <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_consumePriceSegments()</span></span></code> to ensure that the segment state follows the invariant, and <a class="chakra-link css-15y7uvo" node="[object Object]" href="https://cantina.xyz/code/533c3043-fa7a-4275-8bae-e2313e1b5d18/findings/6">Finding #6</a> also makes some assumption checks when modifying segments in <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">_updateSegmentsAndTree()</span></span></code>.</p>
<p class="chakra-text css-xcnbdp" node="[object Object]">For adding/canceling orders, some invariant checks need to be added to ensure that the segment state is as expected.</p>
<p class="chakra-text css-xcnbdp" node="[object Object]">Below are all cases of slots in the segment.</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token plain">(1) o o o  BAD</span></span><span class="token-line" style="display:block"><span class="token plain">(2) o o x  ALLOW, holes Must be tail</span></span><span class="token-line" style="display:block"><span class="token plain">(3) o x o  ALLOW, holes Must be head&amp;tail</span></span><span class="token-line" style="display:block"><span class="token plain">(4) x o o  ALLOW, holes Must be head</span></span><span class="token-line" style="display:block"><span class="token plain">(5) o x x  ALLOW, holes Must be tail</span></span><span class="token-line" style="display:block"><span class="token plain">(6) x o x  BAD</span></span><span class="token-line" style="display:block"><span class="token plain">(7) x x o  ALLOW, holes Must be head</span></span><span class="token-line" style="display:block"><span class="token plain">(8) x x x  ALLOW, No holes</span></span></code></pre></div>
<h2 class="chakra-heading css-jg3yxe" id="recommendation" node="[object Object]">Recommendation</h2>
<p class="chakra-text css-xcnbdp" node="[object Object]">For order additions.</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token plain">@@ -1204,7 +1207,12 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        // Are there are free slots in this segment</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        for (uint256 slotIndex = 0; slotIndex &lt; NUM_SLOTS_PER_SEGMENT; ++slotIndex) {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">          bytes32 remainingSegment = lastSegment.getRemainingSegment(slotIndex);</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // o o o, o o x, o x x, o x o,</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">          if (remainingSegment == 0) {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // catch o o o</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            require(slotIndex != 0, LastPriceSegmentCannotBeEmpty());</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            // for o x o, must be head</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">            if(lastSegment.getSlot(0) == 0) require(lastSegmentIndex == node.tombstoneSegmentOffset, PriceSegmentHasAHole());</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">            // Found free slot, so add this order to an existing segment</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">            bytes10 slot = SlotLibrary.createSlot(orderId, normalizedQuantity);</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">            bytes32 newSegment = lastSegment.setSlotUnsafe(slotIndex, slot);</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token plain">@@ -1212,6 +1220,18 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">            return;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">          }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // slot2 is x, x o o, x x o, x o x, x x x</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // head&amp;tail, catch x o x, allow x o o , x x o, x x x</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        if (lastSegmentIndex == node.tombstoneSegmentOffset) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          if(lastSegment.getSlot(1) == 0) require(lastSegment.getSlot(0) == 0, PriceSegmentHasAHole());</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // tail, must be x, x ,x</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        if (lastSegmentIndex &gt; node.tombstoneSegmentOffset) {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          require(lastSegment.getSlot(0) != 0 &amp;&amp; lastSegment.getSlot(1) != 0, PriceSegmentHasAHole());</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        }</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">      } else {</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        // ot is at most equal to seg.len</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">        require(lastSegmentIndex + 1 == node.tombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTombstoneOffset());</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      }</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span></span></code></pre></div>
<p class="chakra-text css-xcnbdp" node="[object Object]">For order cancellation.</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token plain">@@ -1410,6 +1428,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R</span></span><span class="token-line" style="display:block"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        bytes10 nextSlot = currentOrNextSegment.getSlot(nextSlotIndex);</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        if (nextSlot == 0) {</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">          // There are no more orders left, reset back to the currently iterated order as the last</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          // When reaching a hole, make sure it has iterated to the last order.</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          require(nextSegmentIndex == segments.length - 1, PriceSegmentHasAHole()); // Must iterate to the last seg</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          require(currentOrNextSegment.getRemainingSegment(nextSlotIndex) == 0, PriceSegmentHasAHole()); // nextSlot and subsequent slots must be empty</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token inserted-sign inserted prefix inserted" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">+</span><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)">          require(nextSlotIndex &gt; 0, LastPriceSegmentCannotBeEmpty()); // The last non-empty order must be in seg[seg.len-1](seg.len-1 cannot point to an empty segment).</span></span><span class="token-line" style="display:block"><span class="token inserted-sign inserted line" style="color:var(--chakra-colors-codeHighlighting-diff-inserted)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">          nextSegmentIndex = currentSegmentIndex;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">          nextSlotIndex = currentSlotIndex;</span></span><span class="token-line" style="display:block"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">          break;</span></span></code></pre></div></div></section></li><li class="css-0"><section class="chakra-stack css-1kc89qn"><h4 class="chakra-heading css-thn72w">Use <span class="chakra-code css-l0e4mh">quantityFulfilled</span> for sell market orders when transferring NFTs</h4><dl class="chakra-stack css-18b9je0"><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">State</p></dt><dd class="chakra-stack css-t1uzvz"><div class="chakra-stack css-porbmv"><span class="css-1lnofw7"><span class="css-101m3ux"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2px" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-wrench" aria-hidden="true" color="currentColor"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path></svg></span><span class="css-1l8566">Fixed</span></span><a href="https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106" target="_blank" class="css-hyehfz"><p class="chakra-text css-n1un5q">PR #106</p></a></div></dd></div><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">Severity</p></dt><dd class="chakra-stack css-t1uzvz"><div class="chakra-stack css-porbmv"><span class="css-ypnwc0"><div class="css-dti5c1"></div><span class="css-v26npq">Severity<!-- -->: <!-- -->Informational</span></span></div></dd></div><div class="css-14ge14j"><dt class="css-vgxdvo"><p class="chakra-text css-1l9ml90">Submitted by</p></dt><dd class="chakra-stack css-t1uzvz"><a rel="nofollow" class="chakra-link css-1so5w5b" href="/u/Saw-mon-and-Natalie"><div data-test-id="mask" class="css-15ua73h"><img alt="" width="128" height="128" decoding="async" data-nimg="1" class="no-dark-mode css-1uqohei" style="color:transparent" srcSet="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=128&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=256&amp;q=75 2x" src="/_next/image?url=https%3A%2F%2Fimagedelivery.net%2Fwtv4_V7VzVsxpAFaxzmpbw%2F8039eb9a-b849-4701-675d-fd94168a3300%2Fpublic&amp;w=256&amp;q=75"/></div><p class="chakra-text css-1e0kj1c"> <!-- -->Saw-mon and Natalie</p></a></dd></div></dl><hr aria-orientation="horizontal" class="chakra-divider css-14ry2m8"/><div class="markdown-body css-1rem1b3"><h2 class="chakra-heading css-jg3yxe" id="description" node="[object Object]">Description</h2>
<p class="chakra-text css-xcnbdp" node="[object Object]"><code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">order.quantity</span></span></code> and <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">quantityFulfilled</span></span></code> are supposed to have the same value in this branch (sell market orders need to use exact quantity).</p>
<h2 class="chakra-heading css-jg3yxe" id="recommendation" node="[object Object]">Recommendation</h2>
<p class="chakra-text css-xcnbdp" node="[object Object]">but to avoid future foot gun it would be best to use <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">quantityFulfilled</span></span></code> here:</p>
<div style="position:relative" node="[object Object]" class="css-1kxrhf3"><pre style="overflow:auto;overflow-wrap:anywhere;white-space:pre-wrap" class="css-0"><code style="white-space:pre-wrap"><span class="token-line" style="display:block"><span class="token function" style="color:var(--chakra-colors-codeHighlighting-identifier)">_safeTransferNFTsToUs</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">(</span><span class="token plain">sender</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> order</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">.</span><span class="token plain">tokenId</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">,</span><span class="token plain"> quantityFulfilled</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">)</span><span class="token punctuation" style="color:var(--chakra-colors-codeHighlighting-plain)">;</span></span></code></pre></div>
<p class="chakra-text css-xcnbdp" node="[object Object]">This is due to the fact that if the check regarding exact quantities gets modified the actual value traded would be <code style="white-space:pre-wrap;word-break:break-word"><span class="token-line"><span class="token plain">quantityFulfilled</span></span></code>.</p></div></section></li></ol></section></div></div></section></div></section></div><footer class="css-1pgkvrj"><div class="chakra-container css-bv0bvv"><div class="chakra-stack css-b90z33"><p class="chakra-text css-1ufsqbu">© <!-- -->2025<!-- --> Cantina. All rights reserved.</p><div class="chakra-stack css-1rn13ix"><a target="_blank" rel="noopener nofollow" class="chakra-link css-1g42d1" href="/terms-of-use">Terms of Use</a><a target="_blank" rel="noopener nofollow" class="chakra-link css-1g42d1" href="/privacy-policy">Privacy Policy</a><a target="_blank" rel="noopener nofollow" class="chakra-link css-1g42d1" href="/contact">Contact Form</a><a target="_blank" rel="noopener nofollow" class="chakra-link css-1g42d1" href="https://docs.cantina.xyz/">Support</a><a rel="nofollow" class="chakra-link css-1g42d1" href="/security-contact">Security Contact</a><a target="_blank" rel="noopener nofollow" class="chakra-link css-1g42d1" href="https://status.cantina.xyz">Status</a></div><div class="chakra-stack css-uykjfd"><a target="_blank" rel="noopener nofollow" class="chakra-link css-1v0cowj" href="https://x.com/intent/follow?screen_name=cantinaxyz" aria-label="X"><span class="css-10ju93e"><svg xmlns="http://www.w3.org/2000/svg" width="1.25rem" height="1.25rem" fill="#374151" viewBox="0 0 24 24" stroke-width="1.5"><title>X</title><path d="M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z"></path></svg></span></a><a target="_blank" rel="noopener nofollow" class="chakra-link css-1v0cowj" href="https://discord.cantina.xyz" aria-label="Discord"><span class="css-10ju93e"><svg xmlns="http://www.w3.org/2000/svg" width="1.25rem" height="1.25rem" fill="#374151" viewBox="0 0 24 24" stroke-width="1.5"><title>Discord</title><path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"></path></svg></span></a><a target="_blank" rel="noopener nofollow" class="chakra-link css-1v0cowj" href="https://www.youtube.com/@cantina-xyz" aria-label="YouTube"><span class="css-10ju93e"><svg xmlns="http://www.w3.org/2000/svg" width="1.25rem" height="1.25rem" fill="#374151" viewBox="0 0 24 24" stroke-width="1.5"><title>YouTube</title><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"></path></svg></span></a></div></div></div></footer></section><div style="position:absolute;top:0"></div><!--$--><!--/$--><div></div><span id="__chakra_env" hidden=""></span></main><script src="/_next/static/chunks/webpack-29f04d04c6930a1b.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"9:\"$Sreact.fragment\"\nc:I[49507,[],\"\"]\nd:I[52639,[],\"\"]\nf:I[91432,[],\"OutletBoundary\"]\n11:I[91432,[],\"MetadataBoundary\"]\n13:I[91432,[],\"ViewportBoundary\"]\n15:I[69398,[],\"\"]\n1:HL[\"/_next/static/media/3f0370209693c6c7-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/media/739c2d8941231bb4-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n3:HL[\"/_next/static/media/7612fcb78da57e63-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n4:HL[\"/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n5:HL[\"/_next/static/css/fb86f50bcce31023.css\",\"style\"]\n6:HL[\"/_next/static/css/309a978ed622eb10.css\",\"style\"]\n7:HL[\"/_next/static/css/4cf557a5ae63a804.css\",\"style\"]\n8:HL[\"/_next/static/css/efc7064ad17e3280.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"uxoa9EimqMM3JKPgSmdQT\",\"p\":\"\",\"c\":[\"\",\"portfolio\",\"80b2fc65-3c2e-4ae7-8e48-6383fa936e6d\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"(public)\",{\"children\":[\"portfolio\",{\"children\":[[\"id\",\"80b2fc65-3c2e-4ae7-8e48-6383fa936e6d\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$9\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/fb86f50bcce31023.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/309a978ed622eb10.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"2\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/4cf557a5ae63a804.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],\"$La\"]}],{\"children\":[\"(public)\",[\"$\",\"$9\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/efc7064ad17e3280.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],\"$Lb\"]}],{\"children\":[\"portfolio\",[\"$\",\"$9\",\"c\",{\"children\":[null,[\"$\",\"$Lc\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(public)\",\"children\",\"portfolio\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Ld\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]]}],{\"children\":[[\"id\",\"80b2fc65-3c2e-4ae7-8e48-6383fa936e6d\",\"d\"],[\"$\",\"$9\",\"c\",{\"children\":[null,[\"$\",\"$Lc\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(public)\",\"children\",\"portfolio\",\"children\",\"$0:f:0:1:2:children:2:children:2:children:0\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Ld\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$9\",\"c\",{\"children\":[\"$Le\",null,[\"$\",\"$Lf\",null,{\"children\":\"$L10\"}]]}],{},null]},null]},null]},null]},null],[\"$\",\"$9\",\"h\",{\"children\":[null,[\"$\",\"$9\",\"HnQkNs8POHCwdolM_vthQ\",{\"children\":[[\"$\",\"$L11\",null,{\"children\":\"$L12\"}],[\"$\",\"$L13\",null,{\"children\":\"$L14\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\"}]]}]]}]]],\"m\":\"$undefined\",\"G\":[\"$15\",\"$undefined\"],\"s\":false,\"S\":false}\n"])</script><script>self.__next_f.push([1,"16:I[64727,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"6372\",\"static/chunks/6372-b1ed2f35068abe95.js\",\"4313\",\"static/chunks/4313-11f54c31ec5a8b0d.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"7177\",\"static/chunks/app/layout-cb19078f157f53f7.js\"],\"RootHead\"]\n17:I[89215,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"6372\",\"static/chunks/6372-b1ed2f35068abe95.js\",\"4313\",\"static/chunks/4313-11f54c31ec5a8b0d.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"7177\",\"static/chunks/app/layout-cb19078f157f53f7.js\"],\"GoogleTagManager\"]\n18:I[46246,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js"])</script><script>self.__next_f.push([1,"\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"6372\",\"static/chunks/6372-b1ed2f35068abe95.js\",\"4313\",\"static/chunks/4313-11f54c31ec5a8b0d.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"7177\",\"static/chunks/app/layout-cb19078f157f53f7.js\"],\"DatadogInit\"]\n19:I[7334,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"6372\",\"static/chunks/6372-b1ed2f35068abe95.js\",\"4313\",\"static/chunks/4313-11f54c31ec5a8b0d.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"7177\",\"static/chunks/app/layout-cb19078f157f53f7.js\"],\"default\"]\n1a:I[2054,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"6110\",\"static/c"])</script><script>self.__next_f.push([1,"hunks/6110-03a4130b17b010cf.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"6372\",\"static/chunks/6372-b1ed2f35068abe95.js\",\"4313\",\"static/chunks/4313-11f54c31ec5a8b0d.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"7177\",\"static/chunks/app/layout-cb19078f157f53f7.js\"],\"Providers\"]\n1b:I[6402,[\"2331\",\"static/chunks/db261188-e9f8aa6e4a0a2c21.js\",\"9485\",\"static/chunks/2d4f24d4-f5eb412bce79db6b.js\",\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"5502\",\"static/chunks/5502-dc16e77959dad9f6.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"5141\",\"static/chunks/5141-e71939af309307b4.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"5838\",\"static/chunks/5838-ddc5dc5a9a24b693.js\",\"5096\",\"static/chunks/5096-61c9394f436a129a.js\",\"8039\",\"static/chunks/app/error-e4a6c54656342d67.js\"],\"default\"]\n1c:I[60408,[\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"6397\",\"static/chunks/app/template-9570399e7e3665a7.js\"],\"default\"]\n1e:I[479"])</script><script>self.__next_f.push([1,"34,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"HydrationBoundary\"]\n1f:I[17610,[\"2331\",\"static/chunks/db261188-e9f8aa6e4a0a2c21.js\",\"9485\",\"static/chunks/2d4f24d4-f5eb412bce79db6b.js\",\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2"])</script><script>self.__next_f.push([1,"159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"5502\",\"static/chunks/5502-dc16e77959dad9f6.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"28\",\"static/chunks/28-397907ee75f4a2ba.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"5838\",\"static/chunks/5838-ddc5dc5a9a24b693.js\",\"5096\",\"static/chunks/5096-61c9394f436a129a.js\",\"7405\",\"static/chunks/app/(cantina)/layout-a5a879b5e428d20d.js\"],\"CantinaLayoutProviderWrapper\"]\n20:I[62168,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/751"])</script><script>self.__next_f.push([1,"4-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"Flex\"]\n21:I[67693,[\"2331\",\"static/chunks/db261188-e9f8aa6e4a0a2c21.js\",\"9485\",\"static/chunks/2d4f24d4-f5eb412bce79db6b.js\",\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"5502\",\"static/chunks/5502-dc16e77959dad9f6.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"28\",\"static/chunks/28-397907ee75f4a2ba.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\","])</script><script>self.__next_f.push([1,"\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"5838\",\"static/chunks/5838-ddc5dc5a9a24b693.js\",\"5096\",\"static/chunks/5096-61c9394f436a129a.js\",\"7405\",\"static/chunks/app/(cantina)/layout-a5a879b5e428d20d.js\"],\"Navbar\"]\n22:I[15957,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"Stack\"]\n23:I[14325,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed080"])</script><script>self.__next_f.push([1,"8fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"1681\",\"static/chunks/app/(with-footer)/layout-846e14f9c0d37ecb.js\"],\"Footer\"]\na:[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"$L16\",null,{}],[\"$\",\"$L17\",null,{\"gtmId\":\"GTM-WWS29298\"}],[\"$\",\"body\",null,{\"children\":[[\"$\",\"$L18\",null,{}],[\"$\",\"main\",null,{\"style\":{\"display\":\"flex\",\"flexDirection\":\"column\",\"minHeight\":\"100vh\"},\"children\":[\"$\",\"$L19\",null,{\"options\":{\"key\":\"css\"},\"children\":[\"$\",\"$L1a\",null,{\"queryClientState\":{\"mutations\":[],\"queries\":[{\"state\":{\"data\":null,\"dataUpdateCount\":1,\"dataUpdatedAt\":1755006790120,\"error\":null,\"errorUpdateCount\":0,\"errorUpdatedAt\":0,\"fetchFailureCount\":0,\"fetchFailureReason\":null,\"fetchMeta\":null,\"isInvalidated\":false,\"status\":\"success\",\"fetchStatus\":\"idle\"},\"queryKey\":[\"query\",\"auth.authMe\",\"$undefined\"],\"queryHash\":\"[\\\"query\\\",\\\"auth.authMe\\\",null]\"}]},\"children\":[\"$\",\"$Lc\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$1b\",\"errorStyles\":[[\"$\",\"link\",\"style-0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/efc7064ad17e3280.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],\"errorScripts\":[],\"template\":[\"$\",\"$L1c\",null,{\"children\":[\"$\",\"$Ld\",null,{}]}],\"templateStyles\":[],\"templateScripts\":[],\"notFound\":\"$L1d\",\"notFoundStyles\":[[\"$\",\"link\",\"style-0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/efc7064ad17e3280.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]}]}]}]}]]}]]}]\nb:[\"$\",\"$L1e\",null,{\"state\":{\"mutations\":[],\"queries\":[{\"state\":{\"data\":null,\"dataUpdateCount\":1,\"dataUpdatedAt\":1755006790120,\"error\":null,\"errorUpdateCount\":0,\"errorUpdatedAt\":0,\"fetchFailureCount\":0,\"fetchFailureReason\":null,\"fetchMeta\":null,\"isInvalidated\":false,\"status\":\"success\",\"fetchStatus\":\"idle\"},\"queryKey\":\"$a:props:children:2:props:children:1:props:children:props:children:props:queryClientState:queries:0:qu"])</script><script>self.__next_f.push([1,"eryKey\",\"queryHash\":\"[\\\"query\\\",\\\"auth.authMe\\\",null]\"}]},\"children\":[\"$\",\"$L1f\",null,{\"children\":[\"$\",\"$L20\",null,{\"as\":\"section\",\"bgColor\":\"white\",\"flexDirection\":\"column\",\"minH\":\"100vh\",\"children\":[[\"$\",\"$L21\",null,{}],[\"$\",\"$L22\",null,{\"flexGrow\":1,\"isolation\":\"isolate\",\"children\":[\"$\",\"$Lc\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(public)\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Ld\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]}],[\"$\",\"$L23\",null,{}]]}]}]}]\n"])</script><script>self.__next_f.push([1,"24:I[33998,[\"2331\",\"static/chunks/db261188-e9f8aa6e4a0a2c21.js\",\"9485\",\"static/chunks/2d4f24d4-f5eb412bce79db6b.js\",\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"5502\",\"static/chunks/5502-dc16e77959dad9f6.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"3930\",\"static/chunks/3930-94d831ab74e1afdf.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"5838\",\"static/chunks/5838-ddc5dc5a9a24b693.js\",\"5096\",\"static/chunks/5096-61c9394f436a129a.js\",\"4345\",\"static/chunks/app/not-found-f31194d283b5fba5.js\"],\"ChakraProviderWrapper\"]\n25:I[57144,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"stati"])</script><script>self.__next_f.push([1,"c/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"ErrorPage\"]\n1d:[\"$\",\"$L24\",null,{\"children\":[[\"$\",\"$L21\",null,{}],[\"$\",\"$L25\",null,{\"message\":\"Sorry, we couldn't find the page you were looking for.\",\"title\":\"Page not found\"}]]}]\n"])</script><script>self.__next_f.push([1,"2c:I[50175,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"ReportHeader\"]\n2d:I[47829,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\","])</script><script>self.__next_f.push([1,"\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"VStack\"]\n2e:I[17106,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0"])</script><script>self.__next_f.push([1,"b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"Grid\"]\n2f:I[23522,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"Text\"]\n30:I[55955,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\""])</script><script>self.__next_f.push([1,",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"HStack\"]\n31:I[87243,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32"])</script><script>self.__next_f.push([1,"069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"CompanyHandleTag\"]\n32:I[65588,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"RepoBadge\"]\n33:I[73623,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee"])</script><script>self.__next_f.push([1,"42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"Link\"]\n34:I[6884,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/c"])</script><script>self.__next_f.push([1,"hunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"\"]\n35:I[32323,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\""])</script><script>self.__next_f.push([1,",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"Avatar\"]\n36:I[16328,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"Divider\"]\n37:I[87189,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/c"])</script><script>self.__next_f.push([1,"hunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"Heading\"]\n38:I[73040,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8"])</script><script>self.__next_f.push([1,"741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"GridItem\"]\n39:I[64263,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"Tooltip\"]\n3a:I[73479,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\","])</script><script>self.__next_f.push([1,"\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"Circle\"]\n3b:I[71290,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70"])</script><script>self.__next_f.push([1,"b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"OrderedList\"]\n3c:I[71290,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5"])</script><script>self.__next_f.push([1,"D/page-ca8c43acc7ba6cba.js\"],\"ListItem\"]\n3d:I[66046,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"TextWithBackticks\"]\n3e:I[30332,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"s"])</script><script>self.__next_f.push([1,"tatic/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"Tag\"]\n3f:I[83472,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0"])</script><script>self.__next_f.push([1,"f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"Icon\"]\n40:I[30332,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"TagLabel\"]\n41:I[51943,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\","])</script><script>self.__next_f.push([1,"\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"ErrorBoundary\"]\n42:I[75591,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/751"])</script><script>self.__next_f.push([1,"4-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"FrontMatterRenderer\"]\n43:I[68563,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"PrismCodeComponent\"]\n44:I[8417,[\"4624\",\"static/chun"])</script><script>self.__next_f.push([1,"ks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"Link\"]\n45:I[9352,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\""])</script><script>self.__next_f.push([1,",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"Box\"]\n46:I[56917,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-"])</script><script>self.__next_f.push([1,"0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"CopyButton\"]\n54:I[71290,[\"4624\",\"static/chunks/4624-a3449603f7c3cd66.js\",\"6453\",\"static/chunks/6453-0d300afee42e0695.js\",\"5052\",\"static/chunks/5052-a047dafa444d349c.js\",\"8327\",\"static/chunks/8327-7278f26c255e44b8.js\",\"3914\",\"static/chunks/3914-b0738fd108b57eb1.js\",\"1290\",\"static/chunks/1290-46f05f37548bb0d6.js\",\"5595\",\"static/chunks/5595-84b7fc765ce8ce8c.js\",\"3054\",\"static/chunks/3054-c7ce83b7f9da81cf.js\",\"3978\",\"static/chunks/3978-061c41faaf17e980.js\",\"2718\",\"static/chunks/2718-de2ada3c43de8199.js\",\"2159\",\"static/chunks/2159-6c2ed0808fb509dc.js\",\"3933\",\"static/chunks/3933-accd40f4f0e408ea.js\",\"6110\",\"static/chunks/6110-03a4130b17b010cf.js\",\"5497\",\"static/chunks/5497-bb9f1cc98d6ae1f4.js\",\"3860\",\"static/chunks/3860-601782eebaad6434.js\",\"2556\",\"static/chunks/2556-058a46ae1a312246.js\",\"4041\",\"static/chunks/4041-c8b70b1d1cd54479.js\",\"3414\",\"static/chunks/3414-91e4f91e8f4dab55.js\",\"7514\",\"static/chunks/7514-8ba291b301c2af6a.js\",\"1546\",\"static/chunks/1546-8f32069f317c0f05.js\",\"2189\",\"static/chunks/2189-660d4274669ab31b.js\",\"4148\",\"static/chunks/4148-efcd77d52f5d8741.js\",\"9043\",\"static/chunks/9043-a7590d9c1867f434.js\",\"2043\",\"static/chunks/2043-e93b3391f0f1c061.js\",\"1060\",\"static/chunks/1060-386c0b2232eaae96.js\",\"8720\",\"static/chunks/8720-0e1cb44e32e0ab67.js\",\"3215\",\"static/chunks/3215-be7b43a1226cf93d.js\",\"5279\",\"static/chunks/5279-910b94dcf6d5d422.js\",\"8850\",\"static/chunks/app/(public)/portfolio/%5Bid%5D/page-ca8c43acc7ba6cba.js\"],\"UnorderedList\"]\n26:T4eeb,"])</script><script>self.__next_f.push([1,"## Description\n\n`isBudgetConstrainedBuyingLimitReached` should be set as soon as the remaining budget cannot afford the full order cost. Here is why this is an issue currently. If we can only partially afford to fill the current order to be consumed, ie [`maxAffordableQuantity`](https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L842) (quantised) is not-zero and we partially fill the order, then the implementation moves on to the next order. Most likely in the next iteration, one cannot fill any of the next order, since the `remainingBudget` would be really small and `bestPrice` potentially could be even higher (in budget-constrained market buy orders, best prices increment up as we fill/match orders):\n\n$$\n\\left\\lfloor\n\\frac{\\Delta q p_{b'}}{10^d} \n\\right\\rfloor\n\u003e \\frac{(\\epsilon_0 + \\epsilon_1 \\Delta q) p_b}{10^d} + \\epsilon_2\n$$\n\nIn this scenario, after the first budget-constrained partial fill, if one queries for the next order to potentially match, if it ends up matching `0` amount. We would hit [this branch](https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L845-L850):\n\n```solidity\nif (maxAffordableQuantity == 0) {\n  // Can't afford any of this order, stop here\n  params.isBudgetConstrainedBuyingLimitReached = true;\n  return (\n    segment,\n    0, // ordersConsumed\n    0 // quantityNFTClaimable\n  );\n}\n```\n\nNote that we have queried `2` orders so far and for both one [`ordersConsumed`](https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L805) has been `0`. At this point we have:\n\n| parameter | value|\n|---|---|\n| [`segment`](https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L803) | the segment that includes the last skipped order |\n| [`lastConsumedSegmentIndex`](https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L773) | might be potentially the same as the first order or pointing to the next segment since we have quried 2 orders |\n| [`numOrdersFullyConsumed`](https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L820) | does not count for the last orders: the one that was partially matched and also the one that was skipped since `maxAffordableQuantity` ends up being `0` |\n\nNow, let's analyse this portion of the [`_updateSegmentsAndTree`](https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L937-L951):\n\n```solidity\n// if the order skipped after the partial order match was on the next segement\n// the value for `lastSegmentDeleted` would be `false`\nbool lastSegmentDeleted = lastSegmentIndex \u003c (oldTombstoneOffset + numSegmentsFullyConsumed);\nif (!lastSegmentDeleted) {\n    // `numOrdersWithinLastSegmentFullyConsumed` would be number of orders fully consumed\n    // in before querying the partial or skipped order. Might be the come from the \n    // segment the partial order was on or before\n    if (numOrdersWithinLastSegmentFullyConsumed != 0) {\n        for (uint256 i; i \u003c numOrdersWithinLastSegmentFullyConsumed; ++i) {\n            // potentailly wrong segment is updated, since the assumed fully \n            // matched orders might not be on the same segment as the\n            // last order which was skipped\n            lastSegment = lastSegment.clearSlot(i);\n        }\n    }\n\n    if (uint256(lastSegment) == 0) {\n        // All orders in the last segment are consumed, delete from tree\n        tree.remove(bestPrice);\n        // Don't pop segment for gas efficiency, instead just write zeros\n    }\n\n    // segments gets updated incorrectly\n    segments[lastSegmentIndex] = lastSegment;\n}\n```\n\nLet's follow all this with an example from transaction [0xd1945911cce9d105b4503d3ab378e735c754ae1c5d5df62fe4b824b884c2b3c1](https://www.tdly.co/tx/0xd1945911cce9d105b4503d3ab378e735c754ae1c5d5df62fe4b824b884c2b3c1):\n\n```\n(10, 40416) (10, 40415) (10, 40414)\n(10, 40419) (10, 40418) (10, 40417)\n```\n\nwith `maxCost` $c_{max} = 31500$. The transaction fully consumed the orders `40414` and `40415` and at this point the `params.currentCost` would be $c_{curr} = 31490$ and the remaining budget would be $c_r = 10$, the quantised `maxAffordableQuantity` $q_{max} = 2 \\Delta q$ ($\\Delta q$ being the `QUANTITY_TICK`). Order `40416` gets partialy filled and the slot (in stack) gets updated to `(8, 40416)`. Since we have not set the `isBudgetConstrainedBuyingLimitReached` and the other conditions are satisfied (there is a remaining budget and we have not hit the limit price, ...), querying over the orders continues. At this point we have $c_{curr} = 31498$ and thus $c_r = 2$ this time $q_{max}$ ends up being $0$ and this `isBudgetConstrainedBuyingLimitReached` gets set. The value of `segment` ends up being:\n\n```\n(10, 40419) (10, 40418) (10, 40417) segment\n```\n\nThe storage update in `_updateSegmentsAndTree` performs cleaning on the above segment and since `numOrdersFullyConsumed` did not account for the partial order and the skipped order the `tombstone` also lags behind and we end up with the following segment structure:\n\n```\n(10, 40416) (10, 40415) (10, 40414) \u003c-- tombstone offset\n(10, 40419) ( 0,     0) ( 0,     0)\n```\n\nNote that instead of clearning out the orders `40415` and `40414` which were fully matched the orders `40418` and `40417` get cleared out and the order `40416` does not even get updated although it was partially matched.\n \n## PoC\n\nApply the following patch which will be needed in the test cases:\n\n```diff\ndiff --git a/test/sonicOrderBook/utils.ts b/test/sonicOrderBook/utils.ts\nindex be0608f..845dea0 100644\n--- a/test/sonicOrderBook/utils.ts\n+++ b/test/sonicOrderBook/utils.ts\n@@ -59,6 +59,7 @@ export async function deployContractsFixture() {\n \n   return {\n     orderBook,\n+    sonicOrderBookLibrary,\n     sonicAirdropNFT,\n     wS,\n     quoteToken,\n```\n\nThen create the file `test/sonicOrderBook/isBudgetConstrainedBuyingLimitReached.bug.ts` with the following content:\n\n```ts\nimport {loadFixture} from \"@nomicfoundation/hardhat-toolbox/network-helpers\";\nimport hre, {ethers, upgrades} from \"hardhat\";\nimport {expect} from \"chai\";\nimport {SonicOrderBook} from \"../../typechain-types\";\nimport {Order, OrderSide} from \"@paintswap/sonic-airdrop-definitions/types\";\nimport {deployContractsFixture, calcFees, ONE_ETHER, RETURN_WRAPPED_SONIC} from \"./utils\";\nimport {initializerSlot} from \"../utils\";\nimport {BigNumberish, Block} from \"ethers\";\nimport {deploySonicOrderBook, deploySonicOrderBookLibrary} from \"../../scripts/deployHelpers\";\nimport { HardhatEthersSigner } from \"@nomicfoundation/hardhat-ethers/signers\";\n\n// Uses a plain ERC20 token with 18 decimals\ndescribe(\"SonicOrderBook\", function () {\n  describe(\"Market orders with useExactQuantity: false\", function () {\n    describe(\"Budget-constrained buying\", function () {\n      async function setup() {\n        const {\n          sonicAirdropNFT,\n          wS,\n          sonicOrderBookLibrary,\n          quoteToken,\n          alice,\n          bob,\n          dev,\n          tokenId,\n          initialCoins,\n          maxOrdersPerPrice,\n          QUANTITY_TICK\n        } = await loadFixture(deployContractsFixture);\n\n        await quoteToken.connect(bob).mint(bob, initialCoins);\n\n        const orderBook = await deploySonicOrderBook(sonicAirdropNFT, quoteToken, wS, sonicOrderBookLibrary);\n        \n        // set approvals\n        await quoteToken.approve(orderBook, initialCoins);\n        await quoteToken.connect(alice).approve(orderBook, initialCoins);\n        await sonicAirdropNFT.setApprovalForAll(orderBook, true);\n        await sonicAirdropNFT.connect(alice).setApprovalForAll(orderBook, true);\n        await quoteToken.connect(bob).approve(orderBook, initialCoins);\n\n        const priceTick = 100n;\n        const minQuantity = 10n * QUANTITY_TICK;\n        const isTradeable = true;\n\n        const makerFeeBps = 40n; // 0.2% fee for makers\n        const takerFeeBps = 60n; // 0.3% fee for takers\n        await orderBook.setAdminVars(\n            dev,\n            makerFeeBps,\n            takerFeeBps,\n            maxOrdersPerPrice,\n            [tokenId],\n            [{priceTick, minQuantity, isTradeable}]\n        );\n\n        return {\n          orderBook,\n          quoteToken,\n          alice,\n          bob,\n          dev,\n          tokenId,\n          initialCoins,\n          maxOrdersPerPrice,\n          QUANTITY_TICK,\n          priceTick,\n          minQuantity\n        }\n      }\n\n      it(\"6 orders\", async function () {\n        const {\n          orderBook,\n          quoteToken,\n          alice,\n          bob,\n          tokenId,\n          maxOrdersPerPrice,\n          QUANTITY_TICK,\n          priceTick,\n          minQuantity\n        } = await loadFixture(setup);\n\n        const limitPrice = 4n * priceTick;\n        const quantity = minQuantity;\n        const totalOrders = 6;\n\n        await placeNLimitOrders(\n          orderBook,\n          alice,\n          totalOrders,\n          OrderSide.Sell,\n          tokenId,\n          limitPrice,\n          quantity,\n          true,\n          true\n        );\n\n        await logSegments(orderBook, OrderSide.Sell, tokenId, limitPrice, \"segments before calling placeMarketOrder :\");\n        \n        const nodeBefore = await orderBook.getNode(OrderSide.Sell, tokenId, limitPrice);\n        expect(nodeBefore.tombstoneSegmentOffset).to.be.equal(0);\n\n        const segmentsBefore = await getSegments(orderBook, OrderSide.Sell, tokenId, limitPrice);\n        expect(segmentsBefore[0]).to.be.equal(\"0x00000000000a0000000000030000000a0000000000020000000a000000000001\");\n        expect(segmentsBefore[1]).to.be.equal(\"0x00000000000a0000000000060000000a0000000000050000000a000000000004\");\n\n        // each order is worth 40, so in total with a budget of 101\n        // we should afford 2 full orders and a partial order (1/2 of an order)\n        // this would cost 100, the extra budget of 1 is here to make sure\n        // after we partially match the 3rd order we would not reach the `maxCost`\n        // so the loop would continue to trigger the bug\n        const budget = 101;\n        await orderBook.connect(bob).placeMarketOrder(\n          {\n            side: OrderSide.Buy,\n            tokenId,\n            totalCost: budget,\n            quantity: 0,\n            useExactQuantity: false\n          },\n          RETURN_WRAPPED_SONIC\n        );\n\n        await logSegments(orderBook, OrderSide.Sell, tokenId, limitPrice, \"segments after calling placeMarketOrder :\");\n\n        const nodeAfter = await orderBook.getNode(OrderSide.Sell, tokenId, limitPrice);\n        expect(nodeAfter.tombstoneSegmentOffset).to.be.equal(0);\n\n        const segmentsAfter= await getSegments(orderBook, OrderSide.Sell, tokenId, limitPrice);\n        expect(segmentsAfter[0]).to.be.equal(\"0x0000000000050000000000030000000000000000000000000000000000000000\");\n        expect(segmentsAfter[1]).to.be.equal(\"0x00000000000a0000000000060000000a0000000000050000000a000000000004\");\n\n      });\n\n      it(\"4 orders\", async function () {\n        const {\n          orderBook,\n          quoteToken,\n          alice,\n          bob,\n          tokenId,\n          maxOrdersPerPrice,\n          QUANTITY_TICK,\n          priceTick,\n          minQuantity\n        } = await loadFixture(setup);\n\n        const limitPrice = 4n * priceTick;\n        const quantity = minQuantity;\n        const totalOrders = 4;\n\n        await placeNLimitOrders(\n          orderBook,\n          alice,\n          totalOrders,\n          OrderSide.Sell,\n          tokenId,\n          limitPrice,\n          quantity,\n          true,\n          true\n        );\n\n        await logSegments(orderBook, OrderSide.Sell, tokenId, limitPrice, \"segments before calling placeMarketOrder :\");\n        \n        const nodeBefore = await orderBook.getNode(OrderSide.Sell, tokenId, limitPrice);\n        expect(nodeBefore.tombstoneSegmentOffset).to.be.equal(0);\n\n        const segmentsBefore = await getSegments(orderBook, OrderSide.Sell, tokenId, limitPrice);\n        expect(segmentsBefore[0]).to.be.equal(\"0x00000000000a0000000000030000000a0000000000020000000a000000000001\");\n        expect(segmentsBefore[1]).to.be.equal(\"0x000000000000000000000000000000000000000000000000000a000000000004\");\n\n        // each order is worth 40, so in total with a budget of 101\n        // we should afford 2 full orders and a partial order (1/2 of an order)\n        // this would cost 100, the extra budget of 1 is here to make sure\n        // after we partially match the 3rd order we would not reach the `maxCost`\n        // so the loop would continue to trigger the bug\n        const budget = 101;\n        await orderBook.connect(bob).placeMarketOrder(\n          {\n            side: OrderSide.Buy,\n            tokenId,\n            totalCost: budget,\n            quantity: 0,\n            useExactQuantity: false\n          },\n          RETURN_WRAPPED_SONIC\n        );\n\n        await logSegments(orderBook, OrderSide.Sell, tokenId, limitPrice, \"segments after calling placeMarketOrder :\");\n\n        const nodeAfter = await orderBook.getNode(OrderSide.Sell, tokenId, limitPrice);\n        expect(nodeAfter.tombstoneSegmentOffset).to.be.equal(0);\n\n        const segmentsAfter= await getSegments(orderBook, OrderSide.Sell, tokenId, limitPrice);\n        expect(segmentsAfter[0]).to.be.equal(\"0x0000000000050000000000030000000000000000000000000000000000000000\");\n        expect(segmentsAfter[1]).to.be.equal(\"0x000000000000000000000000000000000000000000000000000a000000000004\");\n      });\n    });\n  });\n\n  async function getNextOrderId(orderBook: SonicOrderBook) {\n    const nextOrderIdSlot = 0;\n    const packedSlot = await ethers.provider.getStorage(orderBook, nextOrderIdSlot);\n    return parseInt(packedSlot.slice(2, 14), 16);\n  }\n\n  async function placeNLimitOrders(\n    orderbook: SonicOrderBook,\n    user: HardhatEthersSigner,\n    totalOrders: number,\n    side: OrderSide,\n    tokenId: BigNumberish,\n    price: BigNumberish,\n    quantity: BigNumberish,\n    onlyPost: boolean,\n    onlyExactPriceIfMaker: boolean\n  ) {\n    for(let i = 0; i \u003c totalOrders; i++) {\n      await orderbook.connect(user).placeLimitOrders([\n        {\n          side: side,\n          tokenId: tokenId,\n          price: price,\n          quantity,\n          onlyPost: onlyPost,\n          onlyExactPriceIfMaker: onlyExactPriceIfMaker\n        }\n      ],\n        RETURN_WRAPPED_SONIC\n      );\n    }\n  }\n\n  async function logSegments(orderBook: SonicOrderBook, side: OrderSide, tokenId: BigNumberish, price: BigNumberish, message: string) {\n    const segmentsAfter = await getSegments(orderBook, side, tokenId, price);\n    console.log(message)\n    console.log(segmentsAfter);\n  }\n\n  async function getSegments(orderBook: SonicOrderBook, side: OrderSide, tokenId: BigNumberish, price: BigNumberish) {\n    // Storage slot assignments based on contract layout:\n    // slot 0: packed variables (_devAddr, _devFeeBps, _maxOrdersPerPrice, _nextOrderId)\n    // slot 1: _tokenIdInfos mapping\n    // slot 2: _asks mapping\n    // slot 3: _bids mapping\n    // slot 4: _asksAtPrice mapping\n    // slot 5: _bidsAtPrice mapping\n\n    const baseSlot = side === 0 ? 5 : 4; // 0 = Buy (bids), 1 = Sell (asks)\n\n    // Calculate slot for tokenId in the outer mapping\n    const tokenIdSlot = ethers.solidityPackedKeccak256([\"uint256\", \"uint256\"], [tokenId, baseSlot]);\n\n    // Calculate slot for price in the inner mapping\n    const priceSlot = ethers.solidityPackedKeccak256([\"uint256\", \"bytes32\"], [price, tokenIdSlot]);\n\n    // Read array length from the calculated slot\n    const lengthHex = await ethers.provider.getStorage(orderBook, priceSlot);\n    const length = parseInt(lengthHex, 16);\n\n    if (length === 0) {\n      return [];\n    }\n\n    // For dynamic arrays, elements start at keccak256(slot)\n    const arrayStartSlot = ethers.solidityPackedKeccak256([\"bytes32\"], [priceSlot]);\n\n    // Read each segment (bytes32 elements)\n    const segments = [];\n    for (let i = 0; i \u003c length; i++) {\n      const elementSlot = BigInt(arrayStartSlot) + BigInt(i);\n      const segment = await ethers.provider.getStorage(orderBook, elementSlot);\n      segments.push(segment);\n    }\n\n    return segments;\n  }\n});\n```\n\nthen run:\n\n```bash\nyarn test -- test/sonicOrderBook/isBudgetConstrainedBuyingLimitReached.bug.ts\n```\n\nThe tests should fail without the fix applied and pass with the fixes applied.\n\nlogs:\n\n```\nsegments before calling placeMarketOrder :\n[\n  '0x00000000000a0000000000030000000a0000000000020000000a000000000001',\n  '0x00000000000a0000000000060000000a0000000000050000000a000000000004'\n]\nsegments after calling placeMarketOrder :\n[\n  '0x00000000000a0000000000030000000a0000000000020000000a000000000001',\n  '0x00000000000a0000000000060000000000000000000000000000000000000000'\n]\n        1) 6 orders\nsegments before calling placeMarketOrder :\n[\n  '0x00000000000a0000000000030000000a0000000000020000000a000000000001',\n  '0x000000000000000000000000000000000000000000000000000a000000000004'\n]\nsegments after calling placeMarketOrder :\n[\n  '0x00000000000a0000000000030000000a0000000000020000000a000000000001',\n  '0x0000000000000000000000000000000000000000000000000000000000000000'\n]\n        2) 4 orders\n\n\n  0 passing (321ms)\n  2 failing\n\n  1) SonicOrderBook\n       Market orders with useExactQuantity: false\n         Budget-constrained buying\n           6 orders:\n\n      AssertionError: expected '0x00000000000a0000000000030000000a000…' to equal '0x00000000000500000000000300000000000…'\n      + expected - actual\n\n      -0x00000000000a0000000000030000000a0000000000020000000a000000000001\n      +0x0000000000050000000000030000000000000000000000000000000000000000\n      \n      at Context.\u003canonymous\u003e (test/sonicOrderBook/isBudgetConstrainedBuyingLimitReached.bug.ts:133:40)\n\n  2) SonicOrderBook\n       Market orders with useExactQuantity: false\n         Budget-constrained buying\n           4 orders:\n     Error: VM Exception while processing transaction: reverted with custom error 'KeyDoesntExist()'\n    at SonicOrderBook.getNode (contracts/libraries/BokkyPooBahsRedBlackTreeLibrary.sol:71)\n    at SonicOrderBook.getNode (contracts/SonicOrderBook.sol:519)\n    at \u003cUnrecognizedContract\u003e.\u003cunknown\u003e (0xa51c1fc2f0d1a1b8494ed1fe312d7c3a78ed91c0)\n    at EdrProviderWrapper.request (node_modules/hardhat/src/internal/hardhat-network/provider/provider.ts:398:41)\n    at async staticCallResult (node_modules/ethers/src.ts/contract/contract.ts:337:22)\n    at async staticCall (node_modules/ethers/src.ts/contract/contract.ts:303:24)\n    at async Proxy.getNode (node_modules/ethers/src.ts/contract/contract.ts:351:41)\n    at async Context.\u003canonymous\u003e (test/sonicOrderBook/isBudgetConstrainedBuyingLimitReached.bug.ts:195:27)\n```\n\n\n## Recommendation\n\nApply the following patch to stop querying more orders as soon as one cannot afford a full order in the budget-constrained market buy order:\n\n```diff\ndiff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol\nindex 31b5486..1a4c724 100644\n--- a/contracts/SonicOrderBook.sol\n+++ b/contracts/SonicOrderBook.sol\n@@ -836,13 +836,13 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n       uint256 remainingBudget = params.maxCost - params.currentCost;\n \n       if (fullOrderCost \u003e remainingBudget) {\n+        // Can't afford a full order, stop here\n+        params.isBudgetConstrainedBuyingLimitReached = true;\n         // Check if we can afford partial order\n         uint256 maxAffordableQuantity = (remainingBudget * BASE_DECIMAL_DIVISOR) / params.bestPrice;\n         // Floor to QUANTITY_TICK to ensure proper alignment\n         maxAffordableQuantity = (maxAffordableQuantity / QUANTITY_TICK) * QUANTITY_TICK;\n         if (maxAffordableQuantity == 0) {\n-          // Can't afford any of this order, stop here\n-          params.isBudgetConstrainedBuyingLimitReached = true;\n           return (\n             segment,\n             0, // ordersConsumed\n```"])</script><script>self.__next_f.push([1,"27:Tc575,"])</script><script>self.__next_f.push([1,"## Description\n\n$$\n\\begin{align*}\n\u0026 \\qquad \\quad \\space \\vdots \\qquad \\quad \u0026 \\\\\n\\square \u0026 \\cdots \\square \\square \\square \\square\\square \\square \\cdots \\square \u0026 \\leftarrow \u0026 \\space o_t - 1 \\\\\n\\blacksquare \u0026 \\cdots \\blacksquare \\blacksquare \\blacksquare \\blacksquare\\blacksquare \\square \\cdots \\square \u0026 \\leftarrow \u0026 \\space o_t \\\\\n\\blacksquare \u0026 \\cdots \\blacksquare \\blacksquare \\blacksquare \\blacksquare\\blacksquare\\blacksquare \\cdots \\blacksquare \u0026 \u0026 \\\\\n\u0026 \\qquad \\quad \\space \\vdots \\qquad \\quad \u0026  \u0026 \\\\\n\\blacksquare \u0026 \\cdots \\blacksquare \\blacksquare \\blacksquare \\bgroup\\color{red}{\\blacksquare}\\egroup\\blacksquare\\blacksquare \\cdots \\blacksquare \u0026 \u0026 \\\\\n\u0026 \\qquad \\quad \\space \\vdots \\qquad \\quad \u0026   \u0026 \\\\\n\\square \u0026 \\cdots  \\square \\bgroup\\color{green}{\\blacksquare}\\egroup \\blacksquare \\blacksquare\\blacksquare\\blacksquare \\cdots \\blacksquare \u0026 \\leftarrow \u0026 \\space \\text{seg len} - 1\\\\\n\\square \u0026 \\cdots \\square \\square \\square \\square\\square \\square \\cdots \\square \u0026 \\leftarrow \u0026 \\space \\text{seg len} \\\\\n\u0026 \\qquad \\quad \\space \\vdots \\qquad \\quad \u0026   \u0026 \\\\\n\\end{align*}\n$$\n\n- $\\square$ represents empty orders with $0$ order id and normalized quantity. \n- $\\blacksquare$ represent orders where both the order id and the normalized quantity are non-zero.\n\n### Invariants\n\n1. the following configuration in the active area of the segments when all orders are drawn on a line should also not be allowed $\\cdots \\blacksquare\\square\\blacksquare \\cdots$, it should be proved that this cannot happen. We call these empty slots **holes**.\n2. If an order has an order id $0$ then its normalized quantity should also be $0$ (◧ is not allowed) and vice versa (◨ is not allowed)\n3. Orders are inserted/added at the end.\n4. Orders are matched based on their order id. The smaller order ids get matched first (FIFO).\n5. The last segment of an existing price node $p \\in T_{tid, s}$ has at least one non-empty order:\n\n    $$\n    \\cdots \\blacksquare \\cdots \\leftarrow \\text{seg len} - 1\n    $$\n\n    For the case of $3$ slots per segment the following cases are possible:\n\n    $$\n    \\begin{align}\n        \\blacksquare \\blacksquare   \\blacksquare    \u0026 \\leftarrow \\text{seg len} - 1         \\\\\n        \\square      \\blacksquare   \\blacksquare    \u0026 \\leftarrow \\text{seg len} - 1         \\\\\n        \\square      \\square        \\blacksquare    \u0026 \\leftarrow \\text{seg len} - 1         \\\\\n        \\blacksquare \\blacksquare   \\square         \u0026 \\leftarrow \\text{seg len} - 1 = o_t   \\\\\n        \\square      \\blacksquare   \\square         \u0026 \\leftarrow \\text{seg len} - 1 = o_t   \\\\\n        \\blacksquare \\square        \\square         \u0026 \\leftarrow \\text{seg len} - 1 = o_t   \\\\\n        \n    \\end{align}\n    $$\n\n\n6. The segment pointed to by $o_t$ (`tombstoneOffset`) if the price node exists $p \\in T_{tid, s}$ in the tree, then this segment would have at least one non-empty order:\n\n    $$\n    \\cdots \\blacksquare \\cdots \\leftarrow o_t\n    $$\n\n    For the case of $3$ slots per segment the following cases are possible:\n\n   $$\n    \\begin{align}\n        \\blacksquare \\blacksquare   \\blacksquare    \u0026 \\leftarrow o_t                        \\tag{1}\\\\\n        \\blacksquare \\blacksquare   \\square         \u0026 \\leftarrow o_t                        \\tag{2}\\\\\n        \\blacksquare \\square        \\square         \u0026 \\leftarrow o_t                        \\tag{3}\\\\\n        \\square      \\blacksquare   \\blacksquare    \u0026 \\leftarrow o_t = \\text{seg len} - 1   \\tag{4}\\\\\n        \\square      \\blacksquare   \\square         \u0026 \\leftarrow o_t = \\text{seg len} - 1   \\tag{5}\\\\\n        \\square      \\square        \\blacksquare    \u0026 \\leftarrow o_t = \\text{seg len} - 1   \\tag{6}\\\\\n    \\end{align}\n    $$\n\n7. For price nodes that do not belong to the tree $p\\notin T_{tid,s}$, we should have the following configuration:\n    $$\n    \\begin{align*}\n        \\square \\cdots \\square \\leftarrow o_t = \\text{seg len}\n    \\end{align*}\n    $$\n\n    ie. all the orders belonging to the segment pointed to by $o_t$, they should all be empty orders.\n\n8.  Either $o_t = 0$ or if $o_t \u003e 0$ all the slots before $o_t$ are empty slots:\n\n    $$\n    \\begin{align*}\n        \\vdots \u0026 \\\\\n        \\square \\square \\square    \u0026 \\\\\n        \\square \\square \\square    \u0026 \\leftarrow o_t - 1\n    \\end{align*}\n    $$\n\n9.  Orders belonging to segments pointed to by $k \\geq \\text{seg len}$ should all be empty orders (⚠️ unless there is a storage collision if $k$ is a  really big number). This is a more general invariant compared to Inv 8.:\n\n    $$\n    \\begin{align*}\n        \\square \\cdots \\square \\leftarrow k \\geq \\text{seg len}\n    \\end{align*}\n    $$\n10. The active orders in the price segments are arranged in a monotonically increasing fashion based on their order ids (this is a more stricted version of Inv 1.)\n\n| method | Inv 1. | Inv 2. | Inv 3. | Inv 4. | Inv 5. | Inv 6. | Inv 7. | Inv. 8 | Inv. 9 | Inv 10. |\n|-----------------------|---|---|---|---|---|---|---|---|---|---|\n| canceling orders      | ✅ | ✅ | N/A | N/A | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |\n| placing limit orders  | ✅ | ✅ | ✅ | N/A | ✅ | ✅ | N/A | ✅ | ✅ | ✅ |\n| matching orders       | | | N/A   | | | ❌ | | | | |\n\nThe ✅ above means that if the invariant was satisfied before calling the method, it will be satisfied after the call has been done (in some edge cases it would only mean the invariant is satisfied after the call has been done, but it might not be before the call for example at the very beginning.)\n\n- **canceling orders**: We should have $p \\in T_{tid,s}$ otherwise the call should fail. First the order's position in the price segment should be found using [`_find`](https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/SonicOrderBook.sol#L1006). The `_find` flow relies on the fact that there are no holes (inv 1.) in the price segments and orders are placed in a monotonically increasing fashion (Inv 10.). The invariant checks need to be performed for each branch in `_cancelOrder`:\n    ```solidity\n    if (isFinalSegment \u0026\u0026 isOnlyOrderInSegment) {\n        // branch A\n    } else {\n        // Branch B: this branch has many sub-branches\n        for (/* ... */) {\n            if (nextSlot == 0) {\n                // this branch should only be hit on the last segment,\n                // ie, when `currentOrNextSegment == segments.length - 1`\n                // one can add a require statement. 🟡\n            }\n        }\n\n        // Branch B1: `for` loop gets skipped (`absoluteSlotIndexToRemove == totalOrders`)\n        // Branch B2: `for` loop is entered   (`absoluteSlotIndexToRemove  \u003c totalOrders`)\n    }\n    ```\n\n    | method | Inv 1. | Inv 2. | Inv 3. | Inv 4. | Inv 5. | Inv 6. | Inv 7. | Inv. 8 | Inv. 9 | Inv 10. |\n    |-------------------------------|---|---|---|---|---|---|---|---|---|---|\n    | canceling orders (branch A)    | ✅ | ✅ | N/A | N/A | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |\n    | canceling orders (branch B1)   | ✅ | ✅ | N/A | N/A | ✅ | ✅ | N/A | ✅ | ✅ | ✅ |\n    | canceling orders (branch B2)   | ✅ | ✅ | N/A | N/A | ✅ | ✅ | N/A | ✅ | ✅ | ✅ |\n\n- **placing limit orders** (adding to the book): It is very important that:\n\n    1. `_tokenIdInfos[order.tokenId].minQuantity` $q_{min}^{tid} \\neq 0$. When an admin makes a token id $tid$ tradable [it has been checked](https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/libraries/SonicOrderBookLibrary.sol#L55-L57) that $\\Delta q | q_{min}^{tid}$ and $\\Delta q \\leq q_{min}^{tid}$.\n    2. $q_o$ `order.quantity` is quantised by $\\Delta q$ and is non-zero. This has been checked.\n    3. `quantityFulfilled` $q_f$ is also quantised by $\\Delta q$. This can be proved by induction/recursion in `_parseOrder`.\n\n    And thus one can deduce that in the branch where `_addToBook(...)` is called, `quantityRemaining` $q_r$ is also quantised by $\\Delta q$ and is non-zero.\n\n    This is very important as it would guarantee one would not add slots to the price segment with a non-zero order id but with $0$ quantised/normalised quantities, ie adding a slot of the form $(0, i)$ should not be possible as this would break (Inv 2.).\n\n    ```solidity\n    _addOrderToEndOfSegments(...) private {\n        if (segments.length != 0) {\n            if (lastSegmentIndex \u003e= node.tombstoneSegmentOffset) {\n                // Branch A: If there is space at the end of last segment\n                //           and if this last segment is in the active aread of the price segment\n                //           add the order slot here and `return`\n            }\n        }\n\n        // Branch B: push a new segment [(0,0), (0,0), (qn, oid)] to price segment\n        //           as the last segment is full.\n        bytes32 segment = SlotLibrary.createSlotAsBytes32(orderId, normalizedQuantity);\n        segments.push(segment);\n    }\n    ```\n\n    | method | Inv 1. | Inv 2. | Inv 3. | Inv 4. | Inv 5. | Inv 6. | Inv 7. | Inv. 8 | Inv. 9 | Inv 10. |\n    |-----------------------------------|---|---|---|---|---|---|---|---|---|---|\n    | placing limit orders (branch A)   | ✅ | ✅ | ✅ | N/A | ✅ | ✅ | N/A | ✅ | ✅ | ✅ |\n    | placing limit orders (branch B)   | ✅ | ✅ | ✅ | N/A | ✅ | ✅ | N/A | ✅ | ✅ | ✅ |\n\n\n- **matching orders**: If the last segment is not deleted but all its orders get consumed, this last segment is not popped out instead just set to `bytes32(0)` $\\square \\square \\square$ ([ref](https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/SonicOrderBook.sol#L948-L950)).\n\nThe invariants broken ❌ \n\n## Recommendation\n\nInvariant checks after applying the suggested patches:\n\n| method | Inv 1. | Inv 2. | Inv 3. | Inv 4. | Inv 5. | Inv 6. | Inv 7. | Inv. 8 | Inv. 9 | Inv 10. |\n|-----------------------|---|---|---|---|---|---|---|---|---|---|\n| canceling orders      | ✅ | ✅ | N/A | N/A | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |\n| placing limit orders  | ✅ | ✅ | ✅ | N/A | ✅ | ✅ | N/A | ✅ | ✅ | ✅ |\n| matching orders       | | ✅ | N/A   | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |\n\n### matching orders\n\nThe fix for [#Finding #4](https://cantina.xyz/code/533c3043-fa7a-4275-8bae-e2313e1b5d18/findings?finding=4) needs to be applied as well is:\n\n#### Inv 6.\n\nCurrently the Inv 6. is broken, apply the patch below to fix:\n\n\u003cdetails\u003e\u003csummary\u003e📝 Click here to view patch\u003c/summary\u003e\n\n```diff\ndiff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol\nindex 31b5486..e690a23 100644\n--- a/contracts/SonicOrderBook.sol\n+++ b/contracts/SonicOrderBook.sol\n@@ -108,6 +108,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n   error SellMustUseExactQuantity();\n   error MakerPriceMustMatch(uint256 expectedPrice, uint256 actualPrice);\n \n+  // Errors related to price segment invariants being broken\n+  error PriceSegmentHasAHole();\n+  error IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset();\n+\n   enum OrderSide {\n     Buy,\n     Sell\n@@ -915,39 +919,126 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 lastSegmentIndex,\n     uint256 numOrdersFullyConsumed\n   ) private {\n+    // `segments.length \u003e lastSegmentIndex \u003e= oldTombstoneOffset`\n+    // `numOrdersFullyConsumed` should be the number of order slots fully consumed\n+    // yet not modified but the cursor passed over it to the next order slot.\n+\n+    // Assumptions:\n+    //    1. `numSegmentsFullyConsumed` is calculated correctly, it should be the number of\n+    //       slots fully consumed or skipped if the slot was EMPTY (0)\n+    //    2. `lastSegmentIndex` points to the last segment consumed\n+    //    3. `lastSegment` is the segment pointed to by `lastSegmentIndex`\n+\n+    // [CHECK LIST] One should enforce the following for `lastSegment` (the last segment consumed):\n+    // (o: an EMPTY slot, x: a non-EMPTY slot)\n+    //\n+    // o o o - last consumed segment - ALLOWED (only if the price node gets removed from the tree)\n+    // o o x - last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+    // o x o - last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+    // o x x - last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+    // x o o - last consumed segment - ALLOWED (check `ot` point to this slot too)\n+    // x o x - last consumed segment - CATCH - no hole in the middle allowed\n+    // x x o - last consumed segment - ALLOWED (check `ot` point to this slot too)\n+    // x x x - last consumed segment - ALLOWED\n+\n     uint256 numSegmentsFullyConsumed = numOrdersFullyConsumed / NUM_SLOTS_PER_SEGMENT;\n-    uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n+    uint256 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n+    uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n \n-    uint56 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n-    if (numSegmentsFullyConsumed != 0) {\n-      // Cleanup segments to get a gas refund\n-      for (uint256 i = 0; i \u003c numSegmentsFullyConsumed; ++i) {\n-        delete segments[oldTombstoneOffset + i];\n-      }\n+    if (lastSegmentIndex == newTombstoneSegmentOffset) {\n+      // At this branch we know `segments.length \u003e lastSegmentIndex \u003e= newTombstoneSegmentOffset`\n+      uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n+      lastSegment = lastSegment.clearUpToSlot(numOrdersWithinLastSegmentFullyConsumed);\n \n-      uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n-      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n+      if (uint256(lastSegment) == 0) {\n+        // `lastSegment` has this property/assumption that either:\n+        // A1. An other was partially matched in this segment or\n+        // A2. We had reached the last segment in the active area of the price segments which\n+        //     has some zero slots (`if (remainingSegment == 0)` branch in `_consumePriceSegments`)\n+        //\n+        // Moreover, there is an assumption here that if `lastSegment` that was touched during the\n+        // matching/filling process ends up being `0` then that would mean, there are no orders\n+        // left in the price segments since A1 would not be possible and so for A2:\n+        // 1. any order slot before this segment should have been fully filled/matched and thus\n+        //    should have been zeroed out in the previous `if (numSegmentsFullyConsumed != 0)`\n+        //    block.\n+        // 2. There could not be any non-zero order slot past this segment since otherwise,\n+        //    that would indicate there would have been holes in the price segments previously\n+        //    breaking (Inv 1.)\n+        newTombstoneSegmentOffset = lastSegmentIndex + 1;\n+        // so we would have:\n+        // `segments.length \u003e= newTombstoneSegmentOffset == lastSegmentIndex + 1`\n+        // `newTombstoneSegmentOffset == lastSegmentIndex + 1 \u003e oldTombstoneOffset`\n+        // thus below `lastSegment` shuold get deleted\n+\n+        // o o o - last consumed segment - ALLOWED - it will get deleted and the new tombstone offset\n+        //                                           points to the following segment\n+\n+        // The checks from the [CHECK LIST] are not required since if one hits this branch and continue\n+        // without reverting, the last segment consumed would be removed from the price segments\n+        // and the new tombstone offset would point to the following segment.\n+      } else {\n+        // At this branch we know `segments.length \u003e lastSegmentIndex \u003e= newTombstoneSegmentOffset`\n+        // and `lastSegment` is non-zero, so at the end `bestPrice` would not get removed from the `tree`\n \n-      // Consumed all orders at this price level, so remove it from the tree\n-      if (newTombstoneSegmentOffset == segments.length) {\n-        tree.remove(bestPrice);\n-      }\n-    }\n \n-    bool lastSegmentDeleted = lastSegmentIndex \u003c (oldTombstoneOffset + numSegmentsFullyConsumed);\n-    if (!lastSegmentDeleted) {\n-      if (numOrdersWithinLastSegmentFullyConsumed != 0) {\n-        for (uint256 i; i \u003c numOrdersWithinLastSegmentFullyConsumed; ++i) {\n-          lastSegment = lastSegment.clearSlot(i);\n+        // s2 s1 s0 : cs(bits) : lastSegment \u003c-- (lastSegmentIndex == newTombstoneSegmentOffset)\n+        // --------------------------------(si: the `i`th slot, cs: compressed status)-------\n+        //  o  o  o :      111 : last consumed segment - ALLOWED (only if the price node gets removed from the tree)\n+        //  o  o  x :      110 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+        //  o  x  o :      101 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+        //  o  x  x :      100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+        //  x  o  o :      011 : last consumed segment - ALLOWED (check `ot` point to this slot too)\n+        //  x  o  x :      010 : last consumed segment - CATCH - no hole in the middle allowed\n+        //  x  x  o :      001 : last consumed segment - ALLOWED (check `ot` point to this slot too)\n+        //  x  x  x :      000 : last consumed segment - ALLOWED\n+\n+        uint256 compressedStatus = lastSegment.compressedStatus();\n+\n+        //  o  o  o : 111 : one would not enter this branch for this case\n+\n+        //  x  o  x : 010 : last consumed segment - CATCH - no hole in the middle allowed\n+        require(compressedStatus != 2, PriceSegmentHasAHole());\n+\n+        if (compressedStatus \u003e 3) {\n+          //  o  x  x : 100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+          //  o  x  o : 101 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+          //  o  o  x : 110 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+          require(lastSegmentIndex == segments.length - 1, PriceSegmentHasAHole());\n         }\n-      }\n \n-      if (uint256(lastSegment) == 0) {\n-        // All orders in the last segment are consumed, delete from tree\n-        tree.remove(bestPrice);\n-        // Don't pop segment for gas efficiency, instead just write zeros\n+        segments[lastSegmentIndex] = lastSegment;\n       }\n-      segments[lastSegmentIndex] = lastSegment;\n+    } else {\n+      // if `lastSegmentIndex =/= newTombstoneSegmentOffset` that would mean the matching process had ended up\n+      // with ( - dashes the slot can be 0 or not, c means that it was consumed):\n+      // ...\n+      // x(c) -(c) -(c) : lastSegmentIndex\n+      // where in the last segment, the last slot was fully filled and thus we would end up with:\n+      // ...\n+      // x(c) -(c) -(c) : lastSegmentIndex\n+      //   -  -    -    : newTombstoneSegmentOffset\n+      // So these values can only be off by `1`\n+      require(lastSegmentIndex + 1 == newTombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset());\n+\n+      // The checks from the [CHECK LIST] are not required since if one hits this branch and continue\n+      // without reverting, the last segment consumed would be removed from the price segments\n+      // and the new tombstone offset would point to the following segment.\n+    }\n+\n+    // Cleanup segments to get a gas refund\n+    for (uint256 i = oldTombstoneOffset; i \u003c newTombstoneSegmentOffset; ++i) {\n+      delete segments[i];\n+    }\n+\n+    if (newTombstoneSegmentOffset != oldTombstoneOffset) {\n+      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n+    }\n+\n+    // below one can add an extra branch for `newTombstoneSegmentOffset \u003e segments.length`\n+    // and possibly revert since that would mean some invariant was broken.\n+    if (newTombstoneSegmentOffset \u003e= segments.length) {\n+      tree.remove(bestPrice);\n     }\n   }\n \ndiff --git a/contracts/libraries/SegmentLibrary.sol b/contracts/libraries/SegmentLibrary.sol\nindex d884717..e7c91a2 100644\n--- a/contracts/libraries/SegmentLibrary.sol\n+++ b/contracts/libraries/SegmentLibrary.sol\n@@ -43,6 +43,39 @@ library SegmentLibrary {\n     return bytes10(uint80((uint256(segment) \u003e\u003e (slotIndex * SEGMENT_SIZE)) \u0026 SEGMENT_MASK));\n   }\n \n+  /// @notice Compresses the segment into 3 indicator bits\n+  /// @param segment The segment to read from\n+  /// @return status with only 3 bits sets each indicating whether the corresponding\n+  //                 slot in the segment is EMPTY or not.\n+  function compressedStatus(bytes32 segment) internal pure returns (uint256 status) {\n+    uint256 MASK = SEGMENT_MASK;\n+    uint256 SIZE = SEGMENT_SIZE;\n+\n+    assembly (\"memory-safe\") {\n+      // s2 s1 s0 : segment\n+      status := iszero(and(segment, MASK))\n+      segment := shr(SIZE, segment)\n+\n+      //  0 s2 s1 : segment\n+      status := or(\n+        shl(1, iszero(and(segment, MASK))),\n+        status\n+      )\n+      segment := shr(SIZE, segment)\n+\n+      //  0  0 s2 : segment\n+      status := or(\n+        shl(2, iszero(and(segment, MASK))), // still mask in case segment has dirty uppper bits\n+        status\n+      )\n+\n+      // b2 b1 b0 : status bits (it would only have 3 set bits)\n+      // b2       : is 1 if s2 the 3rd slot of original segment was EMPTY\n+      //    b1    : is 1 if s1 the 2nd slot of original segment was EMPTY\n+      //       b0 : is 1 if s0 the 1st slot of original segment was EMPTY\n+    }\n+  }\n+\n   /// @notice Checks if the segment only contains data in the specified slot\n   /// @dev Returns true if all other slots in the segment are empty (zero)\n   /// @param segment The segment to check\n@@ -60,6 +93,19 @@ library SegmentLibrary {\n     return bytes32(uint256(segment) \u0026 ~(uint256(SEGMENT_MASK) \u003c\u003c (slotIndex * SEGMENT_SIZE)));\n   }\n \n+  /// @notice Clears slots up to the specified index, setting all its bits to zero\n+  /// @param segment The segment to modify\n+  /// @param slotIndex The index of the slot to clear up to (0, 1, or 2)\n+  /// @return newSegment The updated segment with the right most slots cleared up to `slotIndex`\n+  function clearUpToSlot(bytes32 segment, uint256 slotIndex) internal pure returns (bytes32 newSegment) {\n+    if (slotIndex == 0) {\n+      return segment;\n+    }\n+\n+    uint256 shiftAmount = slotIndex * SEGMENT_SIZE;\n+    return bytes32((uint256(segment) \u003e\u003e (shiftAmount)) \u003c\u003c shiftAmount);\n+  }\n+\n   /// @notice Returns the remaining segment data after the specified slot index\n   /// @dev Shifts the segment right to remove all slots up to and including the specified index.\n   ///      Useful for iterating through higher-indexed slots or processing remaining data.\n\n```\n\n\u003c/details\u003e\n\nThis patch makes reasoning about other invariants easier due to the modification for `_updateSegmentsAndTree`.\n\n\n\u003cdetails\u003e\n\u003csummary\u003eModifications of \u003ccode\u003e_updateSegmentsAndTree\u003c/code\u003e with comments removed\u003c/summary\u003e\n\n```solidity\n  function _updateSegmentsAndTree(\n    BokkyPooBahsRedBlackTreeLibrary.Tree storage tree,\n    BokkyPooBahsRedBlackTreeLibrary.Node storage bestPriceNode,\n    bytes32[] storage segments,\n    uint64 bestPrice,\n    bytes32 lastSegment,\n    uint256 lastSegmentIndex,\n    uint256 numOrdersFullyConsumed\n  ) private {\n\n    uint256 numSegmentsFullyConsumed = numOrdersFullyConsumed / NUM_SLOTS_PER_SEGMENT;\n    uint256 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n    uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n\n    if (lastSegmentIndex == newTombstoneSegmentOffset) {\n      uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n      lastSegment = lastSegment.clearUpToSlot(numOrdersWithinLastSegmentFullyConsumed);\n\n      if (uint256(lastSegment) == 0) {\n        newTombstoneSegmentOffset = lastSegmentIndex + 1;\n      } else {\n        uint256 compressedStatus = lastSegment.compressedStatus();\n        require(compressedStatus != 2, PriceSegmentHasAHole());\n        if (compressedStatus \u003e 3) {\n          require(lastSegmentIndex == segments.length - 1, PriceSegmentHasAHole());\n        }\n\n        segments[lastSegmentIndex] = lastSegment;\n      }\n    } else {\n      require(lastSegmentIndex + 1 == newTombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset());\n    }\n\n    for (uint256 i = oldTombstoneOffset; i \u003c newTombstoneSegmentOffset; ++i) {\n      delete segments[i];\n    }\n\n    if (newTombstoneSegmentOffset != oldTombstoneOffset) {\n      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n    }\n\n    if (newTombstoneSegmentOffset \u003e= segments.length) {\n      tree.remove(bestPrice);\n    }\n  }\n```\n\n\u003c/details\u003e\n\n```solidity\n  function _updateSegmentsAndTree(...) private {\n    // ...\n    if (lastSegmentIndex == newTombstoneSegmentOffset) {\n      // ...\n      if (uint256(lastSegment) == 0) {\n        // ...\n        newTombstoneSegmentOffset = lastSegmentIndex + 1;\n        // Branch A\n      } else {\n        // ...\n        segments[lastSegmentIndex] = lastSegment;\n        // Branch B\n      }\n    } else {\n      require(lastSegmentIndex + 1 == newTombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset());\n      // Branch C\n    }\n\n    // ...\n  }\n```\n\n| method | Inv 1. | Inv 2. | Inv 3. | Inv 4. | Inv 5. | Inv 6. | Inv 7. | Inv. 8 | Inv. 9 | Inv 10. |\n|-----------------------|---|---|---|---|---|---|---|---|---|---|\n| matching orders (patch above) Branch A  | 🌓 | ✅ | N/A | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |\n| matching orders (patch above) Branch B  | 🌓 | 🌓 | N/A | ✅ | ✅ | ✅ | N/A | ✅ | ✅ | ✅ |\n| matching orders (patch above) Branch C  | 🌓 | ✅ | N/A | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |\n\n- 🌓 (Branch A, Inv 1.): If the a hole was about to get introduced it will be ignored. The final price segment would not end up having a hole.\n- 🌓 (Branch C, Inv 1.): If the a hole was about to get introduced it will be ignored. The final price segment would not end up having a hole.\n- 🌓 (Branch B, Inv 1.): If the a hole was about to get introduced it will be ignored the transaction would revert with `PriceSegmentHasAHole()`. One still need to check the upstream flow in `_consumePriceSegments --\u003e loops --\u003e _parseOrder` to make sure one would not hit error. The upside is the new approach would prevent price segmements having holes and in case of an error one needs to check the upstream logic.\n\n1. One can prove that `_parseOrder` preserves the compressed status (ie the shape) of a segment and thus througout the loops in `_consumePriceSegments` up to the point were one enters `_updateSegmentsAndTree` the compressed status (the shape) if the price segment stays the same. Thus the shapes used for invariants 1, 2, 5, 6, 8, 9 are not modified while parsing through the price segment slots.\n\n2. In this whole flow it is important that once one partially matches a slot, the loops should terminate and the paramters `numOrdersFullyConsumed`, `segment` and `lastConsumedSegmentIndex` should not change after this point on (🚨).\n\n    Checking and proving the above points 1. and 2. should prove that **invariant 1** is satisfied for the matching order flow (before and after jumping in `_updateSegmentsAndTree`).\n\n- 🌓 (Branch B, Inv 2.): `_parseOrder` needs to be verified to not break this invariant. It has already been checked that the slot being parsed in `_parseOrder` has a non-zero `orderId` before `_parseOrder` gets called. So we just need to make sure the normalised quantity does not end up being $0$ for this slot (✅ proof below).\n\n##### Case 1. budget-constrained buy market orders\n\n$$\n(0 \u003c q_n) \\land (c_r \u003c \\left\\lfloor \\frac{q_n \\cdot \\Delta q \\cdot p_b}{10^d} \\right\\rfloor)\n\\Rightarrow \nq_n - \\left\\lfloor \\frac{\n    \\left\\lfloor \\frac{c_r \\cdot 10^{d}}{p_b} \\right\\rfloor\n}{\\Delta q} \\right\\rfloor \u003e 0\n$$\n\nOne can prove:\n\n$$\n0 \\leq \n\\left(\\frac{10^d}{\\Delta q \\cdot p_b}\\right)\\epsilon_0 +\n\\left(\\frac{1}{\\Delta q}\\right)\\epsilon_1 +\n\\epsilon_2 \u003c\n\nq_n - \\left\\lfloor \\frac{\n    \\left\\lfloor \\frac{c_r \\cdot 10^{d}}{p_b} \\right\\rfloor\n}{\\Delta q} \\right\\rfloor\n$$\n\nwhere $\\epsilon_0, \\epsilon_1, \\epsilon_2 \\in [0,1)$\n\n##### case 2. all other cases\n\nThis is obvious based on `if`/`else` branch conditions.\n\n\n### canceling orders\n\nApplying the recommendation in [Finding #1](https://cantina.xyz/code/533c3043-fa7a-4275-8bae-e2313e1b5d18/findings?finding=1) is recommended.\n\n## Summary\n\nApply the following patch. This would cover the changes required for:\n\n- Finding 1\n- Finding 2\n- Finding 3\n- Finding 5 (make sure price ticks are multiple of 100)\n- Finding 6 (patch above plus some improvements)\n- Finding 7 (order cancelation flow checks, order addition checks needs another patch)\n\n\u003cdetails\u003e\n\u003csummary\u003e📝 Click here to view the patch.\u003c/summary\u003e\n\n```diff\ndiff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol\nindex 31b5486..cd40406 100644\n--- a/contracts/SonicOrderBook.sol\n+++ b/contracts/SonicOrderBook.sol\n@@ -108,6 +108,12 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n   error SellMustUseExactQuantity();\n   error MakerPriceMustMatch(uint256 expectedPrice, uint256 actualPrice);\n \n+  // Errors related to price segment invariants being broken\n+  error PriceSegmentHasAHole();\n+  error IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset();\n+  error LastPriceSegmentCannotBeEmpty();\n+  error OnlyTheTombstoneSegmentCanStartWithEmptySlots();\n+\n   enum OrderSide {\n     Buy,\n     Sell\n@@ -158,7 +164,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 currentCost;\n     uint256 fee;\n     uint256 numberOfOrdersTraded;\n-    bool isBudgetConstrainedBuyingLimitReached;\n+    bool stopConsumingMoreOrders;\n   }\n \n   // A helper type for a view function to return orders. Packing doesn't matter\n@@ -681,7 +687,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n   }\n \n   function _shouldTakeMoreFromOrderBook(TakeFromOrderBookParams memory params) internal pure returns (bool) {\n-    if (params.isBudgetConstrainedBuyingLimitReached) {\n+    if (params.stopConsumingMoreOrders) {\n       return false;\n     }\n \n@@ -773,7 +779,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 lastConsumedSegmentIndex;\n     uint16 devFeeTakerBps = _devFeeTakerBps;\n \n-    for (uint256 i = node.tombstoneSegmentOffset; i \u003c segments.length \u0026\u0026 _shouldTakeMoreFromOrderBook(params); ++i) {\n+    uint256 segmentsLength = segments.length;\n+    uint256 tombstoneSegmentOffset = node.tombstoneSegmentOffset;\n+\n+    for (uint256 i = tombstoneSegmentOffset; i \u003c segmentsLength \u0026\u0026 _shouldTakeMoreFromOrderBook(params); ++i) {\n       lastConsumedSegmentIndex = i;\n       segment = segments[i];\n \n@@ -786,15 +795,67 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         bytes32 remainingSegment = segment.getRemainingSegment(slotIndex);\n         if (remainingSegment == 0) {\n           // Should only hit this branch on the last segment\n+\n+          // but if for some reason we hit this branch before\n+          // the last segment we add the count of slots skipped\n+          if (i \u003c segmentsLength - 1) {\n+            // This branch which should not be reachable\n+            revert PriceSegmentHasAHole();\n+          } else {\n+            // we are processing the last price segment in this branch\n+            // the possibilities are (o: an empty slot, s: slotIndex):\n+            // o    o    o(s) - BAD\n+            // o    o(s) ...  - skip incrementing `numOrdersFullyConsumed`\n+            // o(s) ...  ...  - skip incrementing `numOrdersFullyConsumed`\n+            if (slotIndex == 0) {\n+              // This branch which should not be reachable\n+              // the last segment in the active area of the price segment\n+              // only has empty slots\n+              // o    o    o(s) - BAD\n+              revert LastPriceSegmentCannotBeEmpty();\n+            }\n+          }\n+\n           break;\n         }\n \n         bytes10 slot = segment.getSlot(slotIndex);\n         uint48 orderId = slot.getOrderId();\n         if (orderId == 0) {\n-          // Skip this order in the segment as it's been deleted\n-          ++numOrdersFullyConsumed;\n-          continue;\n+          // we should only hit this branch at the very beginning of the\n+          // active area of the price segment pointed to by the `tombstoneSegmentOffset`\n+          // Possible configurations of this segment should be of the form:\n+          // (o: an empty slot, x: a non empty slot, s: slotIndex, ot = tombstoneSegmentOffset)\n+          // x o    o(s)  \u003c-- (i === ot) - allowed\n+          // x o(s) o     \u003c-- (i === ot) - allowed\n+          // x x    o(s)  \u003c-- (i === ot) - allowed\n+          //\n+          // x o    o(s)  \u003c-- (i =/= ot) - BAD\n+          // x o(s) o     \u003c-- (i =/= ot) - BAD\n+          // x x    o(s)  \u003c-- (i =/= ot) - BAD\n+          // x o(s) x     \u003c-- (i  \u003e= ot) - BAD\n+\n+          if (i == tombstoneSegmentOffset) {\n+            // x o    o(s)  \u003c-- (i === ot) - allowed\n+            // x o(s) o     \u003c-- (i === ot) - allowed\n+            // x x    o(s)  \u003c-- (i === ot) - allowed\n+            //\n+            // @dev we are allowing this potentially unreachable state below to pass through\n+            //      and just increment `numOrdersFullyConsumed`\n+            // x o(s) x     \u003c-- (i  == ot) - BAD\n+\n+            // Skip this order in the segment as it's been deleted\n+            ++numOrdersFullyConsumed;\n+            continue;\n+          } else {\n+            // this branch should be unreachable if all invariants are satisfied\n+            // x o    o(s)  \u003c-- (i =/= ot) - BAD\n+            // x o(s) o     \u003c-- (i =/= ot) - BAD\n+            // x x    o(s)  \u003c-- (i =/= ot) - BAD\n+            // x o(s) x     \u003c-- (i =/= ot) - BAD\n+\n+            revert OnlyTheTombstoneSegmentCanStartWithEmptySlots();\n+          }\n         }\n \n         uint256 ordersConsumed = 0;\n@@ -836,13 +897,13 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n       uint256 remainingBudget = params.maxCost - params.currentCost;\n \n       if (fullOrderCost \u003e remainingBudget) {\n+        // // Can't afford a full order, stop here as the slot will be potentially partially touched.\n+        params.stopConsumingMoreOrders = true;\n         // Check if we can afford partial order\n         uint256 maxAffordableQuantity = (remainingBudget * BASE_DECIMAL_DIVISOR) / params.bestPrice;\n         // Floor to QUANTITY_TICK to ensure proper alignment\n         maxAffordableQuantity = (maxAffordableQuantity / QUANTITY_TICK) * QUANTITY_TICK;\n         if (maxAffordableQuantity == 0) {\n-          // Can't afford any of this order, stop here\n-          params.isBudgetConstrainedBuyingLimitReached = true;\n           return (\n             segment,\n             0, // ordersConsumed\n@@ -880,6 +941,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         slot = slot.setQuantity(uint88(quantityL3 - quantityRemaining));\n         segment = segment.setSlot(slotIndex, slot);\n         quantityNFTClaimable = quantityRemaining;\n+        params.stopConsumingMoreOrders = true;\n       }\n \n       // at this point one should be able to prove that:\n@@ -915,39 +977,126 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 lastSegmentIndex,\n     uint256 numOrdersFullyConsumed\n   ) private {\n+    // `segments.length \u003e lastSegmentIndex \u003e= oldTombstoneOffset`\n+    // `numOrdersFullyConsumed` should be the number of order slots fully consumed\n+    // yet not modified but the cursor passed over it to the next order slot.\n+\n+    // Assumptions:\n+    //    1. `numSegmentsFullyConsumed` is calculated correctly, it should be the number of\n+    //       slots fully consumed or skipped if the slot was EMPTY (0)\n+    //    2. `lastSegmentIndex` points to the last segment consumed\n+    //    3. `lastSegment` is the segment pointed to by `lastSegmentIndex`\n+\n+    // [CHECK LIST] One should enforce the following for `lastSegment` (the last segment consumed):\n+    // (o: an EMPTY slot, x: a non-EMPTY slot)\n+    //\n+    // o o o - last consumed segment - ALLOWED (only if the price node gets removed from the tree)\n+    // o o x - last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+    // o x o - last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+    // o x x - last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+    // x o o - last consumed segment - ALLOWED (check `ot` point to this slot too)\n+    // x o x - last consumed segment - CATCH - no hole in the middle allowed\n+    // x x o - last consumed segment - ALLOWED (check `ot` point to this slot too)\n+    // x x x - last consumed segment - ALLOWED\n+\n     uint256 numSegmentsFullyConsumed = numOrdersFullyConsumed / NUM_SLOTS_PER_SEGMENT;\n-    uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n+    uint256 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n+    uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n \n-    uint56 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n-    if (numSegmentsFullyConsumed != 0) {\n-      // Cleanup segments to get a gas refund\n-      for (uint256 i = 0; i \u003c numSegmentsFullyConsumed; ++i) {\n-        delete segments[oldTombstoneOffset + i];\n-      }\n+    if (lastSegmentIndex == newTombstoneSegmentOffset) {\n+      // At this branch we know `segments.length \u003e lastSegmentIndex \u003e= newTombstoneSegmentOffset`\n+      uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n+      lastSegment = lastSegment.clearUpToSlot(numOrdersWithinLastSegmentFullyConsumed);\n \n-      uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n-      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n+      if (uint256(lastSegment) == 0) {\n+        // `lastSegment` has this property/assumption that either:\n+        // A1. An other was partially matched in this segment or\n+        // A2. We had reached the last segment in the active area of the price segments which\n+        //     has some zero slots (`if (remainingSegment == 0)` branch in `_consumePriceSegments`)\n+        //\n+        // Moreover, there is an assumption here that if `lastSegment` that was touched during the\n+        // matching/filling process ends up being `0` then that would mean, there are no orders\n+        // left in the price segments since A1 would not be possible and so for A2:\n+        // 1. any order slot before this segment should have been fully filled/matched and thus\n+        //    should have been zeroed out in the previous `if (numSegmentsFullyConsumed != 0)`\n+        //    block.\n+        // 2. There could not be any non-zero order slot past this segment since otherwise,\n+        //    that would indicate there would have been holes in the price segments previously\n+        //    breaking (Inv 1.)\n+        newTombstoneSegmentOffset = lastSegmentIndex + 1;\n+        // so we would have:\n+        // `segments.length \u003e= newTombstoneSegmentOffset == lastSegmentIndex + 1`\n+        // `newTombstoneSegmentOffset == lastSegmentIndex + 1 \u003e oldTombstoneOffset`\n+        // thus below `lastSegment` shuold get deleted\n+\n+        // o o o - last consumed segment - ALLOWED - it will get deleted and the new tombstone offset\n+        //                                           points to the following segment\n+\n+        // The checks from the [CHECK LIST] are not required since if one hits this branch and continue\n+        // without reverting, the last segment consumed would be removed from the price segments\n+        // and the new tombstone offset would point to the following segment.\n+      } else {\n+        // At this branch we know `segments.length \u003e lastSegmentIndex \u003e= newTombstoneSegmentOffset`\n+        // and `lastSegment` is non-zero, so at the end `bestPrice` would not get removed from the `tree`\n \n-      // Consumed all orders at this price level, so remove it from the tree\n-      if (newTombstoneSegmentOffset == segments.length) {\n-        tree.remove(bestPrice);\n-      }\n-    }\n \n-    bool lastSegmentDeleted = lastSegmentIndex \u003c (oldTombstoneOffset + numSegmentsFullyConsumed);\n-    if (!lastSegmentDeleted) {\n-      if (numOrdersWithinLastSegmentFullyConsumed != 0) {\n-        for (uint256 i; i \u003c numOrdersWithinLastSegmentFullyConsumed; ++i) {\n-          lastSegment = lastSegment.clearSlot(i);\n+        // s2 s1 s0 : cs(bits) : lastSegment \u003c-- (lastSegmentIndex == newTombstoneSegmentOffset)\n+        // --------------------------------(si: the `i`th slot, cs: compressed status)-------\n+        //  o  o  o :      111 : last consumed segment - ALLOWED (only if the price node gets removed from the tree)\n+        //  o  o  x :      110 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+        //  o  x  o :      101 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+        //  o  x  x :      100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+        //  x  o  o :      011 : last consumed segment - ALLOWED (check `ot` point to this slot too)\n+        //  x  o  x :      010 : last consumed segment - CATCH - no hole in the middle allowed\n+        //  x  x  o :      001 : last consumed segment - ALLOWED (check `ot` point to this slot too)\n+        //  x  x  x :      000 : last consumed segment - ALLOWED\n+\n+        uint256 compressedStatus = lastSegment.compressedStatus();\n+\n+        //  o  o  o : 111 : one would not enter this branch for this case\n+\n+        //  x  o  x : 010 : last consumed segment - CATCH - no hole in the middle allowed\n+        require(compressedStatus != 2, PriceSegmentHasAHole());\n+\n+        if (compressedStatus \u003e 3) {\n+          //  o  x  x : 100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+          //  o  x  o : 101 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+          //  o  o  x : 110 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+          require(lastSegmentIndex == segments.length - 1, PriceSegmentHasAHole());\n         }\n-      }\n \n-      if (uint256(lastSegment) == 0) {\n-        // All orders in the last segment are consumed, delete from tree\n-        tree.remove(bestPrice);\n-        // Don't pop segment for gas efficiency, instead just write zeros\n+        segments[lastSegmentIndex] = lastSegment;\n       }\n-      segments[lastSegmentIndex] = lastSegment;\n+    } else {\n+      // if `lastSegmentIndex =/= newTombstoneSegmentOffset` that would mean the matching process had ended up\n+      // with ( - dashes the slot can be 0 or not, c means that it was consumed):\n+      // ...\n+      // x(c) -(c) -(c) : lastSegmentIndex\n+      // where in the last segment, the last slot was fully filled and thus we would end up with:\n+      // ...\n+      // x(c) -(c) -(c) : lastSegmentIndex\n+      //   -  -    -    : newTombstoneSegmentOffset\n+      // So these values can only be off by `1`\n+      require(lastSegmentIndex + 1 == newTombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset());\n+\n+      // The checks from the [CHECK LIST] are not required since if one hits this branch and continue\n+      // without reverting, the last segment consumed would be removed from the price segments\n+      // and the new tombstone offset would point to the following segment.\n+    }\n+\n+    // Cleanup segments to get a gas refund\n+    for (uint256 i = oldTombstoneOffset; i \u003c newTombstoneSegmentOffset; ++i) {\n+      delete segments[i];\n+    }\n+\n+    if (newTombstoneSegmentOffset != oldTombstoneOffset) {\n+      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n+    }\n+\n+    // below one can add an extra branch for `newTombstoneSegmentOffset \u003e segments.length`\n+    // and possibly revert since that would mean some invariant was broken.\n+    if (newTombstoneSegmentOffset \u003e= segments.length) {\n+      tree.remove(bestPrice);\n     }\n   }\n \n@@ -1000,7 +1149,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     bytes32[] storage segments,\n     BokkyPooBahsRedBlackTreeLibrary.Tree storage tree\n   ) private returns (uint88 quantity) {\n-    BokkyPooBahsRedBlackTreeLibrary.Node storage node = tree.getNodeUnsafe(price);\n+    BokkyPooBahsRedBlackTreeLibrary.Node storage node = tree.getNode(price);\n     uint256 tombstoneSegmentOffset = node.tombstoneSegmentOffset;\n \n     (uint256 segmentIndex, uint256 slotIndex) = _find(segments, tombstoneSegmentOffset, segments.length, orderId);\n@@ -1058,7 +1207,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n       currentCost: 0,\n       fee: 0,\n       numberOfOrdersTraded: 0,\n-      isBudgetConstrainedBuyingLimitReached: false\n+      stopConsumingMoreOrders: false\n     });\n \n     _takeFromOrderBook(params, orderIdsPool, quantitiesPool, pricesPool);\n@@ -1105,7 +1254,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n       params.currentCost = 0;\n       params.fee = 0;\n       params.numberOfOrdersTraded = 0;\n-      params.isBudgetConstrainedBuyingLimitReached = false;\n+      params.stopConsumingMoreOrders = false;\n     }\n \n     _takeFromOrderBook(params, orderIdsPool, quantitiesPool, pricesPool);\n@@ -1409,6 +1558,17 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         bytes32 currentSegment = segments[currentSegmentIndex];\n         bytes10 nextSlot = currentOrNextSegment.getSlot(nextSlotIndex);\n         if (nextSlot == 0) {\n+          // When reaching a hole, make sure it has iterated to the last order.\n+\n+          // Must iterate to the last seg\n+          require(nextSegmentIndex == segments.length - 1, PriceSegmentHasAHole());\n+\n+          // nextSlot and subsequent slots must be empty\n+          require(currentOrNextSegment.getRemainingSegment(nextSlotIndex) == 0, PriceSegmentHasAHole());\n+\n+          // The last non-empty order must be in `seg[seg.len-1]` (`seg.len-1` cannot point to an empty segment).\n+          require(nextSlotIndex \u003e 0, LastPriceSegmentCannotBeEmpty());\n+\n           // There are no more orders left, reset back to the currently iterated order as the last\n           nextSegmentIndex = currentSegmentIndex;\n           nextSlotIndex = currentSlotIndex;\ndiff --git a/contracts/libraries/SegmentLibrary.sol b/contracts/libraries/SegmentLibrary.sol\nindex d884717..e7c91a2 100644\n--- a/contracts/libraries/SegmentLibrary.sol\n+++ b/contracts/libraries/SegmentLibrary.sol\n@@ -43,6 +43,39 @@ library SegmentLibrary {\n     return bytes10(uint80((uint256(segment) \u003e\u003e (slotIndex * SEGMENT_SIZE)) \u0026 SEGMENT_MASK));\n   }\n \n+  /// @notice Compresses the segment into 3 indicator bits\n+  /// @param segment The segment to read from\n+  /// @return status with only 3 bits sets each indicating whether the corresponding\n+  //                 slot in the segment is EMPTY or not.\n+  function compressedStatus(bytes32 segment) internal pure returns (uint256 status) {\n+    uint256 MASK = SEGMENT_MASK;\n+    uint256 SIZE = SEGMENT_SIZE;\n+\n+    assembly (\"memory-safe\") {\n+      // s2 s1 s0 : segment\n+      status := iszero(and(segment, MASK))\n+      segment := shr(SIZE, segment)\n+\n+      //  0 s2 s1 : segment\n+      status := or(\n+        shl(1, iszero(and(segment, MASK))),\n+        status\n+      )\n+      segment := shr(SIZE, segment)\n+\n+      //  0  0 s2 : segment\n+      status := or(\n+        shl(2, iszero(and(segment, MASK))), // still mask in case segment has dirty uppper bits\n+        status\n+      )\n+\n+      // b2 b1 b0 : status bits (it would only have 3 set bits)\n+      // b2       : is 1 if s2 the 3rd slot of original segment was EMPTY\n+      //    b1    : is 1 if s1 the 2nd slot of original segment was EMPTY\n+      //       b0 : is 1 if s0 the 1st slot of original segment was EMPTY\n+    }\n+  }\n+\n   /// @notice Checks if the segment only contains data in the specified slot\n   /// @dev Returns true if all other slots in the segment are empty (zero)\n   /// @param segment The segment to check\n@@ -60,6 +93,19 @@ library SegmentLibrary {\n     return bytes32(uint256(segment) \u0026 ~(uint256(SEGMENT_MASK) \u003c\u003c (slotIndex * SEGMENT_SIZE)));\n   }\n \n+  /// @notice Clears slots up to the specified index, setting all its bits to zero\n+  /// @param segment The segment to modify\n+  /// @param slotIndex The index of the slot to clear up to (0, 1, or 2)\n+  /// @return newSegment The updated segment with the right most slots cleared up to `slotIndex`\n+  function clearUpToSlot(bytes32 segment, uint256 slotIndex) internal pure returns (bytes32 newSegment) {\n+    if (slotIndex == 0) {\n+      return segment;\n+    }\n+\n+    uint256 shiftAmount = slotIndex * SEGMENT_SIZE;\n+    return bytes32((uint256(segment) \u003e\u003e (shiftAmount)) \u003c\u003c shiftAmount);\n+  }\n+\n   /// @notice Returns the remaining segment data after the specified slot index\n   /// @dev Shifts the segment right to remove all slots up to and including the specified index.\n   ///      Useful for iterating through higher-indexed slots or processing remaining data.\ndiff --git a/contracts/libraries/SonicOrderBookLibrary.sol b/contracts/libraries/SonicOrderBookLibrary.sol\nindex de229f7..08cd374 100644\n--- a/contracts/libraries/SonicOrderBookLibrary.sol\n+++ b/contracts/libraries/SonicOrderBookLibrary.sol\n@@ -31,6 +31,7 @@ library SonicOrderBookLibrary {\n   error DevFeeTooHigh();\n   error DevFeeNotSet();\n   error MaxOrdersNotMultipleOfOrdersInSegment();\n+  error PriceTickShouldBeAMutipleOf100();\n \n   uint256 private constant SET_TRADEABLE_THRESHOLD_LOCKED_BURN_TIME = 7 days;\n \n@@ -57,6 +58,7 @@ library SonicOrderBookLibrary {\n \n       require(existingTick == 0 || existingTick == newTick, PriceTickCannotBeChanged());\n       require(newTick != 0, PriceTickCannotBeZero());\n+      require(newTick % 100 == 0, PriceTickShouldBeAMutipleOf100());\n \n       SeasonData memory seasonData = nft.getSeasonData(Season(tokenId));\n       if (seasonData.startTime != 0 \u0026\u0026 tokenIdInfos[i].isTradeable) {\n```\n\u003c/detials\u003e\n"])</script><script>self.__next_f.push([1,"28:T5d9,## Description\n\nThe price `node` queries from the price `tree` uses the `getNodeUnsafe` which omits checking whether the price `node` belongs to the `tree`. Ommitting this check was added to save some gas during the cancellation process but creates big risk in terms of making assumptions about the structure of the price segments. The assumption is that if the price `node` did not belong the the `tree` then the `node`'s tombstone offset should be equal to greater than the price segments length:\n\n$$\no_t \\geq \\texttt{seg.len}\n$$\n\nThus when one calls `_find` the order should not be found and `type(uint256).max` should be returned for the segment and slot indexes, and so instead one would hit the custom error `OrderNotFound(orderId))` below:\n\n```solidity\nrequire(segmentIndex != type(uint).max, OrderNotFound(orderId));\n```\n\nOne is creating assumptions about distant parts of the codebase using an optimistic approach about supposed invariants.\n\n## Recommendation\n\nThis is a critical flow for orderbook and minimising assumptions to reduce the risk of accounting imbalances would be the recommended suggestion. Thus it would be best to revert back to the original logic of querying the `node` in a safe way:\n\n```solidity\nBokkyPooBahsRedBlackTreeLibrary.Node storage node = tree.getNode(price);\n```\n\nThus would make it harder to cancel a potentially malicious non-existent order and steal funds from the orderbook and it is a more defensive approach about safeguarding the contract balances.\n\n29:T1f68,"])</script><script>self.__next_f.push([1,"## Description\n\nThere are currently two main spots in `_consumePriceSegments` which makes certain assumptions about the structure of the price segments. Mainly:\n\n1. only the beginning of the active area of the price segments can have empty slots\n\n    $$\n    \\cdots\n    \\blacksquare \\square\\square \\stackrel{\\leftarrow}{\\cdots}\n    $$\n\n    which is assumed in the [snippet below](https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/SonicOrderBook.sol#L792-L798):\n\n    ```solidity\n    bytes10 slot = segment.getSlot(slotIndex);\n    uint48 orderId = slot.getOrderId();\n    if (orderId == 0) {\n       // Skip this order in the segment as it's been deleted\n       ++numOrdersFullyConsumed;\n       continue;\n    }\n    ```\n  \n\n\n2. only the end the of the active area of the price segments can have empty slots\n\n    $$\n    \\cdots \\square\\square \\blacksquare \\stackrel{\\leftarrow}{\\cdots}\n    $$\n\n    which is assumed in the [snippet below](https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/SonicOrderBook.sol#L786-L790):\n\n    ```solidity\n    bytes32 remainingSegment = segment.getRemainingSegment(slotIndex);\n    if (remainingSegment == 0) {\n       // Should only hit this branch on the last segment\n       break;\n    }\n    ```\n\n3. There are no holes / empty slots in the middle. Configurations like below should not be present:\n\n    $$\n    \\cdots \\blacksquare \\square \\blacksquare \\stackrel{\\leftarrow}{\\cdots} \\quad \\text{invariant is broken}\n    $$\n\n    In a presence of holes `numOrdersFullyConsumed` would not get updated correctly which eventually in `_updateSegmentsAndTree` would cause the price segment and tree get updated in correctly in the storage.\n\nie, if we lined up all the slots of the active area of the price segment it would look like:\n\n$$\n\\cdots \\square\\square \\blacksquare \\cdots \n\\blacksquare\\blacksquare \\cdots \\blacksquare\\blacksquare\n\\cdots\n\\blacksquare \\square\\square \\stackrel{\\leftarrow}{\\cdots}\n$$\n\nProving the above invariant as well as showing that the order ids of the non-empty slots $\\blacksquare$ increase monotonically involves many edge cases from different lines of the order book contract.  But this these are very important invariants and in case they get broken, many of the endpoints and storage updates would not act as intended or get modified correctly.\n\n\n## Recommendation\n\nIt would be best to add invariant checks to the `_consumePriceSegments` and make it less prone to malfunction in the presence of holes in price segments:\n\n```diff\ndiff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol\nindex 31b5486..13064b8 100644\n--- a/contracts/SonicOrderBook.sol\n+++ b/contracts/SonicOrderBook.sol\n@@ -108,6 +108,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n   error SellMustUseExactQuantity();\n   error MakerPriceMustMatch(uint256 expectedPrice, uint256 actualPrice);\n \n+  // Errors that indicate invariants are broken\n+  error LastPriceSegmentCannotBeEmpty();\n+  error OnlyTheTombstoneSegmentCanStartWithEmptySlots();\n+\n   enum OrderSide {\n     Buy,\n     Sell\n@@ -773,7 +777,9 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 lastConsumedSegmentIndex;\n     uint16 devFeeTakerBps = _devFeeTakerBps;\n \n-    for (uint256 i = node.tombstoneSegmentOffset; i \u003c segments.length \u0026\u0026 _shouldTakeMoreFromOrderBook(params); ++i) {\n+    uint256 segmentsLength = segments.length;\n+    uint256 tombstoneSegmentOffset = node.tombstoneSegmentOffset;\n+    for (uint256 i = tombstoneSegmentOffset; i \u003c segmentsLength \u0026\u0026 _shouldTakeMoreFromOrderBook(params); ++i) {\n       lastConsumedSegmentIndex = i;\n       segment = segments[i];\n \n@@ -786,15 +792,74 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         bytes32 remainingSegment = segment.getRemainingSegment(slotIndex);\n         if (remainingSegment == 0) {\n           // Should only hit this branch on the last segment\n+          // but if for some reason we hit this branch before\n+          // the last segment we add the count of slots skipped\n+          if (i \u003c segmentsLength - 1) {\n+            // This branch which should not be reachable\n+            // But if it does hit we can be proactive and skip the remaining slots\n+            // but still add them to `numOrdersFullyConsumed`\n+            // `s` is the `slotIndex` and `o` represent an empty slot:\n+            // o    o    o(s) - +3\n+            // o    o(s) ...  - +2\n+            // o(s) ...  ...  - +1\n+            //\n+            // @dev one can also decide to REVERT below instead of accounting for the\n+            //      holes (empty slots) in this scenario\n+            numOrdersFullyConsumed += NUM_SLOTS_PER_SEGMENT - slotIndex;\n+          } else {\n+            // we are processing the last price segment in this branch\n+            // the possibilities are (o: an empty slot, s: slotIndex):\n+            // o    o    o(s) - BAD\n+            // o    o(s) ...  - skip incrementing `numOrdersFullyConsumed`\n+            // o(s) ...  ...  - skip incrementing `numOrdersFullyConsumed`\n+            if (slotIndex == 0) {\n+              // This branch which should not be reachable\n+              // the last segment in the active area of the price segment\n+              // only has empty slots\n+              // o    o    o(s) - BAD\n+              revert LastPriceSegmentCannotBeEmpty();\n+            }\n+          }\n           break;\n         }\n \n         bytes10 slot = segment.getSlot(slotIndex);\n         uint48 orderId = slot.getOrderId();\n         if (orderId == 0) {\n-          // Skip this order in the segment as it's been deleted\n-          ++numOrdersFullyConsumed;\n-          continue;\n+          // we should only hit this branch at the very beginning of the\n+          // active area of the price segment pointed to by the `tombstoneSegmentOffset`\n+          // Possible configurations of this segment should be of the form:\n+          // (o: an empty slot, x: a non empty slot, s: slotIndex, ot = tombstoneSegmentOffset)\n+          // x o    o(s)  \u003c-- (i === ot) - allowed\n+          // x o(s) o     \u003c-- (i === ot) - allowed\n+          // x x    o(s)  \u003c-- (i === ot) - allowed\n+          //\n+          // x o    o(s)  \u003c-- (i =/= ot) - BAD\n+          // x o(s) o     \u003c-- (i =/= ot) - BAD\n+          // x x    o(s)  \u003c-- (i =/= ot) - BAD\n+          // x o(s) x     \u003c-- (i  \u003e= ot) - BAD\n+\n+          if (i == tombstoneSegmentOffset) {\n+            // x o    o(s)  \u003c-- (i === ot) - allowed\n+            // x o(s) o     \u003c-- (i === ot) - allowed\n+            // x x    o(s)  \u003c-- (i === ot) - allowed\n+            //\n+            // @dev we are allowing this potentially unreachable state below to pass through\n+            //      and just increment `numOrdersFullyConsumed`\n+            // x o(s) x     \u003c-- (i  == ot) - BAD\n+\n+            // Skip this order in the segment as it's been deleted\n+            ++numOrdersFullyConsumed;\n+            continue;\n+          } else {\n+            // this branch should be unreachable if all invariants are satisfied\n+            // x o    o(s)  \u003c-- (i =/= ot) - BAD\n+            // x o(s) o     \u003c-- (i =/= ot) - BAD\n+            // x x    o(s)  \u003c-- (i =/= ot) - BAD\n+            // x o(s) x     \u003c-- (i =/= ot) - BAD\n+\n+            revert OnlyTheTombstoneSegmentCanStartWithEmptySlots();\n+          }\n         }\n \n         uint256 ordersConsumed = 0;\n```\n\nIn the branch where on is performing:\n\n```solidity\nnumOrdersFullyConsumed += NUM_SLOTS_PER_SEGMENT - slotIndex;\n```\n\nOne can instead revert, since it would indicate the precense of holes. But the above make `_consumePriceSegments` hole-resistant (ie, in the presence of holes this function would not get broken and act as expected, although the other flows make suffer from the holes such as `_find` or `_cancelOrder`, ...). Another options would be to instead `revert` here:\n\n```solidity\nrevert PriceSegmentHasAHole();\n```\n\n"])</script><script>self.__next_f.push([1,"2a:Tcec,"])</script><script>self.__next_f.push([1,"## Description\n\nWhen a sell order is partially matched a few times the amount of quote tokens received by the orderbook would be:\n\n$$\n\\sum_{j} \\left\\lfloor \\frac{q_j \\cdot p_o}{10^d} \\right\\rfloor\n$$\n\nwhere $j$ iterates over the partial match events of one specific order $o$ and $p_o$ is the price for this order, $q_j$ are the partial quantities filled. $d$ is the decimal of the `NFT` contract which in this case would be $18$.\n\nWhen the user wants to claim these partial matches in [`_claimTokens`](https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L360-L383) and [`_calculateClaimableTokens`](https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L1314-L1334) the amount to be claimed and sent to the `maker` and the `dev` would be:\n\n$$\n\\left\\lfloor \\frac{(\\sum_j q_j) \\cdot p_o}{10^d} \\right\\rfloor\n$$\n\nBut we have:\n\n$$\n\\left\\lfloor \\frac{(\\sum_j q_j) \\cdot p_o}{10^d} \\right\\rfloor \\geq \\sum_{j} \\left\\lfloor \\frac{q_j \\cdot p_o}{10^d} \\right\\rfloor\n$$\n\nThus if these divisions are not exact, the orderbook would not have enough quote tokens to compensate for the claims.\n\n## Recommendation\n\nEither one needs to make sure the divisions are exact by setting restrictions on the `priceTicks` and quantity ticks to make sure their product would be division by $10^d$. Moreover one needs to throughout the codebase make sure that the invariant of \n\n1. prices being divisible by `priceTick`\n2. quantities being divisible by quantity tick\n\nto be satisfied.\n\nFor the above apply this patch:\n\n```diff\ndiff --git a/contracts/libraries/SonicOrderBookLibrary.sol b/contracts/libraries/SonicOrderBookLibrary.sol\nindex de229f7..08cd374 100644\n--- a/contracts/libraries/SonicOrderBookLibrary.sol\n+++ b/contracts/libraries/SonicOrderBookLibrary.sol\n@@ -31,6 +31,7 @@ library SonicOrderBookLibrary {\n   error DevFeeTooHigh();\n   error DevFeeNotSet();\n   error MaxOrdersNotMultipleOfOrdersInSegment();\n+  error PriceTickShouldBeAMultipleOf100();\n \n   uint256 private constant SET_TRADEABLE_THRESHOLD_LOCKED_BURN_TIME = 7 days;\n \n@@ -57,6 +58,7 @@ library SonicOrderBookLibrary {\n \n       require(existingTick == 0 || existingTick == newTick, PriceTickCannotBeChanged());\n       require(newTick != 0, PriceTickCannotBeZero());\n+      require(newTick % 100 == 0, PriceTickShouldBeAMultipleOf100());\n \n       SeasonData memory seasonData = nft.getSeasonData(Season(tokenId));\n       if (seasonData.startTime != 0 \u0026\u0026 tokenIdInfos[i].isTradeable) {\n```\n\nAnother solution would be to simply overestimate the case (this would not require checking for the above conditions at least for cost related issues). Overestimating would guarantee that for partially matching a specific order multiple times we would have:\n\n$$\n\\left\\lceil \\frac{(\\sum_j q_j) \\cdot p_o}{10^d} \\right\\rceil \\leq \\sum_{j} \\left\\lceil \\frac{q_j \\cdot p_o}{10^d} \\right\\rceil\n$$\n\nie, in this case the orderbook should have enough quote tokens to cover the cost of a maker whose sell orders get partially filled a few times.\n\nSo in summary:\n\n- overestimate the cost for matching into sell orders\n- underestimate the cost for matching into buy orders\n- overestimate the cost for placing buy limit orders\n\n\n\n"])</script><script>self.__next_f.push([1,"2b:Te6a,"])</script><script>self.__next_f.push([1,"## Description\n\nThe protocol modifies segments when adding/canceling/matching orders. \n\nWhen matching orders, [Finding #3](https://cantina.xyz/code/533c3043-fa7a-4275-8bae-e2313e1b5d18/findings/3) checks segments in `_consumePriceSegments()` to ensure that the segment state follows the invariant, and [Finding #6](https://cantina.xyz/code/533c3043-fa7a-4275-8bae-e2313e1b5d18/findings/6) also makes some assumption checks when modifying segments in `_updateSegmentsAndTree()`.\n\nFor adding/canceling orders, some invariant checks need to be added to ensure that the segment state is as expected.\n\nBelow are all cases of slots in the segment.\n```\n(1) o o o  BAD\n(2) o o x  ALLOW, holes Must be tail\n(3) o x o  ALLOW, holes Must be head\u0026tail\n(4) x o o  ALLOW, holes Must be head\n(5) o x x  ALLOW, holes Must be tail\n(6) x o x  BAD\n(7) x x o  ALLOW, holes Must be head\n(8) x x x  ALLOW, No holes\n```\n## Recommendation\nFor order additions.\n```diff\n@@ -1204,7 +1207,12 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         // Are there are free slots in this segment\n         for (uint256 slotIndex = 0; slotIndex \u003c NUM_SLOTS_PER_SEGMENT; ++slotIndex) {\n           bytes32 remainingSegment = lastSegment.getRemainingSegment(slotIndex);\n+          // o o o, o o x, o x x, o x o,\n           if (remainingSegment == 0) {\n+            // catch o o o\n+            require(slotIndex != 0, LastPriceSegmentCannotBeEmpty());\n+            // for o x o, must be head\n+            if(lastSegment.getSlot(0) == 0) require(lastSegmentIndex == node.tombstoneSegmentOffset, PriceSegmentHasAHole());\n             // Found free slot, so add this order to an existing segment\n             bytes10 slot = SlotLibrary.createSlot(orderId, normalizedQuantity);\n             bytes32 newSegment = lastSegment.setSlotUnsafe(slotIndex, slot);\n@@ -1212,6 +1220,18 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n             return;\n           }\n         }\n+        // slot2 is x, x o o, x x o, x o x, x x x\n+        // head\u0026tail, catch x o x, allow x o o , x x o, x x x\n+        if (lastSegmentIndex == node.tombstoneSegmentOffset) {\n+          if(lastSegment.getSlot(1) == 0) require(lastSegment.getSlot(0) == 0, PriceSegmentHasAHole());\n+        }\n+        // tail, must be x, x ,x\n+        if (lastSegmentIndex \u003e node.tombstoneSegmentOffset) {\n+          require(lastSegment.getSlot(0) != 0 \u0026\u0026 lastSegment.getSlot(1) != 0, PriceSegmentHasAHole());\n+        }\n+      } else {\n+        // ot is at most equal to seg.len\n+        require(lastSegmentIndex + 1 == node.tombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTombstoneOffset());\n       }\n     }\n\n```\n\nFor order cancellation.\n```diff\n@@ -1410,6 +1428,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         bytes10 nextSlot = currentOrNextSegment.getSlot(nextSlotIndex);\n         if (nextSlot == 0) {\n           // There are no more orders left, reset back to the currently iterated order as the last\n+          // When reaching a hole, make sure it has iterated to the last order.\n+          require(nextSegmentIndex == segments.length - 1, PriceSegmentHasAHole()); // Must iterate to the last seg\n+          require(currentOrNextSegment.getRemainingSegment(nextSlotIndex) == 0, PriceSegmentHasAHole()); // nextSlot and subsequent slots must be empty\n+          require(nextSlotIndex \u003e 0, LastPriceSegmentCannotBeEmpty()); // The last non-empty order must be in seg[seg.len-1](seg.len-1 cannot point to an empty segment).\n           nextSegmentIndex = currentSegmentIndex;\n           nextSlotIndex = currentSlotIndex;\n           break;\n```\n"])</script><script>self.__next_f.push([1,"47:T4a0,// if the order skipped after the partial order match was on the next segement\n// the value for `lastSegmentDeleted` would be `false`\nbool lastSegmentDeleted = lastSegmentIndex \u003c (oldTombstoneOffset + numSegmentsFullyConsumed);\nif (!lastSegmentDeleted) {\n    // `numOrdersWithinLastSegmentFullyConsumed` would be number of orders fully consumed\n    // in before querying the partial or skipped order. Might be the come from the \n    // segment the partial order was on or before\n    if (numOrdersWithinLastSegmentFullyConsumed != 0) {\n        for (uint256 i; i \u003c numOrdersWithinLastSegmentFullyConsumed; ++i) {\n            // potentailly wrong segment is updated, since the assumed fully \n            // matched orders might not be on the same segment as the\n            // last order which was skipped\n            lastSegment = lastSegment.clearSlot(i);\n        }\n    }\n\n    if (uint256(lastSegment) == 0) {\n        // All orders in the last segment are consumed, delete from tree\n        tree.remove(bestPrice);\n        // Don't pop segment for gas efficiency, instead just write zeros\n    }\n\n    // segments gets updated incorrectly\n    segments[lastSegmentIndex] = lastSegment;\n}\n48:T49f,// if the order skipped after the partial order match was on the next segement\n// the value for `lastSegmentDeleted` would be `false`\nbool lastSegmentDeleted = lastSegmentIndex \u003c (oldTombstoneOffset + numSegmentsFullyConsumed);\nif (!lastSegmentDeleted) {\n    // `numOrdersWithinLastSegmentFullyConsumed` would be number of orders fully consumed\n    // in before querying the partial or skipped order. Might be the come from the \n    // segment the partial order was on or before\n    if (numOrdersWithinLastSegmentFullyConsumed != 0) {\n        for (uint256 i; i \u003c numOrdersWithinLastSegmentFullyConsumed; ++i) {\n            // potentailly wrong segment is updated, since the assumed fully \n            // matched orders might not be on the same segment as the\n            // last order which was skipped\n            lastSegment = lastSegment.clearSl"])</script><script>self.__next_f.push([1,"ot(i);\n        }\n    }\n\n    if (uint256(lastSegment) == 0) {\n        // All orders in the last segment are consumed, delete from tree\n        tree.remove(bestPrice);\n        // Don't pop segment for gas efficiency, instead just write zeros\n    }\n\n    // segments gets updated incorrectly\n    segments[lastSegmentIndex] = lastSegment;\n}49:T4a0,// if the order skipped after the partial order match was on the next segement\n// the value for `lastSegmentDeleted` would be `false`\nbool lastSegmentDeleted = lastSegmentIndex \u003c (oldTombstoneOffset + numSegmentsFullyConsumed);\nif (!lastSegmentDeleted) {\n    // `numOrdersWithinLastSegmentFullyConsumed` would be number of orders fully consumed\n    // in before querying the partial or skipped order. Might be the come from the \n    // segment the partial order was on or before\n    if (numOrdersWithinLastSegmentFullyConsumed != 0) {\n        for (uint256 i; i \u003c numOrdersWithinLastSegmentFullyConsumed; ++i) {\n            // potentailly wrong segment is updated, since the assumed fully \n            // matched orders might not be on the same segment as the\n            // last order which was skipped\n            lastSegment = lastSegment.clearSlot(i);\n        }\n    }\n\n    if (uint256(lastSegment) == 0) {\n        // All orders in the last segment are consumed, delete from tree\n        tree.remove(bestPrice);\n        // Don't pop segment for gas efficiency, instead just write zeros\n    }\n\n    // segments gets updated incorrectly\n    segments[lastSegmentIndex] = lastSegment;\n}\n4a:T27c0,"])</script><script>self.__next_f.push([1,"import {loadFixture} from \"@nomicfoundation/hardhat-toolbox/network-helpers\";\nimport hre, {ethers, upgrades} from \"hardhat\";\nimport {expect} from \"chai\";\nimport {SonicOrderBook} from \"../../typechain-types\";\nimport {Order, OrderSide} from \"@paintswap/sonic-airdrop-definitions/types\";\nimport {deployContractsFixture, calcFees, ONE_ETHER, RETURN_WRAPPED_SONIC} from \"./utils\";\nimport {initializerSlot} from \"../utils\";\nimport {BigNumberish, Block} from \"ethers\";\nimport {deploySonicOrderBook, deploySonicOrderBookLibrary} from \"../../scripts/deployHelpers\";\nimport { HardhatEthersSigner } from \"@nomicfoundation/hardhat-ethers/signers\";\n\n// Uses a plain ERC20 token with 18 decimals\ndescribe(\"SonicOrderBook\", function () {\n  describe(\"Market orders with useExactQuantity: false\", function () {\n    describe(\"Budget-constrained buying\", function () {\n      async function setup() {\n        const {\n          sonicAirdropNFT,\n          wS,\n          sonicOrderBookLibrary,\n          quoteToken,\n          alice,\n          bob,\n          dev,\n          tokenId,\n          initialCoins,\n          maxOrdersPerPrice,\n          QUANTITY_TICK\n        } = await loadFixture(deployContractsFixture);\n\n        await quoteToken.connect(bob).mint(bob, initialCoins);\n\n        const orderBook = await deploySonicOrderBook(sonicAirdropNFT, quoteToken, wS, sonicOrderBookLibrary);\n        \n        // set approvals\n        await quoteToken.approve(orderBook, initialCoins);\n        await quoteToken.connect(alice).approve(orderBook, initialCoins);\n        await sonicAirdropNFT.setApprovalForAll(orderBook, true);\n        await sonicAirdropNFT.connect(alice).setApprovalForAll(orderBook, true);\n        await quoteToken.connect(bob).approve(orderBook, initialCoins);\n\n        const priceTick = 100n;\n        const minQuantity = 10n * QUANTITY_TICK;\n        const isTradeable = true;\n\n        const makerFeeBps = 40n; // 0.2% fee for makers\n        const takerFeeBps = 60n; // 0.3% fee for takers\n        await orderBook.setAdminVars(\n            dev,\n            makerFeeBps,\n            takerFeeBps,\n            maxOrdersPerPrice,\n            [tokenId],\n            [{priceTick, minQuantity, isTradeable}]\n        );\n\n        return {\n          orderBook,\n          quoteToken,\n          alice,\n          bob,\n          dev,\n          tokenId,\n          initialCoins,\n          maxOrdersPerPrice,\n          QUANTITY_TICK,\n          priceTick,\n          minQuantity\n        }\n      }\n\n      it(\"6 orders\", async function () {\n        const {\n          orderBook,\n          quoteToken,\n          alice,\n          bob,\n          tokenId,\n          maxOrdersPerPrice,\n          QUANTITY_TICK,\n          priceTick,\n          minQuantity\n        } = await loadFixture(setup);\n\n        const limitPrice = 4n * priceTick;\n        const quantity = minQuantity;\n        const totalOrders = 6;\n\n        await placeNLimitOrders(\n          orderBook,\n          alice,\n          totalOrders,\n          OrderSide.Sell,\n          tokenId,\n          limitPrice,\n          quantity,\n          true,\n          true\n        );\n\n        await logSegments(orderBook, OrderSide.Sell, tokenId, limitPrice, \"segments before calling placeMarketOrder :\");\n        \n        const nodeBefore = await orderBook.getNode(OrderSide.Sell, tokenId, limitPrice);\n        expect(nodeBefore.tombstoneSegmentOffset).to.be.equal(0);\n\n        const segmentsBefore = await getSegments(orderBook, OrderSide.Sell, tokenId, limitPrice);\n        expect(segmentsBefore[0]).to.be.equal(\"0x00000000000a0000000000030000000a0000000000020000000a000000000001\");\n        expect(segmentsBefore[1]).to.be.equal(\"0x00000000000a0000000000060000000a0000000000050000000a000000000004\");\n\n        // each order is worth 40, so in total with a budget of 101\n        // we should afford 2 full orders and a partial order (1/2 of an order)\n        // this would cost 100, the extra budget of 1 is here to make sure\n        // after we partially match the 3rd order we would not reach the `maxCost`\n        // so the loop would continue to trigger the bug\n        const budget = 101;\n        await orderBook.connect(bob).placeMarketOrder(\n          {\n            side: OrderSide.Buy,\n            tokenId,\n            totalCost: budget,\n            quantity: 0,\n            useExactQuantity: false\n          },\n          RETURN_WRAPPED_SONIC\n        );\n\n        await logSegments(orderBook, OrderSide.Sell, tokenId, limitPrice, \"segments after calling placeMarketOrder :\");\n\n        const nodeAfter = await orderBook.getNode(OrderSide.Sell, tokenId, limitPrice);\n        expect(nodeAfter.tombstoneSegmentOffset).to.be.equal(0);\n\n        const segmentsAfter= await getSegments(orderBook, OrderSide.Sell, tokenId, limitPrice);\n        expect(segmentsAfter[0]).to.be.equal(\"0x0000000000050000000000030000000000000000000000000000000000000000\");\n        expect(segmentsAfter[1]).to.be.equal(\"0x00000000000a0000000000060000000a0000000000050000000a000000000004\");\n\n      });\n\n      it(\"4 orders\", async function () {\n        const {\n          orderBook,\n          quoteToken,\n          alice,\n          bob,\n          tokenId,\n          maxOrdersPerPrice,\n          QUANTITY_TICK,\n          priceTick,\n          minQuantity\n        } = await loadFixture(setup);\n\n        const limitPrice = 4n * priceTick;\n        const quantity = minQuantity;\n        const totalOrders = 4;\n\n        await placeNLimitOrders(\n          orderBook,\n          alice,\n          totalOrders,\n          OrderSide.Sell,\n          tokenId,\n          limitPrice,\n          quantity,\n          true,\n          true\n        );\n\n        await logSegments(orderBook, OrderSide.Sell, tokenId, limitPrice, \"segments before calling placeMarketOrder :\");\n        \n        const nodeBefore = await orderBook.getNode(OrderSide.Sell, tokenId, limitPrice);\n        expect(nodeBefore.tombstoneSegmentOffset).to.be.equal(0);\n\n        const segmentsBefore = await getSegments(orderBook, OrderSide.Sell, tokenId, limitPrice);\n        expect(segmentsBefore[0]).to.be.equal(\"0x00000000000a0000000000030000000a0000000000020000000a000000000001\");\n        expect(segmentsBefore[1]).to.be.equal(\"0x000000000000000000000000000000000000000000000000000a000000000004\");\n\n        // each order is worth 40, so in total with a budget of 101\n        // we should afford 2 full orders and a partial order (1/2 of an order)\n        // this would cost 100, the extra budget of 1 is here to make sure\n        // after we partially match the 3rd order we would not reach the `maxCost`\n        // so the loop would continue to trigger the bug\n        const budget = 101;\n        await orderBook.connect(bob).placeMarketOrder(\n          {\n            side: OrderSide.Buy,\n            tokenId,\n            totalCost: budget,\n            quantity: 0,\n            useExactQuantity: false\n          },\n          RETURN_WRAPPED_SONIC\n        );\n\n        await logSegments(orderBook, OrderSide.Sell, tokenId, limitPrice, \"segments after calling placeMarketOrder :\");\n\n        const nodeAfter = await orderBook.getNode(OrderSide.Sell, tokenId, limitPrice);\n        expect(nodeAfter.tombstoneSegmentOffset).to.be.equal(0);\n\n        const segmentsAfter= await getSegments(orderBook, OrderSide.Sell, tokenId, limitPrice);\n        expect(segmentsAfter[0]).to.be.equal(\"0x0000000000050000000000030000000000000000000000000000000000000000\");\n        expect(segmentsAfter[1]).to.be.equal(\"0x000000000000000000000000000000000000000000000000000a000000000004\");\n      });\n    });\n  });\n\n  async function getNextOrderId(orderBook: SonicOrderBook) {\n    const nextOrderIdSlot = 0;\n    const packedSlot = await ethers.provider.getStorage(orderBook, nextOrderIdSlot);\n    return parseInt(packedSlot.slice(2, 14), 16);\n  }\n\n  async function placeNLimitOrders(\n    orderbook: SonicOrderBook,\n    user: HardhatEthersSigner,\n    totalOrders: number,\n    side: OrderSide,\n    tokenId: BigNumberish,\n    price: BigNumberish,\n    quantity: BigNumberish,\n    onlyPost: boolean,\n    onlyExactPriceIfMaker: boolean\n  ) {\n    for(let i = 0; i \u003c totalOrders; i++) {\n      await orderbook.connect(user).placeLimitOrders([\n        {\n          side: side,\n          tokenId: tokenId,\n          price: price,\n          quantity,\n          onlyPost: onlyPost,\n          onlyExactPriceIfMaker: onlyExactPriceIfMaker\n        }\n      ],\n        RETURN_WRAPPED_SONIC\n      );\n    }\n  }\n\n  async function logSegments(orderBook: SonicOrderBook, side: OrderSide, tokenId: BigNumberish, price: BigNumberish, message: string) {\n    const segmentsAfter = await getSegments(orderBook, side, tokenId, price);\n    console.log(message)\n    console.log(segmentsAfter);\n  }\n\n  async function getSegments(orderBook: SonicOrderBook, side: OrderSide, tokenId: BigNumberish, price: BigNumberish) {\n    // Storage slot assignments based on contract layout:\n    // slot 0: packed variables (_devAddr, _devFeeBps, _maxOrdersPerPrice, _nextOrderId)\n    // slot 1: _tokenIdInfos mapping\n    // slot 2: _asks mapping\n    // slot 3: _bids mapping\n    // slot 4: _asksAtPrice mapping\n    // slot 5: _bidsAtPrice mapping\n\n    const baseSlot = side === 0 ? 5 : 4; // 0 = Buy (bids), 1 = Sell (asks)\n\n    // Calculate slot for tokenId in the outer mapping\n    const tokenIdSlot = ethers.solidityPackedKeccak256([\"uint256\", \"uint256\"], [tokenId, baseSlot]);\n\n    // Calculate slot for price in the inner mapping\n    const priceSlot = ethers.solidityPackedKeccak256([\"uint256\", \"bytes32\"], [price, tokenIdSlot]);\n\n    // Read array length from the calculated slot\n    const lengthHex = await ethers.provider.getStorage(orderBook, priceSlot);\n    const length = parseInt(lengthHex, 16);\n\n    if (length === 0) {\n      return [];\n    }\n\n    // For dynamic arrays, elements start at keccak256(slot)\n    const arrayStartSlot = ethers.solidityPackedKeccak256([\"bytes32\"], [priceSlot]);\n\n    // Read each segment (bytes32 elements)\n    const segments = [];\n    for (let i = 0; i \u003c length; i++) {\n      const elementSlot = BigInt(arrayStartSlot) + BigInt(i);\n      const segment = await ethers.provider.getStorage(orderBook, elementSlot);\n      segments.push(segment);\n    }\n\n    return segments;\n  }\n});\n"])</script><script>self.__next_f.push([1,"4b:T27bf,"])</script><script>self.__next_f.push([1,"import {loadFixture} from \"@nomicfoundation/hardhat-toolbox/network-helpers\";\nimport hre, {ethers, upgrades} from \"hardhat\";\nimport {expect} from \"chai\";\nimport {SonicOrderBook} from \"../../typechain-types\";\nimport {Order, OrderSide} from \"@paintswap/sonic-airdrop-definitions/types\";\nimport {deployContractsFixture, calcFees, ONE_ETHER, RETURN_WRAPPED_SONIC} from \"./utils\";\nimport {initializerSlot} from \"../utils\";\nimport {BigNumberish, Block} from \"ethers\";\nimport {deploySonicOrderBook, deploySonicOrderBookLibrary} from \"../../scripts/deployHelpers\";\nimport { HardhatEthersSigner } from \"@nomicfoundation/hardhat-ethers/signers\";\n\n// Uses a plain ERC20 token with 18 decimals\ndescribe(\"SonicOrderBook\", function () {\n  describe(\"Market orders with useExactQuantity: false\", function () {\n    describe(\"Budget-constrained buying\", function () {\n      async function setup() {\n        const {\n          sonicAirdropNFT,\n          wS,\n          sonicOrderBookLibrary,\n          quoteToken,\n          alice,\n          bob,\n          dev,\n          tokenId,\n          initialCoins,\n          maxOrdersPerPrice,\n          QUANTITY_TICK\n        } = await loadFixture(deployContractsFixture);\n\n        await quoteToken.connect(bob).mint(bob, initialCoins);\n\n        const orderBook = await deploySonicOrderBook(sonicAirdropNFT, quoteToken, wS, sonicOrderBookLibrary);\n        \n        // set approvals\n        await quoteToken.approve(orderBook, initialCoins);\n        await quoteToken.connect(alice).approve(orderBook, initialCoins);\n        await sonicAirdropNFT.setApprovalForAll(orderBook, true);\n        await sonicAirdropNFT.connect(alice).setApprovalForAll(orderBook, true);\n        await quoteToken.connect(bob).approve(orderBook, initialCoins);\n\n        const priceTick = 100n;\n        const minQuantity = 10n * QUANTITY_TICK;\n        const isTradeable = true;\n\n        const makerFeeBps = 40n; // 0.2% fee for makers\n        const takerFeeBps = 60n; // 0.3% fee for takers\n        await orderBook.setAdminVars(\n            dev,\n            makerFeeBps,\n            takerFeeBps,\n            maxOrdersPerPrice,\n            [tokenId],\n            [{priceTick, minQuantity, isTradeable}]\n        );\n\n        return {\n          orderBook,\n          quoteToken,\n          alice,\n          bob,\n          dev,\n          tokenId,\n          initialCoins,\n          maxOrdersPerPrice,\n          QUANTITY_TICK,\n          priceTick,\n          minQuantity\n        }\n      }\n\n      it(\"6 orders\", async function () {\n        const {\n          orderBook,\n          quoteToken,\n          alice,\n          bob,\n          tokenId,\n          maxOrdersPerPrice,\n          QUANTITY_TICK,\n          priceTick,\n          minQuantity\n        } = await loadFixture(setup);\n\n        const limitPrice = 4n * priceTick;\n        const quantity = minQuantity;\n        const totalOrders = 6;\n\n        await placeNLimitOrders(\n          orderBook,\n          alice,\n          totalOrders,\n          OrderSide.Sell,\n          tokenId,\n          limitPrice,\n          quantity,\n          true,\n          true\n        );\n\n        await logSegments(orderBook, OrderSide.Sell, tokenId, limitPrice, \"segments before calling placeMarketOrder :\");\n        \n        const nodeBefore = await orderBook.getNode(OrderSide.Sell, tokenId, limitPrice);\n        expect(nodeBefore.tombstoneSegmentOffset).to.be.equal(0);\n\n        const segmentsBefore = await getSegments(orderBook, OrderSide.Sell, tokenId, limitPrice);\n        expect(segmentsBefore[0]).to.be.equal(\"0x00000000000a0000000000030000000a0000000000020000000a000000000001\");\n        expect(segmentsBefore[1]).to.be.equal(\"0x00000000000a0000000000060000000a0000000000050000000a000000000004\");\n\n        // each order is worth 40, so in total with a budget of 101\n        // we should afford 2 full orders and a partial order (1/2 of an order)\n        // this would cost 100, the extra budget of 1 is here to make sure\n        // after we partially match the 3rd order we would not reach the `maxCost`\n        // so the loop would continue to trigger the bug\n        const budget = 101;\n        await orderBook.connect(bob).placeMarketOrder(\n          {\n            side: OrderSide.Buy,\n            tokenId,\n            totalCost: budget,\n            quantity: 0,\n            useExactQuantity: false\n          },\n          RETURN_WRAPPED_SONIC\n        );\n\n        await logSegments(orderBook, OrderSide.Sell, tokenId, limitPrice, \"segments after calling placeMarketOrder :\");\n\n        const nodeAfter = await orderBook.getNode(OrderSide.Sell, tokenId, limitPrice);\n        expect(nodeAfter.tombstoneSegmentOffset).to.be.equal(0);\n\n        const segmentsAfter= await getSegments(orderBook, OrderSide.Sell, tokenId, limitPrice);\n        expect(segmentsAfter[0]).to.be.equal(\"0x0000000000050000000000030000000000000000000000000000000000000000\");\n        expect(segmentsAfter[1]).to.be.equal(\"0x00000000000a0000000000060000000a0000000000050000000a000000000004\");\n\n      });\n\n      it(\"4 orders\", async function () {\n        const {\n          orderBook,\n          quoteToken,\n          alice,\n          bob,\n          tokenId,\n          maxOrdersPerPrice,\n          QUANTITY_TICK,\n          priceTick,\n          minQuantity\n        } = await loadFixture(setup);\n\n        const limitPrice = 4n * priceTick;\n        const quantity = minQuantity;\n        const totalOrders = 4;\n\n        await placeNLimitOrders(\n          orderBook,\n          alice,\n          totalOrders,\n          OrderSide.Sell,\n          tokenId,\n          limitPrice,\n          quantity,\n          true,\n          true\n        );\n\n        await logSegments(orderBook, OrderSide.Sell, tokenId, limitPrice, \"segments before calling placeMarketOrder :\");\n        \n        const nodeBefore = await orderBook.getNode(OrderSide.Sell, tokenId, limitPrice);\n        expect(nodeBefore.tombstoneSegmentOffset).to.be.equal(0);\n\n        const segmentsBefore = await getSegments(orderBook, OrderSide.Sell, tokenId, limitPrice);\n        expect(segmentsBefore[0]).to.be.equal(\"0x00000000000a0000000000030000000a0000000000020000000a000000000001\");\n        expect(segmentsBefore[1]).to.be.equal(\"0x000000000000000000000000000000000000000000000000000a000000000004\");\n\n        // each order is worth 40, so in total with a budget of 101\n        // we should afford 2 full orders and a partial order (1/2 of an order)\n        // this would cost 100, the extra budget of 1 is here to make sure\n        // after we partially match the 3rd order we would not reach the `maxCost`\n        // so the loop would continue to trigger the bug\n        const budget = 101;\n        await orderBook.connect(bob).placeMarketOrder(\n          {\n            side: OrderSide.Buy,\n            tokenId,\n            totalCost: budget,\n            quantity: 0,\n            useExactQuantity: false\n          },\n          RETURN_WRAPPED_SONIC\n        );\n\n        await logSegments(orderBook, OrderSide.Sell, tokenId, limitPrice, \"segments after calling placeMarketOrder :\");\n\n        const nodeAfter = await orderBook.getNode(OrderSide.Sell, tokenId, limitPrice);\n        expect(nodeAfter.tombstoneSegmentOffset).to.be.equal(0);\n\n        const segmentsAfter= await getSegments(orderBook, OrderSide.Sell, tokenId, limitPrice);\n        expect(segmentsAfter[0]).to.be.equal(\"0x0000000000050000000000030000000000000000000000000000000000000000\");\n        expect(segmentsAfter[1]).to.be.equal(\"0x000000000000000000000000000000000000000000000000000a000000000004\");\n      });\n    });\n  });\n\n  async function getNextOrderId(orderBook: SonicOrderBook) {\n    const nextOrderIdSlot = 0;\n    const packedSlot = await ethers.provider.getStorage(orderBook, nextOrderIdSlot);\n    return parseInt(packedSlot.slice(2, 14), 16);\n  }\n\n  async function placeNLimitOrders(\n    orderbook: SonicOrderBook,\n    user: HardhatEthersSigner,\n    totalOrders: number,\n    side: OrderSide,\n    tokenId: BigNumberish,\n    price: BigNumberish,\n    quantity: BigNumberish,\n    onlyPost: boolean,\n    onlyExactPriceIfMaker: boolean\n  ) {\n    for(let i = 0; i \u003c totalOrders; i++) {\n      await orderbook.connect(user).placeLimitOrders([\n        {\n          side: side,\n          tokenId: tokenId,\n          price: price,\n          quantity,\n          onlyPost: onlyPost,\n          onlyExactPriceIfMaker: onlyExactPriceIfMaker\n        }\n      ],\n        RETURN_WRAPPED_SONIC\n      );\n    }\n  }\n\n  async function logSegments(orderBook: SonicOrderBook, side: OrderSide, tokenId: BigNumberish, price: BigNumberish, message: string) {\n    const segmentsAfter = await getSegments(orderBook, side, tokenId, price);\n    console.log(message)\n    console.log(segmentsAfter);\n  }\n\n  async function getSegments(orderBook: SonicOrderBook, side: OrderSide, tokenId: BigNumberish, price: BigNumberish) {\n    // Storage slot assignments based on contract layout:\n    // slot 0: packed variables (_devAddr, _devFeeBps, _maxOrdersPerPrice, _nextOrderId)\n    // slot 1: _tokenIdInfos mapping\n    // slot 2: _asks mapping\n    // slot 3: _bids mapping\n    // slot 4: _asksAtPrice mapping\n    // slot 5: _bidsAtPrice mapping\n\n    const baseSlot = side === 0 ? 5 : 4; // 0 = Buy (bids), 1 = Sell (asks)\n\n    // Calculate slot for tokenId in the outer mapping\n    const tokenIdSlot = ethers.solidityPackedKeccak256([\"uint256\", \"uint256\"], [tokenId, baseSlot]);\n\n    // Calculate slot for price in the inner mapping\n    const priceSlot = ethers.solidityPackedKeccak256([\"uint256\", \"bytes32\"], [price, tokenIdSlot]);\n\n    // Read array length from the calculated slot\n    const lengthHex = await ethers.provider.getStorage(orderBook, priceSlot);\n    const length = parseInt(lengthHex, 16);\n\n    if (length === 0) {\n      return [];\n    }\n\n    // For dynamic arrays, elements start at keccak256(slot)\n    const arrayStartSlot = ethers.solidityPackedKeccak256([\"bytes32\"], [priceSlot]);\n\n    // Read each segment (bytes32 elements)\n    const segments = [];\n    for (let i = 0; i \u003c length; i++) {\n      const elementSlot = BigInt(arrayStartSlot) + BigInt(i);\n      const segment = await ethers.provider.getStorage(orderBook, elementSlot);\n      segments.push(segment);\n    }\n\n    return segments;\n  }\n});"])</script><script>self.__next_f.push([1,"4c:T27c0,"])</script><script>self.__next_f.push([1,"import {loadFixture} from \"@nomicfoundation/hardhat-toolbox/network-helpers\";\nimport hre, {ethers, upgrades} from \"hardhat\";\nimport {expect} from \"chai\";\nimport {SonicOrderBook} from \"../../typechain-types\";\nimport {Order, OrderSide} from \"@paintswap/sonic-airdrop-definitions/types\";\nimport {deployContractsFixture, calcFees, ONE_ETHER, RETURN_WRAPPED_SONIC} from \"./utils\";\nimport {initializerSlot} from \"../utils\";\nimport {BigNumberish, Block} from \"ethers\";\nimport {deploySonicOrderBook, deploySonicOrderBookLibrary} from \"../../scripts/deployHelpers\";\nimport { HardhatEthersSigner } from \"@nomicfoundation/hardhat-ethers/signers\";\n\n// Uses a plain ERC20 token with 18 decimals\ndescribe(\"SonicOrderBook\", function () {\n  describe(\"Market orders with useExactQuantity: false\", function () {\n    describe(\"Budget-constrained buying\", function () {\n      async function setup() {\n        const {\n          sonicAirdropNFT,\n          wS,\n          sonicOrderBookLibrary,\n          quoteToken,\n          alice,\n          bob,\n          dev,\n          tokenId,\n          initialCoins,\n          maxOrdersPerPrice,\n          QUANTITY_TICK\n        } = await loadFixture(deployContractsFixture);\n\n        await quoteToken.connect(bob).mint(bob, initialCoins);\n\n        const orderBook = await deploySonicOrderBook(sonicAirdropNFT, quoteToken, wS, sonicOrderBookLibrary);\n        \n        // set approvals\n        await quoteToken.approve(orderBook, initialCoins);\n        await quoteToken.connect(alice).approve(orderBook, initialCoins);\n        await sonicAirdropNFT.setApprovalForAll(orderBook, true);\n        await sonicAirdropNFT.connect(alice).setApprovalForAll(orderBook, true);\n        await quoteToken.connect(bob).approve(orderBook, initialCoins);\n\n        const priceTick = 100n;\n        const minQuantity = 10n * QUANTITY_TICK;\n        const isTradeable = true;\n\n        const makerFeeBps = 40n; // 0.2% fee for makers\n        const takerFeeBps = 60n; // 0.3% fee for takers\n        await orderBook.setAdminVars(\n            dev,\n            makerFeeBps,\n            takerFeeBps,\n            maxOrdersPerPrice,\n            [tokenId],\n            [{priceTick, minQuantity, isTradeable}]\n        );\n\n        return {\n          orderBook,\n          quoteToken,\n          alice,\n          bob,\n          dev,\n          tokenId,\n          initialCoins,\n          maxOrdersPerPrice,\n          QUANTITY_TICK,\n          priceTick,\n          minQuantity\n        }\n      }\n\n      it(\"6 orders\", async function () {\n        const {\n          orderBook,\n          quoteToken,\n          alice,\n          bob,\n          tokenId,\n          maxOrdersPerPrice,\n          QUANTITY_TICK,\n          priceTick,\n          minQuantity\n        } = await loadFixture(setup);\n\n        const limitPrice = 4n * priceTick;\n        const quantity = minQuantity;\n        const totalOrders = 6;\n\n        await placeNLimitOrders(\n          orderBook,\n          alice,\n          totalOrders,\n          OrderSide.Sell,\n          tokenId,\n          limitPrice,\n          quantity,\n          true,\n          true\n        );\n\n        await logSegments(orderBook, OrderSide.Sell, tokenId, limitPrice, \"segments before calling placeMarketOrder :\");\n        \n        const nodeBefore = await orderBook.getNode(OrderSide.Sell, tokenId, limitPrice);\n        expect(nodeBefore.tombstoneSegmentOffset).to.be.equal(0);\n\n        const segmentsBefore = await getSegments(orderBook, OrderSide.Sell, tokenId, limitPrice);\n        expect(segmentsBefore[0]).to.be.equal(\"0x00000000000a0000000000030000000a0000000000020000000a000000000001\");\n        expect(segmentsBefore[1]).to.be.equal(\"0x00000000000a0000000000060000000a0000000000050000000a000000000004\");\n\n        // each order is worth 40, so in total with a budget of 101\n        // we should afford 2 full orders and a partial order (1/2 of an order)\n        // this would cost 100, the extra budget of 1 is here to make sure\n        // after we partially match the 3rd order we would not reach the `maxCost`\n        // so the loop would continue to trigger the bug\n        const budget = 101;\n        await orderBook.connect(bob).placeMarketOrder(\n          {\n            side: OrderSide.Buy,\n            tokenId,\n            totalCost: budget,\n            quantity: 0,\n            useExactQuantity: false\n          },\n          RETURN_WRAPPED_SONIC\n        );\n\n        await logSegments(orderBook, OrderSide.Sell, tokenId, limitPrice, \"segments after calling placeMarketOrder :\");\n\n        const nodeAfter = await orderBook.getNode(OrderSide.Sell, tokenId, limitPrice);\n        expect(nodeAfter.tombstoneSegmentOffset).to.be.equal(0);\n\n        const segmentsAfter= await getSegments(orderBook, OrderSide.Sell, tokenId, limitPrice);\n        expect(segmentsAfter[0]).to.be.equal(\"0x0000000000050000000000030000000000000000000000000000000000000000\");\n        expect(segmentsAfter[1]).to.be.equal(\"0x00000000000a0000000000060000000a0000000000050000000a000000000004\");\n\n      });\n\n      it(\"4 orders\", async function () {\n        const {\n          orderBook,\n          quoteToken,\n          alice,\n          bob,\n          tokenId,\n          maxOrdersPerPrice,\n          QUANTITY_TICK,\n          priceTick,\n          minQuantity\n        } = await loadFixture(setup);\n\n        const limitPrice = 4n * priceTick;\n        const quantity = minQuantity;\n        const totalOrders = 4;\n\n        await placeNLimitOrders(\n          orderBook,\n          alice,\n          totalOrders,\n          OrderSide.Sell,\n          tokenId,\n          limitPrice,\n          quantity,\n          true,\n          true\n        );\n\n        await logSegments(orderBook, OrderSide.Sell, tokenId, limitPrice, \"segments before calling placeMarketOrder :\");\n        \n        const nodeBefore = await orderBook.getNode(OrderSide.Sell, tokenId, limitPrice);\n        expect(nodeBefore.tombstoneSegmentOffset).to.be.equal(0);\n\n        const segmentsBefore = await getSegments(orderBook, OrderSide.Sell, tokenId, limitPrice);\n        expect(segmentsBefore[0]).to.be.equal(\"0x00000000000a0000000000030000000a0000000000020000000a000000000001\");\n        expect(segmentsBefore[1]).to.be.equal(\"0x000000000000000000000000000000000000000000000000000a000000000004\");\n\n        // each order is worth 40, so in total with a budget of 101\n        // we should afford 2 full orders and a partial order (1/2 of an order)\n        // this would cost 100, the extra budget of 1 is here to make sure\n        // after we partially match the 3rd order we would not reach the `maxCost`\n        // so the loop would continue to trigger the bug\n        const budget = 101;\n        await orderBook.connect(bob).placeMarketOrder(\n          {\n            side: OrderSide.Buy,\n            tokenId,\n            totalCost: budget,\n            quantity: 0,\n            useExactQuantity: false\n          },\n          RETURN_WRAPPED_SONIC\n        );\n\n        await logSegments(orderBook, OrderSide.Sell, tokenId, limitPrice, \"segments after calling placeMarketOrder :\");\n\n        const nodeAfter = await orderBook.getNode(OrderSide.Sell, tokenId, limitPrice);\n        expect(nodeAfter.tombstoneSegmentOffset).to.be.equal(0);\n\n        const segmentsAfter= await getSegments(orderBook, OrderSide.Sell, tokenId, limitPrice);\n        expect(segmentsAfter[0]).to.be.equal(\"0x0000000000050000000000030000000000000000000000000000000000000000\");\n        expect(segmentsAfter[1]).to.be.equal(\"0x000000000000000000000000000000000000000000000000000a000000000004\");\n      });\n    });\n  });\n\n  async function getNextOrderId(orderBook: SonicOrderBook) {\n    const nextOrderIdSlot = 0;\n    const packedSlot = await ethers.provider.getStorage(orderBook, nextOrderIdSlot);\n    return parseInt(packedSlot.slice(2, 14), 16);\n  }\n\n  async function placeNLimitOrders(\n    orderbook: SonicOrderBook,\n    user: HardhatEthersSigner,\n    totalOrders: number,\n    side: OrderSide,\n    tokenId: BigNumberish,\n    price: BigNumberish,\n    quantity: BigNumberish,\n    onlyPost: boolean,\n    onlyExactPriceIfMaker: boolean\n  ) {\n    for(let i = 0; i \u003c totalOrders; i++) {\n      await orderbook.connect(user).placeLimitOrders([\n        {\n          side: side,\n          tokenId: tokenId,\n          price: price,\n          quantity,\n          onlyPost: onlyPost,\n          onlyExactPriceIfMaker: onlyExactPriceIfMaker\n        }\n      ],\n        RETURN_WRAPPED_SONIC\n      );\n    }\n  }\n\n  async function logSegments(orderBook: SonicOrderBook, side: OrderSide, tokenId: BigNumberish, price: BigNumberish, message: string) {\n    const segmentsAfter = await getSegments(orderBook, side, tokenId, price);\n    console.log(message)\n    console.log(segmentsAfter);\n  }\n\n  async function getSegments(orderBook: SonicOrderBook, side: OrderSide, tokenId: BigNumberish, price: BigNumberish) {\n    // Storage slot assignments based on contract layout:\n    // slot 0: packed variables (_devAddr, _devFeeBps, _maxOrdersPerPrice, _nextOrderId)\n    // slot 1: _tokenIdInfos mapping\n    // slot 2: _asks mapping\n    // slot 3: _bids mapping\n    // slot 4: _asksAtPrice mapping\n    // slot 5: _bidsAtPrice mapping\n\n    const baseSlot = side === 0 ? 5 : 4; // 0 = Buy (bids), 1 = Sell (asks)\n\n    // Calculate slot for tokenId in the outer mapping\n    const tokenIdSlot = ethers.solidityPackedKeccak256([\"uint256\", \"uint256\"], [tokenId, baseSlot]);\n\n    // Calculate slot for price in the inner mapping\n    const priceSlot = ethers.solidityPackedKeccak256([\"uint256\", \"bytes32\"], [price, tokenIdSlot]);\n\n    // Read array length from the calculated slot\n    const lengthHex = await ethers.provider.getStorage(orderBook, priceSlot);\n    const length = parseInt(lengthHex, 16);\n\n    if (length === 0) {\n      return [];\n    }\n\n    // For dynamic arrays, elements start at keccak256(slot)\n    const arrayStartSlot = ethers.solidityPackedKeccak256([\"bytes32\"], [priceSlot]);\n\n    // Read each segment (bytes32 elements)\n    const segments = [];\n    for (let i = 0; i \u003c length; i++) {\n      const elementSlot = BigInt(arrayStartSlot) + BigInt(i);\n      const segment = await ethers.provider.getStorage(orderBook, elementSlot);\n      segments.push(segment);\n    }\n\n    return segments;\n  }\n});\n"])</script><script>self.__next_f.push([1,"4d:T909,"])</script><script>self.__next_f.push([1,"segments before calling placeMarketOrder :\n[\n  '0x00000000000a0000000000030000000a0000000000020000000a000000000001',\n  '0x00000000000a0000000000060000000a0000000000050000000a000000000004'\n]\nsegments after calling placeMarketOrder :\n[\n  '0x00000000000a0000000000030000000a0000000000020000000a000000000001',\n  '0x00000000000a0000000000060000000000000000000000000000000000000000'\n]\n        1) 6 orders\nsegments before calling placeMarketOrder :\n[\n  '0x00000000000a0000000000030000000a0000000000020000000a000000000001',\n  '0x000000000000000000000000000000000000000000000000000a000000000004'\n]\nsegments after calling placeMarketOrder :\n[\n  '0x00000000000a0000000000030000000a0000000000020000000a000000000001',\n  '0x0000000000000000000000000000000000000000000000000000000000000000'\n]\n        2) 4 orders\n\n\n  0 passing (321ms)\n  2 failing\n\n  1) SonicOrderBook\n       Market orders with useExactQuantity: false\n         Budget-constrained buying\n           6 orders:\n\n      AssertionError: expected '0x00000000000a0000000000030000000a000…' to equal '0x00000000000500000000000300000000000…'\n      + expected - actual\n\n      -0x00000000000a0000000000030000000a0000000000020000000a000000000001\n      +0x0000000000050000000000030000000000000000000000000000000000000000\n      \n      at Context.\u003canonymous\u003e (test/sonicOrderBook/isBudgetConstrainedBuyingLimitReached.bug.ts:133:40)\n\n  2) SonicOrderBook\n       Market orders with useExactQuantity: false\n         Budget-constrained buying\n           4 orders:\n     Error: VM Exception while processing transaction: reverted with custom error 'KeyDoesntExist()'\n    at SonicOrderBook.getNode (contracts/libraries/BokkyPooBahsRedBlackTreeLibrary.sol:71)\n    at SonicOrderBook.getNode (contracts/SonicOrderBook.sol:519)\n    at \u003cUnrecognizedContract\u003e.\u003cunknown\u003e (0xa51c1fc2f0d1a1b8494ed1fe312d7c3a78ed91c0)\n    at EdrProviderWrapper.request (node_modules/hardhat/src/internal/hardhat-network/provider/provider.ts:398:41)\n    at async staticCallResult (node_modules/ethers/src.ts/contract/contract.ts:337:22)\n    at async staticCall (node_modules/ethers/src.ts/contract/contract.ts:303:24)\n    at async Proxy.getNode (node_modules/ethers/src.ts/contract/contract.ts:351:41)\n    at async Context.\u003canonymous\u003e (test/sonicOrderBook/isBudgetConstrainedBuyingLimitReached.bug.ts:195:27)\n"])</script><script>self.__next_f.push([1,"4e:T908,"])</script><script>self.__next_f.push([1,"segments before calling placeMarketOrder :\n[\n  '0x00000000000a0000000000030000000a0000000000020000000a000000000001',\n  '0x00000000000a0000000000060000000a0000000000050000000a000000000004'\n]\nsegments after calling placeMarketOrder :\n[\n  '0x00000000000a0000000000030000000a0000000000020000000a000000000001',\n  '0x00000000000a0000000000060000000000000000000000000000000000000000'\n]\n        1) 6 orders\nsegments before calling placeMarketOrder :\n[\n  '0x00000000000a0000000000030000000a0000000000020000000a000000000001',\n  '0x000000000000000000000000000000000000000000000000000a000000000004'\n]\nsegments after calling placeMarketOrder :\n[\n  '0x00000000000a0000000000030000000a0000000000020000000a000000000001',\n  '0x0000000000000000000000000000000000000000000000000000000000000000'\n]\n        2) 4 orders\n\n\n  0 passing (321ms)\n  2 failing\n\n  1) SonicOrderBook\n       Market orders with useExactQuantity: false\n         Budget-constrained buying\n           6 orders:\n\n      AssertionError: expected '0x00000000000a0000000000030000000a000…' to equal '0x00000000000500000000000300000000000…'\n      + expected - actual\n\n      -0x00000000000a0000000000030000000a0000000000020000000a000000000001\n      +0x0000000000050000000000030000000000000000000000000000000000000000\n      \n      at Context.\u003canonymous\u003e (test/sonicOrderBook/isBudgetConstrainedBuyingLimitReached.bug.ts:133:40)\n\n  2) SonicOrderBook\n       Market orders with useExactQuantity: false\n         Budget-constrained buying\n           4 orders:\n     Error: VM Exception while processing transaction: reverted with custom error 'KeyDoesntExist()'\n    at SonicOrderBook.getNode (contracts/libraries/BokkyPooBahsRedBlackTreeLibrary.sol:71)\n    at SonicOrderBook.getNode (contracts/SonicOrderBook.sol:519)\n    at \u003cUnrecognizedContract\u003e.\u003cunknown\u003e (0xa51c1fc2f0d1a1b8494ed1fe312d7c3a78ed91c0)\n    at EdrProviderWrapper.request (node_modules/hardhat/src/internal/hardhat-network/provider/provider.ts:398:41)\n    at async staticCallResult (node_modules/ethers/src.ts/contract/contract.ts:337:22)\n    at async staticCall (node_modules/ethers/src.ts/contract/contract.ts:303:24)\n    at async Proxy.getNode (node_modules/ethers/src.ts/contract/contract.ts:351:41)\n    at async Context.\u003canonymous\u003e (test/sonicOrderBook/isBudgetConstrainedBuyingLimitReached.bug.ts:195:27)"])</script><script>self.__next_f.push([1,"4f:T909,"])</script><script>self.__next_f.push([1,"segments before calling placeMarketOrder :\n[\n  '0x00000000000a0000000000030000000a0000000000020000000a000000000001',\n  '0x00000000000a0000000000060000000a0000000000050000000a000000000004'\n]\nsegments after calling placeMarketOrder :\n[\n  '0x00000000000a0000000000030000000a0000000000020000000a000000000001',\n  '0x00000000000a0000000000060000000000000000000000000000000000000000'\n]\n        1) 6 orders\nsegments before calling placeMarketOrder :\n[\n  '0x00000000000a0000000000030000000a0000000000020000000a000000000001',\n  '0x000000000000000000000000000000000000000000000000000a000000000004'\n]\nsegments after calling placeMarketOrder :\n[\n  '0x00000000000a0000000000030000000a0000000000020000000a000000000001',\n  '0x0000000000000000000000000000000000000000000000000000000000000000'\n]\n        2) 4 orders\n\n\n  0 passing (321ms)\n  2 failing\n\n  1) SonicOrderBook\n       Market orders with useExactQuantity: false\n         Budget-constrained buying\n           6 orders:\n\n      AssertionError: expected '0x00000000000a0000000000030000000a000…' to equal '0x00000000000500000000000300000000000…'\n      + expected - actual\n\n      -0x00000000000a0000000000030000000a0000000000020000000a000000000001\n      +0x0000000000050000000000030000000000000000000000000000000000000000\n      \n      at Context.\u003canonymous\u003e (test/sonicOrderBook/isBudgetConstrainedBuyingLimitReached.bug.ts:133:40)\n\n  2) SonicOrderBook\n       Market orders with useExactQuantity: false\n         Budget-constrained buying\n           4 orders:\n     Error: VM Exception while processing transaction: reverted with custom error 'KeyDoesntExist()'\n    at SonicOrderBook.getNode (contracts/libraries/BokkyPooBahsRedBlackTreeLibrary.sol:71)\n    at SonicOrderBook.getNode (contracts/SonicOrderBook.sol:519)\n    at \u003cUnrecognizedContract\u003e.\u003cunknown\u003e (0xa51c1fc2f0d1a1b8494ed1fe312d7c3a78ed91c0)\n    at EdrProviderWrapper.request (node_modules/hardhat/src/internal/hardhat-network/provider/provider.ts:398:41)\n    at async staticCallResult (node_modules/ethers/src.ts/contract/contract.ts:337:22)\n    at async staticCall (node_modules/ethers/src.ts/contract/contract.ts:303:24)\n    at async Proxy.getNode (node_modules/ethers/src.ts/contract/contract.ts:351:41)\n    at async Context.\u003canonymous\u003e (test/sonicOrderBook/isBudgetConstrainedBuyingLimitReached.bug.ts:195:27)\n"])</script><script>self.__next_f.push([1,"50:T417,diff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol\nindex 31b5486..1a4c724 100644\n--- a/contracts/SonicOrderBook.sol\n+++ b/contracts/SonicOrderBook.sol\n@@ -836,13 +836,13 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n       uint256 remainingBudget = params.maxCost - params.currentCost;\n \n       if (fullOrderCost \u003e remainingBudget) {\n+        // Can't afford a full order, stop here\n+        params.isBudgetConstrainedBuyingLimitReached = true;\n         // Check if we can afford partial order\n         uint256 maxAffordableQuantity = (remainingBudget * BASE_DECIMAL_DIVISOR) / params.bestPrice;\n         // Floor to QUANTITY_TICK to ensure proper alignment\n         maxAffordableQuantity = (maxAffordableQuantity / QUANTITY_TICK) * QUANTITY_TICK;\n         if (maxAffordableQuantity == 0) {\n-          // Can't afford any of this order, stop here\n-          params.isBudgetConstrainedBuyingLimitReached = true;\n           return (\n             segment,\n             0, // ordersConsumed\n51:T416,diff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol\nindex 31b5486..1a4c724 100644\n--- a/contracts/SonicOrderBook.sol\n+++ b/contracts/SonicOrderBook.sol\n@@ -836,13 +836,13 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n       uint256 remainingBudget = params.maxCost - params.currentCost;\n \n       if (fullOrderCost \u003e remainingBudget) {\n+        // Can't afford a full order, stop here\n+        params.isBudgetConstrainedBuyingLimitReached = true;\n         // Check if we can afford partial order\n         uint256 maxAffordableQuantity = (remainingBudget * BASE_DECIMAL_DIVISOR) / params.bestPrice;\n         // Floor to QUANTITY_TICK to ensure proper alignment\n         maxAffordableQuantity = (maxAffordableQuantity / QUANTITY_TICK) * QUANTITY_TICK;\n         if (maxAffordableQuantity == 0) {\n-          // Can't afford any of this order, stop here\n-          params.isBudgetConstrainedBuyingLimitReached = true;\n           ret"])</script><script>self.__next_f.push([1,"urn (\n             segment,\n             0, // ordersConsumed52:T417,diff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol\nindex 31b5486..1a4c724 100644\n--- a/contracts/SonicOrderBook.sol\n+++ b/contracts/SonicOrderBook.sol\n@@ -836,13 +836,13 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n       uint256 remainingBudget = params.maxCost - params.currentCost;\n \n       if (fullOrderCost \u003e remainingBudget) {\n+        // Can't afford a full order, stop here\n+        params.isBudgetConstrainedBuyingLimitReached = true;\n         // Check if we can afford partial order\n         uint256 maxAffordableQuantity = (remainingBudget * BASE_DECIMAL_DIVISOR) / params.bestPrice;\n         // Floor to QUANTITY_TICK to ensure proper alignment\n         maxAffordableQuantity = (maxAffordableQuantity / QUANTITY_TICK) * QUANTITY_TICK;\n         if (maxAffordableQuantity == 0) {\n-          // Can't afford any of this order, stop here\n-          params.isBudgetConstrainedBuyingLimitReached = true;\n           return (\n             segment,\n             0, // ordersConsumed\n53:T41d,\\begin{align*}\n\u0026 \\qquad \\quad \\space \\vdots \\qquad \\quad \u0026 \\\\\n\\square \u0026 \\cdots \\square \\square \\square \\square\\square \\square \\cdots \\square \u0026 \\leftarrow \u0026 \\space o_t - 1 \\\\\n\\blacksquare \u0026 \\cdots \\blacksquare \\blacksquare \\blacksquare \\blacksquare\\blacksquare \\square \\cdots \\square \u0026 \\leftarrow \u0026 \\space o_t \\\\\n\\blacksquare \u0026 \\cdots \\blacksquare \\blacksquare \\blacksquare \\blacksquare\\blacksquare\\blacksquare \\cdots \\blacksquare \u0026 \u0026 \\\\\n\u0026 \\qquad \\quad \\space \\vdots \\qquad \\quad \u0026  \u0026 \\\\\n\\blacksquare \u0026 \\cdots \\blacksquare \\blacksquare \\blacksquare \\bgroup\\color{red}{\\blacksquare}\\egroup\\blacksquare\\blacksquare \\cdots \\blacksquare \u0026 \u0026 \\\\\n\u0026 \\qquad \\quad \\space \\vdots \\qquad \\quad \u0026   \u0026 \\\\\n\\square \u0026 \\cdots  \\square \\bgroup\\color{green}{\\blacksquare}\\egroup \\blacksquare \\blacksquare\\blacksquare\\blacksquare \\cdots \\blacksquare \u0026 \\leftarrow \u0026 \\space \\text{seg len} - 1\\\\\n\\square \u0026 \\cdots \\square \\square \\square \\square\\squa"])</script><script>self.__next_f.push([1,"re \\square \\cdots \\square \u0026 \\leftarrow \u0026 \\space \\text{seg len} \\\\\n\u0026 \\qquad \\quad \\space \\vdots \\qquad \\quad \u0026   \u0026 \\\\\n\\end{align*}55:T304d,"])</script><script>self.__next_f.push([1,"diff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol\nindex 31b5486..e690a23 100644\n--- a/contracts/SonicOrderBook.sol\n+++ b/contracts/SonicOrderBook.sol\n@@ -108,6 +108,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n   error SellMustUseExactQuantity();\n   error MakerPriceMustMatch(uint256 expectedPrice, uint256 actualPrice);\n \n+  // Errors related to price segment invariants being broken\n+  error PriceSegmentHasAHole();\n+  error IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset();\n+\n   enum OrderSide {\n     Buy,\n     Sell\n@@ -915,39 +919,126 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 lastSegmentIndex,\n     uint256 numOrdersFullyConsumed\n   ) private {\n+    // `segments.length \u003e lastSegmentIndex \u003e= oldTombstoneOffset`\n+    // `numOrdersFullyConsumed` should be the number of order slots fully consumed\n+    // yet not modified but the cursor passed over it to the next order slot.\n+\n+    // Assumptions:\n+    //    1. `numSegmentsFullyConsumed` is calculated correctly, it should be the number of\n+    //       slots fully consumed or skipped if the slot was EMPTY (0)\n+    //    2. `lastSegmentIndex` points to the last segment consumed\n+    //    3. `lastSegment` is the segment pointed to by `lastSegmentIndex`\n+\n+    // [CHECK LIST] One should enforce the following for `lastSegment` (the last segment consumed):\n+    // (o: an EMPTY slot, x: a non-EMPTY slot)\n+    //\n+    // o o o - last consumed segment - ALLOWED (only if the price node gets removed from the tree)\n+    // o o x - last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+    // o x o - last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+    // o x x - last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+    // x o o - last consumed segment - ALLOWED (check `ot` point to this slot too)\n+    // x o x - last consumed segment - CATCH - no hole in the middle allowed\n+    // x x o - last consumed segment - ALLOWED (check `ot` point to this slot too)\n+    // x x x - last consumed segment - ALLOWED\n+\n     uint256 numSegmentsFullyConsumed = numOrdersFullyConsumed / NUM_SLOTS_PER_SEGMENT;\n-    uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n+    uint256 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n+    uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n \n-    uint56 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n-    if (numSegmentsFullyConsumed != 0) {\n-      // Cleanup segments to get a gas refund\n-      for (uint256 i = 0; i \u003c numSegmentsFullyConsumed; ++i) {\n-        delete segments[oldTombstoneOffset + i];\n-      }\n+    if (lastSegmentIndex == newTombstoneSegmentOffset) {\n+      // At this branch we know `segments.length \u003e lastSegmentIndex \u003e= newTombstoneSegmentOffset`\n+      uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n+      lastSegment = lastSegment.clearUpToSlot(numOrdersWithinLastSegmentFullyConsumed);\n \n-      uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n-      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n+      if (uint256(lastSegment) == 0) {\n+        // `lastSegment` has this property/assumption that either:\n+        // A1. An other was partially matched in this segment or\n+        // A2. We had reached the last segment in the active area of the price segments which\n+        //     has some zero slots (`if (remainingSegment == 0)` branch in `_consumePriceSegments`)\n+        //\n+        // Moreover, there is an assumption here that if `lastSegment` that was touched during the\n+        // matching/filling process ends up being `0` then that would mean, there are no orders\n+        // left in the price segments since A1 would not be possible and so for A2:\n+        // 1. any order slot before this segment should have been fully filled/matched and thus\n+        //    should have been zeroed out in the previous `if (numSegmentsFullyConsumed != 0)`\n+        //    block.\n+        // 2. There could not be any non-zero order slot past this segment since otherwise,\n+        //    that would indicate there would have been holes in the price segments previously\n+        //    breaking (Inv 1.)\n+        newTombstoneSegmentOffset = lastSegmentIndex + 1;\n+        // so we would have:\n+        // `segments.length \u003e= newTombstoneSegmentOffset == lastSegmentIndex + 1`\n+        // `newTombstoneSegmentOffset == lastSegmentIndex + 1 \u003e oldTombstoneOffset`\n+        // thus below `lastSegment` shuold get deleted\n+\n+        // o o o - last consumed segment - ALLOWED - it will get deleted and the new tombstone offset\n+        //                                           points to the following segment\n+\n+        // The checks from the [CHECK LIST] are not required since if one hits this branch and continue\n+        // without reverting, the last segment consumed would be removed from the price segments\n+        // and the new tombstone offset would point to the following segment.\n+      } else {\n+        // At this branch we know `segments.length \u003e lastSegmentIndex \u003e= newTombstoneSegmentOffset`\n+        // and `lastSegment` is non-zero, so at the end `bestPrice` would not get removed from the `tree`\n \n-      // Consumed all orders at this price level, so remove it from the tree\n-      if (newTombstoneSegmentOffset == segments.length) {\n-        tree.remove(bestPrice);\n-      }\n-    }\n \n-    bool lastSegmentDeleted = lastSegmentIndex \u003c (oldTombstoneOffset + numSegmentsFullyConsumed);\n-    if (!lastSegmentDeleted) {\n-      if (numOrdersWithinLastSegmentFullyConsumed != 0) {\n-        for (uint256 i; i \u003c numOrdersWithinLastSegmentFullyConsumed; ++i) {\n-          lastSegment = lastSegment.clearSlot(i);\n+        // s2 s1 s0 : cs(bits) : lastSegment \u003c-- (lastSegmentIndex == newTombstoneSegmentOffset)\n+        // --------------------------------(si: the `i`th slot, cs: compressed status)-------\n+        //  o  o  o :      111 : last consumed segment - ALLOWED (only if the price node gets removed from the tree)\n+        //  o  o  x :      110 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+        //  o  x  o :      101 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+        //  o  x  x :      100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+        //  x  o  o :      011 : last consumed segment - ALLOWED (check `ot` point to this slot too)\n+        //  x  o  x :      010 : last consumed segment - CATCH - no hole in the middle allowed\n+        //  x  x  o :      001 : last consumed segment - ALLOWED (check `ot` point to this slot too)\n+        //  x  x  x :      000 : last consumed segment - ALLOWED\n+\n+        uint256 compressedStatus = lastSegment.compressedStatus();\n+\n+        //  o  o  o : 111 : one would not enter this branch for this case\n+\n+        //  x  o  x : 010 : last consumed segment - CATCH - no hole in the middle allowed\n+        require(compressedStatus != 2, PriceSegmentHasAHole());\n+\n+        if (compressedStatus \u003e 3) {\n+          //  o  x  x : 100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+          //  o  x  o : 101 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+          //  o  o  x : 110 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+          require(lastSegmentIndex == segments.length - 1, PriceSegmentHasAHole());\n         }\n-      }\n \n-      if (uint256(lastSegment) == 0) {\n-        // All orders in the last segment are consumed, delete from tree\n-        tree.remove(bestPrice);\n-        // Don't pop segment for gas efficiency, instead just write zeros\n+        segments[lastSegmentIndex] = lastSegment;\n       }\n-      segments[lastSegmentIndex] = lastSegment;\n+    } else {\n+      // if `lastSegmentIndex =/= newTombstoneSegmentOffset` that would mean the matching process had ended up\n+      // with ( - dashes the slot can be 0 or not, c means that it was consumed):\n+      // ...\n+      // x(c) -(c) -(c) : lastSegmentIndex\n+      // where in the last segment, the last slot was fully filled and thus we would end up with:\n+      // ...\n+      // x(c) -(c) -(c) : lastSegmentIndex\n+      //   -  -    -    : newTombstoneSegmentOffset\n+      // So these values can only be off by `1`\n+      require(lastSegmentIndex + 1 == newTombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset());\n+\n+      // The checks from the [CHECK LIST] are not required since if one hits this branch and continue\n+      // without reverting, the last segment consumed would be removed from the price segments\n+      // and the new tombstone offset would point to the following segment.\n+    }\n+\n+    // Cleanup segments to get a gas refund\n+    for (uint256 i = oldTombstoneOffset; i \u003c newTombstoneSegmentOffset; ++i) {\n+      delete segments[i];\n+    }\n+\n+    if (newTombstoneSegmentOffset != oldTombstoneOffset) {\n+      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n+    }\n+\n+    // below one can add an extra branch for `newTombstoneSegmentOffset \u003e segments.length`\n+    // and possibly revert since that would mean some invariant was broken.\n+    if (newTombstoneSegmentOffset \u003e= segments.length) {\n+      tree.remove(bestPrice);\n     }\n   }\n \ndiff --git a/contracts/libraries/SegmentLibrary.sol b/contracts/libraries/SegmentLibrary.sol\nindex d884717..e7c91a2 100644\n--- a/contracts/libraries/SegmentLibrary.sol\n+++ b/contracts/libraries/SegmentLibrary.sol\n@@ -43,6 +43,39 @@ library SegmentLibrary {\n     return bytes10(uint80((uint256(segment) \u003e\u003e (slotIndex * SEGMENT_SIZE)) \u0026 SEGMENT_MASK));\n   }\n \n+  /// @notice Compresses the segment into 3 indicator bits\n+  /// @param segment The segment to read from\n+  /// @return status with only 3 bits sets each indicating whether the corresponding\n+  //                 slot in the segment is EMPTY or not.\n+  function compressedStatus(bytes32 segment) internal pure returns (uint256 status) {\n+    uint256 MASK = SEGMENT_MASK;\n+    uint256 SIZE = SEGMENT_SIZE;\n+\n+    assembly (\"memory-safe\") {\n+      // s2 s1 s0 : segment\n+      status := iszero(and(segment, MASK))\n+      segment := shr(SIZE, segment)\n+\n+      //  0 s2 s1 : segment\n+      status := or(\n+        shl(1, iszero(and(segment, MASK))),\n+        status\n+      )\n+      segment := shr(SIZE, segment)\n+\n+      //  0  0 s2 : segment\n+      status := or(\n+        shl(2, iszero(and(segment, MASK))), // still mask in case segment has dirty uppper bits\n+        status\n+      )\n+\n+      // b2 b1 b0 : status bits (it would only have 3 set bits)\n+      // b2       : is 1 if s2 the 3rd slot of original segment was EMPTY\n+      //    b1    : is 1 if s1 the 2nd slot of original segment was EMPTY\n+      //       b0 : is 1 if s0 the 1st slot of original segment was EMPTY\n+    }\n+  }\n+\n   /// @notice Checks if the segment only contains data in the specified slot\n   /// @dev Returns true if all other slots in the segment are empty (zero)\n   /// @param segment The segment to check\n@@ -60,6 +93,19 @@ library SegmentLibrary {\n     return bytes32(uint256(segment) \u0026 ~(uint256(SEGMENT_MASK) \u003c\u003c (slotIndex * SEGMENT_SIZE)));\n   }\n \n+  /// @notice Clears slots up to the specified index, setting all its bits to zero\n+  /// @param segment The segment to modify\n+  /// @param slotIndex The index of the slot to clear up to (0, 1, or 2)\n+  /// @return newSegment The updated segment with the right most slots cleared up to `slotIndex`\n+  function clearUpToSlot(bytes32 segment, uint256 slotIndex) internal pure returns (bytes32 newSegment) {\n+    if (slotIndex == 0) {\n+      return segment;\n+    }\n+\n+    uint256 shiftAmount = slotIndex * SEGMENT_SIZE;\n+    return bytes32((uint256(segment) \u003e\u003e (shiftAmount)) \u003c\u003c shiftAmount);\n+  }\n+\n   /// @notice Returns the remaining segment data after the specified slot index\n   /// @dev Shifts the segment right to remove all slots up to and including the specified index.\n   ///      Useful for iterating through higher-indexed slots or processing remaining data.\n\n"])</script><script>self.__next_f.push([1,"56:T304b,"])</script><script>self.__next_f.push([1,"diff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol\nindex 31b5486..e690a23 100644\n--- a/contracts/SonicOrderBook.sol\n+++ b/contracts/SonicOrderBook.sol\n@@ -108,6 +108,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n   error SellMustUseExactQuantity();\n   error MakerPriceMustMatch(uint256 expectedPrice, uint256 actualPrice);\n \n+  // Errors related to price segment invariants being broken\n+  error PriceSegmentHasAHole();\n+  error IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset();\n+\n   enum OrderSide {\n     Buy,\n     Sell\n@@ -915,39 +919,126 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 lastSegmentIndex,\n     uint256 numOrdersFullyConsumed\n   ) private {\n+    // `segments.length \u003e lastSegmentIndex \u003e= oldTombstoneOffset`\n+    // `numOrdersFullyConsumed` should be the number of order slots fully consumed\n+    // yet not modified but the cursor passed over it to the next order slot.\n+\n+    // Assumptions:\n+    //    1. `numSegmentsFullyConsumed` is calculated correctly, it should be the number of\n+    //       slots fully consumed or skipped if the slot was EMPTY (0)\n+    //    2. `lastSegmentIndex` points to the last segment consumed\n+    //    3. `lastSegment` is the segment pointed to by `lastSegmentIndex`\n+\n+    // [CHECK LIST] One should enforce the following for `lastSegment` (the last segment consumed):\n+    // (o: an EMPTY slot, x: a non-EMPTY slot)\n+    //\n+    // o o o - last consumed segment - ALLOWED (only if the price node gets removed from the tree)\n+    // o o x - last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+    // o x o - last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+    // o x x - last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+    // x o o - last consumed segment - ALLOWED (check `ot` point to this slot too)\n+    // x o x - last consumed segment - CATCH - no hole in the middle allowed\n+    // x x o - last consumed segment - ALLOWED (check `ot` point to this slot too)\n+    // x x x - last consumed segment - ALLOWED\n+\n     uint256 numSegmentsFullyConsumed = numOrdersFullyConsumed / NUM_SLOTS_PER_SEGMENT;\n-    uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n+    uint256 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n+    uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n \n-    uint56 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n-    if (numSegmentsFullyConsumed != 0) {\n-      // Cleanup segments to get a gas refund\n-      for (uint256 i = 0; i \u003c numSegmentsFullyConsumed; ++i) {\n-        delete segments[oldTombstoneOffset + i];\n-      }\n+    if (lastSegmentIndex == newTombstoneSegmentOffset) {\n+      // At this branch we know `segments.length \u003e lastSegmentIndex \u003e= newTombstoneSegmentOffset`\n+      uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n+      lastSegment = lastSegment.clearUpToSlot(numOrdersWithinLastSegmentFullyConsumed);\n \n-      uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n-      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n+      if (uint256(lastSegment) == 0) {\n+        // `lastSegment` has this property/assumption that either:\n+        // A1. An other was partially matched in this segment or\n+        // A2. We had reached the last segment in the active area of the price segments which\n+        //     has some zero slots (`if (remainingSegment == 0)` branch in `_consumePriceSegments`)\n+        //\n+        // Moreover, there is an assumption here that if `lastSegment` that was touched during the\n+        // matching/filling process ends up being `0` then that would mean, there are no orders\n+        // left in the price segments since A1 would not be possible and so for A2:\n+        // 1. any order slot before this segment should have been fully filled/matched and thus\n+        //    should have been zeroed out in the previous `if (numSegmentsFullyConsumed != 0)`\n+        //    block.\n+        // 2. There could not be any non-zero order slot past this segment since otherwise,\n+        //    that would indicate there would have been holes in the price segments previously\n+        //    breaking (Inv 1.)\n+        newTombstoneSegmentOffset = lastSegmentIndex + 1;\n+        // so we would have:\n+        // `segments.length \u003e= newTombstoneSegmentOffset == lastSegmentIndex + 1`\n+        // `newTombstoneSegmentOffset == lastSegmentIndex + 1 \u003e oldTombstoneOffset`\n+        // thus below `lastSegment` shuold get deleted\n+\n+        // o o o - last consumed segment - ALLOWED - it will get deleted and the new tombstone offset\n+        //                                           points to the following segment\n+\n+        // The checks from the [CHECK LIST] are not required since if one hits this branch and continue\n+        // without reverting, the last segment consumed would be removed from the price segments\n+        // and the new tombstone offset would point to the following segment.\n+      } else {\n+        // At this branch we know `segments.length \u003e lastSegmentIndex \u003e= newTombstoneSegmentOffset`\n+        // and `lastSegment` is non-zero, so at the end `bestPrice` would not get removed from the `tree`\n \n-      // Consumed all orders at this price level, so remove it from the tree\n-      if (newTombstoneSegmentOffset == segments.length) {\n-        tree.remove(bestPrice);\n-      }\n-    }\n \n-    bool lastSegmentDeleted = lastSegmentIndex \u003c (oldTombstoneOffset + numSegmentsFullyConsumed);\n-    if (!lastSegmentDeleted) {\n-      if (numOrdersWithinLastSegmentFullyConsumed != 0) {\n-        for (uint256 i; i \u003c numOrdersWithinLastSegmentFullyConsumed; ++i) {\n-          lastSegment = lastSegment.clearSlot(i);\n+        // s2 s1 s0 : cs(bits) : lastSegment \u003c-- (lastSegmentIndex == newTombstoneSegmentOffset)\n+        // --------------------------------(si: the `i`th slot, cs: compressed status)-------\n+        //  o  o  o :      111 : last consumed segment - ALLOWED (only if the price node gets removed from the tree)\n+        //  o  o  x :      110 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+        //  o  x  o :      101 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+        //  o  x  x :      100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+        //  x  o  o :      011 : last consumed segment - ALLOWED (check `ot` point to this slot too)\n+        //  x  o  x :      010 : last consumed segment - CATCH - no hole in the middle allowed\n+        //  x  x  o :      001 : last consumed segment - ALLOWED (check `ot` point to this slot too)\n+        //  x  x  x :      000 : last consumed segment - ALLOWED\n+\n+        uint256 compressedStatus = lastSegment.compressedStatus();\n+\n+        //  o  o  o : 111 : one would not enter this branch for this case\n+\n+        //  x  o  x : 010 : last consumed segment - CATCH - no hole in the middle allowed\n+        require(compressedStatus != 2, PriceSegmentHasAHole());\n+\n+        if (compressedStatus \u003e 3) {\n+          //  o  x  x : 100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+          //  o  x  o : 101 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+          //  o  o  x : 110 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+          require(lastSegmentIndex == segments.length - 1, PriceSegmentHasAHole());\n         }\n-      }\n \n-      if (uint256(lastSegment) == 0) {\n-        // All orders in the last segment are consumed, delete from tree\n-        tree.remove(bestPrice);\n-        // Don't pop segment for gas efficiency, instead just write zeros\n+        segments[lastSegmentIndex] = lastSegment;\n       }\n-      segments[lastSegmentIndex] = lastSegment;\n+    } else {\n+      // if `lastSegmentIndex =/= newTombstoneSegmentOffset` that would mean the matching process had ended up\n+      // with ( - dashes the slot can be 0 or not, c means that it was consumed):\n+      // ...\n+      // x(c) -(c) -(c) : lastSegmentIndex\n+      // where in the last segment, the last slot was fully filled and thus we would end up with:\n+      // ...\n+      // x(c) -(c) -(c) : lastSegmentIndex\n+      //   -  -    -    : newTombstoneSegmentOffset\n+      // So these values can only be off by `1`\n+      require(lastSegmentIndex + 1 == newTombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset());\n+\n+      // The checks from the [CHECK LIST] are not required since if one hits this branch and continue\n+      // without reverting, the last segment consumed would be removed from the price segments\n+      // and the new tombstone offset would point to the following segment.\n+    }\n+\n+    // Cleanup segments to get a gas refund\n+    for (uint256 i = oldTombstoneOffset; i \u003c newTombstoneSegmentOffset; ++i) {\n+      delete segments[i];\n+    }\n+\n+    if (newTombstoneSegmentOffset != oldTombstoneOffset) {\n+      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n+    }\n+\n+    // below one can add an extra branch for `newTombstoneSegmentOffset \u003e segments.length`\n+    // and possibly revert since that would mean some invariant was broken.\n+    if (newTombstoneSegmentOffset \u003e= segments.length) {\n+      tree.remove(bestPrice);\n     }\n   }\n \ndiff --git a/contracts/libraries/SegmentLibrary.sol b/contracts/libraries/SegmentLibrary.sol\nindex d884717..e7c91a2 100644\n--- a/contracts/libraries/SegmentLibrary.sol\n+++ b/contracts/libraries/SegmentLibrary.sol\n@@ -43,6 +43,39 @@ library SegmentLibrary {\n     return bytes10(uint80((uint256(segment) \u003e\u003e (slotIndex * SEGMENT_SIZE)) \u0026 SEGMENT_MASK));\n   }\n \n+  /// @notice Compresses the segment into 3 indicator bits\n+  /// @param segment The segment to read from\n+  /// @return status with only 3 bits sets each indicating whether the corresponding\n+  //                 slot in the segment is EMPTY or not.\n+  function compressedStatus(bytes32 segment) internal pure returns (uint256 status) {\n+    uint256 MASK = SEGMENT_MASK;\n+    uint256 SIZE = SEGMENT_SIZE;\n+\n+    assembly (\"memory-safe\") {\n+      // s2 s1 s0 : segment\n+      status := iszero(and(segment, MASK))\n+      segment := shr(SIZE, segment)\n+\n+      //  0 s2 s1 : segment\n+      status := or(\n+        shl(1, iszero(and(segment, MASK))),\n+        status\n+      )\n+      segment := shr(SIZE, segment)\n+\n+      //  0  0 s2 : segment\n+      status := or(\n+        shl(2, iszero(and(segment, MASK))), // still mask in case segment has dirty uppper bits\n+        status\n+      )\n+\n+      // b2 b1 b0 : status bits (it would only have 3 set bits)\n+      // b2       : is 1 if s2 the 3rd slot of original segment was EMPTY\n+      //    b1    : is 1 if s1 the 2nd slot of original segment was EMPTY\n+      //       b0 : is 1 if s0 the 1st slot of original segment was EMPTY\n+    }\n+  }\n+\n   /// @notice Checks if the segment only contains data in the specified slot\n   /// @dev Returns true if all other slots in the segment are empty (zero)\n   /// @param segment The segment to check\n@@ -60,6 +93,19 @@ library SegmentLibrary {\n     return bytes32(uint256(segment) \u0026 ~(uint256(SEGMENT_MASK) \u003c\u003c (slotIndex * SEGMENT_SIZE)));\n   }\n \n+  /// @notice Clears slots up to the specified index, setting all its bits to zero\n+  /// @param segment The segment to modify\n+  /// @param slotIndex The index of the slot to clear up to (0, 1, or 2)\n+  /// @return newSegment The updated segment with the right most slots cleared up to `slotIndex`\n+  function clearUpToSlot(bytes32 segment, uint256 slotIndex) internal pure returns (bytes32 newSegment) {\n+    if (slotIndex == 0) {\n+      return segment;\n+    }\n+\n+    uint256 shiftAmount = slotIndex * SEGMENT_SIZE;\n+    return bytes32((uint256(segment) \u003e\u003e (shiftAmount)) \u003c\u003c shiftAmount);\n+  }\n+\n   /// @notice Returns the remaining segment data after the specified slot index\n   /// @dev Shifts the segment right to remove all slots up to and including the specified index.\n   ///      Useful for iterating through higher-indexed slots or processing remaining data."])</script><script>self.__next_f.push([1,"57:T304d,"])</script><script>self.__next_f.push([1,"diff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol\nindex 31b5486..e690a23 100644\n--- a/contracts/SonicOrderBook.sol\n+++ b/contracts/SonicOrderBook.sol\n@@ -108,6 +108,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n   error SellMustUseExactQuantity();\n   error MakerPriceMustMatch(uint256 expectedPrice, uint256 actualPrice);\n \n+  // Errors related to price segment invariants being broken\n+  error PriceSegmentHasAHole();\n+  error IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset();\n+\n   enum OrderSide {\n     Buy,\n     Sell\n@@ -915,39 +919,126 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 lastSegmentIndex,\n     uint256 numOrdersFullyConsumed\n   ) private {\n+    // `segments.length \u003e lastSegmentIndex \u003e= oldTombstoneOffset`\n+    // `numOrdersFullyConsumed` should be the number of order slots fully consumed\n+    // yet not modified but the cursor passed over it to the next order slot.\n+\n+    // Assumptions:\n+    //    1. `numSegmentsFullyConsumed` is calculated correctly, it should be the number of\n+    //       slots fully consumed or skipped if the slot was EMPTY (0)\n+    //    2. `lastSegmentIndex` points to the last segment consumed\n+    //    3. `lastSegment` is the segment pointed to by `lastSegmentIndex`\n+\n+    // [CHECK LIST] One should enforce the following for `lastSegment` (the last segment consumed):\n+    // (o: an EMPTY slot, x: a non-EMPTY slot)\n+    //\n+    // o o o - last consumed segment - ALLOWED (only if the price node gets removed from the tree)\n+    // o o x - last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+    // o x o - last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+    // o x x - last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+    // x o o - last consumed segment - ALLOWED (check `ot` point to this slot too)\n+    // x o x - last consumed segment - CATCH - no hole in the middle allowed\n+    // x x o - last consumed segment - ALLOWED (check `ot` point to this slot too)\n+    // x x x - last consumed segment - ALLOWED\n+\n     uint256 numSegmentsFullyConsumed = numOrdersFullyConsumed / NUM_SLOTS_PER_SEGMENT;\n-    uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n+    uint256 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n+    uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n \n-    uint56 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n-    if (numSegmentsFullyConsumed != 0) {\n-      // Cleanup segments to get a gas refund\n-      for (uint256 i = 0; i \u003c numSegmentsFullyConsumed; ++i) {\n-        delete segments[oldTombstoneOffset + i];\n-      }\n+    if (lastSegmentIndex == newTombstoneSegmentOffset) {\n+      // At this branch we know `segments.length \u003e lastSegmentIndex \u003e= newTombstoneSegmentOffset`\n+      uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n+      lastSegment = lastSegment.clearUpToSlot(numOrdersWithinLastSegmentFullyConsumed);\n \n-      uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n-      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n+      if (uint256(lastSegment) == 0) {\n+        // `lastSegment` has this property/assumption that either:\n+        // A1. An other was partially matched in this segment or\n+        // A2. We had reached the last segment in the active area of the price segments which\n+        //     has some zero slots (`if (remainingSegment == 0)` branch in `_consumePriceSegments`)\n+        //\n+        // Moreover, there is an assumption here that if `lastSegment` that was touched during the\n+        // matching/filling process ends up being `0` then that would mean, there are no orders\n+        // left in the price segments since A1 would not be possible and so for A2:\n+        // 1. any order slot before this segment should have been fully filled/matched and thus\n+        //    should have been zeroed out in the previous `if (numSegmentsFullyConsumed != 0)`\n+        //    block.\n+        // 2. There could not be any non-zero order slot past this segment since otherwise,\n+        //    that would indicate there would have been holes in the price segments previously\n+        //    breaking (Inv 1.)\n+        newTombstoneSegmentOffset = lastSegmentIndex + 1;\n+        // so we would have:\n+        // `segments.length \u003e= newTombstoneSegmentOffset == lastSegmentIndex + 1`\n+        // `newTombstoneSegmentOffset == lastSegmentIndex + 1 \u003e oldTombstoneOffset`\n+        // thus below `lastSegment` shuold get deleted\n+\n+        // o o o - last consumed segment - ALLOWED - it will get deleted and the new tombstone offset\n+        //                                           points to the following segment\n+\n+        // The checks from the [CHECK LIST] are not required since if one hits this branch and continue\n+        // without reverting, the last segment consumed would be removed from the price segments\n+        // and the new tombstone offset would point to the following segment.\n+      } else {\n+        // At this branch we know `segments.length \u003e lastSegmentIndex \u003e= newTombstoneSegmentOffset`\n+        // and `lastSegment` is non-zero, so at the end `bestPrice` would not get removed from the `tree`\n \n-      // Consumed all orders at this price level, so remove it from the tree\n-      if (newTombstoneSegmentOffset == segments.length) {\n-        tree.remove(bestPrice);\n-      }\n-    }\n \n-    bool lastSegmentDeleted = lastSegmentIndex \u003c (oldTombstoneOffset + numSegmentsFullyConsumed);\n-    if (!lastSegmentDeleted) {\n-      if (numOrdersWithinLastSegmentFullyConsumed != 0) {\n-        for (uint256 i; i \u003c numOrdersWithinLastSegmentFullyConsumed; ++i) {\n-          lastSegment = lastSegment.clearSlot(i);\n+        // s2 s1 s0 : cs(bits) : lastSegment \u003c-- (lastSegmentIndex == newTombstoneSegmentOffset)\n+        // --------------------------------(si: the `i`th slot, cs: compressed status)-------\n+        //  o  o  o :      111 : last consumed segment - ALLOWED (only if the price node gets removed from the tree)\n+        //  o  o  x :      110 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+        //  o  x  o :      101 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+        //  o  x  x :      100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+        //  x  o  o :      011 : last consumed segment - ALLOWED (check `ot` point to this slot too)\n+        //  x  o  x :      010 : last consumed segment - CATCH - no hole in the middle allowed\n+        //  x  x  o :      001 : last consumed segment - ALLOWED (check `ot` point to this slot too)\n+        //  x  x  x :      000 : last consumed segment - ALLOWED\n+\n+        uint256 compressedStatus = lastSegment.compressedStatus();\n+\n+        //  o  o  o : 111 : one would not enter this branch for this case\n+\n+        //  x  o  x : 010 : last consumed segment - CATCH - no hole in the middle allowed\n+        require(compressedStatus != 2, PriceSegmentHasAHole());\n+\n+        if (compressedStatus \u003e 3) {\n+          //  o  x  x : 100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+          //  o  x  o : 101 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+          //  o  o  x : 110 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+          require(lastSegmentIndex == segments.length - 1, PriceSegmentHasAHole());\n         }\n-      }\n \n-      if (uint256(lastSegment) == 0) {\n-        // All orders in the last segment are consumed, delete from tree\n-        tree.remove(bestPrice);\n-        // Don't pop segment for gas efficiency, instead just write zeros\n+        segments[lastSegmentIndex] = lastSegment;\n       }\n-      segments[lastSegmentIndex] = lastSegment;\n+    } else {\n+      // if `lastSegmentIndex =/= newTombstoneSegmentOffset` that would mean the matching process had ended up\n+      // with ( - dashes the slot can be 0 or not, c means that it was consumed):\n+      // ...\n+      // x(c) -(c) -(c) : lastSegmentIndex\n+      // where in the last segment, the last slot was fully filled and thus we would end up with:\n+      // ...\n+      // x(c) -(c) -(c) : lastSegmentIndex\n+      //   -  -    -    : newTombstoneSegmentOffset\n+      // So these values can only be off by `1`\n+      require(lastSegmentIndex + 1 == newTombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset());\n+\n+      // The checks from the [CHECK LIST] are not required since if one hits this branch and continue\n+      // without reverting, the last segment consumed would be removed from the price segments\n+      // and the new tombstone offset would point to the following segment.\n+    }\n+\n+    // Cleanup segments to get a gas refund\n+    for (uint256 i = oldTombstoneOffset; i \u003c newTombstoneSegmentOffset; ++i) {\n+      delete segments[i];\n+    }\n+\n+    if (newTombstoneSegmentOffset != oldTombstoneOffset) {\n+      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n+    }\n+\n+    // below one can add an extra branch for `newTombstoneSegmentOffset \u003e segments.length`\n+    // and possibly revert since that would mean some invariant was broken.\n+    if (newTombstoneSegmentOffset \u003e= segments.length) {\n+      tree.remove(bestPrice);\n     }\n   }\n \ndiff --git a/contracts/libraries/SegmentLibrary.sol b/contracts/libraries/SegmentLibrary.sol\nindex d884717..e7c91a2 100644\n--- a/contracts/libraries/SegmentLibrary.sol\n+++ b/contracts/libraries/SegmentLibrary.sol\n@@ -43,6 +43,39 @@ library SegmentLibrary {\n     return bytes10(uint80((uint256(segment) \u003e\u003e (slotIndex * SEGMENT_SIZE)) \u0026 SEGMENT_MASK));\n   }\n \n+  /// @notice Compresses the segment into 3 indicator bits\n+  /// @param segment The segment to read from\n+  /// @return status with only 3 bits sets each indicating whether the corresponding\n+  //                 slot in the segment is EMPTY or not.\n+  function compressedStatus(bytes32 segment) internal pure returns (uint256 status) {\n+    uint256 MASK = SEGMENT_MASK;\n+    uint256 SIZE = SEGMENT_SIZE;\n+\n+    assembly (\"memory-safe\") {\n+      // s2 s1 s0 : segment\n+      status := iszero(and(segment, MASK))\n+      segment := shr(SIZE, segment)\n+\n+      //  0 s2 s1 : segment\n+      status := or(\n+        shl(1, iszero(and(segment, MASK))),\n+        status\n+      )\n+      segment := shr(SIZE, segment)\n+\n+      //  0  0 s2 : segment\n+      status := or(\n+        shl(2, iszero(and(segment, MASK))), // still mask in case segment has dirty uppper bits\n+        status\n+      )\n+\n+      // b2 b1 b0 : status bits (it would only have 3 set bits)\n+      // b2       : is 1 if s2 the 3rd slot of original segment was EMPTY\n+      //    b1    : is 1 if s1 the 2nd slot of original segment was EMPTY\n+      //       b0 : is 1 if s0 the 1st slot of original segment was EMPTY\n+    }\n+  }\n+\n   /// @notice Checks if the segment only contains data in the specified slot\n   /// @dev Returns true if all other slots in the segment are empty (zero)\n   /// @param segment The segment to check\n@@ -60,6 +93,19 @@ library SegmentLibrary {\n     return bytes32(uint256(segment) \u0026 ~(uint256(SEGMENT_MASK) \u003c\u003c (slotIndex * SEGMENT_SIZE)));\n   }\n \n+  /// @notice Clears slots up to the specified index, setting all its bits to zero\n+  /// @param segment The segment to modify\n+  /// @param slotIndex The index of the slot to clear up to (0, 1, or 2)\n+  /// @return newSegment The updated segment with the right most slots cleared up to `slotIndex`\n+  function clearUpToSlot(bytes32 segment, uint256 slotIndex) internal pure returns (bytes32 newSegment) {\n+    if (slotIndex == 0) {\n+      return segment;\n+    }\n+\n+    uint256 shiftAmount = slotIndex * SEGMENT_SIZE;\n+    return bytes32((uint256(segment) \u003e\u003e (shiftAmount)) \u003c\u003c shiftAmount);\n+  }\n+\n   /// @notice Returns the remaining segment data after the specified slot index\n   /// @dev Shifts the segment right to remove all slots up to and including the specified index.\n   ///      Useful for iterating through higher-indexed slots or processing remaining data.\n\n"])</script><script>self.__next_f.push([1,"58:T6bb,  function _updateSegmentsAndTree(\n    BokkyPooBahsRedBlackTreeLibrary.Tree storage tree,\n    BokkyPooBahsRedBlackTreeLibrary.Node storage bestPriceNode,\n    bytes32[] storage segments,\n    uint64 bestPrice,\n    bytes32 lastSegment,\n    uint256 lastSegmentIndex,\n    uint256 numOrdersFullyConsumed\n  ) private {\n\n    uint256 numSegmentsFullyConsumed = numOrdersFullyConsumed / NUM_SLOTS_PER_SEGMENT;\n    uint256 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n    uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n\n    if (lastSegmentIndex == newTombstoneSegmentOffset) {\n      uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n      lastSegment = lastSegment.clearUpToSlot(numOrdersWithinLastSegmentFullyConsumed);\n\n      if (uint256(lastSegment) == 0) {\n        newTombstoneSegmentOffset = lastSegmentIndex + 1;\n      } else {\n        uint256 compressedStatus = lastSegment.compressedStatus();\n        require(compressedStatus != 2, PriceSegmentHasAHole());\n        if (compressedStatus \u003e 3) {\n          require(lastSegmentIndex == segments.length - 1, PriceSegmentHasAHole());\n        }\n\n        segments[lastSegmentIndex] = lastSegment;\n      }\n    } else {\n      require(lastSegmentIndex + 1 == newTombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset());\n    }\n\n    for (uint256 i = oldTombstoneOffset; i \u003c newTombstoneSegmentOffset; ++i) {\n      delete segments[i];\n    }\n\n    if (newTombstoneSegmentOffset != oldTombstoneOffset) {\n      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n    }\n\n    if (newTombstoneSegmentOffset \u003e= segments.length) {\n      tree.remove(bestPrice);\n    }\n  }\n59:T6b8,function _updateSegmentsAndTree(\n    BokkyPooBahsRedBlackTreeLibrary.Tree storage tree,\n    BokkyPooBahsRedBlackTreeLibrary.Node storage bestPriceNode,\n    bytes32[] storage segments,\n    uint64 bestPrice,\n    bytes32 lastSegment,\n    uint256 lastSegmentIndex,\n    uint256 numOrdersFullyConsumed\n  ) private {"])</script><script>self.__next_f.push([1,"\n\n    uint256 numSegmentsFullyConsumed = numOrdersFullyConsumed / NUM_SLOTS_PER_SEGMENT;\n    uint256 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n    uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n\n    if (lastSegmentIndex == newTombstoneSegmentOffset) {\n      uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n      lastSegment = lastSegment.clearUpToSlot(numOrdersWithinLastSegmentFullyConsumed);\n\n      if (uint256(lastSegment) == 0) {\n        newTombstoneSegmentOffset = lastSegmentIndex + 1;\n      } else {\n        uint256 compressedStatus = lastSegment.compressedStatus();\n        require(compressedStatus != 2, PriceSegmentHasAHole());\n        if (compressedStatus \u003e 3) {\n          require(lastSegmentIndex == segments.length - 1, PriceSegmentHasAHole());\n        }\n\n        segments[lastSegmentIndex] = lastSegment;\n      }\n    } else {\n      require(lastSegmentIndex + 1 == newTombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset());\n    }\n\n    for (uint256 i = oldTombstoneOffset; i \u003c newTombstoneSegmentOffset; ++i) {\n      delete segments[i];\n    }\n\n    if (newTombstoneSegmentOffset != oldTombstoneOffset) {\n      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n    }\n\n    if (newTombstoneSegmentOffset \u003e= segments.length) {\n      tree.remove(bestPrice);\n    }\n  }5a:T6bb,  function _updateSegmentsAndTree(\n    BokkyPooBahsRedBlackTreeLibrary.Tree storage tree,\n    BokkyPooBahsRedBlackTreeLibrary.Node storage bestPriceNode,\n    bytes32[] storage segments,\n    uint64 bestPrice,\n    bytes32 lastSegment,\n    uint256 lastSegmentIndex,\n    uint256 numOrdersFullyConsumed\n  ) private {\n\n    uint256 numSegmentsFullyConsumed = numOrdersFullyConsumed / NUM_SLOTS_PER_SEGMENT;\n    uint256 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n    uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n\n    if (lastSegmentIndex == newTombstoneSegmentOffset) {\n      uint256"])</script><script>self.__next_f.push([1," numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n      lastSegment = lastSegment.clearUpToSlot(numOrdersWithinLastSegmentFullyConsumed);\n\n      if (uint256(lastSegment) == 0) {\n        newTombstoneSegmentOffset = lastSegmentIndex + 1;\n      } else {\n        uint256 compressedStatus = lastSegment.compressedStatus();\n        require(compressedStatus != 2, PriceSegmentHasAHole());\n        if (compressedStatus \u003e 3) {\n          require(lastSegmentIndex == segments.length - 1, PriceSegmentHasAHole());\n        }\n\n        segments[lastSegmentIndex] = lastSegment;\n      }\n    } else {\n      require(lastSegmentIndex + 1 == newTombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset());\n    }\n\n    for (uint256 i = oldTombstoneOffset; i \u003c newTombstoneSegmentOffset; ++i) {\n      delete segments[i];\n    }\n\n    if (newTombstoneSegmentOffset != oldTombstoneOffset) {\n      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n    }\n\n    if (newTombstoneSegmentOffset \u003e= segments.length) {\n      tree.remove(bestPrice);\n    }\n  }\n5b:T5454,"])</script><script>self.__next_f.push([1,"diff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol\nindex 31b5486..cd40406 100644\n--- a/contracts/SonicOrderBook.sol\n+++ b/contracts/SonicOrderBook.sol\n@@ -108,6 +108,12 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n   error SellMustUseExactQuantity();\n   error MakerPriceMustMatch(uint256 expectedPrice, uint256 actualPrice);\n \n+  // Errors related to price segment invariants being broken\n+  error PriceSegmentHasAHole();\n+  error IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset();\n+  error LastPriceSegmentCannotBeEmpty();\n+  error OnlyTheTombstoneSegmentCanStartWithEmptySlots();\n+\n   enum OrderSide {\n     Buy,\n     Sell\n@@ -158,7 +164,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 currentCost;\n     uint256 fee;\n     uint256 numberOfOrdersTraded;\n-    bool isBudgetConstrainedBuyingLimitReached;\n+    bool stopConsumingMoreOrders;\n   }\n \n   // A helper type for a view function to return orders. Packing doesn't matter\n@@ -681,7 +687,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n   }\n \n   function _shouldTakeMoreFromOrderBook(TakeFromOrderBookParams memory params) internal pure returns (bool) {\n-    if (params.isBudgetConstrainedBuyingLimitReached) {\n+    if (params.stopConsumingMoreOrders) {\n       return false;\n     }\n \n@@ -773,7 +779,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 lastConsumedSegmentIndex;\n     uint16 devFeeTakerBps = _devFeeTakerBps;\n \n-    for (uint256 i = node.tombstoneSegmentOffset; i \u003c segments.length \u0026\u0026 _shouldTakeMoreFromOrderBook(params); ++i) {\n+    uint256 segmentsLength = segments.length;\n+    uint256 tombstoneSegmentOffset = node.tombstoneSegmentOffset;\n+\n+    for (uint256 i = tombstoneSegmentOffset; i \u003c segmentsLength \u0026\u0026 _shouldTakeMoreFromOrderBook(params); ++i) {\n       lastConsumedSegmentIndex = i;\n       segment = segments[i];\n \n@@ -786,15 +795,67 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         bytes32 remainingSegment = segment.getRemainingSegment(slotIndex);\n         if (remainingSegment == 0) {\n           // Should only hit this branch on the last segment\n+\n+          // but if for some reason we hit this branch before\n+          // the last segment we add the count of slots skipped\n+          if (i \u003c segmentsLength - 1) {\n+            // This branch which should not be reachable\n+            revert PriceSegmentHasAHole();\n+          } else {\n+            // we are processing the last price segment in this branch\n+            // the possibilities are (o: an empty slot, s: slotIndex):\n+            // o    o    o(s) - BAD\n+            // o    o(s) ...  - skip incrementing `numOrdersFullyConsumed`\n+            // o(s) ...  ...  - skip incrementing `numOrdersFullyConsumed`\n+            if (slotIndex == 0) {\n+              // This branch which should not be reachable\n+              // the last segment in the active area of the price segment\n+              // only has empty slots\n+              // o    o    o(s) - BAD\n+              revert LastPriceSegmentCannotBeEmpty();\n+            }\n+          }\n+\n           break;\n         }\n \n         bytes10 slot = segment.getSlot(slotIndex);\n         uint48 orderId = slot.getOrderId();\n         if (orderId == 0) {\n-          // Skip this order in the segment as it's been deleted\n-          ++numOrdersFullyConsumed;\n-          continue;\n+          // we should only hit this branch at the very beginning of the\n+          // active area of the price segment pointed to by the `tombstoneSegmentOffset`\n+          // Possible configurations of this segment should be of the form:\n+          // (o: an empty slot, x: a non empty slot, s: slotIndex, ot = tombstoneSegmentOffset)\n+          // x o    o(s)  \u003c-- (i === ot) - allowed\n+          // x o(s) o     \u003c-- (i === ot) - allowed\n+          // x x    o(s)  \u003c-- (i === ot) - allowed\n+          //\n+          // x o    o(s)  \u003c-- (i =/= ot) - BAD\n+          // x o(s) o     \u003c-- (i =/= ot) - BAD\n+          // x x    o(s)  \u003c-- (i =/= ot) - BAD\n+          // x o(s) x     \u003c-- (i  \u003e= ot) - BAD\n+\n+          if (i == tombstoneSegmentOffset) {\n+            // x o    o(s)  \u003c-- (i === ot) - allowed\n+            // x o(s) o     \u003c-- (i === ot) - allowed\n+            // x x    o(s)  \u003c-- (i === ot) - allowed\n+            //\n+            // @dev we are allowing this potentially unreachable state below to pass through\n+            //      and just increment `numOrdersFullyConsumed`\n+            // x o(s) x     \u003c-- (i  == ot) - BAD\n+\n+            // Skip this order in the segment as it's been deleted\n+            ++numOrdersFullyConsumed;\n+            continue;\n+          } else {\n+            // this branch should be unreachable if all invariants are satisfied\n+            // x o    o(s)  \u003c-- (i =/= ot) - BAD\n+            // x o(s) o     \u003c-- (i =/= ot) - BAD\n+            // x x    o(s)  \u003c-- (i =/= ot) - BAD\n+            // x o(s) x     \u003c-- (i =/= ot) - BAD\n+\n+            revert OnlyTheTombstoneSegmentCanStartWithEmptySlots();\n+          }\n         }\n \n         uint256 ordersConsumed = 0;\n@@ -836,13 +897,13 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n       uint256 remainingBudget = params.maxCost - params.currentCost;\n \n       if (fullOrderCost \u003e remainingBudget) {\n+        // // Can't afford a full order, stop here as the slot will be potentially partially touched.\n+        params.stopConsumingMoreOrders = true;\n         // Check if we can afford partial order\n         uint256 maxAffordableQuantity = (remainingBudget * BASE_DECIMAL_DIVISOR) / params.bestPrice;\n         // Floor to QUANTITY_TICK to ensure proper alignment\n         maxAffordableQuantity = (maxAffordableQuantity / QUANTITY_TICK) * QUANTITY_TICK;\n         if (maxAffordableQuantity == 0) {\n-          // Can't afford any of this order, stop here\n-          params.isBudgetConstrainedBuyingLimitReached = true;\n           return (\n             segment,\n             0, // ordersConsumed\n@@ -880,6 +941,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         slot = slot.setQuantity(uint88(quantityL3 - quantityRemaining));\n         segment = segment.setSlot(slotIndex, slot);\n         quantityNFTClaimable = quantityRemaining;\n+        params.stopConsumingMoreOrders = true;\n       }\n \n       // at this point one should be able to prove that:\n@@ -915,39 +977,126 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 lastSegmentIndex,\n     uint256 numOrdersFullyConsumed\n   ) private {\n+    // `segments.length \u003e lastSegmentIndex \u003e= oldTombstoneOffset`\n+    // `numOrdersFullyConsumed` should be the number of order slots fully consumed\n+    // yet not modified but the cursor passed over it to the next order slot.\n+\n+    // Assumptions:\n+    //    1. `numSegmentsFullyConsumed` is calculated correctly, it should be the number of\n+    //       slots fully consumed or skipped if the slot was EMPTY (0)\n+    //    2. `lastSegmentIndex` points to the last segment consumed\n+    //    3. `lastSegment` is the segment pointed to by `lastSegmentIndex`\n+\n+    // [CHECK LIST] One should enforce the following for `lastSegment` (the last segment consumed):\n+    // (o: an EMPTY slot, x: a non-EMPTY slot)\n+    //\n+    // o o o - last consumed segment - ALLOWED (only if the price node gets removed from the tree)\n+    // o o x - last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+    // o x o - last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+    // o x x - last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+    // x o o - last consumed segment - ALLOWED (check `ot` point to this slot too)\n+    // x o x - last consumed segment - CATCH - no hole in the middle allowed\n+    // x x o - last consumed segment - ALLOWED (check `ot` point to this slot too)\n+    // x x x - last consumed segment - ALLOWED\n+\n     uint256 numSegmentsFullyConsumed = numOrdersFullyConsumed / NUM_SLOTS_PER_SEGMENT;\n-    uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n+    uint256 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n+    uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n \n-    uint56 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n-    if (numSegmentsFullyConsumed != 0) {\n-      // Cleanup segments to get a gas refund\n-      for (uint256 i = 0; i \u003c numSegmentsFullyConsumed; ++i) {\n-        delete segments[oldTombstoneOffset + i];\n-      }\n+    if (lastSegmentIndex == newTombstoneSegmentOffset) {\n+      // At this branch we know `segments.length \u003e lastSegmentIndex \u003e= newTombstoneSegmentOffset`\n+      uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n+      lastSegment = lastSegment.clearUpToSlot(numOrdersWithinLastSegmentFullyConsumed);\n \n-      uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n-      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n+      if (uint256(lastSegment) == 0) {\n+        // `lastSegment` has this property/assumption that either:\n+        // A1. An other was partially matched in this segment or\n+        // A2. We had reached the last segment in the active area of the price segments which\n+        //     has some zero slots (`if (remainingSegment == 0)` branch in `_consumePriceSegments`)\n+        //\n+        // Moreover, there is an assumption here that if `lastSegment` that was touched during the\n+        // matching/filling process ends up being `0` then that would mean, there are no orders\n+        // left in the price segments since A1 would not be possible and so for A2:\n+        // 1. any order slot before this segment should have been fully filled/matched and thus\n+        //    should have been zeroed out in the previous `if (numSegmentsFullyConsumed != 0)`\n+        //    block.\n+        // 2. There could not be any non-zero order slot past this segment since otherwise,\n+        //    that would indicate there would have been holes in the price segments previously\n+        //    breaking (Inv 1.)\n+        newTombstoneSegmentOffset = lastSegmentIndex + 1;\n+        // so we would have:\n+        // `segments.length \u003e= newTombstoneSegmentOffset == lastSegmentIndex + 1`\n+        // `newTombstoneSegmentOffset == lastSegmentIndex + 1 \u003e oldTombstoneOffset`\n+        // thus below `lastSegment` shuold get deleted\n+\n+        // o o o - last consumed segment - ALLOWED - it will get deleted and the new tombstone offset\n+        //                                           points to the following segment\n+\n+        // The checks from the [CHECK LIST] are not required since if one hits this branch and continue\n+        // without reverting, the last segment consumed would be removed from the price segments\n+        // and the new tombstone offset would point to the following segment.\n+      } else {\n+        // At this branch we know `segments.length \u003e lastSegmentIndex \u003e= newTombstoneSegmentOffset`\n+        // and `lastSegment` is non-zero, so at the end `bestPrice` would not get removed from the `tree`\n \n-      // Consumed all orders at this price level, so remove it from the tree\n-      if (newTombstoneSegmentOffset == segments.length) {\n-        tree.remove(bestPrice);\n-      }\n-    }\n \n-    bool lastSegmentDeleted = lastSegmentIndex \u003c (oldTombstoneOffset + numSegmentsFullyConsumed);\n-    if (!lastSegmentDeleted) {\n-      if (numOrdersWithinLastSegmentFullyConsumed != 0) {\n-        for (uint256 i; i \u003c numOrdersWithinLastSegmentFullyConsumed; ++i) {\n-          lastSegment = lastSegment.clearSlot(i);\n+        // s2 s1 s0 : cs(bits) : lastSegment \u003c-- (lastSegmentIndex == newTombstoneSegmentOffset)\n+        // --------------------------------(si: the `i`th slot, cs: compressed status)-------\n+        //  o  o  o :      111 : last consumed segment - ALLOWED (only if the price node gets removed from the tree)\n+        //  o  o  x :      110 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+        //  o  x  o :      101 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+        //  o  x  x :      100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+        //  x  o  o :      011 : last consumed segment - ALLOWED (check `ot` point to this slot too)\n+        //  x  o  x :      010 : last consumed segment - CATCH - no hole in the middle allowed\n+        //  x  x  o :      001 : last consumed segment - ALLOWED (check `ot` point to this slot too)\n+        //  x  x  x :      000 : last consumed segment - ALLOWED\n+\n+        uint256 compressedStatus = lastSegment.compressedStatus();\n+\n+        //  o  o  o : 111 : one would not enter this branch for this case\n+\n+        //  x  o  x : 010 : last consumed segment - CATCH - no hole in the middle allowed\n+        require(compressedStatus != 2, PriceSegmentHasAHole());\n+\n+        if (compressedStatus \u003e 3) {\n+          //  o  x  x : 100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+          //  o  x  o : 101 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+          //  o  o  x : 110 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+          require(lastSegmentIndex == segments.length - 1, PriceSegmentHasAHole());\n         }\n-      }\n \n-      if (uint256(lastSegment) == 0) {\n-        // All orders in the last segment are consumed, delete from tree\n-        tree.remove(bestPrice);\n-        // Don't pop segment for gas efficiency, instead just write zeros\n+        segments[lastSegmentIndex] = lastSegment;\n       }\n-      segments[lastSegmentIndex] = lastSegment;\n+    } else {\n+      // if `lastSegmentIndex =/= newTombstoneSegmentOffset` that would mean the matching process had ended up\n+      // with ( - dashes the slot can be 0 or not, c means that it was consumed):\n+      // ...\n+      // x(c) -(c) -(c) : lastSegmentIndex\n+      // where in the last segment, the last slot was fully filled and thus we would end up with:\n+      // ...\n+      // x(c) -(c) -(c) : lastSegmentIndex\n+      //   -  -    -    : newTombstoneSegmentOffset\n+      // So these values can only be off by `1`\n+      require(lastSegmentIndex + 1 == newTombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset());\n+\n+      // The checks from the [CHECK LIST] are not required since if one hits this branch and continue\n+      // without reverting, the last segment consumed would be removed from the price segments\n+      // and the new tombstone offset would point to the following segment.\n+    }\n+\n+    // Cleanup segments to get a gas refund\n+    for (uint256 i = oldTombstoneOffset; i \u003c newTombstoneSegmentOffset; ++i) {\n+      delete segments[i];\n+    }\n+\n+    if (newTombstoneSegmentOffset != oldTombstoneOffset) {\n+      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n+    }\n+\n+    // below one can add an extra branch for `newTombstoneSegmentOffset \u003e segments.length`\n+    // and possibly revert since that would mean some invariant was broken.\n+    if (newTombstoneSegmentOffset \u003e= segments.length) {\n+      tree.remove(bestPrice);\n     }\n   }\n \n@@ -1000,7 +1149,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     bytes32[] storage segments,\n     BokkyPooBahsRedBlackTreeLibrary.Tree storage tree\n   ) private returns (uint88 quantity) {\n-    BokkyPooBahsRedBlackTreeLibrary.Node storage node = tree.getNodeUnsafe(price);\n+    BokkyPooBahsRedBlackTreeLibrary.Node storage node = tree.getNode(price);\n     uint256 tombstoneSegmentOffset = node.tombstoneSegmentOffset;\n \n     (uint256 segmentIndex, uint256 slotIndex) = _find(segments, tombstoneSegmentOffset, segments.length, orderId);\n@@ -1058,7 +1207,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n       currentCost: 0,\n       fee: 0,\n       numberOfOrdersTraded: 0,\n-      isBudgetConstrainedBuyingLimitReached: false\n+      stopConsumingMoreOrders: false\n     });\n \n     _takeFromOrderBook(params, orderIdsPool, quantitiesPool, pricesPool);\n@@ -1105,7 +1254,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n       params.currentCost = 0;\n       params.fee = 0;\n       params.numberOfOrdersTraded = 0;\n-      params.isBudgetConstrainedBuyingLimitReached = false;\n+      params.stopConsumingMoreOrders = false;\n     }\n \n     _takeFromOrderBook(params, orderIdsPool, quantitiesPool, pricesPool);\n@@ -1409,6 +1558,17 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         bytes32 currentSegment = segments[currentSegmentIndex];\n         bytes10 nextSlot = currentOrNextSegment.getSlot(nextSlotIndex);\n         if (nextSlot == 0) {\n+          // When reaching a hole, make sure it has iterated to the last order.\n+\n+          // Must iterate to the last seg\n+          require(nextSegmentIndex == segments.length - 1, PriceSegmentHasAHole());\n+\n+          // nextSlot and subsequent slots must be empty\n+          require(currentOrNextSegment.getRemainingSegment(nextSlotIndex) == 0, PriceSegmentHasAHole());\n+\n+          // The last non-empty order must be in `seg[seg.len-1]` (`seg.len-1` cannot point to an empty segment).\n+          require(nextSlotIndex \u003e 0, LastPriceSegmentCannotBeEmpty());\n+\n           // There are no more orders left, reset back to the currently iterated order as the last\n           nextSegmentIndex = currentSegmentIndex;\n           nextSlotIndex = currentSlotIndex;\ndiff --git a/contracts/libraries/SegmentLibrary.sol b/contracts/libraries/SegmentLibrary.sol\nindex d884717..e7c91a2 100644\n--- a/contracts/libraries/SegmentLibrary.sol\n+++ b/contracts/libraries/SegmentLibrary.sol\n@@ -43,6 +43,39 @@ library SegmentLibrary {\n     return bytes10(uint80((uint256(segment) \u003e\u003e (slotIndex * SEGMENT_SIZE)) \u0026 SEGMENT_MASK));\n   }\n \n+  /// @notice Compresses the segment into 3 indicator bits\n+  /// @param segment The segment to read from\n+  /// @return status with only 3 bits sets each indicating whether the corresponding\n+  //                 slot in the segment is EMPTY or not.\n+  function compressedStatus(bytes32 segment) internal pure returns (uint256 status) {\n+    uint256 MASK = SEGMENT_MASK;\n+    uint256 SIZE = SEGMENT_SIZE;\n+\n+    assembly (\"memory-safe\") {\n+      // s2 s1 s0 : segment\n+      status := iszero(and(segment, MASK))\n+      segment := shr(SIZE, segment)\n+\n+      //  0 s2 s1 : segment\n+      status := or(\n+        shl(1, iszero(and(segment, MASK))),\n+        status\n+      )\n+      segment := shr(SIZE, segment)\n+\n+      //  0  0 s2 : segment\n+      status := or(\n+        shl(2, iszero(and(segment, MASK))), // still mask in case segment has dirty uppper bits\n+        status\n+      )\n+\n+      // b2 b1 b0 : status bits (it would only have 3 set bits)\n+      // b2       : is 1 if s2 the 3rd slot of original segment was EMPTY\n+      //    b1    : is 1 if s1 the 2nd slot of original segment was EMPTY\n+      //       b0 : is 1 if s0 the 1st slot of original segment was EMPTY\n+    }\n+  }\n+\n   /// @notice Checks if the segment only contains data in the specified slot\n   /// @dev Returns true if all other slots in the segment are empty (zero)\n   /// @param segment The segment to check\n@@ -60,6 +93,19 @@ library SegmentLibrary {\n     return bytes32(uint256(segment) \u0026 ~(uint256(SEGMENT_MASK) \u003c\u003c (slotIndex * SEGMENT_SIZE)));\n   }\n \n+  /// @notice Clears slots up to the specified index, setting all its bits to zero\n+  /// @param segment The segment to modify\n+  /// @param slotIndex The index of the slot to clear up to (0, 1, or 2)\n+  /// @return newSegment The updated segment with the right most slots cleared up to `slotIndex`\n+  function clearUpToSlot(bytes32 segment, uint256 slotIndex) internal pure returns (bytes32 newSegment) {\n+    if (slotIndex == 0) {\n+      return segment;\n+    }\n+\n+    uint256 shiftAmount = slotIndex * SEGMENT_SIZE;\n+    return bytes32((uint256(segment) \u003e\u003e (shiftAmount)) \u003c\u003c shiftAmount);\n+  }\n+\n   /// @notice Returns the remaining segment data after the specified slot index\n   /// @dev Shifts the segment right to remove all slots up to and including the specified index.\n   ///      Useful for iterating through higher-indexed slots or processing remaining data.\ndiff --git a/contracts/libraries/SonicOrderBookLibrary.sol b/contracts/libraries/SonicOrderBookLibrary.sol\nindex de229f7..08cd374 100644\n--- a/contracts/libraries/SonicOrderBookLibrary.sol\n+++ b/contracts/libraries/SonicOrderBookLibrary.sol\n@@ -31,6 +31,7 @@ library SonicOrderBookLibrary {\n   error DevFeeTooHigh();\n   error DevFeeNotSet();\n   error MaxOrdersNotMultipleOfOrdersInSegment();\n+  error PriceTickShouldBeAMutipleOf100();\n \n   uint256 private constant SET_TRADEABLE_THRESHOLD_LOCKED_BURN_TIME = 7 days;\n \n@@ -57,6 +58,7 @@ library SonicOrderBookLibrary {\n \n       require(existingTick == 0 || existingTick == newTick, PriceTickCannotBeChanged());\n       require(newTick != 0, PriceTickCannotBeZero());\n+      require(newTick % 100 == 0, PriceTickShouldBeAMutipleOf100());\n \n       SeasonData memory seasonData = nft.getSeasonData(Season(tokenId));\n       if (seasonData.startTime != 0 \u0026\u0026 tokenIdInfos[i].isTradeable) {\n"])</script><script>self.__next_f.push([1,"5c:T5453,"])</script><script>self.__next_f.push([1,"diff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol\nindex 31b5486..cd40406 100644\n--- a/contracts/SonicOrderBook.sol\n+++ b/contracts/SonicOrderBook.sol\n@@ -108,6 +108,12 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n   error SellMustUseExactQuantity();\n   error MakerPriceMustMatch(uint256 expectedPrice, uint256 actualPrice);\n \n+  // Errors related to price segment invariants being broken\n+  error PriceSegmentHasAHole();\n+  error IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset();\n+  error LastPriceSegmentCannotBeEmpty();\n+  error OnlyTheTombstoneSegmentCanStartWithEmptySlots();\n+\n   enum OrderSide {\n     Buy,\n     Sell\n@@ -158,7 +164,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 currentCost;\n     uint256 fee;\n     uint256 numberOfOrdersTraded;\n-    bool isBudgetConstrainedBuyingLimitReached;\n+    bool stopConsumingMoreOrders;\n   }\n \n   // A helper type for a view function to return orders. Packing doesn't matter\n@@ -681,7 +687,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n   }\n \n   function _shouldTakeMoreFromOrderBook(TakeFromOrderBookParams memory params) internal pure returns (bool) {\n-    if (params.isBudgetConstrainedBuyingLimitReached) {\n+    if (params.stopConsumingMoreOrders) {\n       return false;\n     }\n \n@@ -773,7 +779,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 lastConsumedSegmentIndex;\n     uint16 devFeeTakerBps = _devFeeTakerBps;\n \n-    for (uint256 i = node.tombstoneSegmentOffset; i \u003c segments.length \u0026\u0026 _shouldTakeMoreFromOrderBook(params); ++i) {\n+    uint256 segmentsLength = segments.length;\n+    uint256 tombstoneSegmentOffset = node.tombstoneSegmentOffset;\n+\n+    for (uint256 i = tombstoneSegmentOffset; i \u003c segmentsLength \u0026\u0026 _shouldTakeMoreFromOrderBook(params); ++i) {\n       lastConsumedSegmentIndex = i;\n       segment = segments[i];\n \n@@ -786,15 +795,67 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         bytes32 remainingSegment = segment.getRemainingSegment(slotIndex);\n         if (remainingSegment == 0) {\n           // Should only hit this branch on the last segment\n+\n+          // but if for some reason we hit this branch before\n+          // the last segment we add the count of slots skipped\n+          if (i \u003c segmentsLength - 1) {\n+            // This branch which should not be reachable\n+            revert PriceSegmentHasAHole();\n+          } else {\n+            // we are processing the last price segment in this branch\n+            // the possibilities are (o: an empty slot, s: slotIndex):\n+            // o    o    o(s) - BAD\n+            // o    o(s) ...  - skip incrementing `numOrdersFullyConsumed`\n+            // o(s) ...  ...  - skip incrementing `numOrdersFullyConsumed`\n+            if (slotIndex == 0) {\n+              // This branch which should not be reachable\n+              // the last segment in the active area of the price segment\n+              // only has empty slots\n+              // o    o    o(s) - BAD\n+              revert LastPriceSegmentCannotBeEmpty();\n+            }\n+          }\n+\n           break;\n         }\n \n         bytes10 slot = segment.getSlot(slotIndex);\n         uint48 orderId = slot.getOrderId();\n         if (orderId == 0) {\n-          // Skip this order in the segment as it's been deleted\n-          ++numOrdersFullyConsumed;\n-          continue;\n+          // we should only hit this branch at the very beginning of the\n+          // active area of the price segment pointed to by the `tombstoneSegmentOffset`\n+          // Possible configurations of this segment should be of the form:\n+          // (o: an empty slot, x: a non empty slot, s: slotIndex, ot = tombstoneSegmentOffset)\n+          // x o    o(s)  \u003c-- (i === ot) - allowed\n+          // x o(s) o     \u003c-- (i === ot) - allowed\n+          // x x    o(s)  \u003c-- (i === ot) - allowed\n+          //\n+          // x o    o(s)  \u003c-- (i =/= ot) - BAD\n+          // x o(s) o     \u003c-- (i =/= ot) - BAD\n+          // x x    o(s)  \u003c-- (i =/= ot) - BAD\n+          // x o(s) x     \u003c-- (i  \u003e= ot) - BAD\n+\n+          if (i == tombstoneSegmentOffset) {\n+            // x o    o(s)  \u003c-- (i === ot) - allowed\n+            // x o(s) o     \u003c-- (i === ot) - allowed\n+            // x x    o(s)  \u003c-- (i === ot) - allowed\n+            //\n+            // @dev we are allowing this potentially unreachable state below to pass through\n+            //      and just increment `numOrdersFullyConsumed`\n+            // x o(s) x     \u003c-- (i  == ot) - BAD\n+\n+            // Skip this order in the segment as it's been deleted\n+            ++numOrdersFullyConsumed;\n+            continue;\n+          } else {\n+            // this branch should be unreachable if all invariants are satisfied\n+            // x o    o(s)  \u003c-- (i =/= ot) - BAD\n+            // x o(s) o     \u003c-- (i =/= ot) - BAD\n+            // x x    o(s)  \u003c-- (i =/= ot) - BAD\n+            // x o(s) x     \u003c-- (i =/= ot) - BAD\n+\n+            revert OnlyTheTombstoneSegmentCanStartWithEmptySlots();\n+          }\n         }\n \n         uint256 ordersConsumed = 0;\n@@ -836,13 +897,13 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n       uint256 remainingBudget = params.maxCost - params.currentCost;\n \n       if (fullOrderCost \u003e remainingBudget) {\n+        // // Can't afford a full order, stop here as the slot will be potentially partially touched.\n+        params.stopConsumingMoreOrders = true;\n         // Check if we can afford partial order\n         uint256 maxAffordableQuantity = (remainingBudget * BASE_DECIMAL_DIVISOR) / params.bestPrice;\n         // Floor to QUANTITY_TICK to ensure proper alignment\n         maxAffordableQuantity = (maxAffordableQuantity / QUANTITY_TICK) * QUANTITY_TICK;\n         if (maxAffordableQuantity == 0) {\n-          // Can't afford any of this order, stop here\n-          params.isBudgetConstrainedBuyingLimitReached = true;\n           return (\n             segment,\n             0, // ordersConsumed\n@@ -880,6 +941,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         slot = slot.setQuantity(uint88(quantityL3 - quantityRemaining));\n         segment = segment.setSlot(slotIndex, slot);\n         quantityNFTClaimable = quantityRemaining;\n+        params.stopConsumingMoreOrders = true;\n       }\n \n       // at this point one should be able to prove that:\n@@ -915,39 +977,126 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 lastSegmentIndex,\n     uint256 numOrdersFullyConsumed\n   ) private {\n+    // `segments.length \u003e lastSegmentIndex \u003e= oldTombstoneOffset`\n+    // `numOrdersFullyConsumed` should be the number of order slots fully consumed\n+    // yet not modified but the cursor passed over it to the next order slot.\n+\n+    // Assumptions:\n+    //    1. `numSegmentsFullyConsumed` is calculated correctly, it should be the number of\n+    //       slots fully consumed or skipped if the slot was EMPTY (0)\n+    //    2. `lastSegmentIndex` points to the last segment consumed\n+    //    3. `lastSegment` is the segment pointed to by `lastSegmentIndex`\n+\n+    // [CHECK LIST] One should enforce the following for `lastSegment` (the last segment consumed):\n+    // (o: an EMPTY slot, x: a non-EMPTY slot)\n+    //\n+    // o o o - last consumed segment - ALLOWED (only if the price node gets removed from the tree)\n+    // o o x - last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+    // o x o - last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+    // o x x - last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+    // x o o - last consumed segment - ALLOWED (check `ot` point to this slot too)\n+    // x o x - last consumed segment - CATCH - no hole in the middle allowed\n+    // x x o - last consumed segment - ALLOWED (check `ot` point to this slot too)\n+    // x x x - last consumed segment - ALLOWED\n+\n     uint256 numSegmentsFullyConsumed = numOrdersFullyConsumed / NUM_SLOTS_PER_SEGMENT;\n-    uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n+    uint256 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n+    uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n \n-    uint56 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n-    if (numSegmentsFullyConsumed != 0) {\n-      // Cleanup segments to get a gas refund\n-      for (uint256 i = 0; i \u003c numSegmentsFullyConsumed; ++i) {\n-        delete segments[oldTombstoneOffset + i];\n-      }\n+    if (lastSegmentIndex == newTombstoneSegmentOffset) {\n+      // At this branch we know `segments.length \u003e lastSegmentIndex \u003e= newTombstoneSegmentOffset`\n+      uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n+      lastSegment = lastSegment.clearUpToSlot(numOrdersWithinLastSegmentFullyConsumed);\n \n-      uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n-      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n+      if (uint256(lastSegment) == 0) {\n+        // `lastSegment` has this property/assumption that either:\n+        // A1. An other was partially matched in this segment or\n+        // A2. We had reached the last segment in the active area of the price segments which\n+        //     has some zero slots (`if (remainingSegment == 0)` branch in `_consumePriceSegments`)\n+        //\n+        // Moreover, there is an assumption here that if `lastSegment` that was touched during the\n+        // matching/filling process ends up being `0` then that would mean, there are no orders\n+        // left in the price segments since A1 would not be possible and so for A2:\n+        // 1. any order slot before this segment should have been fully filled/matched and thus\n+        //    should have been zeroed out in the previous `if (numSegmentsFullyConsumed != 0)`\n+        //    block.\n+        // 2. There could not be any non-zero order slot past this segment since otherwise,\n+        //    that would indicate there would have been holes in the price segments previously\n+        //    breaking (Inv 1.)\n+        newTombstoneSegmentOffset = lastSegmentIndex + 1;\n+        // so we would have:\n+        // `segments.length \u003e= newTombstoneSegmentOffset == lastSegmentIndex + 1`\n+        // `newTombstoneSegmentOffset == lastSegmentIndex + 1 \u003e oldTombstoneOffset`\n+        // thus below `lastSegment` shuold get deleted\n+\n+        // o o o - last consumed segment - ALLOWED - it will get deleted and the new tombstone offset\n+        //                                           points to the following segment\n+\n+        // The checks from the [CHECK LIST] are not required since if one hits this branch and continue\n+        // without reverting, the last segment consumed would be removed from the price segments\n+        // and the new tombstone offset would point to the following segment.\n+      } else {\n+        // At this branch we know `segments.length \u003e lastSegmentIndex \u003e= newTombstoneSegmentOffset`\n+        // and `lastSegment` is non-zero, so at the end `bestPrice` would not get removed from the `tree`\n \n-      // Consumed all orders at this price level, so remove it from the tree\n-      if (newTombstoneSegmentOffset == segments.length) {\n-        tree.remove(bestPrice);\n-      }\n-    }\n \n-    bool lastSegmentDeleted = lastSegmentIndex \u003c (oldTombstoneOffset + numSegmentsFullyConsumed);\n-    if (!lastSegmentDeleted) {\n-      if (numOrdersWithinLastSegmentFullyConsumed != 0) {\n-        for (uint256 i; i \u003c numOrdersWithinLastSegmentFullyConsumed; ++i) {\n-          lastSegment = lastSegment.clearSlot(i);\n+        // s2 s1 s0 : cs(bits) : lastSegment \u003c-- (lastSegmentIndex == newTombstoneSegmentOffset)\n+        // --------------------------------(si: the `i`th slot, cs: compressed status)-------\n+        //  o  o  o :      111 : last consumed segment - ALLOWED (only if the price node gets removed from the tree)\n+        //  o  o  x :      110 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+        //  o  x  o :      101 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+        //  o  x  x :      100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+        //  x  o  o :      011 : last consumed segment - ALLOWED (check `ot` point to this slot too)\n+        //  x  o  x :      010 : last consumed segment - CATCH - no hole in the middle allowed\n+        //  x  x  o :      001 : last consumed segment - ALLOWED (check `ot` point to this slot too)\n+        //  x  x  x :      000 : last consumed segment - ALLOWED\n+\n+        uint256 compressedStatus = lastSegment.compressedStatus();\n+\n+        //  o  o  o : 111 : one would not enter this branch for this case\n+\n+        //  x  o  x : 010 : last consumed segment - CATCH - no hole in the middle allowed\n+        require(compressedStatus != 2, PriceSegmentHasAHole());\n+\n+        if (compressedStatus \u003e 3) {\n+          //  o  x  x : 100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+          //  o  x  o : 101 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+          //  o  o  x : 110 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+          require(lastSegmentIndex == segments.length - 1, PriceSegmentHasAHole());\n         }\n-      }\n \n-      if (uint256(lastSegment) == 0) {\n-        // All orders in the last segment are consumed, delete from tree\n-        tree.remove(bestPrice);\n-        // Don't pop segment for gas efficiency, instead just write zeros\n+        segments[lastSegmentIndex] = lastSegment;\n       }\n-      segments[lastSegmentIndex] = lastSegment;\n+    } else {\n+      // if `lastSegmentIndex =/= newTombstoneSegmentOffset` that would mean the matching process had ended up\n+      // with ( - dashes the slot can be 0 or not, c means that it was consumed):\n+      // ...\n+      // x(c) -(c) -(c) : lastSegmentIndex\n+      // where in the last segment, the last slot was fully filled and thus we would end up with:\n+      // ...\n+      // x(c) -(c) -(c) : lastSegmentIndex\n+      //   -  -    -    : newTombstoneSegmentOffset\n+      // So these values can only be off by `1`\n+      require(lastSegmentIndex + 1 == newTombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset());\n+\n+      // The checks from the [CHECK LIST] are not required since if one hits this branch and continue\n+      // without reverting, the last segment consumed would be removed from the price segments\n+      // and the new tombstone offset would point to the following segment.\n+    }\n+\n+    // Cleanup segments to get a gas refund\n+    for (uint256 i = oldTombstoneOffset; i \u003c newTombstoneSegmentOffset; ++i) {\n+      delete segments[i];\n+    }\n+\n+    if (newTombstoneSegmentOffset != oldTombstoneOffset) {\n+      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n+    }\n+\n+    // below one can add an extra branch for `newTombstoneSegmentOffset \u003e segments.length`\n+    // and possibly revert since that would mean some invariant was broken.\n+    if (newTombstoneSegmentOffset \u003e= segments.length) {\n+      tree.remove(bestPrice);\n     }\n   }\n \n@@ -1000,7 +1149,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     bytes32[] storage segments,\n     BokkyPooBahsRedBlackTreeLibrary.Tree storage tree\n   ) private returns (uint88 quantity) {\n-    BokkyPooBahsRedBlackTreeLibrary.Node storage node = tree.getNodeUnsafe(price);\n+    BokkyPooBahsRedBlackTreeLibrary.Node storage node = tree.getNode(price);\n     uint256 tombstoneSegmentOffset = node.tombstoneSegmentOffset;\n \n     (uint256 segmentIndex, uint256 slotIndex) = _find(segments, tombstoneSegmentOffset, segments.length, orderId);\n@@ -1058,7 +1207,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n       currentCost: 0,\n       fee: 0,\n       numberOfOrdersTraded: 0,\n-      isBudgetConstrainedBuyingLimitReached: false\n+      stopConsumingMoreOrders: false\n     });\n \n     _takeFromOrderBook(params, orderIdsPool, quantitiesPool, pricesPool);\n@@ -1105,7 +1254,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n       params.currentCost = 0;\n       params.fee = 0;\n       params.numberOfOrdersTraded = 0;\n-      params.isBudgetConstrainedBuyingLimitReached = false;\n+      params.stopConsumingMoreOrders = false;\n     }\n \n     _takeFromOrderBook(params, orderIdsPool, quantitiesPool, pricesPool);\n@@ -1409,6 +1558,17 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         bytes32 currentSegment = segments[currentSegmentIndex];\n         bytes10 nextSlot = currentOrNextSegment.getSlot(nextSlotIndex);\n         if (nextSlot == 0) {\n+          // When reaching a hole, make sure it has iterated to the last order.\n+\n+          // Must iterate to the last seg\n+          require(nextSegmentIndex == segments.length - 1, PriceSegmentHasAHole());\n+\n+          // nextSlot and subsequent slots must be empty\n+          require(currentOrNextSegment.getRemainingSegment(nextSlotIndex) == 0, PriceSegmentHasAHole());\n+\n+          // The last non-empty order must be in `seg[seg.len-1]` (`seg.len-1` cannot point to an empty segment).\n+          require(nextSlotIndex \u003e 0, LastPriceSegmentCannotBeEmpty());\n+\n           // There are no more orders left, reset back to the currently iterated order as the last\n           nextSegmentIndex = currentSegmentIndex;\n           nextSlotIndex = currentSlotIndex;\ndiff --git a/contracts/libraries/SegmentLibrary.sol b/contracts/libraries/SegmentLibrary.sol\nindex d884717..e7c91a2 100644\n--- a/contracts/libraries/SegmentLibrary.sol\n+++ b/contracts/libraries/SegmentLibrary.sol\n@@ -43,6 +43,39 @@ library SegmentLibrary {\n     return bytes10(uint80((uint256(segment) \u003e\u003e (slotIndex * SEGMENT_SIZE)) \u0026 SEGMENT_MASK));\n   }\n \n+  /// @notice Compresses the segment into 3 indicator bits\n+  /// @param segment The segment to read from\n+  /// @return status with only 3 bits sets each indicating whether the corresponding\n+  //                 slot in the segment is EMPTY or not.\n+  function compressedStatus(bytes32 segment) internal pure returns (uint256 status) {\n+    uint256 MASK = SEGMENT_MASK;\n+    uint256 SIZE = SEGMENT_SIZE;\n+\n+    assembly (\"memory-safe\") {\n+      // s2 s1 s0 : segment\n+      status := iszero(and(segment, MASK))\n+      segment := shr(SIZE, segment)\n+\n+      //  0 s2 s1 : segment\n+      status := or(\n+        shl(1, iszero(and(segment, MASK))),\n+        status\n+      )\n+      segment := shr(SIZE, segment)\n+\n+      //  0  0 s2 : segment\n+      status := or(\n+        shl(2, iszero(and(segment, MASK))), // still mask in case segment has dirty uppper bits\n+        status\n+      )\n+\n+      // b2 b1 b0 : status bits (it would only have 3 set bits)\n+      // b2       : is 1 if s2 the 3rd slot of original segment was EMPTY\n+      //    b1    : is 1 if s1 the 2nd slot of original segment was EMPTY\n+      //       b0 : is 1 if s0 the 1st slot of original segment was EMPTY\n+    }\n+  }\n+\n   /// @notice Checks if the segment only contains data in the specified slot\n   /// @dev Returns true if all other slots in the segment are empty (zero)\n   /// @param segment The segment to check\n@@ -60,6 +93,19 @@ library SegmentLibrary {\n     return bytes32(uint256(segment) \u0026 ~(uint256(SEGMENT_MASK) \u003c\u003c (slotIndex * SEGMENT_SIZE)));\n   }\n \n+  /// @notice Clears slots up to the specified index, setting all its bits to zero\n+  /// @param segment The segment to modify\n+  /// @param slotIndex The index of the slot to clear up to (0, 1, or 2)\n+  /// @return newSegment The updated segment with the right most slots cleared up to `slotIndex`\n+  function clearUpToSlot(bytes32 segment, uint256 slotIndex) internal pure returns (bytes32 newSegment) {\n+    if (slotIndex == 0) {\n+      return segment;\n+    }\n+\n+    uint256 shiftAmount = slotIndex * SEGMENT_SIZE;\n+    return bytes32((uint256(segment) \u003e\u003e (shiftAmount)) \u003c\u003c shiftAmount);\n+  }\n+\n   /// @notice Returns the remaining segment data after the specified slot index\n   /// @dev Shifts the segment right to remove all slots up to and including the specified index.\n   ///      Useful for iterating through higher-indexed slots or processing remaining data.\ndiff --git a/contracts/libraries/SonicOrderBookLibrary.sol b/contracts/libraries/SonicOrderBookLibrary.sol\nindex de229f7..08cd374 100644\n--- a/contracts/libraries/SonicOrderBookLibrary.sol\n+++ b/contracts/libraries/SonicOrderBookLibrary.sol\n@@ -31,6 +31,7 @@ library SonicOrderBookLibrary {\n   error DevFeeTooHigh();\n   error DevFeeNotSet();\n   error MaxOrdersNotMultipleOfOrdersInSegment();\n+  error PriceTickShouldBeAMutipleOf100();\n \n   uint256 private constant SET_TRADEABLE_THRESHOLD_LOCKED_BURN_TIME = 7 days;\n \n@@ -57,6 +58,7 @@ library SonicOrderBookLibrary {\n \n       require(existingTick == 0 || existingTick == newTick, PriceTickCannotBeChanged());\n       require(newTick != 0, PriceTickCannotBeZero());\n+      require(newTick % 100 == 0, PriceTickShouldBeAMutipleOf100());\n \n       SeasonData memory seasonData = nft.getSeasonData(Season(tokenId));\n       if (seasonData.startTime != 0 \u0026\u0026 tokenIdInfos[i].isTradeable) {"])</script><script>self.__next_f.push([1,"5d:T5454,"])</script><script>self.__next_f.push([1,"diff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol\nindex 31b5486..cd40406 100644\n--- a/contracts/SonicOrderBook.sol\n+++ b/contracts/SonicOrderBook.sol\n@@ -108,6 +108,12 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n   error SellMustUseExactQuantity();\n   error MakerPriceMustMatch(uint256 expectedPrice, uint256 actualPrice);\n \n+  // Errors related to price segment invariants being broken\n+  error PriceSegmentHasAHole();\n+  error IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset();\n+  error LastPriceSegmentCannotBeEmpty();\n+  error OnlyTheTombstoneSegmentCanStartWithEmptySlots();\n+\n   enum OrderSide {\n     Buy,\n     Sell\n@@ -158,7 +164,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 currentCost;\n     uint256 fee;\n     uint256 numberOfOrdersTraded;\n-    bool isBudgetConstrainedBuyingLimitReached;\n+    bool stopConsumingMoreOrders;\n   }\n \n   // A helper type for a view function to return orders. Packing doesn't matter\n@@ -681,7 +687,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n   }\n \n   function _shouldTakeMoreFromOrderBook(TakeFromOrderBookParams memory params) internal pure returns (bool) {\n-    if (params.isBudgetConstrainedBuyingLimitReached) {\n+    if (params.stopConsumingMoreOrders) {\n       return false;\n     }\n \n@@ -773,7 +779,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 lastConsumedSegmentIndex;\n     uint16 devFeeTakerBps = _devFeeTakerBps;\n \n-    for (uint256 i = node.tombstoneSegmentOffset; i \u003c segments.length \u0026\u0026 _shouldTakeMoreFromOrderBook(params); ++i) {\n+    uint256 segmentsLength = segments.length;\n+    uint256 tombstoneSegmentOffset = node.tombstoneSegmentOffset;\n+\n+    for (uint256 i = tombstoneSegmentOffset; i \u003c segmentsLength \u0026\u0026 _shouldTakeMoreFromOrderBook(params); ++i) {\n       lastConsumedSegmentIndex = i;\n       segment = segments[i];\n \n@@ -786,15 +795,67 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         bytes32 remainingSegment = segment.getRemainingSegment(slotIndex);\n         if (remainingSegment == 0) {\n           // Should only hit this branch on the last segment\n+\n+          // but if for some reason we hit this branch before\n+          // the last segment we add the count of slots skipped\n+          if (i \u003c segmentsLength - 1) {\n+            // This branch which should not be reachable\n+            revert PriceSegmentHasAHole();\n+          } else {\n+            // we are processing the last price segment in this branch\n+            // the possibilities are (o: an empty slot, s: slotIndex):\n+            // o    o    o(s) - BAD\n+            // o    o(s) ...  - skip incrementing `numOrdersFullyConsumed`\n+            // o(s) ...  ...  - skip incrementing `numOrdersFullyConsumed`\n+            if (slotIndex == 0) {\n+              // This branch which should not be reachable\n+              // the last segment in the active area of the price segment\n+              // only has empty slots\n+              // o    o    o(s) - BAD\n+              revert LastPriceSegmentCannotBeEmpty();\n+            }\n+          }\n+\n           break;\n         }\n \n         bytes10 slot = segment.getSlot(slotIndex);\n         uint48 orderId = slot.getOrderId();\n         if (orderId == 0) {\n-          // Skip this order in the segment as it's been deleted\n-          ++numOrdersFullyConsumed;\n-          continue;\n+          // we should only hit this branch at the very beginning of the\n+          // active area of the price segment pointed to by the `tombstoneSegmentOffset`\n+          // Possible configurations of this segment should be of the form:\n+          // (o: an empty slot, x: a non empty slot, s: slotIndex, ot = tombstoneSegmentOffset)\n+          // x o    o(s)  \u003c-- (i === ot) - allowed\n+          // x o(s) o     \u003c-- (i === ot) - allowed\n+          // x x    o(s)  \u003c-- (i === ot) - allowed\n+          //\n+          // x o    o(s)  \u003c-- (i =/= ot) - BAD\n+          // x o(s) o     \u003c-- (i =/= ot) - BAD\n+          // x x    o(s)  \u003c-- (i =/= ot) - BAD\n+          // x o(s) x     \u003c-- (i  \u003e= ot) - BAD\n+\n+          if (i == tombstoneSegmentOffset) {\n+            // x o    o(s)  \u003c-- (i === ot) - allowed\n+            // x o(s) o     \u003c-- (i === ot) - allowed\n+            // x x    o(s)  \u003c-- (i === ot) - allowed\n+            //\n+            // @dev we are allowing this potentially unreachable state below to pass through\n+            //      and just increment `numOrdersFullyConsumed`\n+            // x o(s) x     \u003c-- (i  == ot) - BAD\n+\n+            // Skip this order in the segment as it's been deleted\n+            ++numOrdersFullyConsumed;\n+            continue;\n+          } else {\n+            // this branch should be unreachable if all invariants are satisfied\n+            // x o    o(s)  \u003c-- (i =/= ot) - BAD\n+            // x o(s) o     \u003c-- (i =/= ot) - BAD\n+            // x x    o(s)  \u003c-- (i =/= ot) - BAD\n+            // x o(s) x     \u003c-- (i =/= ot) - BAD\n+\n+            revert OnlyTheTombstoneSegmentCanStartWithEmptySlots();\n+          }\n         }\n \n         uint256 ordersConsumed = 0;\n@@ -836,13 +897,13 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n       uint256 remainingBudget = params.maxCost - params.currentCost;\n \n       if (fullOrderCost \u003e remainingBudget) {\n+        // // Can't afford a full order, stop here as the slot will be potentially partially touched.\n+        params.stopConsumingMoreOrders = true;\n         // Check if we can afford partial order\n         uint256 maxAffordableQuantity = (remainingBudget * BASE_DECIMAL_DIVISOR) / params.bestPrice;\n         // Floor to QUANTITY_TICK to ensure proper alignment\n         maxAffordableQuantity = (maxAffordableQuantity / QUANTITY_TICK) * QUANTITY_TICK;\n         if (maxAffordableQuantity == 0) {\n-          // Can't afford any of this order, stop here\n-          params.isBudgetConstrainedBuyingLimitReached = true;\n           return (\n             segment,\n             0, // ordersConsumed\n@@ -880,6 +941,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         slot = slot.setQuantity(uint88(quantityL3 - quantityRemaining));\n         segment = segment.setSlot(slotIndex, slot);\n         quantityNFTClaimable = quantityRemaining;\n+        params.stopConsumingMoreOrders = true;\n       }\n \n       // at this point one should be able to prove that:\n@@ -915,39 +977,126 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 lastSegmentIndex,\n     uint256 numOrdersFullyConsumed\n   ) private {\n+    // `segments.length \u003e lastSegmentIndex \u003e= oldTombstoneOffset`\n+    // `numOrdersFullyConsumed` should be the number of order slots fully consumed\n+    // yet not modified but the cursor passed over it to the next order slot.\n+\n+    // Assumptions:\n+    //    1. `numSegmentsFullyConsumed` is calculated correctly, it should be the number of\n+    //       slots fully consumed or skipped if the slot was EMPTY (0)\n+    //    2. `lastSegmentIndex` points to the last segment consumed\n+    //    3. `lastSegment` is the segment pointed to by `lastSegmentIndex`\n+\n+    // [CHECK LIST] One should enforce the following for `lastSegment` (the last segment consumed):\n+    // (o: an EMPTY slot, x: a non-EMPTY slot)\n+    //\n+    // o o o - last consumed segment - ALLOWED (only if the price node gets removed from the tree)\n+    // o o x - last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+    // o x o - last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+    // o x x - last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+    // x o o - last consumed segment - ALLOWED (check `ot` point to this slot too)\n+    // x o x - last consumed segment - CATCH - no hole in the middle allowed\n+    // x x o - last consumed segment - ALLOWED (check `ot` point to this slot too)\n+    // x x x - last consumed segment - ALLOWED\n+\n     uint256 numSegmentsFullyConsumed = numOrdersFullyConsumed / NUM_SLOTS_PER_SEGMENT;\n-    uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n+    uint256 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n+    uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n \n-    uint56 oldTombstoneOffset = bestPriceNode.tombstoneSegmentOffset;\n-    if (numSegmentsFullyConsumed != 0) {\n-      // Cleanup segments to get a gas refund\n-      for (uint256 i = 0; i \u003c numSegmentsFullyConsumed; ++i) {\n-        delete segments[oldTombstoneOffset + i];\n-      }\n+    if (lastSegmentIndex == newTombstoneSegmentOffset) {\n+      // At this branch we know `segments.length \u003e lastSegmentIndex \u003e= newTombstoneSegmentOffset`\n+      uint256 numOrdersWithinLastSegmentFullyConsumed = numOrdersFullyConsumed % NUM_SLOTS_PER_SEGMENT;\n+      lastSegment = lastSegment.clearUpToSlot(numOrdersWithinLastSegmentFullyConsumed);\n \n-      uint256 newTombstoneSegmentOffset = oldTombstoneOffset + numSegmentsFullyConsumed;\n-      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n+      if (uint256(lastSegment) == 0) {\n+        // `lastSegment` has this property/assumption that either:\n+        // A1. An other was partially matched in this segment or\n+        // A2. We had reached the last segment in the active area of the price segments which\n+        //     has some zero slots (`if (remainingSegment == 0)` branch in `_consumePriceSegments`)\n+        //\n+        // Moreover, there is an assumption here that if `lastSegment` that was touched during the\n+        // matching/filling process ends up being `0` then that would mean, there are no orders\n+        // left in the price segments since A1 would not be possible and so for A2:\n+        // 1. any order slot before this segment should have been fully filled/matched and thus\n+        //    should have been zeroed out in the previous `if (numSegmentsFullyConsumed != 0)`\n+        //    block.\n+        // 2. There could not be any non-zero order slot past this segment since otherwise,\n+        //    that would indicate there would have been holes in the price segments previously\n+        //    breaking (Inv 1.)\n+        newTombstoneSegmentOffset = lastSegmentIndex + 1;\n+        // so we would have:\n+        // `segments.length \u003e= newTombstoneSegmentOffset == lastSegmentIndex + 1`\n+        // `newTombstoneSegmentOffset == lastSegmentIndex + 1 \u003e oldTombstoneOffset`\n+        // thus below `lastSegment` shuold get deleted\n+\n+        // o o o - last consumed segment - ALLOWED - it will get deleted and the new tombstone offset\n+        //                                           points to the following segment\n+\n+        // The checks from the [CHECK LIST] are not required since if one hits this branch and continue\n+        // without reverting, the last segment consumed would be removed from the price segments\n+        // and the new tombstone offset would point to the following segment.\n+      } else {\n+        // At this branch we know `segments.length \u003e lastSegmentIndex \u003e= newTombstoneSegmentOffset`\n+        // and `lastSegment` is non-zero, so at the end `bestPrice` would not get removed from the `tree`\n \n-      // Consumed all orders at this price level, so remove it from the tree\n-      if (newTombstoneSegmentOffset == segments.length) {\n-        tree.remove(bestPrice);\n-      }\n-    }\n \n-    bool lastSegmentDeleted = lastSegmentIndex \u003c (oldTombstoneOffset + numSegmentsFullyConsumed);\n-    if (!lastSegmentDeleted) {\n-      if (numOrdersWithinLastSegmentFullyConsumed != 0) {\n-        for (uint256 i; i \u003c numOrdersWithinLastSegmentFullyConsumed; ++i) {\n-          lastSegment = lastSegment.clearSlot(i);\n+        // s2 s1 s0 : cs(bits) : lastSegment \u003c-- (lastSegmentIndex == newTombstoneSegmentOffset)\n+        // --------------------------------(si: the `i`th slot, cs: compressed status)-------\n+        //  o  o  o :      111 : last consumed segment - ALLOWED (only if the price node gets removed from the tree)\n+        //  o  o  x :      110 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+        //  o  x  o :      101 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+        //  o  x  x :      100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+        //  x  o  o :      011 : last consumed segment - ALLOWED (check `ot` point to this slot too)\n+        //  x  o  x :      010 : last consumed segment - CATCH - no hole in the middle allowed\n+        //  x  x  o :      001 : last consumed segment - ALLOWED (check `ot` point to this slot too)\n+        //  x  x  x :      000 : last consumed segment - ALLOWED\n+\n+        uint256 compressedStatus = lastSegment.compressedStatus();\n+\n+        //  o  o  o : 111 : one would not enter this branch for this case\n+\n+        //  x  o  x : 010 : last consumed segment - CATCH - no hole in the middle allowed\n+        require(compressedStatus != 2, PriceSegmentHasAHole());\n+\n+        if (compressedStatus \u003e 3) {\n+          //  o  x  x : 100 : last consumed segment - ALLOWED (check `seg.len - 1` point to this slot too)\n+          //  o  x  o : 101 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+          //  o  o  x : 110 : last consumed segment - ALLOWED (check `ot` \u0026 `seg.len - 1` point to this slot too)\n+          require(lastSegmentIndex == segments.length - 1, PriceSegmentHasAHole());\n         }\n-      }\n \n-      if (uint256(lastSegment) == 0) {\n-        // All orders in the last segment are consumed, delete from tree\n-        tree.remove(bestPrice);\n-        // Don't pop segment for gas efficiency, instead just write zeros\n+        segments[lastSegmentIndex] = lastSegment;\n       }\n-      segments[lastSegmentIndex] = lastSegment;\n+    } else {\n+      // if `lastSegmentIndex =/= newTombstoneSegmentOffset` that would mean the matching process had ended up\n+      // with ( - dashes the slot can be 0 or not, c means that it was consumed):\n+      // ...\n+      // x(c) -(c) -(c) : lastSegmentIndex\n+      // where in the last segment, the last slot was fully filled and thus we would end up with:\n+      // ...\n+      // x(c) -(c) -(c) : lastSegmentIndex\n+      //   -  -    -    : newTombstoneSegmentOffset\n+      // So these values can only be off by `1`\n+      require(lastSegmentIndex + 1 == newTombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset());\n+\n+      // The checks from the [CHECK LIST] are not required since if one hits this branch and continue\n+      // without reverting, the last segment consumed would be removed from the price segments\n+      // and the new tombstone offset would point to the following segment.\n+    }\n+\n+    // Cleanup segments to get a gas refund\n+    for (uint256 i = oldTombstoneOffset; i \u003c newTombstoneSegmentOffset; ++i) {\n+      delete segments[i];\n+    }\n+\n+    if (newTombstoneSegmentOffset != oldTombstoneOffset) {\n+      tree.edit(bestPrice, uint56(newTombstoneSegmentOffset));\n+    }\n+\n+    // below one can add an extra branch for `newTombstoneSegmentOffset \u003e segments.length`\n+    // and possibly revert since that would mean some invariant was broken.\n+    if (newTombstoneSegmentOffset \u003e= segments.length) {\n+      tree.remove(bestPrice);\n     }\n   }\n \n@@ -1000,7 +1149,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     bytes32[] storage segments,\n     BokkyPooBahsRedBlackTreeLibrary.Tree storage tree\n   ) private returns (uint88 quantity) {\n-    BokkyPooBahsRedBlackTreeLibrary.Node storage node = tree.getNodeUnsafe(price);\n+    BokkyPooBahsRedBlackTreeLibrary.Node storage node = tree.getNode(price);\n     uint256 tombstoneSegmentOffset = node.tombstoneSegmentOffset;\n \n     (uint256 segmentIndex, uint256 slotIndex) = _find(segments, tombstoneSegmentOffset, segments.length, orderId);\n@@ -1058,7 +1207,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n       currentCost: 0,\n       fee: 0,\n       numberOfOrdersTraded: 0,\n-      isBudgetConstrainedBuyingLimitReached: false\n+      stopConsumingMoreOrders: false\n     });\n \n     _takeFromOrderBook(params, orderIdsPool, quantitiesPool, pricesPool);\n@@ -1105,7 +1254,7 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n       params.currentCost = 0;\n       params.fee = 0;\n       params.numberOfOrdersTraded = 0;\n-      params.isBudgetConstrainedBuyingLimitReached = false;\n+      params.stopConsumingMoreOrders = false;\n     }\n \n     _takeFromOrderBook(params, orderIdsPool, quantitiesPool, pricesPool);\n@@ -1409,6 +1558,17 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         bytes32 currentSegment = segments[currentSegmentIndex];\n         bytes10 nextSlot = currentOrNextSegment.getSlot(nextSlotIndex);\n         if (nextSlot == 0) {\n+          // When reaching a hole, make sure it has iterated to the last order.\n+\n+          // Must iterate to the last seg\n+          require(nextSegmentIndex == segments.length - 1, PriceSegmentHasAHole());\n+\n+          // nextSlot and subsequent slots must be empty\n+          require(currentOrNextSegment.getRemainingSegment(nextSlotIndex) == 0, PriceSegmentHasAHole());\n+\n+          // The last non-empty order must be in `seg[seg.len-1]` (`seg.len-1` cannot point to an empty segment).\n+          require(nextSlotIndex \u003e 0, LastPriceSegmentCannotBeEmpty());\n+\n           // There are no more orders left, reset back to the currently iterated order as the last\n           nextSegmentIndex = currentSegmentIndex;\n           nextSlotIndex = currentSlotIndex;\ndiff --git a/contracts/libraries/SegmentLibrary.sol b/contracts/libraries/SegmentLibrary.sol\nindex d884717..e7c91a2 100644\n--- a/contracts/libraries/SegmentLibrary.sol\n+++ b/contracts/libraries/SegmentLibrary.sol\n@@ -43,6 +43,39 @@ library SegmentLibrary {\n     return bytes10(uint80((uint256(segment) \u003e\u003e (slotIndex * SEGMENT_SIZE)) \u0026 SEGMENT_MASK));\n   }\n \n+  /// @notice Compresses the segment into 3 indicator bits\n+  /// @param segment The segment to read from\n+  /// @return status with only 3 bits sets each indicating whether the corresponding\n+  //                 slot in the segment is EMPTY or not.\n+  function compressedStatus(bytes32 segment) internal pure returns (uint256 status) {\n+    uint256 MASK = SEGMENT_MASK;\n+    uint256 SIZE = SEGMENT_SIZE;\n+\n+    assembly (\"memory-safe\") {\n+      // s2 s1 s0 : segment\n+      status := iszero(and(segment, MASK))\n+      segment := shr(SIZE, segment)\n+\n+      //  0 s2 s1 : segment\n+      status := or(\n+        shl(1, iszero(and(segment, MASK))),\n+        status\n+      )\n+      segment := shr(SIZE, segment)\n+\n+      //  0  0 s2 : segment\n+      status := or(\n+        shl(2, iszero(and(segment, MASK))), // still mask in case segment has dirty uppper bits\n+        status\n+      )\n+\n+      // b2 b1 b0 : status bits (it would only have 3 set bits)\n+      // b2       : is 1 if s2 the 3rd slot of original segment was EMPTY\n+      //    b1    : is 1 if s1 the 2nd slot of original segment was EMPTY\n+      //       b0 : is 1 if s0 the 1st slot of original segment was EMPTY\n+    }\n+  }\n+\n   /// @notice Checks if the segment only contains data in the specified slot\n   /// @dev Returns true if all other slots in the segment are empty (zero)\n   /// @param segment The segment to check\n@@ -60,6 +93,19 @@ library SegmentLibrary {\n     return bytes32(uint256(segment) \u0026 ~(uint256(SEGMENT_MASK) \u003c\u003c (slotIndex * SEGMENT_SIZE)));\n   }\n \n+  /// @notice Clears slots up to the specified index, setting all its bits to zero\n+  /// @param segment The segment to modify\n+  /// @param slotIndex The index of the slot to clear up to (0, 1, or 2)\n+  /// @return newSegment The updated segment with the right most slots cleared up to `slotIndex`\n+  function clearUpToSlot(bytes32 segment, uint256 slotIndex) internal pure returns (bytes32 newSegment) {\n+    if (slotIndex == 0) {\n+      return segment;\n+    }\n+\n+    uint256 shiftAmount = slotIndex * SEGMENT_SIZE;\n+    return bytes32((uint256(segment) \u003e\u003e (shiftAmount)) \u003c\u003c shiftAmount);\n+  }\n+\n   /// @notice Returns the remaining segment data after the specified slot index\n   /// @dev Shifts the segment right to remove all slots up to and including the specified index.\n   ///      Useful for iterating through higher-indexed slots or processing remaining data.\ndiff --git a/contracts/libraries/SonicOrderBookLibrary.sol b/contracts/libraries/SonicOrderBookLibrary.sol\nindex de229f7..08cd374 100644\n--- a/contracts/libraries/SonicOrderBookLibrary.sol\n+++ b/contracts/libraries/SonicOrderBookLibrary.sol\n@@ -31,6 +31,7 @@ library SonicOrderBookLibrary {\n   error DevFeeTooHigh();\n   error DevFeeNotSet();\n   error MaxOrdersNotMultipleOfOrdersInSegment();\n+  error PriceTickShouldBeAMutipleOf100();\n \n   uint256 private constant SET_TRADEABLE_THRESHOLD_LOCKED_BURN_TIME = 7 days;\n \n@@ -57,6 +58,7 @@ library SonicOrderBookLibrary {\n \n       require(existingTick == 0 || existingTick == newTick, PriceTickCannotBeChanged());\n       require(newTick != 0, PriceTickCannotBeZero());\n+      require(newTick % 100 == 0, PriceTickShouldBeAMutipleOf100());\n \n       SeasonData memory seasonData = nft.getSeasonData(Season(tokenId));\n       if (seasonData.startTime != 0 \u0026\u0026 tokenIdInfos[i].isTradeable) {\n"])</script><script>self.__next_f.push([1,"5e:T1336,"])</script><script>self.__next_f.push([1,"diff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol\nindex 31b5486..13064b8 100644\n--- a/contracts/SonicOrderBook.sol\n+++ b/contracts/SonicOrderBook.sol\n@@ -108,6 +108,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n   error SellMustUseExactQuantity();\n   error MakerPriceMustMatch(uint256 expectedPrice, uint256 actualPrice);\n \n+  // Errors that indicate invariants are broken\n+  error LastPriceSegmentCannotBeEmpty();\n+  error OnlyTheTombstoneSegmentCanStartWithEmptySlots();\n+\n   enum OrderSide {\n     Buy,\n     Sell\n@@ -773,7 +777,9 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 lastConsumedSegmentIndex;\n     uint16 devFeeTakerBps = _devFeeTakerBps;\n \n-    for (uint256 i = node.tombstoneSegmentOffset; i \u003c segments.length \u0026\u0026 _shouldTakeMoreFromOrderBook(params); ++i) {\n+    uint256 segmentsLength = segments.length;\n+    uint256 tombstoneSegmentOffset = node.tombstoneSegmentOffset;\n+    for (uint256 i = tombstoneSegmentOffset; i \u003c segmentsLength \u0026\u0026 _shouldTakeMoreFromOrderBook(params); ++i) {\n       lastConsumedSegmentIndex = i;\n       segment = segments[i];\n \n@@ -786,15 +792,74 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         bytes32 remainingSegment = segment.getRemainingSegment(slotIndex);\n         if (remainingSegment == 0) {\n           // Should only hit this branch on the last segment\n+          // but if for some reason we hit this branch before\n+          // the last segment we add the count of slots skipped\n+          if (i \u003c segmentsLength - 1) {\n+            // This branch which should not be reachable\n+            // But if it does hit we can be proactive and skip the remaining slots\n+            // but still add them to `numOrdersFullyConsumed`\n+            // `s` is the `slotIndex` and `o` represent an empty slot:\n+            // o    o    o(s) - +3\n+            // o    o(s) ...  - +2\n+            // o(s) ...  ...  - +1\n+            //\n+            // @dev one can also decide to REVERT below instead of accounting for the\n+            //      holes (empty slots) in this scenario\n+            numOrdersFullyConsumed += NUM_SLOTS_PER_SEGMENT - slotIndex;\n+          } else {\n+            // we are processing the last price segment in this branch\n+            // the possibilities are (o: an empty slot, s: slotIndex):\n+            // o    o    o(s) - BAD\n+            // o    o(s) ...  - skip incrementing `numOrdersFullyConsumed`\n+            // o(s) ...  ...  - skip incrementing `numOrdersFullyConsumed`\n+            if (slotIndex == 0) {\n+              // This branch which should not be reachable\n+              // the last segment in the active area of the price segment\n+              // only has empty slots\n+              // o    o    o(s) - BAD\n+              revert LastPriceSegmentCannotBeEmpty();\n+            }\n+          }\n           break;\n         }\n \n         bytes10 slot = segment.getSlot(slotIndex);\n         uint48 orderId = slot.getOrderId();\n         if (orderId == 0) {\n-          // Skip this order in the segment as it's been deleted\n-          ++numOrdersFullyConsumed;\n-          continue;\n+          // we should only hit this branch at the very beginning of the\n+          // active area of the price segment pointed to by the `tombstoneSegmentOffset`\n+          // Possible configurations of this segment should be of the form:\n+          // (o: an empty slot, x: a non empty slot, s: slotIndex, ot = tombstoneSegmentOffset)\n+          // x o    o(s)  \u003c-- (i === ot) - allowed\n+          // x o(s) o     \u003c-- (i === ot) - allowed\n+          // x x    o(s)  \u003c-- (i === ot) - allowed\n+          //\n+          // x o    o(s)  \u003c-- (i =/= ot) - BAD\n+          // x o(s) o     \u003c-- (i =/= ot) - BAD\n+          // x x    o(s)  \u003c-- (i =/= ot) - BAD\n+          // x o(s) x     \u003c-- (i  \u003e= ot) - BAD\n+\n+          if (i == tombstoneSegmentOffset) {\n+            // x o    o(s)  \u003c-- (i === ot) - allowed\n+            // x o(s) o     \u003c-- (i === ot) - allowed\n+            // x x    o(s)  \u003c-- (i === ot) - allowed\n+            //\n+            // @dev we are allowing this potentially unreachable state below to pass through\n+            //      and just increment `numOrdersFullyConsumed`\n+            // x o(s) x     \u003c-- (i  == ot) - BAD\n+\n+            // Skip this order in the segment as it's been deleted\n+            ++numOrdersFullyConsumed;\n+            continue;\n+          } else {\n+            // this branch should be unreachable if all invariants are satisfied\n+            // x o    o(s)  \u003c-- (i =/= ot) - BAD\n+            // x o(s) o     \u003c-- (i =/= ot) - BAD\n+            // x x    o(s)  \u003c-- (i =/= ot) - BAD\n+            // x o(s) x     \u003c-- (i =/= ot) - BAD\n+\n+            revert OnlyTheTombstoneSegmentCanStartWithEmptySlots();\n+          }\n         }\n \n         uint256 ordersConsumed = 0;\n"])</script><script>self.__next_f.push([1,"5f:T1335,"])</script><script>self.__next_f.push([1,"diff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol\nindex 31b5486..13064b8 100644\n--- a/contracts/SonicOrderBook.sol\n+++ b/contracts/SonicOrderBook.sol\n@@ -108,6 +108,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n   error SellMustUseExactQuantity();\n   error MakerPriceMustMatch(uint256 expectedPrice, uint256 actualPrice);\n \n+  // Errors that indicate invariants are broken\n+  error LastPriceSegmentCannotBeEmpty();\n+  error OnlyTheTombstoneSegmentCanStartWithEmptySlots();\n+\n   enum OrderSide {\n     Buy,\n     Sell\n@@ -773,7 +777,9 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 lastConsumedSegmentIndex;\n     uint16 devFeeTakerBps = _devFeeTakerBps;\n \n-    for (uint256 i = node.tombstoneSegmentOffset; i \u003c segments.length \u0026\u0026 _shouldTakeMoreFromOrderBook(params); ++i) {\n+    uint256 segmentsLength = segments.length;\n+    uint256 tombstoneSegmentOffset = node.tombstoneSegmentOffset;\n+    for (uint256 i = tombstoneSegmentOffset; i \u003c segmentsLength \u0026\u0026 _shouldTakeMoreFromOrderBook(params); ++i) {\n       lastConsumedSegmentIndex = i;\n       segment = segments[i];\n \n@@ -786,15 +792,74 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         bytes32 remainingSegment = segment.getRemainingSegment(slotIndex);\n         if (remainingSegment == 0) {\n           // Should only hit this branch on the last segment\n+          // but if for some reason we hit this branch before\n+          // the last segment we add the count of slots skipped\n+          if (i \u003c segmentsLength - 1) {\n+            // This branch which should not be reachable\n+            // But if it does hit we can be proactive and skip the remaining slots\n+            // but still add them to `numOrdersFullyConsumed`\n+            // `s` is the `slotIndex` and `o` represent an empty slot:\n+            // o    o    o(s) - +3\n+            // o    o(s) ...  - +2\n+            // o(s) ...  ...  - +1\n+            //\n+            // @dev one can also decide to REVERT below instead of accounting for the\n+            //      holes (empty slots) in this scenario\n+            numOrdersFullyConsumed += NUM_SLOTS_PER_SEGMENT - slotIndex;\n+          } else {\n+            // we are processing the last price segment in this branch\n+            // the possibilities are (o: an empty slot, s: slotIndex):\n+            // o    o    o(s) - BAD\n+            // o    o(s) ...  - skip incrementing `numOrdersFullyConsumed`\n+            // o(s) ...  ...  - skip incrementing `numOrdersFullyConsumed`\n+            if (slotIndex == 0) {\n+              // This branch which should not be reachable\n+              // the last segment in the active area of the price segment\n+              // only has empty slots\n+              // o    o    o(s) - BAD\n+              revert LastPriceSegmentCannotBeEmpty();\n+            }\n+          }\n           break;\n         }\n \n         bytes10 slot = segment.getSlot(slotIndex);\n         uint48 orderId = slot.getOrderId();\n         if (orderId == 0) {\n-          // Skip this order in the segment as it's been deleted\n-          ++numOrdersFullyConsumed;\n-          continue;\n+          // we should only hit this branch at the very beginning of the\n+          // active area of the price segment pointed to by the `tombstoneSegmentOffset`\n+          // Possible configurations of this segment should be of the form:\n+          // (o: an empty slot, x: a non empty slot, s: slotIndex, ot = tombstoneSegmentOffset)\n+          // x o    o(s)  \u003c-- (i === ot) - allowed\n+          // x o(s) o     \u003c-- (i === ot) - allowed\n+          // x x    o(s)  \u003c-- (i === ot) - allowed\n+          //\n+          // x o    o(s)  \u003c-- (i =/= ot) - BAD\n+          // x o(s) o     \u003c-- (i =/= ot) - BAD\n+          // x x    o(s)  \u003c-- (i =/= ot) - BAD\n+          // x o(s) x     \u003c-- (i  \u003e= ot) - BAD\n+\n+          if (i == tombstoneSegmentOffset) {\n+            // x o    o(s)  \u003c-- (i === ot) - allowed\n+            // x o(s) o     \u003c-- (i === ot) - allowed\n+            // x x    o(s)  \u003c-- (i === ot) - allowed\n+            //\n+            // @dev we are allowing this potentially unreachable state below to pass through\n+            //      and just increment `numOrdersFullyConsumed`\n+            // x o(s) x     \u003c-- (i  == ot) - BAD\n+\n+            // Skip this order in the segment as it's been deleted\n+            ++numOrdersFullyConsumed;\n+            continue;\n+          } else {\n+            // this branch should be unreachable if all invariants are satisfied\n+            // x o    o(s)  \u003c-- (i =/= ot) - BAD\n+            // x o(s) o     \u003c-- (i =/= ot) - BAD\n+            // x x    o(s)  \u003c-- (i =/= ot) - BAD\n+            // x o(s) x     \u003c-- (i =/= ot) - BAD\n+\n+            revert OnlyTheTombstoneSegmentCanStartWithEmptySlots();\n+          }\n         }\n \n         uint256 ordersConsumed = 0;"])</script><script>self.__next_f.push([1,"60:T1336,"])</script><script>self.__next_f.push([1,"diff --git a/contracts/SonicOrderBook.sol b/contracts/SonicOrderBook.sol\nindex 31b5486..13064b8 100644\n--- a/contracts/SonicOrderBook.sol\n+++ b/contracts/SonicOrderBook.sol\n@@ -108,6 +108,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n   error SellMustUseExactQuantity();\n   error MakerPriceMustMatch(uint256 expectedPrice, uint256 actualPrice);\n \n+  // Errors that indicate invariants are broken\n+  error LastPriceSegmentCannotBeEmpty();\n+  error OnlyTheTombstoneSegmentCanStartWithEmptySlots();\n+\n   enum OrderSide {\n     Buy,\n     Sell\n@@ -773,7 +777,9 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n     uint256 lastConsumedSegmentIndex;\n     uint16 devFeeTakerBps = _devFeeTakerBps;\n \n-    for (uint256 i = node.tombstoneSegmentOffset; i \u003c segments.length \u0026\u0026 _shouldTakeMoreFromOrderBook(params); ++i) {\n+    uint256 segmentsLength = segments.length;\n+    uint256 tombstoneSegmentOffset = node.tombstoneSegmentOffset;\n+    for (uint256 i = tombstoneSegmentOffset; i \u003c segmentsLength \u0026\u0026 _shouldTakeMoreFromOrderBook(params); ++i) {\n       lastConsumedSegmentIndex = i;\n       segment = segments[i];\n \n@@ -786,15 +792,74 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         bytes32 remainingSegment = segment.getRemainingSegment(slotIndex);\n         if (remainingSegment == 0) {\n           // Should only hit this branch on the last segment\n+          // but if for some reason we hit this branch before\n+          // the last segment we add the count of slots skipped\n+          if (i \u003c segmentsLength - 1) {\n+            // This branch which should not be reachable\n+            // But if it does hit we can be proactive and skip the remaining slots\n+            // but still add them to `numOrdersFullyConsumed`\n+            // `s` is the `slotIndex` and `o` represent an empty slot:\n+            // o    o    o(s) - +3\n+            // o    o(s) ...  - +2\n+            // o(s) ...  ...  - +1\n+            //\n+            // @dev one can also decide to REVERT below instead of accounting for the\n+            //      holes (empty slots) in this scenario\n+            numOrdersFullyConsumed += NUM_SLOTS_PER_SEGMENT - slotIndex;\n+          } else {\n+            // we are processing the last price segment in this branch\n+            // the possibilities are (o: an empty slot, s: slotIndex):\n+            // o    o    o(s) - BAD\n+            // o    o(s) ...  - skip incrementing `numOrdersFullyConsumed`\n+            // o(s) ...  ...  - skip incrementing `numOrdersFullyConsumed`\n+            if (slotIndex == 0) {\n+              // This branch which should not be reachable\n+              // the last segment in the active area of the price segment\n+              // only has empty slots\n+              // o    o    o(s) - BAD\n+              revert LastPriceSegmentCannotBeEmpty();\n+            }\n+          }\n           break;\n         }\n \n         bytes10 slot = segment.getSlot(slotIndex);\n         uint48 orderId = slot.getOrderId();\n         if (orderId == 0) {\n-          // Skip this order in the segment as it's been deleted\n-          ++numOrdersFullyConsumed;\n-          continue;\n+          // we should only hit this branch at the very beginning of the\n+          // active area of the price segment pointed to by the `tombstoneSegmentOffset`\n+          // Possible configurations of this segment should be of the form:\n+          // (o: an empty slot, x: a non empty slot, s: slotIndex, ot = tombstoneSegmentOffset)\n+          // x o    o(s)  \u003c-- (i === ot) - allowed\n+          // x o(s) o     \u003c-- (i === ot) - allowed\n+          // x x    o(s)  \u003c-- (i === ot) - allowed\n+          //\n+          // x o    o(s)  \u003c-- (i =/= ot) - BAD\n+          // x o(s) o     \u003c-- (i =/= ot) - BAD\n+          // x x    o(s)  \u003c-- (i =/= ot) - BAD\n+          // x o(s) x     \u003c-- (i  \u003e= ot) - BAD\n+\n+          if (i == tombstoneSegmentOffset) {\n+            // x o    o(s)  \u003c-- (i === ot) - allowed\n+            // x o(s) o     \u003c-- (i === ot) - allowed\n+            // x x    o(s)  \u003c-- (i === ot) - allowed\n+            //\n+            // @dev we are allowing this potentially unreachable state below to pass through\n+            //      and just increment `numOrdersFullyConsumed`\n+            // x o(s) x     \u003c-- (i  == ot) - BAD\n+\n+            // Skip this order in the segment as it's been deleted\n+            ++numOrdersFullyConsumed;\n+            continue;\n+          } else {\n+            // this branch should be unreachable if all invariants are satisfied\n+            // x o    o(s)  \u003c-- (i =/= ot) - BAD\n+            // x o(s) o     \u003c-- (i =/= ot) - BAD\n+            // x x    o(s)  \u003c-- (i =/= ot) - BAD\n+            // x o(s) x     \u003c-- (i =/= ot) - BAD\n+\n+            revert OnlyTheTombstoneSegmentCanStartWithEmptySlots();\n+          }\n         }\n \n         uint256 ordersConsumed = 0;\n"])</script><script>self.__next_f.push([1,"61:T6e2,@@ -1204,7 +1207,12 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         // Are there are free slots in this segment\n         for (uint256 slotIndex = 0; slotIndex \u003c NUM_SLOTS_PER_SEGMENT; ++slotIndex) {\n           bytes32 remainingSegment = lastSegment.getRemainingSegment(slotIndex);\n+          // o o o, o o x, o x x, o x o,\n           if (remainingSegment == 0) {\n+            // catch o o o\n+            require(slotIndex != 0, LastPriceSegmentCannotBeEmpty());\n+            // for o x o, must be head\n+            if(lastSegment.getSlot(0) == 0) require(lastSegmentIndex == node.tombstoneSegmentOffset, PriceSegmentHasAHole());\n             // Found free slot, so add this order to an existing segment\n             bytes10 slot = SlotLibrary.createSlot(orderId, normalizedQuantity);\n             bytes32 newSegment = lastSegment.setSlotUnsafe(slotIndex, slot);\n@@ -1212,6 +1220,18 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n             return;\n           }\n         }\n+        // slot2 is x, x o o, x x o, x o x, x x x\n+        // head\u0026tail, catch x o x, allow x o o , x x o, x x x\n+        if (lastSegmentIndex == node.tombstoneSegmentOffset) {\n+          if(lastSegment.getSlot(1) == 0) require(lastSegment.getSlot(0) == 0, PriceSegmentHasAHole());\n+        }\n+        // tail, must be x, x ,x\n+        if (lastSegmentIndex \u003e node.tombstoneSegmentOffset) {\n+          require(lastSegment.getSlot(0) != 0 \u0026\u0026 lastSegment.getSlot(1) != 0, PriceSegmentHasAHole());\n+        }\n+      } else {\n+        // ot is at most equal to seg.len\n+        require(lastSegmentIndex + 1 == node.tombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTombstoneOffset());\n       }\n     }\n\n62:T6e0,@@ -1204,7 +1207,12 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         // Are there are free slots in this segment\n         for (uint256 slotIndex = 0; slotIndex \u003c NUM_SLOTS_PER_SEGMENT; ++slotIndex) {\n           bytes32 remaini"])</script><script>self.__next_f.push([1,"ngSegment = lastSegment.getRemainingSegment(slotIndex);\n+          // o o o, o o x, o x x, o x o,\n           if (remainingSegment == 0) {\n+            // catch o o o\n+            require(slotIndex != 0, LastPriceSegmentCannotBeEmpty());\n+            // for o x o, must be head\n+            if(lastSegment.getSlot(0) == 0) require(lastSegmentIndex == node.tombstoneSegmentOffset, PriceSegmentHasAHole());\n             // Found free slot, so add this order to an existing segment\n             bytes10 slot = SlotLibrary.createSlot(orderId, normalizedQuantity);\n             bytes32 newSegment = lastSegment.setSlotUnsafe(slotIndex, slot);\n@@ -1212,6 +1220,18 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n             return;\n           }\n         }\n+        // slot2 is x, x o o, x x o, x o x, x x x\n+        // head\u0026tail, catch x o x, allow x o o , x x o, x x x\n+        if (lastSegmentIndex == node.tombstoneSegmentOffset) {\n+          if(lastSegment.getSlot(1) == 0) require(lastSegment.getSlot(0) == 0, PriceSegmentHasAHole());\n+        }\n+        // tail, must be x, x ,x\n+        if (lastSegmentIndex \u003e node.tombstoneSegmentOffset) {\n+          require(lastSegment.getSlot(0) != 0 \u0026\u0026 lastSegment.getSlot(1) != 0, PriceSegmentHasAHole());\n+        }\n+      } else {\n+        // ot is at most equal to seg.len\n+        require(lastSegmentIndex + 1 == node.tombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTombstoneOffset());\n       }\n     }63:T6e2,@@ -1204,7 +1207,12 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n         // Are there are free slots in this segment\n         for (uint256 slotIndex = 0; slotIndex \u003c NUM_SLOTS_PER_SEGMENT; ++slotIndex) {\n           bytes32 remainingSegment = lastSegment.getRemainingSegment(slotIndex);\n+          // o o o, o o x, o x x, o x o,\n           if (remainingSegment == 0) {\n+            // catch o o o\n+            require(slotIndex != 0, LastPriceSegmentCannotBeEmpty());\n+            // for o x o, must be head\n+  "])</script><script>self.__next_f.push([1,"          if(lastSegment.getSlot(0) == 0) require(lastSegmentIndex == node.tombstoneSegmentOffset, PriceSegmentHasAHole());\n             // Found free slot, so add this order to an existing segment\n             bytes10 slot = SlotLibrary.createSlot(orderId, normalizedQuantity);\n             bytes32 newSegment = lastSegment.setSlotUnsafe(slotIndex, slot);\n@@ -1212,6 +1220,18 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\n             return;\n           }\n         }\n+        // slot2 is x, x o o, x x o, x o x, x x x\n+        // head\u0026tail, catch x o x, allow x o o , x x o, x x x\n+        if (lastSegmentIndex == node.tombstoneSegmentOffset) {\n+          if(lastSegment.getSlot(1) == 0) require(lastSegment.getSlot(0) == 0, PriceSegmentHasAHole());\n+        }\n+        // tail, must be x, x ,x\n+        if (lastSegmentIndex \u003e node.tombstoneSegmentOffset) {\n+          require(lastSegment.getSlot(0) != 0 \u0026\u0026 lastSegment.getSlot(1) != 0, PriceSegmentHasAHole());\n+        }\n+      } else {\n+        // ot is at most equal to seg.len\n+        require(lastSegmentIndex + 1 == node.tombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTombstoneOffset());\n       }\n     }\n\n"])</script><script>self.__next_f.push([1,"e:[\"$\",\"$L1e\",null,{\"state\":{\"mutations\":[],\"queries\":[{\"state\":{\"data\":null,\"dataUpdateCount\":1,\"dataUpdatedAt\":1755006790120,\"error\":null,\"errorUpdateCount\":0,\"errorUpdatedAt\":0,\"fetchFailureCount\":0,\"fetchFailureReason\":null,\"fetchMeta\":null,\"isInvalidated\":false,\"status\":\"success\",\"fetchStatus\":\"idle\"},\"queryKey\":\"$a:props:children:2:props:children:1:props:children:props:children:props:queryClientState:queries:0:queryKey\",\"queryHash\":\"[\\\"query\\\",\\\"auth.authMe\\\",null]\"},{\"state\":{\"data\":{\"id\":\"80b2fc65-3c2e-4ae7-8e48-6383fa936e6d\",\"isPrivate\":false,\"projectTitle\":\"Sonic Airdrop Contracts\",\"companyId\":\"6210d20d-b333-4f5b-b6db-894178a9e3d8\",\"companyHandle\":\"PaintSwap\",\"clientName\":\"PaintSwap\",\"clientLogo\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/7a499fdf-33f5-465b-70cf-0d96eb6f9700/public\",\"clientWebsite\":\"https://paintswap.finance/\",\"engagementId\":\"d53f8f19-5e04-4b9d-9da9-a6930a77ea39\",\"repositoryId\":\"533c3043-fa7a-4275-8bae-e2313e1b5d18\",\"guildId\":null,\"engagementKind\":\"cantina_managed\",\"engagementStartDate\":\"2025-07-25T16:00:00Z\",\"engagementEndDate\":\"2025-07-30T00:00:00Z\",\"reportPdfLink\":\"https://cdn.cantina.xyz/reports/cantina_paintswap_2_july2025.pdf\",\"repositoryLinks\":[\"https://github.com/PaintSwap/sonic-airdrop-contracts\"],\"commitHashes\":[\"09a09846e01e2a471b593ad7052fde9160ddb154\"],\"typeOfProject\":[\"\"],\"teamMembers\":[{\"reportId\":\"80b2fc65-3c2e-4ae7-8e48-6383fa936e6d\",\"auditorPublicProfile\":{\"id\":\"d0d09383-5704-4167-a8ff-529571a8c666\",\"name\":\"Saw-mon and Natalie\",\"username\":\"Saw-mon-and-Natalie\",\"github\":\"Saw-mon-and-Natalie\",\"twitter\":\"sw0nt\",\"tagline\":\"Interested to review projects with innovative ideas using higher level mathematics and cryptography.\",\"bio\":null,\"website\":null,\"avatar\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/8039eb9a-b849-4701-675d-fd94168a3300/public\",\"isBot\":false,\"verifiedProfile\":true,\"guildAffiliation\":\"13371337-0000-0000-0000-000000000042\",\"isNdaSigned\":true,\"rank\":\"lsr\",\"reputation\":50,\"fellowshipLevel\":null,\"skills\":[],\"badges\":[{\"id\":\"1445c1e3-2746-46c7-8089-358e9181e859\",\"name\":\"Cantina 2024 Beta Tester\",\"image\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/4ce79774-62f1-4c3d-bab0-78436b66b200/public\",\"description\":\"\",\"issuedAt\":\"2024-09-11T14:42:43.713259Z\"}],\"createdAt\":\"2023-08-22T16:38:15.568491Z\"},\"rankDuringAudit\":\"lsr\"},{\"reportId\":\"80b2fc65-3c2e-4ae7-8e48-6383fa936e6d\",\"auditorPublicProfile\":{\"id\":\"20b2bdd7-b3d3-47be-adea-0706dbb02cce\",\"name\":\"cccz\",\"username\":\"thereksfour\",\"github\":\"thereksfour\",\"twitter\":\"hellocccz\",\"tagline\":null,\"bio\":\"### Biography\\n+ Browser Security Researcher (Q3 2019)\\n    + found multiple chrome vulnerabilities and got acknowledgements, some results published in BlackHat EU 2020.\\n+ BlockChain Security Researcher (Q3 2020)\\n    + found critical vulnerability in TRON, published in BlackHat USA 2021 and DEFCON 29.\\n+ Smart Contract Security Researcher (Q4 2021)\\n    + found 100+ high-risk and 200+ medium-risk vulnerabilities in C4.\\n\",\"website\":null,\"avatar\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/d5e6d378-e0c9-47e8-66eb-fba7e9ce9700/public\",\"isBot\":false,\"verifiedProfile\":true,\"guildAffiliation\":\"13371337-0000-0000-0000-000000000042\",\"isNdaSigned\":true,\"rank\":\"sr\",\"reputation\":100,\"fellowshipLevel\":null,\"skills\":[],\"badges\":[{\"id\":\"6281fef8-2958-476f-a282-cd068850e066\",\"name\":\"100% Reputation\",\"image\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/b4853349-67bb-4daa-556c-5277af700a00/public\",\"description\":\"A badge awarded to users that reach 100% reputation score on Cantina. \",\"issuedAt\":\"2025-03-25T13:56:45.010031Z\"}],\"createdAt\":\"2023-08-22T16:38:36.885395Z\"},\"rankDuringAudit\":\"sr\"}],\"findingStats\":[{\"severity\":\"critical\",\"totalCount\":1,\"fixedCount\":1},{\"severity\":\"high\",\"totalCount\":1,\"fixedCount\":1},{\"severity\":\"medium\",\"totalCount\":3,\"fixedCount\":3},{\"severity\":\"informational\",\"totalCount\":2,\"fixedCount\":2}],\"findings\":[{\"id\":\"8c0aa1ea-bbe9-4b8a-b544-d621feb31ae2\",\"number\":4,\"attributedTo\":\"4387e507-bfea-401f-8d78-d8f6c8bafdf3\",\"title\":\"`isBudgetConstrainedBuyingLimitReached` should be set as soon as the remaining budget cannot afford the full order cost\",\"description\":\"$26\",\"status\":\"fixed\",\"severity\":\"critical\",\"likelihood\":\"high\",\"impact\":\"high\",\"fixedBy\":[\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\"],\"createdBy\":{\"userId\":\"d0d09383-5704-4167-a8ff-529571a8c666\",\"name\":\"Saw-mon and Natalie\",\"username\":\"Saw-mon-and-Natalie\",\"avatar\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/8039eb9a-b849-4701-675d-fd94168a3300/public\"},\"createdAt\":\"2025-07-27T16:30:53.562050Z\"},{\"id\":\"63cd6b54-d4f6-4f43-9bab-cf01d9913ee8\",\"number\":6,\"attributedTo\":\"4387e507-bfea-401f-8d78-d8f6c8bafdf3\",\"title\":\"Invariants of Price Segments (version 2)\",\"description\":\"$27\",\"status\":\"fixed\",\"severity\":\"high\",\"likelihood\":\"low\",\"impact\":\"high\",\"fixedBy\":[\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\"],\"createdBy\":{\"userId\":\"d0d09383-5704-4167-a8ff-529571a8c666\",\"name\":\"Saw-mon and Natalie\",\"username\":\"Saw-mon-and-Natalie\",\"avatar\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/8039eb9a-b849-4701-675d-fd94168a3300/public\"},\"createdAt\":\"2025-07-28T12:35:34.828029Z\"},{\"id\":\"1d0e1a54-b60c-4780-8624-b7b22c8e7985\",\"number\":1,\"attributedTo\":\"4387e507-bfea-401f-8d78-d8f6c8bafdf3\",\"title\":\"unsafe node check in `_cancelOrdersSide`\",\"description\":\"$28\",\"status\":\"fixed\",\"severity\":\"medium\",\"likelihood\":\"low\",\"impact\":\"high\",\"fixedBy\":[\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\"],\"createdBy\":{\"userId\":\"d0d09383-5704-4167-a8ff-529571a8c666\",\"name\":\"Saw-mon and Natalie\",\"username\":\"Saw-mon-and-Natalie\",\"avatar\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/8039eb9a-b849-4701-675d-fd94168a3300/public\"},\"createdAt\":\"2025-07-26T19:03:06.144933Z\"},{\"id\":\"0bd4fc3d-b504-444b-a393-2ed8a42d7839\",\"number\":3,\"attributedTo\":\"4387e507-bfea-401f-8d78-d8f6c8bafdf3\",\"title\":\"Add invariant checks to the `_consumePriceSegments` and make it less prone to malfunction\",\"description\":\"$29\",\"status\":\"fixed\",\"severity\":\"medium\",\"likelihood\":\"low\",\"impact\":\"high\",\"fixedBy\":[\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\"],\"createdBy\":{\"userId\":\"d0d09383-5704-4167-a8ff-529571a8c666\",\"name\":\"Saw-mon and Natalie\",\"username\":\"Saw-mon-and-Natalie\",\"avatar\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/8039eb9a-b849-4701-675d-fd94168a3300/public\"},\"createdAt\":\"2025-07-27T16:26:30.893151Z\"},{\"id\":\"fec5a33b-d790-40e4-ac94-1182dee9a832\",\"number\":5,\"attributedTo\":\"4387e507-bfea-401f-8d78-d8f6c8bafdf3\",\"title\":\"quote tokens received by the orderbook versus to-be-claimed quote tokens by sellers\",\"description\":\"$2a\",\"status\":\"fixed\",\"severity\":\"medium\",\"fixedBy\":[\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\"],\"createdBy\":{\"userId\":\"d0d09383-5704-4167-a8ff-529571a8c666\",\"name\":\"Saw-mon and Natalie\",\"username\":\"Saw-mon-and-Natalie\",\"avatar\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/8039eb9a-b849-4701-675d-fd94168a3300/public\"},\"createdAt\":\"2025-07-27T16:32:56.688550Z\"},{\"id\":\"d26e4d46-b9cc-47b0-af68-9e72afeb4b7b\",\"number\":7,\"attributedTo\":\"4387e507-bfea-401f-8d78-d8f6c8bafdf3\",\"title\":\"Add invariant checks when adding and canceling orders\",\"description\":\"$2b\",\"status\":\"fixed\",\"severity\":\"informational\",\"fixedBy\":[\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\"],\"createdBy\":{\"userId\":\"20b2bdd7-b3d3-47be-adea-0706dbb02cce\",\"name\":\"cccz\",\"username\":\"thereksfour\",\"avatar\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/d5e6d378-e0c9-47e8-66eb-fba7e9ce9700/public\"},\"createdAt\":\"2025-07-29T08:59:45.465283Z\"},{\"id\":\"0e21dae8-c652-4bdc-ada9-f3420fe41e67\",\"number\":8,\"attributedTo\":\"4387e507-bfea-401f-8d78-d8f6c8bafdf3\",\"title\":\"Use `quantityFulfilled` for sell market orders when transferring NFTs\",\"description\":\"## Description\\n\\n`order.quantity` and `quantityFulfilled` are supposed to have the same value in this branch (sell market orders need to use exact quantity).\\n\\n## Recommendation\\n\\nbut to avoid future foot gun it would be best to use `quantityFulfilled` here:\\n\\n```solidity\\n_safeTransferNFTsToUs(sender, order.tokenId, quantityFulfilled);\\n```\\n\\nThis is due to the fact that if the check regarding exact quantities gets modified the actual value traded would be `quantityFulfilled`.\\n\\n\",\"status\":\"fixed\",\"severity\":\"informational\",\"fixedBy\":[\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\"],\"createdBy\":{\"userId\":\"d0d09383-5704-4167-a8ff-529571a8c666\",\"name\":\"Saw-mon and Natalie\",\"username\":\"Saw-mon-and-Natalie\",\"avatar\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/8039eb9a-b849-4701-675d-fd94168a3300/public\"},\"createdAt\":\"2025-07-29T20:03:42.247662Z\"}],\"createdBy\":\"6a399484-ad82-4aca-976d-779e4801d5ea\",\"createdAt\":\"2025-07-31T15:59:26.760220Z\",\"publishedAt\":\"2025-07-30T22:00:00Z\"},\"dataUpdateCount\":1,\"dataUpdatedAt\":1755006790160,\"error\":null,\"errorUpdateCount\":0,\"errorUpdatedAt\":0,\"fetchFailureCount\":0,\"fetchFailureReason\":null,\"fetchMeta\":null,\"isInvalidated\":false,\"status\":\"success\",\"fetchStatus\":\"idle\"},\"queryKey\":[\"query\",\"reports.getReportById\",{\"reportId\":\"80b2fc65-3c2e-4ae7-8e48-6383fa936e6d\",\"withFiles\":false}],\"queryHash\":\"[\\\"query\\\",\\\"reports.getReportById\\\",{\\\"reportId\\\":\\\"80b2fc65-3c2e-4ae7-8e48-6383fa936e6d\\\",\\\"withFiles\\\":false}]\"}]},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"as\":\"section\",\"bg\":\"white\",\"borderBottomWidth\":\"1px\",\"borderColor\":\"chakra-border-color\",\"borderStyle\":\"solid\",\"flexDirection\":\"column\",\"gap\":\"3rem\",\"pb\":{\"base\":6,\"md\":12},\"pt\":\"3rem\",\"bgGradient\":{\"base\":\"none\",\"md\":\"linear(to-b, #fff, hsl(0 0% 98% / 1))\"},\"borderBottomColor\":\"chakra-border-color\",\"children\":[\"$\",\"$L20\",null,{\"ref\":\"$undefined\",\"flexDirection\":\"column\",\"gap\":\"3rem\",\"maxW\":\"1080px\",\"w\":\"calc(100vw - (2 * 1rem))\",\"children\":[\"$\",\"$L2c\",null,{\"report\":\"$e:props:state:queries:1:state:data\"}]}]}],[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"as\":\"section\",\"bg\":\"white\",\"borderBottomWidth\":0,\"borderColor\":\"chakra-border-color\",\"borderStyle\":\"solid\",\"flexDirection\":\"column\",\"gap\":\"3rem\",\"pb\":{\"base\":\"3rem\",\"md\":\"6rem\"},\"pt\":12,\"children\":[\"$\",\"$L20\",null,{\"ref\":\"$undefined\",\"flexDirection\":\"column\",\"gap\":\"3rem\",\"maxW\":\"1080px\",\"w\":\"calc(100vw - (2 * 1rem))\",\"children\":[[\"$\",\"$L2d\",null,{\"alignItems\":\"flex-start\",\"gap\":4,\"children\":[[\"$\",\"$L2d\",null,{\"alignItems\":\"stretch\",\"as\":\"dl\",\"gap\":2,\"sx\":{\"w\":\"full\",\"containerType\":\"inline-size\"},\"children\":[[\"$\",\"$L2e\",\"Organization\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"160px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Organization\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L31\",null,{\"report\":\"$e:props:state:queries:1:state:data\"}]}]]}],[\"$\",\"$L2e\",\"Engagement Type\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"160px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Engagement Type\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Cantina Reviews\"}]}]]}],[\"$\",\"$L2e\",\"Period\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"160px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Period\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":[[\"$\",\"time\",null,{\"dateTime\":\"2025-07-25\",\"children\":\"25 July 2025\"}],\" - \",[\"$\",\"time\",null,{\"dateTime\":\"2025-07-30\",\"children\":\"30 July 2025\"}]]}]}]]}],[\"$\",\"$L2e\",\"Repositories\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"160px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Repositories\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":2,\"children\":[[\"$\",\"$L32\",\"https://github.com/PaintSwap/sonic-airdrop-contracts\",{\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts\",\"label\":\"PaintSwap/sonic-airdrop-contracts\"}]]}]}]]}],[\"$\",\"$L2e\",\"Researchers\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"160px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Researchers\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":4,\"children\":[[\"$\",\"$L33\",\"Saw-mon-and-Natalie\",{\"alignItems\":\"center\",\"as\":\"$34\",\"display\":\"flex\",\"gap\":2,\"href\":\"/u/Saw-mon-and-Natalie\",\"prefetch\":false,\"children\":[[\"$\",\"$L35\",null,{\"height\":\"20px\",\"src\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/8039eb9a-b849-4701-675d-fd94168a3300/public\",\"width\":\"20px\"}],[\"$\",\"$L2f\",null,{\"fontSize\":\"sm\",\"fontWeight\":\"medium\",\"children\":\"Saw-mon and Natalie\"}]]}],[\"$\",\"$L33\",\"thereksfour\",{\"alignItems\":\"center\",\"as\":\"$34\",\"display\":\"flex\",\"gap\":2,\"href\":\"/u/thereksfour\",\"prefetch\":false,\"children\":[[\"$\",\"$L35\",null,{\"height\":\"20px\",\"src\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/d5e6d378-e0c9-47e8-66eb-fba7e9ce9700/public\",\"width\":\"20px\"}],[\"$\",\"$L2f\",null,{\"fontSize\":\"sm\",\"fontWeight\":\"medium\",\"children\":\"cccz\"}]]}]]}]}]]}]]}],false,\"$undefined\"]}],[[\"$\",\"$L36\",null,{}],[\"$\",\"$L2d\",null,{\"alignItems\":\"stretch\",\"as\":\"section\",\"gap\":8,\"children\":[[\"$\",\"$L37\",null,{\"as\":\"h2\",\"fontSize\":\"3xl\",\"fontWeight\":\"semibold\",\"children\":\"Findings\"}],[\"$\",\"$L2d\",null,{\"alignItems\":\"stretch\",\"gap\":12,\"children\":[[\"$\",\"$L2e\",null,{\"gap\":6,\"gridTemplateColumns\":\"repeat(auto-fit, minmax(250px, 1fr))\",\"children\":[[\"$\",\"$L38\",\"critical\",{\"alignItems\":\"flex-start\",\"as\":\"$2e\",\"gridTemplateColumns\":\"2rem 1fr\",\"children\":[[\"$\",\"$L2e\",null,{\"alignItems\":\"center\",\"gap\":0,\"gridColumn\":\"1/span 2\",\"gridTemplateColumns\":\"inherit\",\"children\":[[\"$\",\"$L39\",null,{\"label\":\"critical\",\"textTransform\":\"capitalize\",\"children\":[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.critical\",\"borderRadius\":\"full\",\"boxSize\":\"1rem\"}]}],[\"$\",\"$L2f\",null,{\"fontSize\":\"md\",\"fontWeight\":\"semibold\",\"children\":\"Critical Risk\"}]]}],[\"$\",\"$L2d\",null,{\"alignItems\":\"flex-start\",\"gridColumn\":\"2/2\",\"spacing\":0,\"children\":[[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"sm\",\"children\":[1,\" findings\"]}],[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"sm\",\"children\":[1,\" fixed\"]}],[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"sm\",\"children\":[0,\" acknowledged\"]}]]}]]}],[\"$\",\"$L38\",\"high\",{\"alignItems\":\"flex-start\",\"as\":\"$2e\",\"gridTemplateColumns\":\"2rem 1fr\",\"children\":[[\"$\",\"$L2e\",null,{\"alignItems\":\"center\",\"gap\":0,\"gridColumn\":\"1/span 2\",\"gridTemplateColumns\":\"inherit\",\"children\":[[\"$\",\"$L39\",null,{\"label\":\"high\",\"textTransform\":\"capitalize\",\"children\":[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.high\",\"borderRadius\":\"full\",\"boxSize\":\"1rem\"}]}],[\"$\",\"$L2f\",null,{\"fontSize\":\"md\",\"fontWeight\":\"semibold\",\"children\":\"High Risk\"}]]}],[\"$\",\"$L2d\",null,{\"alignItems\":\"flex-start\",\"gridColumn\":\"2/2\",\"spacing\":0,\"children\":[[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"sm\",\"children\":[1,\" findings\"]}],[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"sm\",\"children\":[1,\" fixed\"]}],[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"sm\",\"children\":[0,\" acknowledged\"]}]]}]]}],[\"$\",\"$L38\",\"medium\",{\"alignItems\":\"flex-start\",\"as\":\"$2e\",\"gridTemplateColumns\":\"2rem 1fr\",\"children\":[[\"$\",\"$L2e\",null,{\"alignItems\":\"center\",\"gap\":0,\"gridColumn\":\"1/span 2\",\"gridTemplateColumns\":\"inherit\",\"children\":[[\"$\",\"$L39\",null,{\"label\":\"medium\",\"textTransform\":\"capitalize\",\"children\":[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.medium\",\"borderRadius\":\"full\",\"boxSize\":\"1rem\"}]}],[\"$\",\"$L2f\",null,{\"fontSize\":\"md\",\"fontWeight\":\"semibold\",\"children\":\"Medium Risk\"}]]}],[\"$\",\"$L2d\",null,{\"alignItems\":\"flex-start\",\"gridColumn\":\"2/2\",\"spacing\":0,\"children\":[[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"sm\",\"children\":[3,\" findings\"]}],[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"sm\",\"children\":[3,\" fixed\"]}],[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"sm\",\"children\":[0,\" acknowledged\"]}]]}]]}],[\"$\",\"$L38\",\"informational\",{\"alignItems\":\"flex-start\",\"as\":\"$2e\",\"gridTemplateColumns\":\"2rem 1fr\",\"children\":[[\"$\",\"$L2e\",null,{\"alignItems\":\"center\",\"gap\":0,\"gridColumn\":\"1/span 2\",\"gridTemplateColumns\":\"inherit\",\"children\":[[\"$\",\"$L39\",null,{\"label\":\"informational\",\"textTransform\":\"capitalize\",\"children\":[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.informational\",\"borderRadius\":\"full\",\"boxSize\":\"1rem\"}]}],[\"$\",\"$L2f\",null,{\"fontSize\":\"md\",\"fontWeight\":\"semibold\",\"children\":\"Informational\"}]]}],[\"$\",\"$L2d\",null,{\"alignItems\":\"flex-start\",\"gridColumn\":\"2/2\",\"spacing\":0,\"children\":[[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"sm\",\"children\":[2,\" findings\"]}],[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"sm\",\"children\":[2,\" fixed\"]}],[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"sm\",\"children\":[0,\" acknowledged\"]}]]}]]}]]}],[[\"$\",\"$L36\",null,{}],[\"$\",\"$L2d\",null,{\"alignItems\":\"stretch\",\"gap\":12,\"sx\":{\"counterReset\":\"report-severities\"},\"children\":[[\"$\",\"$L2d\",\"critical\",{\"alignItems\":\"stretch\",\"as\":\"section\",\"gap\":4,\"children\":[[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":4,\"children\":[[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.critical\",\"borderRadius\":\"full\",\"boxSize\":4}],[\"$\",\"$L37\",null,{\"_before\":{\"content\":\"counter(report-severities) \\\".\\\"\"},\"alignItems\":\"center\",\"as\":\"h3\",\"display\":\"flex\",\"flexWrap\":\"wrap\",\"fontSize\":{\"base\":\"2xl\",\"md\":\"3xl\"},\"fontWeight\":\"semibold\",\"gap\":2,\"sx\":{\"counterIncrement\":\"report-severities\"},\"children\":[\"Critical Risk\",[\"$\",\"$L2f\",null,{\"as\":\"span\",\"color\":\"gray.500\",\"children\":[1,\" \",\"finding\"]}]]}]]}],[\"$\",\"$L3b\",null,{\"m\":0,\"spacing\":8,\"styleType\":\"none\",\"sx\":{\"counterReset\":\"report-severity-findings\"},\"children\":[[\"$\",\"$L3c\",\"8c0aa1ea-bbe9-4b8a-b544-d621feb31ae2\",{\"children\":[\"$\",\"$L2d\",\"8c0aa1ea-bbe9-4b8a-b544-d621feb31ae2\",{\"alignItems\":\"flex-start\",\"as\":\"section\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"borderRadius\":\"md\",\"gap\":6,\"p\":8,\"children\":[[\"$\",\"$L37\",null,{\"_before\":{\"content\":\"counter(report-severities) \\\".\\\" counter(report-severity-findings) \\\" \\\"\"},\"as\":\"h4\",\"color\":\"gray.950\",\"fontSize\":{\"base\":\"2xl\",\"md\":\"3xl\"},\"fontWeight\":\"semibold\",\"sx\":{\"counterIncrement\":\"report-severity-findings\"},\"wordBreak\":\"break-word\",\"children\":[\"$\",\"$L3d\",null,{\"text\":\"`isBudgetConstrainedBuyingLimitReached` should be set as soon as the remaining budget cannot afford the full order cost\"}]}],[\"$\",\"$L2d\",null,{\"alignItems\":\"stretch\",\"as\":\"dl\",\"gap\":2,\"sx\":{\"w\":\"full\",\"containerType\":\"inline-size\"},\"children\":[[\"$\",\"$L2e\",\"State\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"State\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":2,\"children\":[[\"$\",\"$L3e\",null,{\"alignItems\":\"center\",\"bgColor\":\"status.bg.fixed\",\"border\":\"1px solid\",\"borderColor\":\"status.bg.fixed\",\"color\":\"status.fixed\",\"display\":\"inline-flex\",\"gap\":1.5,\"lineHeight\":\"1rem\",\"minWidth\":\"fit-content\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"role\":\"$undefined\",\"size\":\"sm\",\"children\":[[\"$\",\"$L3f\",null,{\"boxSize\":3.5,\"strokeWidth\":\"2px\",\"children\":[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-wrench\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"cbrjhi\",{\"d\":\"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z\"}],\"$undefined\"]}]}],[\"$\",\"$L40\",null,{\"color\":\"inherit\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":\"Fixed\"}]]}],[[\"$\",\"$L3e\",\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\",{\"_hover\":{\"bg\":\"gray.100\"},\"as\":\"a\",\"bg\":\"white\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"borderRadius\":\"full\",\"color\":\"gray.950\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\",\"maxW\":\"10rem\",\"size\":\"sm\",\"target\":\"_blank\",\"children\":[\"$\",\"$L2f\",null,{\"isTruncated\":true,\"children\":\"PR #106\"}]}]]]}]}]]}],[\"$\",\"$L2e\",\"Severity\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Severity\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":2,\"children\":[[\"$\",\"$L3e\",null,{\"ref\":\"$undefined\",\"alignItems\":\"center\",\"bgColor\":\"transparent\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"display\":\"flex\",\"gap\":\"0.375rem\",\"lineHeight\":\"1rem\",\"size\":\"sm\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"fontWeight\":\"600\",\"children\":[[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.critical\",\"borderRadius\":\"full\",\"boxSize\":\"0.5rem\"}],[\"$\",\"$L40\",null,{\"color\":\"gray.950\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":[[\"Severity\",\": \"],\"Critical\"]}]]}],[[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"children\":\"≈\"}],[\"$\",\"$L3e\",null,{\"ref\":\"$undefined\",\"alignItems\":\"center\",\"bgColor\":\"transparent\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"display\":\"flex\",\"gap\":\"0.375rem\",\"lineHeight\":\"1rem\",\"size\":\"sm\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"fontWeight\":\"600\",\"children\":[[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.high\",\"borderRadius\":\"full\",\"boxSize\":\"0.5rem\"}],[\"$\",\"$L40\",null,{\"color\":\"gray.950\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":[[\"Likelihood\",\": \"],\"High\"]}]]}],[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"children\":\"×\"}],[\"$\",\"$L3e\",null,{\"ref\":\"$undefined\",\"alignItems\":\"center\",\"bgColor\":\"transparent\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"display\":\"flex\",\"gap\":\"0.375rem\",\"lineHeight\":\"1rem\",\"size\":\"sm\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"fontWeight\":\"600\",\"children\":[[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.high\",\"borderRadius\":\"full\",\"boxSize\":\"0.5rem\"}],[\"$\",\"$L40\",null,{\"color\":\"gray.950\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":[[\"Impact\",\": \"],\"High\"]}]]}]]]}]}]]}],[\"$\",\"$L2e\",\"Submitted by\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Submitted by\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L33\",null,{\"alignItems\":\"center\",\"as\":\"$34\",\"display\":\"flex\",\"gap\":2,\"href\":\"/u/Saw-mon-and-Natalie\",\"prefetch\":false,\"children\":[[\"$\",\"$L35\",null,{\"height\":\"20px\",\"src\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/8039eb9a-b849-4701-675d-fd94168a3300/public\",\"width\":\"20px\"}],[\"$\",\"$L2f\",null,{\"fontSize\":\"xs\",\"children\":[\" \",\"Saw-mon and Natalie\"]}]]}]}]]}]]}],[\"$\",\"$L36\",null,{}],[\"$\",\"$L41\",null,{\"children\":[\"$\",\"$L20\",null,{\"alignSelf\":\"stretch\",\"bg\":\"transparent\",\"className\":\"markdown-body\",\"flex\":\"1\",\"flexDirection\":\"column\",\"fontFamily\":\"body\",\"fontSize\":\"sm\",\"position\":\"relative\",\"sx\":{\"\u0026 code[class*=\\\"language-\\\"],  \u0026 pre[class*=\\\"language-\\\"]\":{\"color\":\"codeHighlighting.plain\",\"background\":\"white\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"fontFamily\":\"SFMono-Regular,Menlo,Monaco,Consolas,monospace\",\"fontSize\":\"0.75rem\",\"lineHeight\":\"1.5em\",\"tabSize\":\"4\",\"hyphens\":\"none\"},\"\u0026 :not(pre)\u003ecode[class*=\\\"language-\\\"]\":{\"whiteSpace\":\"normal\",\"borderRadius\":\"0.2em\",\"padding\":\"0.1em\"},\"\u0026 pre[class*=\\\"language-\\\"]\":{\"overflow\":\"auto\",\"position\":\"relative\",\"margin\":\"0.5em 0\",\"padding\":\"1.25em 1em\",\"border\":\"1px solid #ececec\",\"borderRadius\":\"4px\"},\"\u0026 [class*=\\\"language-\\\"] .namespace\":{\"opacity\":\"0.7\"},\"\u0026 :where(img, svg, video, canvas, audio, iframe, embed, object)\":{\"display\":\"initial\"},\"\u0026 h1\":{\"borderBottomColor\":\"var(--chakra-colors-gray-200)\"},\"\u0026 h2\":{\"borderBottomColor\":\"var(--chakra-colors-gray-200)\"},\"\u0026 .token.tag,\u0026 .token.selector,\u0026 .token.keyword,\u0026 .token.operator,\u0026 .token.atrule\":{\"color\":\"var(--chakra-colors-codeHighlighting-keyword)\"},\"\u0026 .token.comment,\u0026 .token.prolog,\u0026 .token.doctype,\u0026 .token.cdata\":{\"color\":\"var(--chakra-colors-codeHighlighting-meta)\",\"fontStyle\":\"italic\"},\"\u0026 .token.namespace\":{\"opacity\":0.7},\"\u0026 .token.string,\u0026 .token.attr-value,\u0026 .token.attribute,\u0026 .token.pseudo-class,\u0026 .token.pseudo-element\":{\"color\":\"var(--chakra-colors-codeHighlighting-string)\"},\"\u0026 .token.number,\u0026 .token.boolean,\u0026 .token.builtin,\u0026 .token.entity,\u0026 .token.url,\u0026 .token.symbol,\u0026 .token.variable,\u0026 .token.constant,\u0026 .token.property,\u0026 .token.regex,\u0026 .token.attr-name,\u0026 .token.unit,\u0026 .token.hexcode\":{\"color\":\"var(--chakra-colors-codeHighlighting-literal)\"},\"\u0026 .token.punctuation,\u0026 .token.char,\u0026 .token.class\":{\"color\":\"var(--chakra-colors-codeHighlighting-plain)\"},\"\u0026 .token.function,\u0026 .token.class-name,\u0026 .token.function-variable,\u0026 .token.id\":{\"color\":\"var(--chakra-colors-codeHighlighting-identifier)\"},\"\u0026 .token.important,\u0026 .token.bold\":{\"fontWeight\":\"bold\"},\"\u0026 .token.italic\":{\"fontStyle\":\"italic\"},\"\u0026 .token.deleted\":{\"color\":\"var(--chakra-colors-codeHighlighting-diff-deleted)\"},\"\u0026 .token.inserted\":{\"color\":\"var(--chakra-colors-codeHighlighting-diff-inserted)\"}},\"wordBreak\":\"break-word\",\"children\":[[\"$\",\"$L42\",null,{\"frontmatter\":{}}],[[\"$\",\"$L37\",\"h2-0\",{\"as\":\"h2\",\"id\":\"description\",\"mb\":\"5\",\"size\":\"xl\",\"node\":{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Description\",\"position\":{\"start\":{\"line\":1,\"column\":4,\"offset\":3},\"end\":{\"line\":1,\"column\":15,\"offset\":14}}}],\"position\":{\"start\":{\"line\":1,\"column\":1,\"offset\":0},\"end\":{\"line\":1,\"column\":15,\"offset\":14}}},\"children\":\"Description\"}],\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"isBudgetConstrainedBuyingLimitReached\",\"position\":{\"start\":{\"line\":3,\"column\":1,\"offset\":16},\"end\":{\"line\":3,\"column\":40,\"offset\":55}}}],\"position\":{\"start\":{\"line\":3,\"column\":1,\"offset\":16},\"end\":{\"line\":3,\"column\":40,\"offset\":55}}},{\"type\":\"text\",\"value\":\" should be set as soon as the remaining budget cannot afford the full order cost. Here is why this is an issue currently. If we can only partially afford to fill the current order to be consumed, ie \",\"position\":{\"start\":{\"line\":3,\"column\":40,\"offset\":55},\"end\":{\"line\":3,\"column\":239,\"offset\":254}}},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L842\"},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"maxAffordableQuantity\",\"position\":{\"start\":{\"line\":3,\"column\":240,\"offset\":255},\"end\":{\"line\":3,\"column\":263,\"offset\":278}}}],\"position\":{\"start\":{\"line\":3,\"column\":240,\"offset\":255},\"end\":{\"line\":3,\"column\":263,\"offset\":278}}}],\"position\":{\"start\":{\"line\":3,\"column\":239,\"offset\":254},\"end\":{\"line\":3,\"column\":398,\"offset\":413}}},{\"type\":\"text\",\"value\":\" (quantised) is not-zero and we partially fill the order, then the implementation moves on to the next order. Most likely in the next iteration, one cannot fill any of the next order, since the \",\"position\":{\"start\":{\"line\":3,\"column\":398,\"offset\":413},\"end\":{\"line\":3,\"column\":592,\"offset\":607}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"remainingBudget\",\"position\":{\"start\":{\"line\":3,\"column\":592,\"offset\":607},\"end\":{\"line\":3,\"column\":609,\"offset\":624}}}],\"position\":{\"start\":{\"line\":3,\"column\":592,\"offset\":607},\"end\":{\"line\":3,\"column\":609,\"offset\":624}}},{\"type\":\"text\",\"value\":\" would be really small and \",\"position\":{\"start\":{\"line\":3,\"column\":609,\"offset\":624},\"end\":{\"line\":3,\"column\":636,\"offset\":651}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"bestPrice\",\"position\":{\"start\":{\"line\":3,\"column\":636,\"offset\":651},\"end\":{\"line\":3,\"column\":647,\"offset\":662}}}],\"position\":{\"start\":{\"line\":3,\"column\":636,\"offset\":651},\"end\":{\"line\":3,\"column\":647,\"offset\":662}}},{\"type\":\"text\",\"value\":\" potentially could be even higher (in budget-constrained market buy orders, best prices increment up as we fill/match orders):\",\"position\":{\"start\":{\"line\":3,\"column\":647,\"offset\":662},\"end\":{\"line\":3,\"column\":773,\"offset\":788}}}],\"position\":{\"start\":{\"line\":3,\"column\":1,\"offset\":16},\"end\":{\"line\":3,\"column\":773,\"offset\":788}}},\"children\":[[\"$\",\"$L43\",\"code-0\",{\"code\":\"isBudgetConstrainedBuyingLimitReached\",\"inline\":true,\"language\":\"text\"}],\" should be set as soon as the remaining budget cannot afford the full order cost. Here is why this is an issue currently. If we can only partially afford to fill the current order to be consumed, ie \",[\"$\",\"$L44\",\"a-0\",{\"repoId\":\"$undefined\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L842\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:2:props:node:children:2\",\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"maxAffordableQuantity\",\"inline\":true,\"language\":\"text\"}]}],\" (quantised) is not-zero and we partially fill the order, then the implementation moves on to the next order. Most likely in the next iteration, one cannot fill any of the next order, since the \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"remainingBudget\",\"inline\":true,\"language\":\"text\"}],\" would be really small and \",[\"$\",\"$L43\",\"code-2\",{\"code\":\"bestPrice\",\"inline\":true,\"language\":\"text\"}],\" potentially could be even higher (in budget-constrained market buy orders, best prices increment up as we fill/match orders):\"]}],\"\\n\",[\"$\",\"span\",\"span-0\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"fence\":\"true\",\"children\":\"⌊\"}],[\"$\",\"mfrac\",\"mfrac-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"Δ\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"q\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"p\"}],[\"$\",\"msup\",\"msup-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"b\"}],[\"$\",\"mo\",\"mo-0\",{\"mathvariant\":\"normal\",\"lspace\":\"0em\",\"rspace\":\"0em\",\"children\":\"′\"}]]}]]}]]}],[\"$\",\"msup\",\"msup-0\",{\"children\":[[\"$\",\"mn\",\"mn-0\",{\"children\":\"10\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"d\"}]]}]]}],[\"$\",\"mo\",\"mo-1\",{\"fence\":\"true\",\"children\":\"⌋\"}]]}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"\u003e\"}],[\"$\",\"mfrac\",\"mfrac-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"ϵ\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"0\"}]]}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"+\"}],[\"$\",\"msub\",\"msub-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"ϵ\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"1\"}]]}],[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"Δ\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"q\"}],[\"$\",\"mo\",\"mo-2\",{\"stretchy\":\"false\",\"children\":\")\"}],[\"$\",\"msub\",\"msub-2\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"p\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"b\"}]]}]]}],[\"$\",\"msup\",\"msup-0\",{\"children\":[[\"$\",\"mn\",\"mn-0\",{\"children\":\"10\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"d\"}]]}]]}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"+\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"ϵ\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"2\"}]]}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\left\\\\lfloor\\n\\\\frac{\\\\Delta q p_{b'}}{10^d} \\n\\\\right\\\\rfloor\\n\u003e \\\\frac{(\\\\epsilon_0 + \\\\epsilon_1 \\\\Delta q) p_b}{10^d} + \\\\epsilon_2\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"2.4em\",\"verticalAlign\":\"-0.95em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"minner\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size3\",\"children\":\"⌊\"}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen nulldelimiter\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mfrac\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.3603em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.314em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"1\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"0\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.7751em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.989em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}]}]]}]}]}]}]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.23em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"frac-line\",\"style\":{\"borderBottomWidth\":\"0.04em\"}}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-3.677em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"Δ\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"p\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3361em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"b\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.6828em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.786em\",\"marginRight\":\"0.0714em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size3 size1 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":\"′\"}]}]}]]}]}]}]}]}]]}]}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.686em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose nulldelimiter\"}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size3\",\"children\":\"⌋\"}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":\"\u003e\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"2.113em\",\"verticalAlign\":\"-0.686em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen nulldelimiter\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mfrac\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.427em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.314em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"1\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"0\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.7751em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.989em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}]}]]}]}]}]}]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.23em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"frac-line\",\"style\":{\"borderBottomWidth\":\"0.04em\"}}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-3.677em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"ϵ\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3011em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":\"0\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mbin\",\"children\":\"+\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-5\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"ϵ\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3011em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":\"1\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-6\",{\"className\":\"mord\",\"children\":\"Δ\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-8\",{\"className\":\"mclose\",\"children\":\")\"}],[\"$\",\"span\",\"span-9\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"p\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3361em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"b\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.686em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose nulldelimiter\"}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mbin\",\"children\":\"+\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.5806em\",\"verticalAlign\":\"-0.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"ϵ\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3011em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":\"2\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}]]}]}],\"\\n\",[\"$\",\"$L2f\",\"p-1\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"In this scenario, after the first budget-constrained partial fill, if one queries for the next order to potentially match, if it ends up matching \",\"position\":{\"start\":{\"line\":12,\"column\":1,\"offset\":921},\"end\":{\"line\":12,\"column\":147,\"offset\":1067}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"0\",\"position\":{\"start\":{\"line\":12,\"column\":147,\"offset\":1067},\"end\":{\"line\":12,\"column\":150,\"offset\":1070}}}],\"position\":{\"start\":{\"line\":12,\"column\":147,\"offset\":1067},\"end\":{\"line\":12,\"column\":150,\"offset\":1070}}},{\"type\":\"text\",\"value\":\" amount. We would hit \",\"position\":{\"start\":{\"line\":12,\"column\":150,\"offset\":1070},\"end\":{\"line\":12,\"column\":172,\"offset\":1092}}},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L845-L850\"},\"children\":[{\"type\":\"text\",\"value\":\"this branch\",\"position\":{\"start\":{\"line\":12,\"column\":173,\"offset\":1093},\"end\":{\"line\":12,\"column\":184,\"offset\":1104}}}],\"position\":{\"start\":{\"line\":12,\"column\":172,\"offset\":1092},\"end\":{\"line\":12,\"column\":324,\"offset\":1244}}},{\"type\":\"text\",\"value\":\":\",\"position\":{\"start\":{\"line\":12,\"column\":324,\"offset\":1244},\"end\":{\"line\":12,\"column\":325,\"offset\":1245}}}],\"position\":{\"start\":{\"line\":12,\"column\":1,\"offset\":921},\"end\":{\"line\":12,\"column\":325,\"offset\":1245}}},\"children\":[\"In this scenario, after the first budget-constrained partial fill, if one queries for the next order to potentially match, if it ends up matching \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"0\",\"inline\":true,\"language\":\"text\"}],\" amount. We would hit \",[\"$\",\"$L44\",\"a-0\",{\"repoId\":\"$undefined\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L845-L850\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:6:props:node:children:3\",\"children\":\"this branch\"}],\":\"]}],\"\\n\",[\"$\",\"$L45\",\"pre-0\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-solidity\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"if (maxAffordableQuantity == 0) {\\n  // Can't afford any of this order, stop here\\n  params.isBudgetConstrainedBuyingLimitReached = true;\\n  return (\\n    segment,\\n    0, // ordersConsumed\\n    0 // quantityNFTClaimable\\n  );\\n}\\n\"}],\"position\":{\"start\":{\"line\":14,\"column\":1,\"offset\":1247},\"end\":{\"line\":24,\"column\":4,\"offset\":1484}}}],\"position\":{\"start\":{\"line\":14,\"column\":1,\"offset\":1247},\"end\":{\"line\":24,\"column\":4,\"offset\":1484}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"if (maxAffordableQuantity == 0) {\\n  // Can't afford any of this order, stop here\\n  params.isBudgetConstrainedBuyingLimitReached = true;\\n  return (\\n    segment,\\n    0, // ordersConsumed\\n    0 // quantityNFTClaimable\\n  );\\n}\",\"inline\":false,\"language\":\"solidity\"}]}],[\"$\",\"$L46\",null,{\"content\":\"if (maxAffordableQuantity == 0) {\\n  // Can't afford any of this order, stop here\\n  params.isBudgetConstrainedBuyingLimitReached = true;\\n  return (\\n    segment,\\n    0, // ordersConsumed\\n    0 // quantityNFTClaimable\\n  );\\n}\\n\"}]]}],\"\\n\",[\"$\",\"$L2f\",\"p-2\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Note that we have queried \",\"position\":{\"start\":{\"line\":26,\"column\":1,\"offset\":1486},\"end\":{\"line\":26,\"column\":27,\"offset\":1512}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"2\",\"position\":{\"start\":{\"line\":26,\"column\":27,\"offset\":1512},\"end\":{\"line\":26,\"column\":30,\"offset\":1515}}}],\"position\":{\"start\":{\"line\":26,\"column\":27,\"offset\":1512},\"end\":{\"line\":26,\"column\":30,\"offset\":1515}}},{\"type\":\"text\",\"value\":\" orders so far and for both one \",\"position\":{\"start\":{\"line\":26,\"column\":30,\"offset\":1515},\"end\":{\"line\":26,\"column\":62,\"offset\":1547}}},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L805\"},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"ordersConsumed\",\"position\":{\"start\":{\"line\":26,\"column\":63,\"offset\":1548},\"end\":{\"line\":26,\"column\":79,\"offset\":1564}}}],\"position\":{\"start\":{\"line\":26,\"column\":63,\"offset\":1548},\"end\":{\"line\":26,\"column\":79,\"offset\":1564}}}],\"position\":{\"start\":{\"line\":26,\"column\":62,\"offset\":1547},\"end\":{\"line\":26,\"column\":214,\"offset\":1699}}},{\"type\":\"text\",\"value\":\" has been \",\"position\":{\"start\":{\"line\":26,\"column\":214,\"offset\":1699},\"end\":{\"line\":26,\"column\":224,\"offset\":1709}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"0\",\"position\":{\"start\":{\"line\":26,\"column\":224,\"offset\":1709},\"end\":{\"line\":26,\"column\":227,\"offset\":1712}}}],\"position\":{\"start\":{\"line\":26,\"column\":224,\"offset\":1709},\"end\":{\"line\":26,\"column\":227,\"offset\":1712}}},{\"type\":\"text\",\"value\":\". At this point we have:\",\"position\":{\"start\":{\"line\":26,\"column\":227,\"offset\":1712},\"end\":{\"line\":26,\"column\":251,\"offset\":1736}}}],\"position\":{\"start\":{\"line\":26,\"column\":1,\"offset\":1486},\"end\":{\"line\":26,\"column\":251,\"offset\":1736}}},\"children\":[\"Note that we have queried \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"2\",\"inline\":true,\"language\":\"text\"}],\" orders so far and for both one \",[\"$\",\"$L44\",\"a-0\",{\"repoId\":\"$undefined\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L805\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:10:props:node:children:3\",\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"ordersConsumed\",\"inline\":true,\"language\":\"text\"}]}],\" has been \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"0\",\"inline\":true,\"language\":\"text\"}],\". At this point we have:\"]}],\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\",[\"$\",\"table\",\"table-0\",{\"children\":[[\"$\",\"thead\",\"thead-0\",{\"children\":[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"th\",\"th-0\",{\"children\":\"parameter\"}],[\"$\",\"th\",\"th-1\",{\"children\":\"value\"}]]}]}],[\"$\",\"tbody\",\"tbody-0\",{\"children\":[[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"children\":[\"$\",\"$L44\",\"a-0\",{\"repoId\":\"$undefined\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L803\",\"node\":{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L803\"},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"segment\",\"position\":{\"start\":{\"line\":30,\"column\":4,\"offset\":1772},\"end\":{\"line\":30,\"column\":13,\"offset\":1781}}}],\"position\":{\"start\":{\"line\":30,\"column\":4,\"offset\":1772},\"end\":{\"line\":30,\"column\":13,\"offset\":1781}}}],\"position\":{\"start\":{\"line\":30,\"column\":3,\"offset\":1771},\"end\":{\"line\":30,\"column\":148,\"offset\":1916}}},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"segment\",\"inline\":true,\"language\":\"text\"}]}]}],[\"$\",\"td\",\"td-1\",{\"children\":\"the segment that includes the last skipped order\"}]]}],[\"$\",\"tr\",\"tr-1\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"children\":[\"$\",\"$L44\",\"a-0\",{\"repoId\":\"$undefined\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L773\",\"node\":{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L773\"},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"lastConsumedSegmentIndex\",\"position\":{\"start\":{\"line\":31,\"column\":4,\"offset\":1973},\"end\":{\"line\":31,\"column\":30,\"offset\":1999}}}],\"position\":{\"start\":{\"line\":31,\"column\":4,\"offset\":1973},\"end\":{\"line\":31,\"column\":30,\"offset\":1999}}}],\"position\":{\"start\":{\"line\":31,\"column\":3,\"offset\":1972},\"end\":{\"line\":31,\"column\":165,\"offset\":2134}}},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"lastConsumedSegmentIndex\",\"inline\":true,\"language\":\"text\"}]}]}],[\"$\",\"td\",\"td-1\",{\"children\":\"might be potentially the same as the first order or pointing to the next segment since we have quried 2 orders\"}]]}],[\"$\",\"tr\",\"tr-2\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"children\":[\"$\",\"$L44\",\"a-0\",{\"repoId\":\"$undefined\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L820\",\"node\":{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L820\"},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"numOrdersFullyConsumed\",\"position\":{\"start\":{\"line\":32,\"column\":4,\"offset\":2253},\"end\":{\"line\":32,\"column\":28,\"offset\":2277}}}],\"position\":{\"start\":{\"line\":32,\"column\":4,\"offset\":2253},\"end\":{\"line\":32,\"column\":28,\"offset\":2277}}}],\"position\":{\"start\":{\"line\":32,\"column\":3,\"offset\":2252},\"end\":{\"line\":32,\"column\":163,\"offset\":2412}}},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"numOrdersFullyConsumed\",\"inline\":true,\"language\":\"text\"}]}]}],[\"$\",\"td\",\"td-1\",{\"children\":[\"does not count for the last orders: the one that was partially matched and also the one that was skipped since \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"maxAffordableQuantity\",\"inline\":true,\"language\":\"text\"}],\" ends up being \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"0\",\"inline\":true,\"language\":\"text\"}]]}]]}]]}]]}],\"\\n\",[\"$\",\"$L2f\",\"p-3\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Now, let's analyse this portion of the \",\"position\":{\"start\":{\"line\":34,\"column\":1,\"offset\":2571},\"end\":{\"line\":34,\"column\":40,\"offset\":2610}}},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L937-L951\"},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_updateSegmentsAndTree\",\"position\":{\"start\":{\"line\":34,\"column\":41,\"offset\":2611},\"end\":{\"line\":34,\"column\":65,\"offset\":2635}}}],\"position\":{\"start\":{\"line\":34,\"column\":41,\"offset\":2611},\"end\":{\"line\":34,\"column\":65,\"offset\":2635}}}],\"position\":{\"start\":{\"line\":34,\"column\":40,\"offset\":2610},\"end\":{\"line\":34,\"column\":205,\"offset\":2775}}},{\"type\":\"text\",\"value\":\":\",\"position\":{\"start\":{\"line\":34,\"column\":205,\"offset\":2775},\"end\":{\"line\":34,\"column\":206,\"offset\":2776}}}],\"position\":{\"start\":{\"line\":34,\"column\":1,\"offset\":2571},\"end\":{\"line\":34,\"column\":206,\"offset\":2776}}},\"children\":[\"Now, let's analyse this portion of the \",[\"$\",\"$L44\",\"a-0\",{\"repoId\":\"$undefined\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L937-L951\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:14:props:node:children:1\",\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"_updateSegmentsAndTree\",\"inline\":true,\"language\":\"text\"}]}],\":\"]}],\"\\n\",[\"$\",\"$L45\",\"pre-1\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-solidity\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"$47\"}],\"position\":{\"start\":{\"line\":36,\"column\":1,\"offset\":2778},\"end\":{\"line\":62,\"column\":4,\"offset\":3977}}}],\"position\":{\"start\":{\"line\":36,\"column\":1,\"offset\":2778},\"end\":{\"line\":62,\"column\":4,\"offset\":3977}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"$48\",\"inline\":false,\"language\":\"solidity\"}]}],[\"$\",\"$L46\",null,{\"content\":\"$49\"}]]}],\"\\n\",[\"$\",\"$L2f\",\"p-4\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Let's follow all this with an example from transaction \",\"position\":{\"start\":{\"line\":64,\"column\":1,\"offset\":3979},\"end\":{\"line\":64,\"column\":56,\"offset\":4034}}},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://www.tdly.co/tx/0xd1945911cce9d105b4503d3ab378e735c754ae1c5d5df62fe4b824b884c2b3c1\"},\"children\":[{\"type\":\"text\",\"value\":\"0xd1945911cce9d105b4503d3ab378e735c754ae1c5d5df62fe4b824b884c2b3c1\",\"position\":{\"start\":{\"line\":64,\"column\":57,\"offset\":4035},\"end\":{\"line\":64,\"column\":123,\"offset\":4101}}}],\"position\":{\"start\":{\"line\":64,\"column\":56,\"offset\":4034},\"end\":{\"line\":64,\"column\":215,\"offset\":4193}}},{\"type\":\"text\",\"value\":\":\",\"position\":{\"start\":{\"line\":64,\"column\":215,\"offset\":4193},\"end\":{\"line\":64,\"column\":216,\"offset\":4194}}}],\"position\":{\"start\":{\"line\":64,\"column\":1,\"offset\":3979},\"end\":{\"line\":64,\"column\":216,\"offset\":4194}}},\"children\":[\"Let's follow all this with an example from transaction \",[\"$\",\"$L44\",\"a-0\",{\"repoId\":\"$undefined\",\"href\":\"https://www.tdly.co/tx/0xd1945911cce9d105b4503d3ab378e735c754ae1c5d5df62fe4b824b884c2b3c1\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:18:props:node:children:1\",\"children\":\"0xd1945911cce9d105b4503d3ab378e735c754ae1c5d5df62fe4b824b884c2b3c1\"}],\":\"]}],\"\\n\",[\"$\",\"$L45\",\"pre-2\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"(10, 40416) (10, 40415) (10, 40414)\\n(10, 40419) (10, 40418) (10, 40417)\\n\"}],\"position\":{\"start\":{\"line\":66,\"column\":1,\"offset\":4196},\"end\":{\"line\":69,\"column\":4,\"offset\":4275}}}],\"position\":{\"start\":{\"line\":66,\"column\":1,\"offset\":4196},\"end\":{\"line\":69,\"column\":4,\"offset\":4275}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"(10, 40416) (10, 40415) (10, 40414)\\n(10, 40419) (10, 40418) (10, 40417)\",\"inline\":false,\"language\":\"text\"}]}],[\"$\",\"$L46\",null,{\"content\":\"(10, 40416) (10, 40415) (10, 40414)\\n(10, 40419) (10, 40418) (10, 40417)\\n\"}]]}],\"\\n\",[\"$\",\"$L2f\",\"p-5\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"with \",\"position\":{\"start\":{\"line\":71,\"column\":1,\"offset\":4277},\"end\":{\"line\":71,\"column\":6,\"offset\":4282}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"maxCost\",\"position\":{\"start\":{\"line\":71,\"column\":6,\"offset\":4282},\"end\":{\"line\":71,\"column\":15,\"offset\":4291}}}],\"position\":{\"start\":{\"line\":71,\"column\":6,\"offset\":4282},\"end\":{\"line\":71,\"column\":15,\"offset\":4291}}},{\"type\":\"text\",\"value\":\" \",\"position\":{\"start\":{\"line\":71,\"column\":15,\"offset\":4291},\"end\":{\"line\":71,\"column\":16,\"offset\":4292}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"c\"}]},{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"m\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"a\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"x\"}]}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"31500\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"c_{max} = 31500\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.5806em;vertical-align:-0.15em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"c\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.1514em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"ma\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"x\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6444em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"31500\"}]}]}]}]},{\"type\":\"text\",\"value\":\". The transaction fully consumed the orders \",\"position\":{\"start\":{\"line\":71,\"column\":33,\"offset\":4309},\"end\":{\"line\":71,\"column\":77,\"offset\":4353}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"40414\",\"position\":{\"start\":{\"line\":71,\"column\":77,\"offset\":4353},\"end\":{\"line\":71,\"column\":84,\"offset\":4360}}}],\"position\":{\"start\":{\"line\":71,\"column\":77,\"offset\":4353},\"end\":{\"line\":71,\"column\":84,\"offset\":4360}}},{\"type\":\"text\",\"value\":\" and \",\"position\":{\"start\":{\"line\":71,\"column\":84,\"offset\":4360},\"end\":{\"line\":71,\"column\":89,\"offset\":4365}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"40415\",\"position\":{\"start\":{\"line\":71,\"column\":89,\"offset\":4365},\"end\":{\"line\":71,\"column\":96,\"offset\":4372}}}],\"position\":{\"start\":{\"line\":71,\"column\":89,\"offset\":4365},\"end\":{\"line\":71,\"column\":96,\"offset\":4372}}},{\"type\":\"text\",\"value\":\" and at this point the \",\"position\":{\"start\":{\"line\":71,\"column\":96,\"offset\":4372},\"end\":{\"line\":71,\"column\":119,\"offset\":4395}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"params.currentCost\",\"position\":{\"start\":{\"line\":71,\"column\":119,\"offset\":4395},\"end\":{\"line\":71,\"column\":139,\"offset\":4415}}}],\"position\":{\"start\":{\"line\":71,\"column\":119,\"offset\":4395},\"end\":{\"line\":71,\"column\":139,\"offset\":4415}}},{\"type\":\"text\",\"value\":\" would be \",\"position\":{\"start\":{\"line\":71,\"column\":139,\"offset\":4415},\"end\":{\"line\":71,\"column\":149,\"offset\":4425}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"c\"}]},{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"c\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"u\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"r\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"r\"}]}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"31490\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"c_{curr} = 31490\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.5806em;vertical-align:-0.15em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"c\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.1514em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"c\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"u\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"],\"style\":\"margin-right:0.02778em;\"},\"children\":[{\"type\":\"text\",\"value\":\"rr\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6444em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"31490\"}]}]}]}]},{\"type\":\"text\",\"value\":\" and the remaining budget would be \",\"position\":{\"start\":{\"line\":71,\"column\":167,\"offset\":4443},\"end\":{\"line\":71,\"column\":202,\"offset\":4478}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"c\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"r\"}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"10\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"c_r = 10\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.5806em;vertical-align:-0.15em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"c\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.1514em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"],\"style\":\"margin-right:0.02778em;\"},\"children\":[{\"type\":\"text\",\"value\":\"r\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6444em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"10\"}]}]}]}]},{\"type\":\"text\",\"value\":\", the quantised \",\"position\":{\"start\":{\"line\":71,\"column\":212,\"offset\":4488},\"end\":{\"line\":71,\"column\":228,\"offset\":4504}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"maxAffordableQuantity\",\"position\":{\"start\":{\"line\":71,\"column\":228,\"offset\":4504},\"end\":{\"line\":71,\"column\":251,\"offset\":4527}}}],\"position\":{\"start\":{\"line\":71,\"column\":228,\"offset\":4504},\"end\":{\"line\":71,\"column\":251,\"offset\":4527}}},{\"type\":\"text\",\"value\":\" \",\"position\":{\"start\":{\"line\":71,\"column\":251,\"offset\":4527},\"end\":{\"line\":71,\"column\":252,\"offset\":4528}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"m\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"a\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"x\"}]}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"Δ\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"q_{max} = 2 \\\\Delta q\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.625em;vertical-align:-0.1944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.03588em;\"},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.1514em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"ma\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"x\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.8778em;vertical-align:-0.1944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"2Δ\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.03588em;\"},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]}]}]}]},{\"type\":\"text\",\"value\":\" (\",\"position\":{\"start\":{\"line\":71,\"column\":274,\"offset\":4550},\"end\":{\"line\":71,\"column\":276,\"offset\":4552}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"Δ\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\Delta q\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.8778em;vertical-align:-0.1944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"Δ\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.03588em;\"},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]}]}]}]},{\"type\":\"text\",\"value\":\" being the \",\"position\":{\"start\":{\"line\":71,\"column\":286,\"offset\":4562},\"end\":{\"line\":71,\"column\":297,\"offset\":4573}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"QUANTITY_TICK\",\"position\":{\"start\":{\"line\":71,\"column\":297,\"offset\":4573},\"end\":{\"line\":71,\"column\":312,\"offset\":4588}}}],\"position\":{\"start\":{\"line\":71,\"column\":297,\"offset\":4573},\"end\":{\"line\":71,\"column\":312,\"offset\":4588}}},{\"type\":\"text\",\"value\":\"). Order \",\"position\":{\"start\":{\"line\":71,\"column\":312,\"offset\":4588},\"end\":{\"line\":71,\"column\":321,\"offset\":4597}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"40416\",\"position\":{\"start\":{\"line\":71,\"column\":321,\"offset\":4597},\"end\":{\"line\":71,\"column\":328,\"offset\":4604}}}],\"position\":{\"start\":{\"line\":71,\"column\":321,\"offset\":4597},\"end\":{\"line\":71,\"column\":328,\"offset\":4604}}},{\"type\":\"text\",\"value\":\" gets partialy filled and the slot (in stack) gets updated to \",\"position\":{\"start\":{\"line\":71,\"column\":328,\"offset\":4604},\"end\":{\"line\":71,\"column\":390,\"offset\":4666}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"(8, 40416)\",\"position\":{\"start\":{\"line\":71,\"column\":390,\"offset\":4666},\"end\":{\"line\":71,\"column\":402,\"offset\":4678}}}],\"position\":{\"start\":{\"line\":71,\"column\":390,\"offset\":4666},\"end\":{\"line\":71,\"column\":402,\"offset\":4678}}},{\"type\":\"text\",\"value\":\". Since we have not set the \",\"position\":{\"start\":{\"line\":71,\"column\":402,\"offset\":4678},\"end\":{\"line\":71,\"column\":430,\"offset\":4706}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"isBudgetConstrainedBuyingLimitReached\",\"position\":{\"start\":{\"line\":71,\"column\":430,\"offset\":4706},\"end\":{\"line\":71,\"column\":469,\"offset\":4745}}}],\"position\":{\"start\":{\"line\":71,\"column\":430,\"offset\":4706},\"end\":{\"line\":71,\"column\":469,\"offset\":4745}}},{\"type\":\"text\",\"value\":\" and the other conditions are satisfied (there is a remaining budget and we have not hit the limit price, ...), querying over the orders continues. At this point we have \",\"position\":{\"start\":{\"line\":71,\"column\":469,\"offset\":4745},\"end\":{\"line\":71,\"column\":639,\"offset\":4915}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"c\"}]},{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"c\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"u\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"r\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"r\"}]}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"31498\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"c_{curr} = 31498\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.5806em;vertical-align:-0.15em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"c\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.1514em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"c\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"u\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"],\"style\":\"margin-right:0.02778em;\"},\"children\":[{\"type\":\"text\",\"value\":\"rr\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6444em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"31498\"}]}]}]}]},{\"type\":\"text\",\"value\":\" and thus \",\"position\":{\"start\":{\"line\":71,\"column\":657,\"offset\":4933},\"end\":{\"line\":71,\"column\":667,\"offset\":4943}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"c\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"r\"}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"c_r = 2\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.5806em;vertical-align:-0.15em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"c\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.1514em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"],\"style\":\"margin-right:0.02778em;\"},\"children\":[{\"type\":\"text\",\"value\":\"r\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6444em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]}]}]}]},{\"type\":\"text\",\"value\":\" this time \",\"position\":{\"start\":{\"line\":71,\"column\":676,\"offset\":4952},\"end\":{\"line\":71,\"column\":687,\"offset\":4963}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"m\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"a\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"x\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"q_{max}\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.625em;vertical-align:-0.1944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.03588em;\"},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.1514em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"ma\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"x\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\" ends up being \",\"position\":{\"start\":{\"line\":71,\"column\":696,\"offset\":4972},\"end\":{\"line\":71,\"column\":711,\"offset\":4987}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6444em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]}]}]},{\"type\":\"text\",\"value\":\" and this \",\"position\":{\"start\":{\"line\":71,\"column\":714,\"offset\":4990},\"end\":{\"line\":71,\"column\":724,\"offset\":5000}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"isBudgetConstrainedBuyingLimitReached\",\"position\":{\"start\":{\"line\":71,\"column\":724,\"offset\":5000},\"end\":{\"line\":71,\"column\":763,\"offset\":5039}}}],\"position\":{\"start\":{\"line\":71,\"column\":724,\"offset\":5000},\"end\":{\"line\":71,\"column\":763,\"offset\":5039}}},{\"type\":\"text\",\"value\":\" gets set. The value of \",\"position\":{\"start\":{\"line\":71,\"column\":763,\"offset\":5039},\"end\":{\"line\":71,\"column\":787,\"offset\":5063}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"segment\",\"position\":{\"start\":{\"line\":71,\"column\":787,\"offset\":5063},\"end\":{\"line\":71,\"column\":796,\"offset\":5072}}}],\"position\":{\"start\":{\"line\":71,\"column\":787,\"offset\":5063},\"end\":{\"line\":71,\"column\":796,\"offset\":5072}}},{\"type\":\"text\",\"value\":\" ends up being:\",\"position\":{\"start\":{\"line\":71,\"column\":796,\"offset\":5072},\"end\":{\"line\":71,\"column\":811,\"offset\":5087}}}],\"position\":{\"start\":{\"line\":71,\"column\":1,\"offset\":4277},\"end\":{\"line\":71,\"column\":811,\"offset\":5087}}},\"children\":[\"with \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"maxCost\",\"inline\":true,\"language\":\"text\"}],\" \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"c\"}],[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"m\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"a\"}],[\"$\",\"mi\",\"mi-2\",{\"children\":\"x\"}]]}]]}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"=\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"31500\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"c_{max} = 31500\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.5806em\",\"verticalAlign\":\"-0.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"c\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"ma\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal mtight\",\"children\":\"x\"}]]}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":\"=\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"31500\"}]]}]]}]]}],\". The transaction fully consumed the orders \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"40414\",\"inline\":true,\"language\":\"text\"}],\" and \",[\"$\",\"$L43\",\"code-2\",{\"code\":\"40415\",\"inline\":true,\"language\":\"text\"}],\" and at this point the \",[\"$\",\"$L43\",\"code-3\",{\"code\":\"params.currentCost\",\"inline\":true,\"language\":\"text\"}],\" would be \",[\"$\",\"span\",\"span-1\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"c\"}],[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"c\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"u\"}],[\"$\",\"mi\",\"mi-2\",{\"children\":\"r\"}],[\"$\",\"mi\",\"mi-3\",{\"children\":\"r\"}]]}]]}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"=\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"31490\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"c_{curr} = 31490\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.5806em\",\"verticalAlign\":\"-0.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"c\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"c\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal mtight\",\"children\":\"u\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.02778em\"},\"children\":\"rr\"}]]}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":\"=\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"31490\"}]]}]]}]]}],\" and the remaining budget would be \",[\"$\",\"span\",\"span-2\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"c\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"r\"}]]}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"=\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"10\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"c_r = 10\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.5806em\",\"verticalAlign\":\"-0.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"c\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.02778em\"},\"children\":\"r\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":\"=\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"10\"}]]}]]}]]}],\", the quantised \",[\"$\",\"$L43\",\"code-4\",{\"code\":\"maxAffordableQuantity\",\"inline\":true,\"language\":\"text\"}],\" \",[\"$\",\"span\",\"span-3\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"q\"}],[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"m\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"a\"}],[\"$\",\"mi\",\"mi-2\",{\"children\":\"x\"}]]}]]}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"=\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"2\"}],[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"Δ\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"q\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"q_{max} = 2 \\\\Delta q\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.625em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.0359em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"ma\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal mtight\",\"children\":\"x\"}]]}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":\"=\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.8778em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"2Δ\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}]]}]]}]]}],\" (\",[\"$\",\"span\",\"span-4\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"Δ\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"q\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\Delta q\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.8778em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"Δ\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}]]}]}]]}],\" being the \",[\"$\",\"$L43\",\"code-5\",{\"code\":\"QUANTITY_TICK\",\"inline\":true,\"language\":\"text\"}],\"). Order \",[\"$\",\"$L43\",\"code-6\",{\"code\":\"40416\",\"inline\":true,\"language\":\"text\"}],\" gets partialy filled and the slot (in stack) gets updated to \",[\"$\",\"$L43\",\"code-7\",{\"code\":\"(8, 40416)\",\"inline\":true,\"language\":\"text\"}],\". Since we have not set the \",[\"$\",\"$L43\",\"code-8\",{\"code\":\"isBudgetConstrainedBuyingLimitReached\",\"inline\":true,\"language\":\"text\"}],\" and the other conditions are satisfied (there is a remaining budget and we have not hit the limit price, ...), querying over the orders continues. At this point we have \",[\"$\",\"span\",\"span-5\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"c\"}],[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"c\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"u\"}],[\"$\",\"mi\",\"mi-2\",{\"children\":\"r\"}],[\"$\",\"mi\",\"mi-3\",{\"children\":\"r\"}]]}]]}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"=\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"31498\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"c_{curr} = 31498\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.5806em\",\"verticalAlign\":\"-0.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"c\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"c\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal mtight\",\"children\":\"u\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.02778em\"},\"children\":\"rr\"}]]}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":\"=\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"31498\"}]]}]]}]]}],\" and thus \",[\"$\",\"span\",\"span-6\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"c\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"r\"}]]}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"=\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"2\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"c_r = 2\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.5806em\",\"verticalAlign\":\"-0.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"c\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.02778em\"},\"children\":\"r\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":\"=\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"2\"}]]}]]}]]}],\" this time \",[\"$\",\"span\",\"span-7\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"q\"}],[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"m\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"a\"}],[\"$\",\"mi\",\"mi-2\",{\"children\":\"x\"}]]}]]}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"q_{max}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.625em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.0359em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"ma\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal mtight\",\"children\":\"x\"}]]}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]}]]}],\" ends up being \",[\"$\",\"span\",\"span-8\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mn\",\"mn-0\",{\"children\":\"0\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"0\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"0\"}]]}]}]]}],\" and this \",[\"$\",\"$L43\",\"code-9\",{\"code\":\"isBudgetConstrainedBuyingLimitReached\",\"inline\":true,\"language\":\"text\"}],\" gets set. The value of \",[\"$\",\"$L43\",\"code-10\",{\"code\":\"segment\",\"inline\":true,\"language\":\"text\"}],\" ends up being:\"]}],\"\\n\",[\"$\",\"$L45\",\"pre-3\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"(10, 40419) (10, 40418) (10, 40417) segment\\n\"}],\"position\":{\"start\":{\"line\":73,\"column\":1,\"offset\":5089},\"end\":{\"line\":75,\"column\":4,\"offset\":5140}}}],\"position\":{\"start\":{\"line\":73,\"column\":1,\"offset\":5089},\"end\":{\"line\":75,\"column\":4,\"offset\":5140}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"(10, 40419) (10, 40418) (10, 40417) segment\",\"inline\":false,\"language\":\"text\"}]}],[\"$\",\"$L46\",null,{\"content\":\"(10, 40419) (10, 40418) (10, 40417) segment\\n\"}]]}],\"\\n\",[\"$\",\"$L2f\",\"p-6\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"The storage update in \",\"position\":{\"start\":{\"line\":77,\"column\":1,\"offset\":5142},\"end\":{\"line\":77,\"column\":23,\"offset\":5164}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_updateSegmentsAndTree\",\"position\":{\"start\":{\"line\":77,\"column\":23,\"offset\":5164},\"end\":{\"line\":77,\"column\":47,\"offset\":5188}}}],\"position\":{\"start\":{\"line\":77,\"column\":23,\"offset\":5164},\"end\":{\"line\":77,\"column\":47,\"offset\":5188}}},{\"type\":\"text\",\"value\":\" performs cleaning on the above segment and since \",\"position\":{\"start\":{\"line\":77,\"column\":47,\"offset\":5188},\"end\":{\"line\":77,\"column\":97,\"offset\":5238}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"numOrdersFullyConsumed\",\"position\":{\"start\":{\"line\":77,\"column\":97,\"offset\":5238},\"end\":{\"line\":77,\"column\":121,\"offset\":5262}}}],\"position\":{\"start\":{\"line\":77,\"column\":97,\"offset\":5238},\"end\":{\"line\":77,\"column\":121,\"offset\":5262}}},{\"type\":\"text\",\"value\":\" did not account for the partial order and the skipped order the \",\"position\":{\"start\":{\"line\":77,\"column\":121,\"offset\":5262},\"end\":{\"line\":77,\"column\":186,\"offset\":5327}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"tombstone\",\"position\":{\"start\":{\"line\":77,\"column\":186,\"offset\":5327},\"end\":{\"line\":77,\"column\":197,\"offset\":5338}}}],\"position\":{\"start\":{\"line\":77,\"column\":186,\"offset\":5327},\"end\":{\"line\":77,\"column\":197,\"offset\":5338}}},{\"type\":\"text\",\"value\":\" also lags behind and we end up with the following segment structure:\",\"position\":{\"start\":{\"line\":77,\"column\":197,\"offset\":5338},\"end\":{\"line\":77,\"column\":266,\"offset\":5407}}}],\"position\":{\"start\":{\"line\":77,\"column\":1,\"offset\":5142},\"end\":{\"line\":77,\"column\":266,\"offset\":5407}}},\"children\":[\"The storage update in \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"_updateSegmentsAndTree\",\"inline\":true,\"language\":\"text\"}],\" performs cleaning on the above segment and since \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"numOrdersFullyConsumed\",\"inline\":true,\"language\":\"text\"}],\" did not account for the partial order and the skipped order the \",[\"$\",\"$L43\",\"code-2\",{\"code\":\"tombstone\",\"inline\":true,\"language\":\"text\"}],\" also lags behind and we end up with the following segment structure:\"]}],\"\\n\",[\"$\",\"$L45\",\"pre-4\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"(10, 40416) (10, 40415) (10, 40414) \u003c-- tombstone offset\\n(10, 40419) ( 0,     0) ( 0,     0)\\n\"}],\"position\":{\"start\":{\"line\":79,\"column\":1,\"offset\":5409},\"end\":{\"line\":82,\"column\":4,\"offset\":5509}}}],\"position\":{\"start\":{\"line\":79,\"column\":1,\"offset\":5409},\"end\":{\"line\":82,\"column\":4,\"offset\":5509}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"(10, 40416) (10, 40415) (10, 40414) \u003c-- tombstone offset\\n(10, 40419) ( 0,     0) ( 0,     0)\",\"inline\":false,\"language\":\"text\"}]}],[\"$\",\"$L46\",null,{\"content\":\"(10, 40416) (10, 40415) (10, 40414) \u003c-- tombstone offset\\n(10, 40419) ( 0,     0) ( 0,     0)\\n\"}]]}],\"\\n\",[\"$\",\"$L2f\",\"p-7\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Note that instead of clearning out the orders \",\"position\":{\"start\":{\"line\":84,\"column\":1,\"offset\":5511},\"end\":{\"line\":84,\"column\":47,\"offset\":5557}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"40415\",\"position\":{\"start\":{\"line\":84,\"column\":47,\"offset\":5557},\"end\":{\"line\":84,\"column\":54,\"offset\":5564}}}],\"position\":{\"start\":{\"line\":84,\"column\":47,\"offset\":5557},\"end\":{\"line\":84,\"column\":54,\"offset\":5564}}},{\"type\":\"text\",\"value\":\" and \",\"position\":{\"start\":{\"line\":84,\"column\":54,\"offset\":5564},\"end\":{\"line\":84,\"column\":59,\"offset\":5569}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"40414\",\"position\":{\"start\":{\"line\":84,\"column\":59,\"offset\":5569},\"end\":{\"line\":84,\"column\":66,\"offset\":5576}}}],\"position\":{\"start\":{\"line\":84,\"column\":59,\"offset\":5569},\"end\":{\"line\":84,\"column\":66,\"offset\":5576}}},{\"type\":\"text\",\"value\":\" which were fully matched the orders \",\"position\":{\"start\":{\"line\":84,\"column\":66,\"offset\":5576},\"end\":{\"line\":84,\"column\":103,\"offset\":5613}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"40418\",\"position\":{\"start\":{\"line\":84,\"column\":103,\"offset\":5613},\"end\":{\"line\":84,\"column\":110,\"offset\":5620}}}],\"position\":{\"start\":{\"line\":84,\"column\":103,\"offset\":5613},\"end\":{\"line\":84,\"column\":110,\"offset\":5620}}},{\"type\":\"text\",\"value\":\" and \",\"position\":{\"start\":{\"line\":84,\"column\":110,\"offset\":5620},\"end\":{\"line\":84,\"column\":115,\"offset\":5625}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"40417\",\"position\":{\"start\":{\"line\":84,\"column\":115,\"offset\":5625},\"end\":{\"line\":84,\"column\":122,\"offset\":5632}}}],\"position\":{\"start\":{\"line\":84,\"column\":115,\"offset\":5625},\"end\":{\"line\":84,\"column\":122,\"offset\":5632}}},{\"type\":\"text\",\"value\":\" get cleared out and the order \",\"position\":{\"start\":{\"line\":84,\"column\":122,\"offset\":5632},\"end\":{\"line\":84,\"column\":153,\"offset\":5663}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"40416\",\"position\":{\"start\":{\"line\":84,\"column\":153,\"offset\":5663},\"end\":{\"line\":84,\"column\":160,\"offset\":5670}}}],\"position\":{\"start\":{\"line\":84,\"column\":153,\"offset\":5663},\"end\":{\"line\":84,\"column\":160,\"offset\":5670}}},{\"type\":\"text\",\"value\":\" does not even get updated although it was partially matched.\",\"position\":{\"start\":{\"line\":84,\"column\":160,\"offset\":5670},\"end\":{\"line\":84,\"column\":221,\"offset\":5731}}}],\"position\":{\"start\":{\"line\":84,\"column\":1,\"offset\":5511},\"end\":{\"line\":84,\"column\":221,\"offset\":5731}}},\"children\":[\"Note that instead of clearning out the orders \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"40415\",\"inline\":true,\"language\":\"text\"}],\" and \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"40414\",\"inline\":true,\"language\":\"text\"}],\" which were fully matched the orders \",[\"$\",\"$L43\",\"code-2\",{\"code\":\"40418\",\"inline\":true,\"language\":\"text\"}],\" and \",[\"$\",\"$L43\",\"code-3\",{\"code\":\"40417\",\"inline\":true,\"language\":\"text\"}],\" get cleared out and the order \",[\"$\",\"$L43\",\"code-4\",{\"code\":\"40416\",\"inline\":true,\"language\":\"text\"}],\" does not even get updated although it was partially matched.\"]}],\"\\n\",[\"$\",\"$L37\",\"h2-1\",{\"as\":\"h2\",\"id\":\"poc\",\"mb\":\"5\",\"size\":\"xl\",\"node\":{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"PoC\",\"position\":{\"start\":{\"line\":86,\"column\":4,\"offset\":5737},\"end\":{\"line\":86,\"column\":7,\"offset\":5740}}}],\"position\":{\"start\":{\"line\":86,\"column\":1,\"offset\":5734},\"end\":{\"line\":86,\"column\":7,\"offset\":5740}}},\"children\":\"PoC\"}],\"\\n\",[\"$\",\"$L2f\",\"p-8\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Apply the following patch which will be needed in the test cases:\",\"position\":{\"start\":{\"line\":88,\"column\":1,\"offset\":5742},\"end\":{\"line\":88,\"column\":66,\"offset\":5807}}}],\"position\":{\"start\":{\"line\":88,\"column\":1,\"offset\":5742},\"end\":{\"line\":88,\"column\":66,\"offset\":5807}}},\"children\":\"Apply the following patch which will be needed in the test cases:\"}],\"\\n\",[\"$\",\"$L45\",\"pre-5\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-diff\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"diff --git a/test/sonicOrderBook/utils.ts b/test/sonicOrderBook/utils.ts\\nindex be0608f..845dea0 100644\\n--- a/test/sonicOrderBook/utils.ts\\n+++ b/test/sonicOrderBook/utils.ts\\n@@ -59,6 +59,7 @@ export async function deployContractsFixture() {\\n \\n   return {\\n     orderBook,\\n+    sonicOrderBookLibrary,\\n     sonicAirdropNFT,\\n     wS,\\n     quoteToken,\\n\"}],\"position\":{\"start\":{\"line\":90,\"column\":1,\"offset\":5809},\"end\":{\"line\":103,\"column\":4,\"offset\":6166}}}],\"position\":{\"start\":{\"line\":90,\"column\":1,\"offset\":5809},\"end\":{\"line\":103,\"column\":4,\"offset\":6166}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"diff --git a/test/sonicOrderBook/utils.ts b/test/sonicOrderBook/utils.ts\\nindex be0608f..845dea0 100644\\n--- a/test/sonicOrderBook/utils.ts\\n+++ b/test/sonicOrderBook/utils.ts\\n@@ -59,6 +59,7 @@ export async function deployContractsFixture() {\\n \\n   return {\\n     orderBook,\\n+    sonicOrderBookLibrary,\\n     sonicAirdropNFT,\\n     wS,\\n     quoteToken,\",\"inline\":false,\"language\":\"diff\"}]}],[\"$\",\"$L46\",null,{\"content\":\"diff --git a/test/sonicOrderBook/utils.ts b/test/sonicOrderBook/utils.ts\\nindex be0608f..845dea0 100644\\n--- a/test/sonicOrderBook/utils.ts\\n+++ b/test/sonicOrderBook/utils.ts\\n@@ -59,6 +59,7 @@ export async function deployContractsFixture() {\\n \\n   return {\\n     orderBook,\\n+    sonicOrderBookLibrary,\\n     sonicAirdropNFT,\\n     wS,\\n     quoteToken,\\n\"}]]}],\"\\n\",[\"$\",\"$L2f\",\"p-9\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Then create the file \",\"position\":{\"start\":{\"line\":105,\"column\":1,\"offset\":6168},\"end\":{\"line\":105,\"column\":22,\"offset\":6189}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"test/sonicOrderBook/isBudgetConstrainedBuyingLimitReached.bug.ts\",\"position\":{\"start\":{\"line\":105,\"column\":22,\"offset\":6189},\"end\":{\"line\":105,\"column\":88,\"offset\":6255}}}],\"position\":{\"start\":{\"line\":105,\"column\":22,\"offset\":6189},\"end\":{\"line\":105,\"column\":88,\"offset\":6255}}},{\"type\":\"text\",\"value\":\" with the following content:\",\"position\":{\"start\":{\"line\":105,\"column\":88,\"offset\":6255},\"end\":{\"line\":105,\"column\":116,\"offset\":6283}}}],\"position\":{\"start\":{\"line\":105,\"column\":1,\"offset\":6168},\"end\":{\"line\":105,\"column\":116,\"offset\":6283}}},\"children\":[\"Then create the file \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"test/sonicOrderBook/isBudgetConstrainedBuyingLimitReached.bug.ts\",\"inline\":true,\"language\":\"text\"}],\" with the following content:\"]}],\"\\n\",[\"$\",\"$L45\",\"pre-6\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-ts\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"$4a\"}],\"position\":{\"start\":{\"line\":107,\"column\":1,\"offset\":6285},\"end\":{\"line\":390,\"column\":4,\"offset\":16470}}}],\"position\":{\"start\":{\"line\":107,\"column\":1,\"offset\":6285},\"end\":{\"line\":390,\"column\":4,\"offset\":16470}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"$4b\",\"inline\":false,\"language\":\"ts\"}]}],[\"$\",\"$L46\",null,{\"content\":\"$4c\"}]]}],\"\\n\",[\"$\",\"$L2f\",\"p-10\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"then run:\",\"position\":{\"start\":{\"line\":392,\"column\":1,\"offset\":16472},\"end\":{\"line\":392,\"column\":10,\"offset\":16481}}}],\"position\":{\"start\":{\"line\":392,\"column\":1,\"offset\":16472},\"end\":{\"line\":392,\"column\":10,\"offset\":16481}}},\"children\":\"then run:\"}],\"\\n\",[\"$\",\"$L45\",\"pre-7\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-bash\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"yarn test -- test/sonicOrderBook/isBudgetConstrainedBuyingLimitReached.bug.ts\\n\"}],\"position\":{\"start\":{\"line\":394,\"column\":1,\"offset\":16483},\"end\":{\"line\":396,\"column\":4,\"offset\":16572}}}],\"position\":{\"start\":{\"line\":394,\"column\":1,\"offset\":16483},\"end\":{\"line\":396,\"column\":4,\"offset\":16572}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"yarn test -- test/sonicOrderBook/isBudgetConstrainedBuyingLimitReached.bug.ts\",\"inline\":false,\"language\":\"bash\"}]}],[\"$\",\"$L46\",null,{\"content\":\"yarn test -- test/sonicOrderBook/isBudgetConstrainedBuyingLimitReached.bug.ts\\n\"}]]}],\"\\n\",[\"$\",\"$L2f\",\"p-11\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"The tests should fail without the fix applied and pass with the fixes applied.\",\"position\":{\"start\":{\"line\":398,\"column\":1,\"offset\":16574},\"end\":{\"line\":398,\"column\":79,\"offset\":16652}}}],\"position\":{\"start\":{\"line\":398,\"column\":1,\"offset\":16574},\"end\":{\"line\":398,\"column\":79,\"offset\":16652}}},\"children\":\"The tests should fail without the fix applied and pass with the fixes applied.\"}],\"\\n\",[\"$\",\"$L2f\",\"p-12\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"logs:\",\"position\":{\"start\":{\"line\":400,\"column\":1,\"offset\":16654},\"end\":{\"line\":400,\"column\":6,\"offset\":16659}}}],\"position\":{\"start\":{\"line\":400,\"column\":1,\"offset\":16654},\"end\":{\"line\":400,\"column\":6,\"offset\":16659}}},\"children\":\"logs:\"}],\"\\n\",[\"$\",\"$L45\",\"pre-8\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"$4d\"}],\"position\":{\"start\":{\"line\":402,\"column\":1,\"offset\":16661},\"end\":{\"line\":456,\"column\":4,\"offset\":18977}}}],\"position\":{\"start\":{\"line\":402,\"column\":1,\"offset\":16661},\"end\":{\"line\":456,\"column\":4,\"offset\":18977}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"$4e\",\"inline\":false,\"language\":\"text\"}]}],[\"$\",\"$L46\",null,{\"content\":\"$4f\"}]]}],\"\\n\",[\"$\",\"$L37\",\"h2-2\",{\"as\":\"h2\",\"id\":\"recommendation\",\"mb\":\"5\",\"size\":\"xl\",\"node\":{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Recommendation\",\"position\":{\"start\":{\"line\":459,\"column\":4,\"offset\":18983},\"end\":{\"line\":459,\"column\":18,\"offset\":18997}}}],\"position\":{\"start\":{\"line\":459,\"column\":1,\"offset\":18980},\"end\":{\"line\":459,\"column\":18,\"offset\":18997}}},\"children\":\"Recommendation\"}],\"\\n\",[\"$\",\"$L2f\",\"p-13\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Apply the following patch to stop querying more orders as soon as one cannot afford a full order in the budget-constrained market buy order:\",\"position\":{\"start\":{\"line\":461,\"column\":1,\"offset\":18999},\"end\":{\"line\":461,\"column\":141,\"offset\":19139}}}],\"position\":{\"start\":{\"line\":461,\"column\":1,\"offset\":18999},\"end\":{\"line\":461,\"column\":141,\"offset\":19139}}},\"children\":\"Apply the following patch to stop querying more orders as soon as one cannot afford a full order in the budget-constrained market buy order:\"}],\"\\n\",[\"$\",\"$L45\",\"pre-9\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-diff\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"$50\"}],\"position\":{\"start\":{\"line\":463,\"column\":1,\"offset\":19141},\"end\":{\"line\":484,\"column\":4,\"offset\":20199}}}],\"position\":{\"start\":{\"line\":463,\"column\":1,\"offset\":19141},\"end\":{\"line\":484,\"column\":4,\"offset\":20199}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"$51\",\"inline\":false,\"language\":\"diff\"}]}],[\"$\",\"$L46\",null,{\"content\":\"$52\"}]]}]]]}]}],false]}]}]]}]]}],[\"$\",\"$L2d\",\"high\",{\"alignItems\":\"stretch\",\"as\":\"section\",\"gap\":4,\"children\":[[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":4,\"children\":[[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.high\",\"borderRadius\":\"full\",\"boxSize\":4}],[\"$\",\"$L37\",null,{\"_before\":{\"content\":\"counter(report-severities) \\\".\\\"\"},\"alignItems\":\"center\",\"as\":\"h3\",\"display\":\"flex\",\"flexWrap\":\"wrap\",\"fontSize\":{\"base\":\"2xl\",\"md\":\"3xl\"},\"fontWeight\":\"semibold\",\"gap\":2,\"sx\":{\"counterIncrement\":\"report-severities\"},\"children\":[\"High Risk\",[\"$\",\"$L2f\",null,{\"as\":\"span\",\"color\":\"gray.500\",\"children\":[1,\" \",\"finding\"]}]]}]]}],[\"$\",\"$L3b\",null,{\"m\":0,\"spacing\":8,\"styleType\":\"none\",\"sx\":{\"counterReset\":\"report-severity-findings\"},\"children\":[[\"$\",\"$L3c\",\"63cd6b54-d4f6-4f43-9bab-cf01d9913ee8\",{\"children\":[\"$\",\"$L2d\",\"63cd6b54-d4f6-4f43-9bab-cf01d9913ee8\",{\"alignItems\":\"flex-start\",\"as\":\"section\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"borderRadius\":\"md\",\"gap\":6,\"p\":8,\"children\":[[\"$\",\"$L37\",null,{\"_before\":{\"content\":\"counter(report-severities) \\\".\\\" counter(report-severity-findings) \\\" \\\"\"},\"as\":\"h4\",\"color\":\"gray.950\",\"fontSize\":{\"base\":\"2xl\",\"md\":\"3xl\"},\"fontWeight\":\"semibold\",\"sx\":{\"counterIncrement\":\"report-severity-findings\"},\"wordBreak\":\"break-word\",\"children\":[\"$\",\"$L3d\",null,{\"text\":\"Invariants of Price Segments (version 2)\"}]}],[\"$\",\"$L2d\",null,{\"alignItems\":\"stretch\",\"as\":\"dl\",\"gap\":2,\"sx\":{\"w\":\"full\",\"containerType\":\"inline-size\"},\"children\":[[\"$\",\"$L2e\",\"State\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"State\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":2,\"children\":[[\"$\",\"$L3e\",null,{\"alignItems\":\"center\",\"bgColor\":\"status.bg.fixed\",\"border\":\"1px solid\",\"borderColor\":\"status.bg.fixed\",\"color\":\"status.fixed\",\"display\":\"inline-flex\",\"gap\":1.5,\"lineHeight\":\"1rem\",\"minWidth\":\"fit-content\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"role\":\"$undefined\",\"size\":\"sm\",\"children\":[[\"$\",\"$L3f\",null,{\"boxSize\":3.5,\"strokeWidth\":\"2px\",\"children\":[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-wrench\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"cbrjhi\",{\"d\":\"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z\"}],\"$undefined\"]}]}],[\"$\",\"$L40\",null,{\"color\":\"inherit\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":\"Fixed\"}]]}],[[\"$\",\"$L3e\",\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\",{\"_hover\":{\"bg\":\"gray.100\"},\"as\":\"a\",\"bg\":\"white\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"borderRadius\":\"full\",\"color\":\"gray.950\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\",\"maxW\":\"10rem\",\"size\":\"sm\",\"target\":\"_blank\",\"children\":[\"$\",\"$L2f\",null,{\"isTruncated\":true,\"children\":\"PR #106\"}]}]]]}]}]]}],[\"$\",\"$L2e\",\"Severity\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Severity\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":2,\"children\":[[\"$\",\"$L3e\",null,{\"ref\":\"$undefined\",\"alignItems\":\"center\",\"bgColor\":\"transparent\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"display\":\"flex\",\"gap\":\"0.375rem\",\"lineHeight\":\"1rem\",\"size\":\"sm\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"fontWeight\":\"600\",\"children\":[[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.high\",\"borderRadius\":\"full\",\"boxSize\":\"0.5rem\"}],[\"$\",\"$L40\",null,{\"color\":\"gray.950\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":[[\"Severity\",\": \"],\"High\"]}]]}],[[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"children\":\"≈\"}],[\"$\",\"$L3e\",null,{\"ref\":\"$undefined\",\"alignItems\":\"center\",\"bgColor\":\"transparent\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"display\":\"flex\",\"gap\":\"0.375rem\",\"lineHeight\":\"1rem\",\"size\":\"sm\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"fontWeight\":\"600\",\"children\":[[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.low\",\"borderRadius\":\"full\",\"boxSize\":\"0.5rem\"}],[\"$\",\"$L40\",null,{\"color\":\"gray.950\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":[[\"Likelihood\",\": \"],\"Low\"]}]]}],[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"children\":\"×\"}],[\"$\",\"$L3e\",null,{\"ref\":\"$undefined\",\"alignItems\":\"center\",\"bgColor\":\"transparent\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"display\":\"flex\",\"gap\":\"0.375rem\",\"lineHeight\":\"1rem\",\"size\":\"sm\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"fontWeight\":\"600\",\"children\":[[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.high\",\"borderRadius\":\"full\",\"boxSize\":\"0.5rem\"}],[\"$\",\"$L40\",null,{\"color\":\"gray.950\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":[[\"Impact\",\": \"],\"High\"]}]]}]]]}]}]]}],[\"$\",\"$L2e\",\"Submitted by\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Submitted by\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L33\",null,{\"alignItems\":\"center\",\"as\":\"$34\",\"display\":\"flex\",\"gap\":2,\"href\":\"/u/Saw-mon-and-Natalie\",\"prefetch\":false,\"children\":[[\"$\",\"$L35\",null,{\"height\":\"20px\",\"src\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/8039eb9a-b849-4701-675d-fd94168a3300/public\",\"width\":\"20px\"}],[\"$\",\"$L2f\",null,{\"fontSize\":\"xs\",\"children\":[\" \",\"Saw-mon and Natalie\"]}]]}]}]]}]]}],[\"$\",\"$L36\",null,{}],[\"$\",\"$L41\",null,{\"children\":[\"$\",\"$L20\",null,{\"alignSelf\":\"stretch\",\"bg\":\"transparent\",\"className\":\"markdown-body\",\"flex\":\"1\",\"flexDirection\":\"column\",\"fontFamily\":\"body\",\"fontSize\":\"sm\",\"position\":\"relative\",\"sx\":{\"\u0026 code[class*=\\\"language-\\\"],  \u0026 pre[class*=\\\"language-\\\"]\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 code[class*=\\\"language-\\\"],  \u0026 pre[class*=\\\"language-\\\"]\",\"\u0026 :not(pre)\u003ecode[class*=\\\"language-\\\"]\":{\"whiteSpace\":\"normal\",\"borderRadius\":\"0.2em\",\"padding\":\"0.1em\"},\"\u0026 pre[class*=\\\"language-\\\"]\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 pre[class*=\\\"language-\\\"]\",\"\u0026 [class*=\\\"language-\\\"] .namespace\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 [class*=\\\"language-\\\"] .namespace\",\"\u0026 :where(img, svg, video, canvas, audio, iframe, embed, object)\":{\"display\":\"initial\"},\"\u0026 h1\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 h1\",\"\u0026 h2\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 h2\",\"\u0026 .token.tag,\u0026 .token.selector,\u0026 .token.keyword,\u0026 .token.operator,\u0026 .token.atrule\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.tag,\u0026 .token.selector,\u0026 .token.keyword,\u0026 .token.operator,\u0026 .token.atrule\",\"\u0026 .token.comment,\u0026 .token.prolog,\u0026 .token.doctype,\u0026 .token.cdata\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.comment,\u0026 .token.prolog,\u0026 .token.doctype,\u0026 .token.cdata\",\"\u0026 .token.namespace\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.namespace\",\"\u0026 .token.string,\u0026 .token.attr-value,\u0026 .token.attribute,\u0026 .token.pseudo-class,\u0026 .token.pseudo-element\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.string,\u0026 .token.attr-value,\u0026 .token.attribute,\u0026 .token.pseudo-class,\u0026 .token.pseudo-element\",\"\u0026 .token.number,\u0026 .token.boolean,\u0026 .token.builtin,\u0026 .token.entity,\u0026 .token.url,\u0026 .token.symbol,\u0026 .token.variable,\u0026 .token.constant,\u0026 .token.property,\u0026 .token.regex,\u0026 .token.attr-name,\u0026 .token.unit,\u0026 .token.hexcode\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.number,\u0026 .token.boolean,\u0026 .token.builtin,\u0026 .token.entity,\u0026 .token.url,\u0026 .token.symbol,\u0026 .token.variable,\u0026 .token.constant,\u0026 .token.property,\u0026 .token.regex,\u0026 .token.attr-name,\u0026 .token.unit,\u0026 .token.hexcode\",\"\u0026 .token.punctuation,\u0026 .token.char,\u0026 .token.class\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.punctuation,\u0026 .token.char,\u0026 .token.class\",\"\u0026 .token.function,\u0026 .token.class-name,\u0026 .token.function-variable,\u0026 .token.id\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.function,\u0026 .token.class-name,\u0026 .token.function-variable,\u0026 .token.id\",\"\u0026 .token.important,\u0026 .token.bold\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.important,\u0026 .token.bold\",\"\u0026 .token.italic\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.italic\",\"\u0026 .token.deleted\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.deleted\",\"\u0026 .token.inserted\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.inserted\"},\"wordBreak\":\"break-word\",\"children\":[[\"$\",\"$L42\",null,{\"frontmatter\":{}}],[[\"$\",\"$L37\",\"h2-0\",{\"as\":\"h2\",\"id\":\"description\",\"mb\":\"5\",\"size\":\"xl\",\"node\":{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Description\",\"position\":{\"start\":{\"line\":1,\"column\":4,\"offset\":3},\"end\":{\"line\":1,\"column\":15,\"offset\":14}}}],\"position\":{\"start\":{\"line\":1,\"column\":1,\"offset\":0},\"end\":{\"line\":1,\"column\":15,\"offset\":14}}},\"children\":\"Description\"}],\"\\n\",[\"$\",\"span\",\"span-0\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mtable\",\"mtable-0\",{\"rowspacing\":\"0.25em\",\"columnalign\":\"right left right left\",\"columnspacing\":\"0em 1em 0em\",\"children\":[[\"$\",\"mtr\",\"mtr-0\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{}]}]}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mspace\",\"mspace-0\",{\"width\":\"2em\"}],[\"$\",\"mspace\",\"mspace-1\",{\"width\":\"1em\"}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\" \"}],[\"$\",\"mrow\",\"mrow-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"⋮\"}],[\"$\",\"mpadded\",\"mpadded-0\",{\"height\":\"0em\",\"voffset\":\"0em\",\"children\":[\"$\",\"mspace\",\"mspace-0\",{\"mathbackground\":\"black\",\"width\":\"0em\",\"height\":\"1.5em\"}]}]]}],[\"$\",\"mspace\",\"mspace-2\",{\"width\":\"2em\"}],[\"$\",\"mspace\",\"mspace-3\",{\"width\":\"1em\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{}]}]}]]}],[\"$\",\"mtr\",\"mtr-1\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}]}]}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-3\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-4\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-5\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-6\",{\"mathvariant\":\"normal\",\"children\":\"□\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mo\",\"mo-0\",{\"lspace\":\"0em\",\"rspace\":\"0em\",\"children\":\"←\"}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\" \"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"−\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"1\"}]]}]}]}]]}],[\"$\",\"mtr\",\"mtr-2\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}]}]}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-3\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-4\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-5\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-6\",{\"mathvariant\":\"normal\",\"children\":\"□\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mo\",\"mo-0\",{\"lspace\":\"0em\",\"rspace\":\"0em\",\"children\":\"←\"}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\" \"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}]]}]}]}]]}],[\"$\",\"mtr\",\"mtr-3\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}]}]}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-3\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-4\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-5\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-6\",{\"mathvariant\":\"normal\",\"children\":\"■\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{}]}]}]]}],[\"$\",\"mtr\",\"mtr-4\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{}]}]}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mspace\",\"mspace-0\",{\"width\":\"2em\"}],[\"$\",\"mspace\",\"mspace-1\",{\"width\":\"1em\"}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\" \"}],[\"$\",\"mrow\",\"mrow-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"⋮\"}],[\"$\",\"mpadded\",\"mpadded-0\",{\"height\":\"0em\",\"voffset\":\"0em\",\"children\":[\"$\",\"mspace\",\"mspace-0\",{\"mathbackground\":\"black\",\"width\":\"0em\",\"height\":\"1.5em\"}]}]]}],[\"$\",\"mspace\",\"mspace-2\",{\"width\":\"2em\"}],[\"$\",\"mspace\",\"mspace-3\",{\"width\":\"1em\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{}]}]}]]}],[\"$\",\"mtr\",\"mtr-5\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}]}]}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mstyle\",\"mstyle-0\",{\"mathcolor\":\"red\",\"children\":[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}]}],[\"$\",\"mi\",\"mi-3\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-4\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-5\",{\"mathvariant\":\"normal\",\"children\":\"■\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{}]}]}]]}],[\"$\",\"mtr\",\"mtr-6\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{}]}]}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mspace\",\"mspace-0\",{\"width\":\"2em\"}],[\"$\",\"mspace\",\"mspace-1\",{\"width\":\"1em\"}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\" \"}],[\"$\",\"mrow\",\"mrow-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"⋮\"}],[\"$\",\"mpadded\",\"mpadded-0\",{\"height\":\"0em\",\"voffset\":\"0em\",\"children\":[\"$\",\"mspace\",\"mspace-0\",{\"mathbackground\":\"black\",\"width\":\"0em\",\"height\":\"1.5em\"}]}]]}],[\"$\",\"mspace\",\"mspace-2\",{\"width\":\"2em\"}],[\"$\",\"mspace\",\"mspace-3\",{\"width\":\"1em\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{}]}]}]]}],[\"$\",\"mtr\",\"mtr-7\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}]}]}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mstyle\",\"mstyle-0\",{\"mathcolor\":\"green\",\"children\":[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}]}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-3\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-4\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-5\",{\"mathvariant\":\"normal\",\"children\":\"■\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mo\",\"mo-0\",{\"lspace\":\"0em\",\"rspace\":\"0em\",\"children\":\"←\"}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\" seg len\"}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"−\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"1\"}]]}]}]}]]}],[\"$\",\"mtr\",\"mtr-8\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}]}]}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-3\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-4\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-5\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-6\",{\"mathvariant\":\"normal\",\"children\":\"□\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mo\",\"mo-0\",{\"lspace\":\"0em\",\"rspace\":\"0em\",\"children\":\"←\"}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\" seg len\"}]]}]}]}]]}],[\"$\",\"mtr\",\"mtr-9\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{}]}]}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mspace\",\"mspace-0\",{\"width\":\"2em\"}],[\"$\",\"mspace\",\"mspace-1\",{\"width\":\"1em\"}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\" \"}],[\"$\",\"mrow\",\"mrow-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"⋮\"}],[\"$\",\"mpadded\",\"mpadded-0\",{\"height\":\"0em\",\"voffset\":\"0em\",\"children\":[\"$\",\"mspace\",\"mspace-0\",{\"mathbackground\":\"black\",\"width\":\"0em\",\"height\":\"1.5em\"}]}]]}],[\"$\",\"mspace\",\"mspace-2\",{\"width\":\"2em\"}],[\"$\",\"mspace\",\"mspace-3\",{\"width\":\"1em\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{}]}]}]]}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"$53\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"17.64em\",\"verticalAlign\":\"-8.57em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mtable\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"col-align-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"9.07em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-11.07em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\"}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-9.57em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"□\"}]}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-8.07em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"■\"}]}]]}],[\"$\",\"span\",\"span-3\",{\"style\":{\"top\":\"-6.57em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"■\"}]}]]}],[\"$\",\"span\",\"span-4\",{\"style\":{\"top\":\"-4.41em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\"}]]}],[\"$\",\"span\",\"span-5\",{\"style\":{\"top\":\"-2.91em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"■\"}]}]]}],[\"$\",\"span\",\"span-6\",{\"style\":{\"top\":\"-0.75em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\"}]]}],[\"$\",\"span\",\"span-7\",{\"style\":{\"top\":\"0.75em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"□\"}]}]]}],[\"$\",\"span\",\"span-8\",{\"style\":{\"top\":\"2.25em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"□\"}]}]]}],[\"$\",\"span\",\"span-9\",{\"style\":{\"top\":\"4.41em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\"}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"8.57em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"col-align-l\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"9.07em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-11.2575em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.6875em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"2em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"1em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"children\":\" \"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"⋮\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord rule\",\"style\":{\"borderRightWidth\":\"0em\",\"borderTopWidth\":\"1.5em\",\"bottom\":\"0em\"}}]]}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"2em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"1em\"}}]]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-9.7575em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.6875em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord amsrm\",\"children\":\"□□□□□□\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"mord amsrm\",\"children\":\"□\"}]]}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-8.2575em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.6875em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord amsrm\",\"children\":\"■■■■■□\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"mord amsrm\",\"children\":\"□\"}]]}]]}],[\"$\",\"span\",\"span-3\",{\"style\":{\"top\":\"-6.7575em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.6875em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord amsrm\",\"children\":\"■■■■■■\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"mord amsrm\",\"children\":\"■\"}]]}]]}],[\"$\",\"span\",\"span-4\",{\"style\":{\"top\":\"-4.5975em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.6875em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"2em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"1em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"children\":\" \"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"⋮\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord rule\",\"style\":{\"borderRightWidth\":\"0em\",\"borderTopWidth\":\"1.5em\",\"bottom\":\"0em\"}}]]}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"2em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"1em\"}}]]}]]}],[\"$\",\"span\",\"span-5\",{\"style\":{\"top\":\"-3.0975em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.6875em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord amsrm\",\"children\":\"■■■\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"style\":{\"color\":\"red\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"style\":{\"color\":\"red\"},\"children\":\"■\"}]}]}],[\"$\",\"span\",\"span-6\",{\"className\":\"mord amsrm\",\"children\":\"■■\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-9\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-10\",{\"className\":\"mord amsrm\",\"children\":\"■\"}]]}]]}],[\"$\",\"span\",\"span-6\",{\"style\":{\"top\":\"-0.9375em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.6875em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"2em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"1em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"children\":\" \"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"⋮\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord rule\",\"style\":{\"borderRightWidth\":\"0em\",\"borderTopWidth\":\"1.5em\",\"bottom\":\"0em\"}}]]}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"2em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"1em\"}}]]}]]}],[\"$\",\"span\",\"span-7\",{\"style\":{\"top\":\"0.5625em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.6875em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord amsrm\",\"children\":\"□\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"style\":{\"color\":\"green\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"style\":{\"color\":\"green\"},\"children\":\"■\"}]}]}],[\"$\",\"span\",\"span-6\",{\"className\":\"mord amsrm\",\"children\":\"■■■■\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-9\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-10\",{\"className\":\"mord amsrm\",\"children\":\"■\"}]]}]]}],[\"$\",\"span\",\"span-8\",{\"style\":{\"top\":\"2.0625em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.6875em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord amsrm\",\"children\":\"□□□□□□\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"mord amsrm\",\"children\":\"□\"}]]}]]}],[\"$\",\"span\",\"span-9\",{\"style\":{\"top\":\"4.2225em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.6875em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"2em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"1em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"children\":\" \"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"⋮\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord rule\",\"style\":{\"borderRightWidth\":\"0em\",\"borderTopWidth\":\"1.5em\",\"bottom\":\"0em\"}}]]}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"2em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"1em\"}}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"8.57em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"arraycolsep\",\"style\":{\"width\":\"1em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"col-align-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"9.07em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-11.07em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\"}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-9.57em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mrel\",\"children\":\"←\"}]}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-8.07em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mrel\",\"children\":\"←\"}]}]]}],[\"$\",\"span\",\"span-3\",{\"style\":{\"top\":\"-6.57em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\"}]]}],[\"$\",\"span\",\"span-4\",{\"style\":{\"top\":\"-4.41em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\"}]]}],[\"$\",\"span\",\"span-5\",{\"style\":{\"top\":\"-2.91em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\"}]]}],[\"$\",\"span\",\"span-6\",{\"style\":{\"top\":\"-0.75em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\"}]]}],[\"$\",\"span\",\"span-7\",{\"style\":{\"top\":\"0.75em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mrel\",\"children\":\"←\"}]}]]}],[\"$\",\"span\",\"span-8\",{\"style\":{\"top\":\"2.25em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mrel\",\"children\":\"←\"}]}]]}],[\"$\",\"span\",\"span-9\",{\"style\":{\"top\":\"4.41em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\"}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"8.57em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-4\",{\"className\":\"col-align-l\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"6.91em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-9.57em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"children\":\" \"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mbin\",\"children\":\"−\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mord\",\"children\":\"1\"}]]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-8.07em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"children\":\" \"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-6.57em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}]}]]}],[\"$\",\"span\",\"span-3\",{\"style\":{\"top\":\"-4.41em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}]}]]}],[\"$\",\"span\",\"span-4\",{\"style\":{\"top\":\"-2.91em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}]}]]}],[\"$\",\"span\",\"span-5\",{\"style\":{\"top\":\"-0.75em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}]}]]}],[\"$\",\"span\",\"span-6\",{\"style\":{\"top\":\"0.75em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"children\":\" \"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord text\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"seg len\"}]}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mbin\",\"children\":\"−\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mord\",\"children\":\"1\"}]]}]]}],[\"$\",\"span\",\"span-7\",{\"style\":{\"top\":\"2.25em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"children\":\" \"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord text\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"seg len\"}]}]]}]]}],[\"$\",\"span\",\"span-8\",{\"style\":{\"top\":\"4.41em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"8.57em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]}]]}]}]]}]}],\"\\n\",[\"$\",\"$L54\",\"ul-0\",{\"node\":{\"type\":\"element\",\"tagName\":\"ul\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\square\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.675em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]}]}]}]},{\"type\":\"text\",\"value\":\" represents empty orders with \",\"position\":{\"start\":{\"line\":18,\"column\":12,\"offset\":1088},\"end\":{\"line\":18,\"column\":42,\"offset\":1118}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6444em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]}]}]},{\"type\":\"text\",\"value\":\" order id and normalized quantity.\",\"position\":{\"start\":{\"line\":18,\"column\":45,\"offset\":1121},\"end\":{\"line\":18,\"column\":79,\"offset\":1155}}}],\"position\":{\"start\":{\"line\":18,\"column\":1,\"offset\":1077},\"end\":{\"line\":18,\"column\":80,\"offset\":1156}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\blacksquare\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.675em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]}]}]}]},{\"type\":\"text\",\"value\":\" represent orders where both the order id and the normalized quantity are non-zero.\",\"position\":{\"start\":{\"line\":19,\"column\":17,\"offset\":1173},\"end\":{\"line\":19,\"column\":100,\"offset\":1256}}}],\"position\":{\"start\":{\"line\":19,\"column\":1,\"offset\":1157},\"end\":{\"line\":19,\"column\":100,\"offset\":1256}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":18,\"column\":1,\"offset\":1077},\"end\":{\"line\":19,\"column\":100,\"offset\":1256}}},\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\square\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.675em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord amsrm\",\"children\":\"□\"}]]}]}]]}],\" represents empty orders with \",[\"$\",\"span\",\"span-1\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mn\",\"mn-0\",{\"children\":\"0\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"0\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"0\"}]]}]}]]}],\" order id and normalized quantity.\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\blacksquare\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.675em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord amsrm\",\"children\":\"■\"}]]}]}]]}],\" represent orders where both the order id and the normalized quantity are non-zero.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"$L37\",\"h3-0\",{\"as\":\"h3\",\"id\":\"invariants\",\"mb\":\"4\",\"size\":\"lg\",\"node\":{\"type\":\"element\",\"tagName\":\"h3\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Invariants\",\"position\":{\"start\":{\"line\":21,\"column\":5,\"offset\":1262},\"end\":{\"line\":21,\"column\":15,\"offset\":1272}}}],\"position\":{\"start\":{\"line\":21,\"column\":1,\"offset\":1258},\"end\":{\"line\":21,\"column\":15,\"offset\":1272}}},\"children\":\"Invariants\"}],\"\\n\",[\"$\",\"$L3b\",\"ol-0\",{\"node\":{\"type\":\"element\",\"tagName\":\"ol\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"the following configuration in the active area of the segments when all orders are drawn on a line should also not be allowed \",\"position\":{\"start\":{\"line\":23,\"column\":4,\"offset\":1277},\"end\":{\"line\":23,\"column\":130,\"offset\":1403}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\cdots \\\\blacksquare\\\\square\\\\blacksquare \\\\cdots\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.675em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"minner\"]},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.1667em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"■□■\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.1667em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"minner\"]},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]}]}]}]},{\"type\":\"text\",\"value\":\", it should be proved that this cannot happen. We call these empty slots \",\"position\":{\"start\":{\"line\":23,\"column\":177,\"offset\":1450},\"end\":{\"line\":23,\"column\":250,\"offset\":1523}}},{\"type\":\"element\",\"tagName\":\"strong\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"holes\",\"position\":{\"start\":{\"line\":23,\"column\":252,\"offset\":1525},\"end\":{\"line\":23,\"column\":257,\"offset\":1530}}}],\"position\":{\"start\":{\"line\":23,\"column\":250,\"offset\":1523},\"end\":{\"line\":23,\"column\":259,\"offset\":1532}}},{\"type\":\"text\",\"value\":\".\",\"position\":{\"start\":{\"line\":23,\"column\":259,\"offset\":1532},\"end\":{\"line\":23,\"column\":260,\"offset\":1533}}}],\"position\":{\"start\":{\"line\":23,\"column\":4,\"offset\":1277},\"end\":{\"line\":23,\"column\":260,\"offset\":1533}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":23,\"column\":1,\"offset\":1274},\"end\":{\"line\":23,\"column\":260,\"offset\":1533}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"If an order has an order id \",\"position\":{\"start\":{\"line\":24,\"column\":4,\"offset\":1537},\"end\":{\"line\":24,\"column\":32,\"offset\":1565}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6444em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]}]}]},{\"type\":\"text\",\"value\":\" then its normalized quantity should also be \",\"position\":{\"start\":{\"line\":24,\"column\":35,\"offset\":1568},\"end\":{\"line\":24,\"column\":80,\"offset\":1613}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6444em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]}]}]},{\"type\":\"text\",\"value\":\" (◧ is not allowed) and vice versa (◨ is not allowed)\",\"position\":{\"start\":{\"line\":24,\"column\":83,\"offset\":1616},\"end\":{\"line\":24,\"column\":136,\"offset\":1669}}}],\"position\":{\"start\":{\"line\":24,\"column\":4,\"offset\":1537},\"end\":{\"line\":24,\"column\":136,\"offset\":1669}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":24,\"column\":1,\"offset\":1534},\"end\":{\"line\":24,\"column\":136,\"offset\":1669}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Orders are inserted/added at the end.\",\"position\":{\"start\":{\"line\":25,\"column\":4,\"offset\":1673},\"end\":{\"line\":25,\"column\":41,\"offset\":1710}}}],\"position\":{\"start\":{\"line\":25,\"column\":4,\"offset\":1673},\"end\":{\"line\":25,\"column\":41,\"offset\":1710}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":25,\"column\":1,\"offset\":1670},\"end\":{\"line\":25,\"column\":41,\"offset\":1710}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Orders are matched based on their order id. The smaller order ids get matched first (FIFO).\",\"position\":{\"start\":{\"line\":26,\"column\":4,\"offset\":1714},\"end\":{\"line\":26,\"column\":95,\"offset\":1805}}}],\"position\":{\"start\":{\"line\":26,\"column\":4,\"offset\":1714},\"end\":{\"line\":26,\"column\":95,\"offset\":1805}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":26,\"column\":1,\"offset\":1711},\"end\":{\"line\":26,\"column\":95,\"offset\":1805}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"The last segment of an existing price node \",\"position\":{\"start\":{\"line\":27,\"column\":4,\"offset\":1809},\"end\":{\"line\":27,\"column\":47,\"offset\":1852}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"p\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"∈\"}]},{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"T\"}]},{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{\"separator\":\"true\"},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"s\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"p \\\\in T_{tid, s}\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.7335em;vertical-align:-0.1944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"p\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"∈\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.9694em;vertical-align:-0.2861em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.13889em;\"},\"children\":[{\"type\":\"text\",\"value\":\"T\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.3361em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mpunct\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"s\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2861em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\" has at least one non-empty order:\",\"position\":{\"start\":{\"line\":27,\"column\":65,\"offset\":1870},\"end\":{\"line\":27,\"column\":99,\"offset\":1904}}}],\"position\":{\"start\":{\"line\":27,\"column\":4,\"offset\":1809},\"end\":{\"line\":27,\"column\":99,\"offset\":1904}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-display\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"mtext\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\cdots \\\\blacksquare \\\\cdots \\\\leftarrow \\\\text{seg len} - 1\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.675em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"minner\"]},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.1667em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.1667em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"minner\"]},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.8889em;vertical-align:-0.1944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mbin\"]},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6444em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]}]}]}]}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"For the case of \",\"position\":{\"start\":{\"line\":33,\"column\":5,\"offset\":1986},\"end\":{\"line\":33,\"column\":21,\"offset\":2002}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"3\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"3\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6444em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"3\"}]}]}]}]},{\"type\":\"text\",\"value\":\" slots per segment the following cases are possible:\",\"position\":{\"start\":{\"line\":33,\"column\":24,\"offset\":2005},\"end\":{\"line\":33,\"column\":76,\"offset\":2057}}}],\"position\":{\"start\":{\"line\":33,\"column\":5,\"offset\":1986},\"end\":{\"line\":33,\"column\":76,\"offset\":2057}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-display\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtable\",\"properties\":{\"rowspacing\":\"0.25em\",\"columnalign\":\"right left\",\"columnspacing\":\"0em\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mtr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"mtext\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mml-eqn-num\"]},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"mtr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"mtext\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mml-eqn-num\"]},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"mtr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"mtext\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mml-eqn-num\"]},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"mtr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"mtext\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mml-eqn-num\"]},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"mtr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"mtext\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mml-eqn-num\"]},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"mtr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"mtext\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mml-eqn-num\"]},\"children\":[]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\begin{align}\\n    \\\\blacksquare \\\\blacksquare   \\\\blacksquare    \u0026 \\\\leftarrow \\\\text{seg len} - 1         \\\\\\\\\\n    \\\\square      \\\\blacksquare   \\\\blacksquare    \u0026 \\\\leftarrow \\\\text{seg len} - 1         \\\\\\\\\\n    \\\\square      \\\\square        \\\\blacksquare    \u0026 \\\\leftarrow \\\\text{seg len} - 1         \\\\\\\\\\n    \\\\blacksquare \\\\blacksquare   \\\\square         \u0026 \\\\leftarrow \\\\text{seg len} - 1 = o_t   \\\\\\\\\\n    \\\\square      \\\\blacksquare   \\\\square         \u0026 \\\\leftarrow \\\\text{seg len} - 1 = o_t   \\\\\\\\\\n    \\\\blacksquare \\\\square        \\\\square         \u0026 \\\\leftarrow \\\\text{seg len} - 1 = o_t   \\\\\\\\\\n    \\n\\\\end{align}\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:9em;vertical-align:-4.25em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mtable\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"col-align-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:4.75em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-6.91em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"■■■\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-5.41em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"□■■\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-3.91em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"□□■\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.41em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"■■□\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-0.91em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"□■□\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:0.59em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"■□□\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:4.25em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"col-align-l\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:4.75em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-6.91em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mbin\"]},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-5.41em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mbin\"]},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-3.91em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mbin\"]},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.41em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mbin\"]},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2806em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-0.91em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mbin\"]},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2806em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:0.59em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mbin\"]},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2806em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:4.25em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"tag\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:4.75em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-6.75em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.84em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"eqn-num\"]},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-5.25em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.84em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"eqn-num\"]},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-3.75em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.84em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"eqn-num\"]},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.25em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.84em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"eqn-num\"]},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-0.75em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.84em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"eqn-num\"]},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:0.75em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.84em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"eqn-num\"]},\"children\":[]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:4.25em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":27,\"column\":1,\"offset\":1806},\"end\":{\"line\":45,\"column\":7,\"offset\":2685}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"The segment pointed to by \",\"position\":{\"start\":{\"line\":48,\"column\":4,\"offset\":2691},\"end\":{\"line\":48,\"column\":30,\"offset\":2717}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"o_t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.5806em;vertical-align:-0.15em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2806em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\" (\",\"position\":{\"start\":{\"line\":48,\"column\":35,\"offset\":2722},\"end\":{\"line\":48,\"column\":37,\"offset\":2724}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"tombstoneOffset\",\"position\":{\"start\":{\"line\":48,\"column\":37,\"offset\":2724},\"end\":{\"line\":48,\"column\":54,\"offset\":2741}}}],\"position\":{\"start\":{\"line\":48,\"column\":37,\"offset\":2724},\"end\":{\"line\":48,\"column\":54,\"offset\":2741}}},{\"type\":\"text\",\"value\":\") if the price node exists \",\"position\":{\"start\":{\"line\":48,\"column\":54,\"offset\":2741},\"end\":{\"line\":48,\"column\":81,\"offset\":2768}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"p\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"∈\"}]},{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"T\"}]},{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{\"separator\":\"true\"},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"s\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"p \\\\in T_{tid, s}\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.7335em;vertical-align:-0.1944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"p\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"∈\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.9694em;vertical-align:-0.2861em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.13889em;\"},\"children\":[{\"type\":\"text\",\"value\":\"T\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.3361em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mpunct\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"s\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2861em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\" in the tree, then this segment would have at least one non-empty order:\",\"position\":{\"start\":{\"line\":48,\"column\":99,\"offset\":2786},\"end\":{\"line\":48,\"column\":171,\"offset\":2858}}}],\"position\":{\"start\":{\"line\":48,\"column\":4,\"offset\":2691},\"end\":{\"line\":48,\"column\":171,\"offset\":2858}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-display\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\cdots \\\\blacksquare \\\\cdots \\\\leftarrow o_t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.675em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"minner\"]},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.1667em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.1667em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"minner\"]},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.5806em;vertical-align:-0.15em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2806em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"For the case of \",\"position\":{\"start\":{\"line\":54,\"column\":5,\"offset\":2925},\"end\":{\"line\":54,\"column\":21,\"offset\":2941}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"3\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"3\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6444em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"3\"}]}]}]}]},{\"type\":\"text\",\"value\":\" slots per segment the following cases are possible:\",\"position\":{\"start\":{\"line\":54,\"column\":24,\"offset\":2944},\"end\":{\"line\":54,\"column\":76,\"offset\":2996}}}],\"position\":{\"start\":{\"line\":54,\"column\":5,\"offset\":2925},\"end\":{\"line\":54,\"column\":76,\"offset\":2996}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-display\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtable\",\"properties\":{\"rowspacing\":\"0.25em\",\"columnalign\":\"right left\",\"columnspacing\":\"0em\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mtr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mml-eqn-num\"]},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"mtr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mml-eqn-num\"]},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"mtr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mml-eqn-num\"]},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"mtr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"mtext\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mml-eqn-num\"]},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"mtr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"mtext\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mml-eqn-num\"]},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"mtr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"mtext\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mtr-glue\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{\"className\":[\"mml-eqn-num\"]},\"children\":[]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\" \\\\begin{align}\\n     \\\\blacksquare \\\\blacksquare   \\\\blacksquare    \u0026 \\\\leftarrow o_t                        \\\\tag{1}\\\\\\\\\\n     \\\\blacksquare \\\\blacksquare   \\\\square         \u0026 \\\\leftarrow o_t                        \\\\tag{2}\\\\\\\\\\n     \\\\blacksquare \\\\square        \\\\square         \u0026 \\\\leftarrow o_t                        \\\\tag{3}\\\\\\\\\\n     \\\\square      \\\\blacksquare   \\\\blacksquare    \u0026 \\\\leftarrow o_t = \\\\text{seg len} - 1   \\\\tag{4}\\\\\\\\\\n     \\\\square      \\\\blacksquare   \\\\square         \u0026 \\\\leftarrow o_t = \\\\text{seg len} - 1   \\\\tag{5}\\\\\\\\\\n     \\\\square      \\\\square        \\\\blacksquare    \u0026 \\\\leftarrow o_t = \\\\text{seg len} - 1   \\\\tag{6}\\\\\\\\\\n \\\\end{align}\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:9em;vertical-align:-4.25em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mtable\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"col-align-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:4.75em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-6.91em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"■■■\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-5.41em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"■■□\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-3.91em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"■□□\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.41em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"□■■\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-0.91em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"□■□\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:0.59em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"□□■\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:4.25em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"col-align-l\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:4.75em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-6.91em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2806em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-5.41em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2806em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-3.91em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2806em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.41em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2806em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mbin\"]},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-0.91em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2806em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mbin\"]},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:0.59em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2806em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mbin\"]},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:4.25em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"tag\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:4.75em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-6.91em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-5.41em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-3.91em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"3\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.41em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"4\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-0.91em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"5\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:0.59em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"6\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:4.25em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":48,\"column\":1,\"offset\":2688},\"end\":{\"line\":65,\"column\":7,\"offset\":3656}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"For price nodes that do not belong to the tree \",\"position\":{\"start\":{\"line\":67,\"column\":4,\"offset\":3661},\"end\":{\"line\":67,\"column\":51,\"offset\":3708}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"p\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"∉\"}]},{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"T\"}]},{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{\"separator\":\"true\"},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"s\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"p\\\\notin T_{tid,s}\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:1em;vertical-align:-0.25em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"p\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"∈\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"vbox\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"thinbox\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"llap\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:1em;vertical-align:-0.25em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"inner\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"/\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.0556em;\"},\"children\":[]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"fix\"]},\"children\":[]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.9694em;vertical-align:-0.2861em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.13889em;\"},\"children\":[{\"type\":\"text\",\"value\":\"T\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.3361em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mpunct\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"s\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2861em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\", we should have the following configuration:\",\"position\":{\"start\":{\"line\":67,\"column\":70,\"offset\":3727},\"end\":{\"line\":67,\"column\":115,\"offset\":3772}}}],\"position\":{\"start\":{\"line\":67,\"column\":4,\"offset\":3661},\"end\":{\"line\":67,\"column\":115,\"offset\":3772}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-display\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtable\",\"properties\":{\"rowspacing\":\"0.25em\",\"columnalign\":\"right\",\"columnspacing\":\"\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mtr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"mtext\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\begin{align*}\\n    \\\\square \\\\cdots \\\\square \\\\leftarrow o_t = \\\\text{seg len}\\n\\\\end{align*}\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:1.5em;vertical-align:-0.5em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mtable\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"col-align-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:1em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-3.16em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.1667em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"minner\"]},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.1667em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2806em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.5em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"ie. all the orders belonging to the segment pointed to by \",\"position\":{\"start\":{\"line\":74,\"column\":5,\"offset\":3891},\"end\":{\"line\":74,\"column\":63,\"offset\":3949}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"o_t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.5806em;vertical-align:-0.15em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2806em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\", they should all be empty orders.\",\"position\":{\"start\":{\"line\":74,\"column\":68,\"offset\":3954},\"end\":{\"line\":74,\"column\":102,\"offset\":3988}}}],\"position\":{\"start\":{\"line\":74,\"column\":5,\"offset\":3891},\"end\":{\"line\":74,\"column\":102,\"offset\":3988}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":67,\"column\":1,\"offset\":3658},\"end\":{\"line\":74,\"column\":102,\"offset\":3988}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Either \",\"position\":{\"start\":{\"line\":76,\"column\":5,\"offset\":3994},\"end\":{\"line\":76,\"column\":12,\"offset\":4001}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"o_t = 0\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.5806em;vertical-align:-0.15em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2806em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6444em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]}]}]},{\"type\":\"text\",\"value\":\" or if \",\"position\":{\"start\":{\"line\":76,\"column\":21,\"offset\":4010},\"end\":{\"line\":76,\"column\":28,\"offset\":4017}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\u003e\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"o_t \u003e 0\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6891em;vertical-align:-0.15em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2806em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"\u003e\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6444em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]}]}]},{\"type\":\"text\",\"value\":\" all the slots before \",\"position\":{\"start\":{\"line\":76,\"column\":37,\"offset\":4026},\"end\":{\"line\":76,\"column\":59,\"offset\":4048}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"o_t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.5806em;vertical-align:-0.15em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2806em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\" are empty slots:\",\"position\":{\"start\":{\"line\":76,\"column\":64,\"offset\":4053},\"end\":{\"line\":76,\"column\":81,\"offset\":4070}}}],\"position\":{\"start\":{\"line\":76,\"column\":5,\"offset\":3994},\"end\":{\"line\":76,\"column\":81,\"offset\":4070}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-display\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtable\",\"properties\":{\"rowspacing\":\"0.25em\",\"columnalign\":\"right left\",\"columnspacing\":\"0em\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mtr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"⋮\"}]},{\"type\":\"element\",\"tagName\":\"mpadded\",\"properties\":{\"height\":\"0em\",\"voffset\":\"0em\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mspace\",\"properties\":{\"mathbackground\":\"black\",\"width\":\"0em\",\"height\":\"1.5em\"},\"children\":[]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\begin{align*}\\n    \\\\vdots \u0026 \\\\\\\\\\n    \\\\square \\\\square \\\\square    \u0026 \\\\\\\\\\n    \\\\square \\\\square \\\\square    \u0026 \\\\leftarrow o_t - 1\\n\\\\end{align*}\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:5.16em;vertical-align:-2.33em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mtable\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"col-align-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:2.83em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-5.0175em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3.6875em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"⋮\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"rule\"],\"style\":\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\"},\"children\":[]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-3.5175em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3.6875em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"□□□\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.0175em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3.6875em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"□□□\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:2.33em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"col-align-l\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:2.83em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-4.83em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3.5em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-3.33em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3.5em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-1.83em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3.5em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2806em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mbin\"]},\"children\":[{\"type\":\"text\",\"value\":\"−\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2222em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:2.33em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":76,\"column\":1,\"offset\":3990},\"end\":{\"line\":84,\"column\":7,\"offset\":4237}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Orders belonging to segments pointed to by \",\"position\":{\"start\":{\"line\":86,\"column\":5,\"offset\":4243},\"end\":{\"line\":86,\"column\":48,\"offset\":4286}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"k\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"≥\"}]},{\"type\":\"element\",\"tagName\":\"mtext\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"k \\\\geq \\\\text{seg len}\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.8304em;vertical-align:-0.136em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.03148em;\"},\"children\":[{\"type\":\"text\",\"value\":\"k\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"≥\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.8889em;vertical-align:-0.1944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]}]}]}]}]},{\"type\":\"text\",\"value\":\" should all be empty orders (⚠️ unless there is a storage collision if \",\"position\":{\"start\":{\"line\":86,\"column\":71,\"offset\":4309},\"end\":{\"line\":86,\"column\":142,\"offset\":4380}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"k\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"k\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.03148em;\"},\"children\":[{\"type\":\"text\",\"value\":\"k\"}]}]}]}]},{\"type\":\"text\",\"value\":\" is a  really big number). This is a more general invariant compared to Inv 8.:\",\"position\":{\"start\":{\"line\":86,\"column\":145,\"offset\":4383},\"end\":{\"line\":86,\"column\":224,\"offset\":4462}}}],\"position\":{\"start\":{\"line\":86,\"column\":5,\"offset\":4243},\"end\":{\"line\":86,\"column\":224,\"offset\":4462}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-display\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtable\",\"properties\":{\"rowspacing\":\"0.25em\",\"columnalign\":\"right\",\"columnspacing\":\"\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mtr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mtd\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mstyle\",\"properties\":{\"scriptlevel\":\"0\",\"displaystyle\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"k\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"≥\"}]},{\"type\":\"element\",\"tagName\":\"mtext\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\begin{align*}\\n    \\\\square \\\\cdots \\\\square \\\\leftarrow k \\\\geq \\\\text{seg len}\\n\\\\end{align*}\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:1.5em;vertical-align:-0.5em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mtable\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"col-align-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:1em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-3.16em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.1667em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"minner\"]},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.1667em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.03148em;\"},\"children\":[{\"type\":\"text\",\"value\":\"k\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"≥\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"seg len\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.5em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":86,\"column\":1,\"offset\":4239},\"end\":{\"line\":92,\"column\":7,\"offset\":4577}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"The active orders in the price segments are arranged in a monotonically increasing fashion based on their order ids (this is a more stricted version of Inv 1.)\",\"position\":{\"start\":{\"line\":93,\"column\":5,\"offset\":4582},\"end\":{\"line\":93,\"column\":164,\"offset\":4741}}}],\"position\":{\"start\":{\"line\":93,\"column\":5,\"offset\":4582},\"end\":{\"line\":93,\"column\":164,\"offset\":4741}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":93,\"column\":1,\"offset\":4578},\"end\":{\"line\":93,\"column\":164,\"offset\":4741}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":23,\"column\":1,\"offset\":1274},\"end\":{\"line\":93,\"column\":164,\"offset\":4741}}},\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:8:props:node:children:1:children:1\",\"children\":[\"the following configuration in the active area of the segments when all orders are drawn on a line should also not be allowed \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"⋯\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\cdots \\\\blacksquare\\\\square\\\\blacksquare \\\\cdots\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.675em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mord amsrm\",\"children\":\"■□■\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-5\",{\"className\":\"minner\",\"children\":\"⋯\"}]]}]}]]}],\", it should be proved that this cannot happen. We call these empty slots \",[\"$\",\"$L2f\",\"strong-0\",{\"as\":\"strong\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:8:props:node:children:1:children:1:children:3\",\"children\":\"holes\"}],\".\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:8:props:node:children:3:children:1\",\"children\":[\"If an order has an order id \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mn\",\"mn-0\",{\"children\":\"0\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"0\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"0\"}]]}]}]]}],\" then its normalized quantity should also be \",[\"$\",\"span\",\"span-1\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mn\",\"mn-0\",{\"children\":\"0\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"0\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"0\"}]]}]}]]}],\" (◧ is not allowed) and vice versa (◨ is not allowed)\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":[\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:8:props:node:children:5:children:1\",\"children\":\"Orders are inserted/added at the end.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-3\",{\"children\":[\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:8:props:node:children:7:children:1\",\"children\":\"Orders are matched based on their order id. The smaller order ids get matched first (FIFO).\"}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-4\",{\"children\":[\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:8:props:node:children:9:children:1\",\"children\":[\"The last segment of an existing price node \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"p\"}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"∈\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"T\"}],[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"t\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"i\"}],[\"$\",\"mi\",\"mi-2\",{\"children\":\"d\"}],[\"$\",\"mo\",\"mo-0\",{\"separator\":\"true\",\"children\":\",\"}],[\"$\",\"mi\",\"mi-3\",{\"children\":\"s\"}]]}]]}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"p \\\\in T_{tid, s}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.7335em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"children\":\"p\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":\"∈\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.9694em\",\"verticalAlign\":\"-0.2861em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.13889em\"},\"children\":\"T\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3361em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.1389em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal mtight\",\"children\":\"i\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mpunct mtight\",\"children\":\",\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord mathnormal mtight\",\"children\":\"s\"}]]}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2861em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}]]}],\" has at least one non-empty order:\"]}],\"\\n\",[\"$\",\"span\",\"span-0\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"⋯\"}],[\"$\",\"mo\",\"mo-2\",{\"children\":\"←\"}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\"seg len\"}],[\"$\",\"mo\",\"mo-3\",{\"children\":\"−\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"1\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\cdots \\\\blacksquare \\\\cdots \\\\leftarrow \\\\text{seg len} - 1\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.675em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mord amsrm\",\"children\":\"■\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-5\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-6\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-7\",{\"className\":\"mrel\",\"children\":\"←\"}],[\"$\",\"span\",\"span-8\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.8889em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord text\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"seg len\"}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mbin\",\"children\":\"−\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"1\"}]]}]]}]]}]}],\"\\n\",[\"$\",\"$L2f\",\"p-1\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:8:props:node:children:9:children:5\",\"children\":[\"For the case of \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mn\",\"mn-0\",{\"children\":\"3\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"3\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"3\"}]]}]}]]}],\" slots per segment the following cases are possible:\"]}],\"\\n\",[\"$\",\"span\",\"span-1\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mtable\",\"mtable-0\",{\"rowspacing\":\"0.25em\",\"columnalign\":\"right left\",\"columnspacing\":\"0em\",\"children\":[[\"$\",\"mtr\",\"mtr-0\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"■\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"←\"}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\"seg len\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"−\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"1\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-4\",{\"className\":\"mml-eqn-num\"}]]}],[\"$\",\"mtr\",\"mtr-1\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"■\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"←\"}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\"seg len\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"−\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"1\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-4\",{\"className\":\"mml-eqn-num\"}]]}],[\"$\",\"mtr\",\"mtr-2\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"■\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"←\"}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\"seg len\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"−\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"1\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-4\",{\"className\":\"mml-eqn-num\"}]]}],[\"$\",\"mtr\",\"mtr-3\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"□\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"←\"}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\"seg len\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"−\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"1\"}],[\"$\",\"mo\",\"mo-2\",{\"children\":\"=\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}]]}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-4\",{\"className\":\"mml-eqn-num\"}]]}],[\"$\",\"mtr\",\"mtr-4\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"□\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"←\"}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\"seg len\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"−\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"1\"}],[\"$\",\"mo\",\"mo-2\",{\"children\":\"=\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}]]}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-4\",{\"className\":\"mml-eqn-num\"}]]}],[\"$\",\"mtr\",\"mtr-5\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"□\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"←\"}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\"seg len\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"−\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"1\"}],[\"$\",\"mo\",\"mo-2\",{\"children\":\"=\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}]]}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-4\",{\"className\":\"mml-eqn-num\"}]]}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\begin{align}\\n    \\\\blacksquare \\\\blacksquare   \\\\blacksquare    \u0026 \\\\leftarrow \\\\text{seg len} - 1         \\\\\\\\\\n    \\\\square      \\\\blacksquare   \\\\blacksquare    \u0026 \\\\leftarrow \\\\text{seg len} - 1         \\\\\\\\\\n    \\\\square      \\\\square        \\\\blacksquare    \u0026 \\\\leftarrow \\\\text{seg len} - 1         \\\\\\\\\\n    \\\\blacksquare \\\\blacksquare   \\\\square         \u0026 \\\\leftarrow \\\\text{seg len} - 1 = o_t   \\\\\\\\\\n    \\\\square      \\\\blacksquare   \\\\square         \u0026 \\\\leftarrow \\\\text{seg len} - 1 = o_t   \\\\\\\\\\n    \\\\blacksquare \\\\square        \\\\square         \u0026 \\\\leftarrow \\\\text{seg len} - 1 = o_t   \\\\\\\\\\n    \\n\\\\end{align}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"9em\",\"verticalAlign\":\"-4.25em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mtable\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"col-align-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"4.75em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-6.91em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"■■■\"}]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-5.41em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"□■■\"}]}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-3.91em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"□□■\"}]}]]}],[\"$\",\"span\",\"span-3\",{\"style\":{\"top\":\"-2.41em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"■■□\"}]}]]}],[\"$\",\"span\",\"span-4\",{\"style\":{\"top\":\"-0.91em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"□■□\"}]}]]}],[\"$\",\"span\",\"span-5\",{\"style\":{\"top\":\"0.59em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"■□□\"}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"4.25em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"col-align-l\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"4.75em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-6.91em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mrel\",\"children\":\"←\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord text\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"seg len\"}]}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mbin\",\"children\":\"−\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"mord\",\"children\":\"1\"}]]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-5.41em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mrel\",\"children\":\"←\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord text\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"seg len\"}]}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mbin\",\"children\":\"−\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"mord\",\"children\":\"1\"}]]}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-3.91em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mrel\",\"children\":\"←\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord text\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"seg len\"}]}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mbin\",\"children\":\"−\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"mord\",\"children\":\"1\"}]]}]]}],[\"$\",\"span\",\"span-3\",{\"style\":{\"top\":\"-2.41em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mrel\",\"children\":\"←\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord text\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"seg len\"}]}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mbin\",\"children\":\"−\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"mord\",\"children\":\"1\"}],[\"$\",\"span\",\"span-9\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-10\",{\"className\":\"mrel\",\"children\":\"=\"}],[\"$\",\"span\",\"span-11\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-12\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}],[\"$\",\"span\",\"span-4\",{\"style\":{\"top\":\"-0.91em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mrel\",\"children\":\"←\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord text\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"seg len\"}]}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mbin\",\"children\":\"−\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"mord\",\"children\":\"1\"}],[\"$\",\"span\",\"span-9\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-10\",{\"className\":\"mrel\",\"children\":\"=\"}],[\"$\",\"span\",\"span-11\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-12\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}],[\"$\",\"span\",\"span-5\",{\"style\":{\"top\":\"0.59em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mrel\",\"children\":\"←\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord text\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"seg len\"}]}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mbin\",\"children\":\"−\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"mord\",\"children\":\"1\"}],[\"$\",\"span\",\"span-9\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-10\",{\"className\":\"mrel\",\"children\":\"=\"}],[\"$\",\"span\",\"span-11\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-12\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"4.25em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"tag\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"4.75em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-6.75em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.84em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"eqn-num\"}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-5.25em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.84em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"eqn-num\"}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-3.75em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.84em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"eqn-num\"}]]}],[\"$\",\"span\",\"span-3\",{\"style\":{\"top\":\"-2.25em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.84em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"eqn-num\"}]]}],[\"$\",\"span\",\"span-4\",{\"style\":{\"top\":\"-0.75em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.84em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"eqn-num\"}]]}],[\"$\",\"span\",\"span-5\",{\"style\":{\"top\":\"0.75em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.84em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"eqn-num\"}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"4.25em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-5\",{\"children\":[\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:8:props:node:children:11:children:1\",\"children\":[\"The segment pointed to by \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"o_t\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.5806em\",\"verticalAlign\":\"-0.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]}]]}],\" (\",[\"$\",\"$L43\",\"code-0\",{\"code\":\"tombstoneOffset\",\"inline\":true,\"language\":\"text\"}],\") if the price node exists \",[\"$\",\"span\",\"span-1\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"p\"}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"∈\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"T\"}],[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"t\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"i\"}],[\"$\",\"mi\",\"mi-2\",{\"children\":\"d\"}],[\"$\",\"mo\",\"mo-0\",{\"separator\":\"true\",\"children\":\",\"}],[\"$\",\"mi\",\"mi-3\",{\"children\":\"s\"}]]}]]}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"p \\\\in T_{tid, s}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.7335em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"children\":\"p\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":\"∈\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.9694em\",\"verticalAlign\":\"-0.2861em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.13889em\"},\"children\":\"T\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3361em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.1389em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal mtight\",\"children\":\"i\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mpunct mtight\",\"children\":\",\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord mathnormal mtight\",\"children\":\"s\"}]]}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2861em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}]]}],\" in the tree, then this segment would have at least one non-empty order:\"]}],\"\\n\",[\"$\",\"span\",\"span-0\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"⋯\"}],[\"$\",\"mo\",\"mo-2\",{\"children\":\"←\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\cdots \\\\blacksquare \\\\cdots \\\\leftarrow o_t\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.675em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mord amsrm\",\"children\":\"■\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-5\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-6\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-7\",{\"className\":\"mrel\",\"children\":\"←\"}],[\"$\",\"span\",\"span-8\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.5806em\",\"verticalAlign\":\"-0.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}]]}]}],\"\\n\",[\"$\",\"$L2f\",\"p-1\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:8:props:node:children:11:children:5\",\"children\":[\"For the case of \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mn\",\"mn-0\",{\"children\":\"3\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"3\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"3\"}]]}]}]]}],\" slots per segment the following cases are possible:\"]}],\"\\n\",[\"$\",\"span\",\"span-1\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mtable\",\"mtable-0\",{\"rowspacing\":\"0.25em\",\"columnalign\":\"right left\",\"columnspacing\":\"0em\",\"children\":[[\"$\",\"mtr\",\"mtr-0\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"■\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"←\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}]]}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-4\",{\"className\":\"mml-eqn-num\"}]]}],[\"$\",\"mtr\",\"mtr-1\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"□\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"←\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}]]}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-4\",{\"className\":\"mml-eqn-num\"}]]}],[\"$\",\"mtr\",\"mtr-2\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"□\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"←\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}]]}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-4\",{\"className\":\"mml-eqn-num\"}]]}],[\"$\",\"mtr\",\"mtr-3\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"■\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"←\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"=\"}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\"seg len\"}],[\"$\",\"mo\",\"mo-2\",{\"children\":\"−\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"1\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-4\",{\"className\":\"mml-eqn-num\"}]]}],[\"$\",\"mtr\",\"mtr-4\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"□\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"←\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"=\"}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\"seg len\"}],[\"$\",\"mo\",\"mo-2\",{\"children\":\"−\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"1\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-4\",{\"className\":\"mml-eqn-num\"}]]}],[\"$\",\"mtr\",\"mtr-5\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"■\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-2\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"←\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"=\"}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\"seg len\"}],[\"$\",\"mo\",\"mo-2\",{\"children\":\"−\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"1\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-3\",{\"className\":\"mtr-glue\"}],[\"$\",\"mtd\",\"mtd-4\",{\"className\":\"mml-eqn-num\"}]]}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\" \\\\begin{align}\\n     \\\\blacksquare \\\\blacksquare   \\\\blacksquare    \u0026 \\\\leftarrow o_t                        \\\\tag{1}\\\\\\\\\\n     \\\\blacksquare \\\\blacksquare   \\\\square         \u0026 \\\\leftarrow o_t                        \\\\tag{2}\\\\\\\\\\n     \\\\blacksquare \\\\square        \\\\square         \u0026 \\\\leftarrow o_t                        \\\\tag{3}\\\\\\\\\\n     \\\\square      \\\\blacksquare   \\\\blacksquare    \u0026 \\\\leftarrow o_t = \\\\text{seg len} - 1   \\\\tag{4}\\\\\\\\\\n     \\\\square      \\\\blacksquare   \\\\square         \u0026 \\\\leftarrow o_t = \\\\text{seg len} - 1   \\\\tag{5}\\\\\\\\\\n     \\\\square      \\\\square        \\\\blacksquare    \u0026 \\\\leftarrow o_t = \\\\text{seg len} - 1   \\\\tag{6}\\\\\\\\\\n \\\\end{align}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"9em\",\"verticalAlign\":\"-4.25em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mtable\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"col-align-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"4.75em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-6.91em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"■■■\"}]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-5.41em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"■■□\"}]}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-3.91em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"■□□\"}]}]]}],[\"$\",\"span\",\"span-3\",{\"style\":{\"top\":\"-2.41em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"□■■\"}]}]]}],[\"$\",\"span\",\"span-4\",{\"style\":{\"top\":\"-0.91em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"□■□\"}]}]]}],[\"$\",\"span\",\"span-5\",{\"style\":{\"top\":\"0.59em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"□□■\"}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"4.25em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"col-align-l\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"4.75em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-6.91em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mrel\",\"children\":\"←\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-5.41em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mrel\",\"children\":\"←\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-3.91em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mrel\",\"children\":\"←\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}],[\"$\",\"span\",\"span-3\",{\"style\":{\"top\":\"-2.41em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mrel\",\"children\":\"←\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mrel\",\"children\":\"=\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"mord text\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"seg len\"}]}],[\"$\",\"span\",\"span-9\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-10\",{\"className\":\"mbin\",\"children\":\"−\"}],[\"$\",\"span\",\"span-11\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-12\",{\"className\":\"mord\",\"children\":\"1\"}]]}]]}],[\"$\",\"span\",\"span-4\",{\"style\":{\"top\":\"-0.91em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mrel\",\"children\":\"←\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mrel\",\"children\":\"=\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"mord text\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"seg len\"}]}],[\"$\",\"span\",\"span-9\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-10\",{\"className\":\"mbin\",\"children\":\"−\"}],[\"$\",\"span\",\"span-11\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-12\",{\"className\":\"mord\",\"children\":\"1\"}]]}]]}],[\"$\",\"span\",\"span-5\",{\"style\":{\"top\":\"0.59em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mrel\",\"children\":\"←\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mrel\",\"children\":\"=\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"mord text\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"seg len\"}]}],[\"$\",\"span\",\"span-9\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-10\",{\"className\":\"mbin\",\"children\":\"−\"}],[\"$\",\"span\",\"span-11\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-12\",{\"className\":\"mord\",\"children\":\"1\"}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"4.25em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"tag\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"4.75em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-6.91em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord text\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"(\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"1\"}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord\",\"children\":\")\"}]]}]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-5.41em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord text\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"(\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"2\"}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord\",\"children\":\")\"}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-3.91em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord text\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"(\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"3\"}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord\",\"children\":\")\"}]]}]}]]}],[\"$\",\"span\",\"span-3\",{\"style\":{\"top\":\"-2.41em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord text\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"(\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"4\"}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord\",\"children\":\")\"}]]}]}]]}],[\"$\",\"span\",\"span-4\",{\"style\":{\"top\":\"-0.91em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord text\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"(\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"5\"}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord\",\"children\":\")\"}]]}]}]]}],[\"$\",\"span\",\"span-5\",{\"style\":{\"top\":\"0.59em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord text\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"(\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"6\"}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord\",\"children\":\")\"}]]}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"4.25em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-6\",{\"children\":[\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:8:props:node:children:13:children:1\",\"children\":[\"For price nodes that do not belong to the tree \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"p\"}],[\"$\",\"mo\",\"mo-0\",{\"mathvariant\":\"normal\",\"children\":\"∉\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"T\"}],[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"t\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"i\"}],[\"$\",\"mi\",\"mi-2\",{\"children\":\"d\"}],[\"$\",\"mo\",\"mo-0\",{\"separator\":\"true\",\"children\":\",\"}],[\"$\",\"mi\",\"mi-3\",{\"children\":\"s\"}]]}]]}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"p\\\\notin T_{tid,s}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-0.25em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"children\":\"p\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mrel\",\"children\":\"∈\"}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord vbox\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"thinbox\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"llap\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-0.25em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"inner\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"/\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.0556em\"}}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"fix\"}]]}]}]}]]}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.9694em\",\"verticalAlign\":\"-0.2861em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.13889em\"},\"children\":\"T\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3361em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.1389em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal mtight\",\"children\":\"i\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mpunct mtight\",\"children\":\",\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord mathnormal mtight\",\"children\":\"s\"}]]}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2861em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}]]}],\", we should have the following configuration:\"]}],\"\\n\",[\"$\",\"span\",\"span-0\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mtable\",\"mtable-0\",{\"rowspacing\":\"0.25em\",\"columnalign\":\"right\",\"columnspacing\":\"\",\"children\":[\"$\",\"mtr\",\"mtr-0\",{\"children\":[\"$\",\"mtd\",\"mtd-0\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"←\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}],[\"$\",\"mo\",\"mo-2\",{\"children\":\"=\"}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\"seg len\"}]]}]}]}]}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\begin{align*}\\n    \\\\square \\\\cdots \\\\square \\\\leftarrow o_t = \\\\text{seg len}\\n\\\\end{align*}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"1.5em\",\"verticalAlign\":\"-0.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mtable\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"col-align-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-3.16em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"□\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord amsrm\",\"children\":\"□\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mrel\",\"children\":\"←\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-9\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-10\",{\"className\":\"mrel\",\"children\":\"=\"}],[\"$\",\"span\",\"span-11\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-12\",{\"className\":\"mord text\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"seg len\"}]}]]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.5em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]}]}]]}]}]]}]}],\"\\n\",[\"$\",\"$L2f\",\"p-1\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:8:props:node:children:13:children:5\",\"children\":[\"ie. all the orders belonging to the segment pointed to by \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"o_t\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.5806em\",\"verticalAlign\":\"-0.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]}]]}],\", they should all be empty orders.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-7\",{\"children\":[\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:8:props:node:children:15:children:1\",\"children\":[\"Either \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"=\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"0\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"o_t = 0\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.5806em\",\"verticalAlign\":\"-0.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":\"=\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"0\"}]]}]]}]]}],\" or if \",[\"$\",\"span\",\"span-1\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"\u003e\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"0\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"o_t \u003e 0\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6891em\",\"verticalAlign\":\"-0.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":\"\u003e\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"0\"}]]}]]}]]}],\" all the slots before \",[\"$\",\"span\",\"span-2\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"o_t\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.5806em\",\"verticalAlign\":\"-0.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]}]]}],\" are empty slots:\"]}],\"\\n\",[\"$\",\"span\",\"span-0\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mtable\",\"mtable-0\",{\"rowspacing\":\"0.25em\",\"columnalign\":\"right left\",\"columnspacing\":\"0em\",\"children\":[[\"$\",\"mtr\",\"mtr-0\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"⋮\"}],[\"$\",\"mpadded\",\"mpadded-0\",{\"height\":\"0em\",\"voffset\":\"0em\",\"children\":[\"$\",\"mspace\",\"mspace-0\",{\"mathbackground\":\"black\",\"width\":\"0em\",\"height\":\"1.5em\"}]}]]}]}]}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{}]}]}]]}],[\"$\",\"mtr\",\"mtr-1\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"□\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{}]}]}]]}],[\"$\",\"mtr\",\"mtr-2\",{\"children\":[[\"$\",\"mtd\",\"mtd-0\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"□\"}]]}]}]}],[\"$\",\"mtd\",\"mtd-1\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"←\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"−\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"1\"}]]}]}]}]]}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\begin{align*}\\n    \\\\vdots \u0026 \\\\\\\\\\n    \\\\square \\\\square \\\\square    \u0026 \\\\\\\\\\n    \\\\square \\\\square \\\\square    \u0026 \\\\leftarrow o_t - 1\\n\\\\end{align*}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"5.16em\",\"verticalAlign\":\"-2.33em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mtable\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"col-align-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"2.83em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-5.0175em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.6875em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"⋮\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord rule\",\"style\":{\"borderRightWidth\":\"0em\",\"borderTopWidth\":\"1.5em\",\"bottom\":\"0em\"}}]]}]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.5175em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.6875em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"□□□\"}]}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-2.0175em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.6875em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"□□□\"}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"2.33em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"col-align-l\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"2.83em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-4.83em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.33em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}]}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-1.83em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mrel\",\"children\":\"←\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mbin\",\"children\":\"−\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"mord\",\"children\":\"1\"}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"2.33em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]}]]}]}]]}]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-8\",{\"children\":[\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:8:props:node:children:17:children:1\",\"children\":[\"Orders belonging to segments pointed to by \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"k\"}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"≥\"}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\"seg len\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"k \\\\geq \\\\text{seg len}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.8304em\",\"verticalAlign\":\"-0.136em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03148em\"},\"children\":\"k\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":\"≥\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.8889em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord text\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"seg len\"}]}]]}]]}]]}],\" should all be empty orders (⚠️ unless there is a storage collision if \",[\"$\",\"span\",\"span-1\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"children\":\"k\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"k\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03148em\"},\"children\":\"k\"}]]}]}]]}],\" is a  really big number). This is a more general invariant compared to Inv 8.:\"]}],\"\\n\",[\"$\",\"span\",\"span-0\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mtable\",\"mtable-0\",{\"rowspacing\":\"0.25em\",\"columnalign\":\"right\",\"columnspacing\":\"\",\"children\":[\"$\",\"mtr\",\"mtr-0\",{\"children\":[\"$\",\"mtd\",\"mtd-0\",{\"children\":[\"$\",\"mstyle\",\"mstyle-0\",{\"scriptlevel\":\"0\",\"displaystyle\":\"true\",\"children\":[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"←\"}],[\"$\",\"mi\",\"mi-2\",{\"children\":\"k\"}],[\"$\",\"mo\",\"mo-2\",{\"children\":\"≥\"}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\"seg len\"}]]}]}]}]}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\begin{align*}\\n    \\\\square \\\\cdots \\\\square \\\\leftarrow k \\\\geq \\\\text{seg len}\\n\\\\end{align*}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"1.5em\",\"verticalAlign\":\"-0.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mtable\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"col-align-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-3.16em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord amsrm\",\"children\":\"□\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord amsrm\",\"children\":\"□\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mrel\",\"children\":\"←\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03148em\"},\"children\":\"k\"}],[\"$\",\"span\",\"span-9\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-10\",{\"className\":\"mrel\",\"children\":\"≥\"}],[\"$\",\"span\",\"span-11\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-12\",{\"className\":\"mord text\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"seg len\"}]}]]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.5em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]}]}]]}]}]]}]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-9\",{\"children\":[\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:8:props:node:children:19:children:1\",\"children\":\"The active orders in the price segments are arranged in a monotonically increasing fashion based on their order ids (this is a more stricted version of Inv 1.)\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\",[\"$\",\"table\",\"table-0\",{\"children\":[[\"$\",\"thead\",\"thead-0\",{\"children\":[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"th\",\"th-0\",{\"children\":\"method\"}],[\"$\",\"th\",\"th-1\",{\"children\":\"Inv 1.\"}],[\"$\",\"th\",\"th-2\",{\"children\":\"Inv 2.\"}],[\"$\",\"th\",\"th-3\",{\"children\":\"Inv 3.\"}],[\"$\",\"th\",\"th-4\",{\"children\":\"Inv 4.\"}],[\"$\",\"th\",\"th-5\",{\"children\":\"Inv 5.\"}],[\"$\",\"th\",\"th-6\",{\"children\":\"Inv 6.\"}],[\"$\",\"th\",\"th-7\",{\"children\":\"Inv 7.\"}],[\"$\",\"th\",\"th-8\",{\"children\":\"Inv. 8\"}],[\"$\",\"th\",\"th-9\",{\"children\":\"Inv. 9\"}],[\"$\",\"th\",\"th-10\",{\"children\":\"Inv 10.\"}]]}]}],[\"$\",\"tbody\",\"tbody-0\",{\"children\":[[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"children\":\"canceling orders\"}],[\"$\",\"td\",\"td-1\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-2\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-3\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-4\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-5\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-6\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-7\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-8\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-9\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-10\",{\"children\":\"✅\"}]]}],[\"$\",\"tr\",\"tr-1\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"children\":\"placing limit orders\"}],[\"$\",\"td\",\"td-1\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-2\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-3\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-4\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-5\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-6\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-7\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-8\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-9\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-10\",{\"children\":\"✅\"}]]}],[\"$\",\"tr\",\"tr-2\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"children\":\"matching orders\"}],[\"$\",\"td\",\"td-1\",{}],[\"$\",\"td\",\"td-2\",{}],[\"$\",\"td\",\"td-3\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-4\",{}],[\"$\",\"td\",\"td-5\",{}],[\"$\",\"td\",\"td-6\",{\"children\":\"❌\"}],[\"$\",\"td\",\"td-7\",{}],[\"$\",\"td\",\"td-8\",{}],[\"$\",\"td\",\"td-9\",{}],[\"$\",\"td\",\"td-10\",{}]]}]]}]]}],\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"The ✅ above means that if the invariant was satisfied before calling the method, it will be satisfied after the call has been done (in some edge cases it would only mean the invariant is satisfied after the call has been done, but it might not be before the call for example at the very beginning.)\",\"position\":{\"start\":{\"line\":101,\"column\":1,\"offset\":5106},\"end\":{\"line\":101,\"column\":299,\"offset\":5404}}}],\"position\":{\"start\":{\"line\":101,\"column\":1,\"offset\":5106},\"end\":{\"line\":101,\"column\":299,\"offset\":5404}}},\"children\":\"The ✅ above means that if the invariant was satisfied before calling the method, it will be satisfied after the call has been done (in some edge cases it would only mean the invariant is satisfied after the call has been done, but it might not be before the call for example at the very beginning.)\"}],\"\\n\",[\"$\",\"$L54\",\"ul-1\",{\"node\":{\"type\":\"element\",\"tagName\":\"ul\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"strong\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"canceling orders\",\"position\":{\"start\":{\"line\":103,\"column\":5,\"offset\":5410},\"end\":{\"line\":103,\"column\":21,\"offset\":5426}}}],\"position\":{\"start\":{\"line\":103,\"column\":3,\"offset\":5408},\"end\":{\"line\":103,\"column\":23,\"offset\":5428}}},{\"type\":\"text\",\"value\":\": We should have \",\"position\":{\"start\":{\"line\":103,\"column\":23,\"offset\":5428},\"end\":{\"line\":103,\"column\":40,\"offset\":5445}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"p\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"∈\"}]},{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"T\"}]},{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{\"separator\":\"true\"},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"s\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"p \\\\in T_{tid,s}\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.7335em;vertical-align:-0.1944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"p\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"∈\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.9694em;vertical-align:-0.2861em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.13889em;\"},\"children\":[{\"type\":\"text\",\"value\":\"T\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.3361em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mpunct\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"s\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2861em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\" otherwise the call should fail. First the order's position in the price segment should be found using \",\"position\":{\"start\":{\"line\":103,\"column\":57,\"offset\":5462},\"end\":{\"line\":103,\"column\":160,\"offset\":5565}}},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/SonicOrderBook.sol#L1006\"},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_find\",\"position\":{\"start\":{\"line\":103,\"column\":161,\"offset\":5566},\"end\":{\"line\":103,\"column\":168,\"offset\":5573}}}],\"position\":{\"start\":{\"line\":103,\"column\":161,\"offset\":5566},\"end\":{\"line\":103,\"column\":168,\"offset\":5573}}}],\"position\":{\"start\":{\"line\":103,\"column\":160,\"offset\":5565},\"end\":{\"line\":103,\"column\":304,\"offset\":5709}}},{\"type\":\"text\",\"value\":\". The \",\"position\":{\"start\":{\"line\":103,\"column\":304,\"offset\":5709},\"end\":{\"line\":103,\"column\":310,\"offset\":5715}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_find\",\"position\":{\"start\":{\"line\":103,\"column\":310,\"offset\":5715},\"end\":{\"line\":103,\"column\":317,\"offset\":5722}}}],\"position\":{\"start\":{\"line\":103,\"column\":310,\"offset\":5715},\"end\":{\"line\":103,\"column\":317,\"offset\":5722}}},{\"type\":\"text\",\"value\":\" flow relies on the fact that there are no holes (inv 1.) in the price segments and orders are placed in a monotonically increasing fashion (Inv 10.). The invariant checks need to be performed for each branch in \",\"position\":{\"start\":{\"line\":103,\"column\":317,\"offset\":5722},\"end\":{\"line\":103,\"column\":529,\"offset\":5934}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_cancelOrder\",\"position\":{\"start\":{\"line\":103,\"column\":529,\"offset\":5934},\"end\":{\"line\":103,\"column\":543,\"offset\":5948}}}],\"position\":{\"start\":{\"line\":103,\"column\":529,\"offset\":5934},\"end\":{\"line\":103,\"column\":543,\"offset\":5948}}},{\"type\":\"text\",\"value\":\":\",\"position\":{\"start\":{\"line\":103,\"column\":543,\"offset\":5948},\"end\":{\"line\":103,\"column\":544,\"offset\":5949}}}],\"position\":{\"start\":{\"line\":103,\"column\":3,\"offset\":5408},\"end\":{\"line\":103,\"column\":544,\"offset\":5949}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-solidity\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"if (isFinalSegment \u0026\u0026 isOnlyOrderInSegment) {\\n    // branch A\\n} else {\\n    // Branch B: this branch has many sub-branches\\n    for (/* ... */) {\\n        if (nextSlot == 0) {\\n            // this branch should only be hit on the last segment,\\n            // ie, when `currentOrNextSegment == segments.length - 1`\\n            // one can add a require statement. 🟡\\n        }\\n    }\\n\\n    // Branch B1: `for` loop gets skipped (`absoluteSlotIndexToRemove == totalOrders`)\\n    // Branch B2: `for` loop is entered   (`absoluteSlotIndexToRemove  \u003c totalOrders`)\\n}\\n\"}],\"position\":{\"start\":{\"line\":104,\"column\":5,\"offset\":5954},\"end\":{\"line\":120,\"column\":8,\"offset\":6583}}}],\"position\":{\"start\":{\"line\":104,\"column\":5,\"offset\":5954},\"end\":{\"line\":120,\"column\":8,\"offset\":6583}}},{\"type\":\"text\",\"value\":\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\"},{\"type\":\"element\",\"tagName\":\"table\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"thead\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"tr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"method\",\"position\":{\"start\":{\"line\":122,\"column\":7,\"offset\":6591},\"end\":{\"line\":122,\"column\":13,\"offset\":6597}}}],\"position\":{\"start\":{\"line\":122,\"column\":5,\"offset\":6589},\"end\":{\"line\":122,\"column\":14,\"offset\":6598}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv 1.\",\"position\":{\"start\":{\"line\":122,\"column\":16,\"offset\":6600},\"end\":{\"line\":122,\"column\":22,\"offset\":6606}}}],\"position\":{\"start\":{\"line\":122,\"column\":14,\"offset\":6598},\"end\":{\"line\":122,\"column\":23,\"offset\":6607}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv 2.\",\"position\":{\"start\":{\"line\":122,\"column\":25,\"offset\":6609},\"end\":{\"line\":122,\"column\":31,\"offset\":6615}}}],\"position\":{\"start\":{\"line\":122,\"column\":23,\"offset\":6607},\"end\":{\"line\":122,\"column\":32,\"offset\":6616}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv 3.\",\"position\":{\"start\":{\"line\":122,\"column\":34,\"offset\":6618},\"end\":{\"line\":122,\"column\":40,\"offset\":6624}}}],\"position\":{\"start\":{\"line\":122,\"column\":32,\"offset\":6616},\"end\":{\"line\":122,\"column\":41,\"offset\":6625}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv 4.\",\"position\":{\"start\":{\"line\":122,\"column\":43,\"offset\":6627},\"end\":{\"line\":122,\"column\":49,\"offset\":6633}}}],\"position\":{\"start\":{\"line\":122,\"column\":41,\"offset\":6625},\"end\":{\"line\":122,\"column\":50,\"offset\":6634}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv 5.\",\"position\":{\"start\":{\"line\":122,\"column\":52,\"offset\":6636},\"end\":{\"line\":122,\"column\":58,\"offset\":6642}}}],\"position\":{\"start\":{\"line\":122,\"column\":50,\"offset\":6634},\"end\":{\"line\":122,\"column\":59,\"offset\":6643}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv 6.\",\"position\":{\"start\":{\"line\":122,\"column\":61,\"offset\":6645},\"end\":{\"line\":122,\"column\":67,\"offset\":6651}}}],\"position\":{\"start\":{\"line\":122,\"column\":59,\"offset\":6643},\"end\":{\"line\":122,\"column\":68,\"offset\":6652}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv 7.\",\"position\":{\"start\":{\"line\":122,\"column\":70,\"offset\":6654},\"end\":{\"line\":122,\"column\":76,\"offset\":6660}}}],\"position\":{\"start\":{\"line\":122,\"column\":68,\"offset\":6652},\"end\":{\"line\":122,\"column\":77,\"offset\":6661}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv. 8\",\"position\":{\"start\":{\"line\":122,\"column\":79,\"offset\":6663},\"end\":{\"line\":122,\"column\":85,\"offset\":6669}}}],\"position\":{\"start\":{\"line\":122,\"column\":77,\"offset\":6661},\"end\":{\"line\":122,\"column\":86,\"offset\":6670}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv. 9\",\"position\":{\"start\":{\"line\":122,\"column\":88,\"offset\":6672},\"end\":{\"line\":122,\"column\":94,\"offset\":6678}}}],\"position\":{\"start\":{\"line\":122,\"column\":86,\"offset\":6670},\"end\":{\"line\":122,\"column\":95,\"offset\":6679}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv 10.\",\"position\":{\"start\":{\"line\":122,\"column\":97,\"offset\":6681},\"end\":{\"line\":122,\"column\":104,\"offset\":6688}}}],\"position\":{\"start\":{\"line\":122,\"column\":95,\"offset\":6679},\"end\":{\"line\":122,\"column\":106,\"offset\":6690}}}],\"position\":{\"start\":{\"line\":122,\"column\":5,\"offset\":6589},\"end\":{\"line\":122,\"column\":106,\"offset\":6690}}}],\"position\":{\"start\":{\"line\":122,\"column\":5,\"offset\":6589},\"end\":{\"line\":122,\"column\":106,\"offset\":6690}}},{\"type\":\"element\",\"tagName\":\"tbody\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"tr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"canceling orders (branch A)\",\"position\":{\"start\":{\"line\":124,\"column\":7,\"offset\":6775},\"end\":{\"line\":124,\"column\":34,\"offset\":6802}}}],\"position\":{\"start\":{\"line\":124,\"column\":5,\"offset\":6773},\"end\":{\"line\":124,\"column\":38,\"offset\":6806}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":124,\"column\":40,\"offset\":6808},\"end\":{\"line\":124,\"column\":41,\"offset\":6809}}}],\"position\":{\"start\":{\"line\":124,\"column\":38,\"offset\":6806},\"end\":{\"line\":124,\"column\":42,\"offset\":6810}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":124,\"column\":44,\"offset\":6812},\"end\":{\"line\":124,\"column\":45,\"offset\":6813}}}],\"position\":{\"start\":{\"line\":124,\"column\":42,\"offset\":6810},\"end\":{\"line\":124,\"column\":46,\"offset\":6814}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"N/A\",\"position\":{\"start\":{\"line\":124,\"column\":48,\"offset\":6816},\"end\":{\"line\":124,\"column\":51,\"offset\":6819}}}],\"position\":{\"start\":{\"line\":124,\"column\":46,\"offset\":6814},\"end\":{\"line\":124,\"column\":52,\"offset\":6820}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"N/A\",\"position\":{\"start\":{\"line\":124,\"column\":54,\"offset\":6822},\"end\":{\"line\":124,\"column\":57,\"offset\":6825}}}],\"position\":{\"start\":{\"line\":124,\"column\":52,\"offset\":6820},\"end\":{\"line\":124,\"column\":58,\"offset\":6826}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":124,\"column\":60,\"offset\":6828},\"end\":{\"line\":124,\"column\":61,\"offset\":6829}}}],\"position\":{\"start\":{\"line\":124,\"column\":58,\"offset\":6826},\"end\":{\"line\":124,\"column\":62,\"offset\":6830}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":124,\"column\":64,\"offset\":6832},\"end\":{\"line\":124,\"column\":65,\"offset\":6833}}}],\"position\":{\"start\":{\"line\":124,\"column\":62,\"offset\":6830},\"end\":{\"line\":124,\"column\":66,\"offset\":6834}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":124,\"column\":68,\"offset\":6836},\"end\":{\"line\":124,\"column\":69,\"offset\":6837}}}],\"position\":{\"start\":{\"line\":124,\"column\":66,\"offset\":6834},\"end\":{\"line\":124,\"column\":70,\"offset\":6838}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":124,\"column\":72,\"offset\":6840},\"end\":{\"line\":124,\"column\":73,\"offset\":6841}}}],\"position\":{\"start\":{\"line\":124,\"column\":70,\"offset\":6838},\"end\":{\"line\":124,\"column\":74,\"offset\":6842}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":124,\"column\":76,\"offset\":6844},\"end\":{\"line\":124,\"column\":77,\"offset\":6845}}}],\"position\":{\"start\":{\"line\":124,\"column\":74,\"offset\":6842},\"end\":{\"line\":124,\"column\":78,\"offset\":6846}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":124,\"column\":80,\"offset\":6848},\"end\":{\"line\":124,\"column\":81,\"offset\":6849}}}],\"position\":{\"start\":{\"line\":124,\"column\":78,\"offset\":6846},\"end\":{\"line\":124,\"column\":83,\"offset\":6851}}}],\"position\":{\"start\":{\"line\":124,\"column\":5,\"offset\":6773},\"end\":{\"line\":124,\"column\":83,\"offset\":6851}}},{\"type\":\"element\",\"tagName\":\"tr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"canceling orders (branch B1)\",\"position\":{\"start\":{\"line\":125,\"column\":7,\"offset\":6858},\"end\":{\"line\":125,\"column\":35,\"offset\":6886}}}],\"position\":{\"start\":{\"line\":125,\"column\":5,\"offset\":6856},\"end\":{\"line\":125,\"column\":38,\"offset\":6889}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":125,\"column\":40,\"offset\":6891},\"end\":{\"line\":125,\"column\":41,\"offset\":6892}}}],\"position\":{\"start\":{\"line\":125,\"column\":38,\"offset\":6889},\"end\":{\"line\":125,\"column\":42,\"offset\":6893}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":125,\"column\":44,\"offset\":6895},\"end\":{\"line\":125,\"column\":45,\"offset\":6896}}}],\"position\":{\"start\":{\"line\":125,\"column\":42,\"offset\":6893},\"end\":{\"line\":125,\"column\":46,\"offset\":6897}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"N/A\",\"position\":{\"start\":{\"line\":125,\"column\":48,\"offset\":6899},\"end\":{\"line\":125,\"column\":51,\"offset\":6902}}}],\"position\":{\"start\":{\"line\":125,\"column\":46,\"offset\":6897},\"end\":{\"line\":125,\"column\":52,\"offset\":6903}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"N/A\",\"position\":{\"start\":{\"line\":125,\"column\":54,\"offset\":6905},\"end\":{\"line\":125,\"column\":57,\"offset\":6908}}}],\"position\":{\"start\":{\"line\":125,\"column\":52,\"offset\":6903},\"end\":{\"line\":125,\"column\":58,\"offset\":6909}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":125,\"column\":60,\"offset\":6911},\"end\":{\"line\":125,\"column\":61,\"offset\":6912}}}],\"position\":{\"start\":{\"line\":125,\"column\":58,\"offset\":6909},\"end\":{\"line\":125,\"column\":62,\"offset\":6913}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":125,\"column\":64,\"offset\":6915},\"end\":{\"line\":125,\"column\":65,\"offset\":6916}}}],\"position\":{\"start\":{\"line\":125,\"column\":62,\"offset\":6913},\"end\":{\"line\":125,\"column\":66,\"offset\":6917}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"N/A\",\"position\":{\"start\":{\"line\":125,\"column\":68,\"offset\":6919},\"end\":{\"line\":125,\"column\":71,\"offset\":6922}}}],\"position\":{\"start\":{\"line\":125,\"column\":66,\"offset\":6917},\"end\":{\"line\":125,\"column\":72,\"offset\":6923}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":125,\"column\":74,\"offset\":6925},\"end\":{\"line\":125,\"column\":75,\"offset\":6926}}}],\"position\":{\"start\":{\"line\":125,\"column\":72,\"offset\":6923},\"end\":{\"line\":125,\"column\":76,\"offset\":6927}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":125,\"column\":78,\"offset\":6929},\"end\":{\"line\":125,\"column\":79,\"offset\":6930}}}],\"position\":{\"start\":{\"line\":125,\"column\":76,\"offset\":6927},\"end\":{\"line\":125,\"column\":80,\"offset\":6931}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":125,\"column\":82,\"offset\":6933},\"end\":{\"line\":125,\"column\":83,\"offset\":6934}}}],\"position\":{\"start\":{\"line\":125,\"column\":80,\"offset\":6931},\"end\":{\"line\":125,\"column\":85,\"offset\":6936}}}],\"position\":{\"start\":{\"line\":125,\"column\":5,\"offset\":6856},\"end\":{\"line\":125,\"column\":85,\"offset\":6936}}},{\"type\":\"element\",\"tagName\":\"tr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"canceling orders (branch B2)\",\"position\":{\"start\":{\"line\":126,\"column\":7,\"offset\":6943},\"end\":{\"line\":126,\"column\":35,\"offset\":6971}}}],\"position\":{\"start\":{\"line\":126,\"column\":5,\"offset\":6941},\"end\":{\"line\":126,\"column\":38,\"offset\":6974}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":126,\"column\":40,\"offset\":6976},\"end\":{\"line\":126,\"column\":41,\"offset\":6977}}}],\"position\":{\"start\":{\"line\":126,\"column\":38,\"offset\":6974},\"end\":{\"line\":126,\"column\":42,\"offset\":6978}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":126,\"column\":44,\"offset\":6980},\"end\":{\"line\":126,\"column\":45,\"offset\":6981}}}],\"position\":{\"start\":{\"line\":126,\"column\":42,\"offset\":6978},\"end\":{\"line\":126,\"column\":46,\"offset\":6982}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"N/A\",\"position\":{\"start\":{\"line\":126,\"column\":48,\"offset\":6984},\"end\":{\"line\":126,\"column\":51,\"offset\":6987}}}],\"position\":{\"start\":{\"line\":126,\"column\":46,\"offset\":6982},\"end\":{\"line\":126,\"column\":52,\"offset\":6988}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"N/A\",\"position\":{\"start\":{\"line\":126,\"column\":54,\"offset\":6990},\"end\":{\"line\":126,\"column\":57,\"offset\":6993}}}],\"position\":{\"start\":{\"line\":126,\"column\":52,\"offset\":6988},\"end\":{\"line\":126,\"column\":58,\"offset\":6994}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":126,\"column\":60,\"offset\":6996},\"end\":{\"line\":126,\"column\":61,\"offset\":6997}}}],\"position\":{\"start\":{\"line\":126,\"column\":58,\"offset\":6994},\"end\":{\"line\":126,\"column\":62,\"offset\":6998}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":126,\"column\":64,\"offset\":7000},\"end\":{\"line\":126,\"column\":65,\"offset\":7001}}}],\"position\":{\"start\":{\"line\":126,\"column\":62,\"offset\":6998},\"end\":{\"line\":126,\"column\":66,\"offset\":7002}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"N/A\",\"position\":{\"start\":{\"line\":126,\"column\":68,\"offset\":7004},\"end\":{\"line\":126,\"column\":71,\"offset\":7007}}}],\"position\":{\"start\":{\"line\":126,\"column\":66,\"offset\":7002},\"end\":{\"line\":126,\"column\":72,\"offset\":7008}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":126,\"column\":74,\"offset\":7010},\"end\":{\"line\":126,\"column\":75,\"offset\":7011}}}],\"position\":{\"start\":{\"line\":126,\"column\":72,\"offset\":7008},\"end\":{\"line\":126,\"column\":76,\"offset\":7012}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":126,\"column\":78,\"offset\":7014},\"end\":{\"line\":126,\"column\":79,\"offset\":7015}}}],\"position\":{\"start\":{\"line\":126,\"column\":76,\"offset\":7012},\"end\":{\"line\":126,\"column\":80,\"offset\":7016}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":126,\"column\":82,\"offset\":7018},\"end\":{\"line\":126,\"column\":83,\"offset\":7019}}}],\"position\":{\"start\":{\"line\":126,\"column\":80,\"offset\":7016},\"end\":{\"line\":126,\"column\":85,\"offset\":7021}}}],\"position\":{\"start\":{\"line\":126,\"column\":5,\"offset\":6941},\"end\":{\"line\":126,\"column\":85,\"offset\":7021}}}],\"position\":{\"start\":{\"line\":124,\"column\":5,\"offset\":6773},\"end\":{\"line\":126,\"column\":85,\"offset\":7021}}}],\"position\":{\"start\":{\"line\":122,\"column\":5,\"offset\":6589},\"end\":{\"line\":126,\"column\":85,\"offset\":7021}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":103,\"column\":1,\"offset\":5406},\"end\":{\"line\":126,\"column\":85,\"offset\":7021}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"strong\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"placing limit orders\",\"position\":{\"start\":{\"line\":128,\"column\":5,\"offset\":7027},\"end\":{\"line\":128,\"column\":25,\"offset\":7047}}}],\"position\":{\"start\":{\"line\":128,\"column\":3,\"offset\":7025},\"end\":{\"line\":128,\"column\":27,\"offset\":7049}}},{\"type\":\"text\",\"value\":\" (adding to the book): It is very important that:\",\"position\":{\"start\":{\"line\":128,\"column\":27,\"offset\":7049},\"end\":{\"line\":128,\"column\":76,\"offset\":7098}}}],\"position\":{\"start\":{\"line\":128,\"column\":3,\"offset\":7025},\"end\":{\"line\":128,\"column\":76,\"offset\":7098}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"ol\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_tokenIdInfos[order.tokenId].minQuantity\",\"position\":{\"start\":{\"line\":130,\"column\":8,\"offset\":7107},\"end\":{\"line\":130,\"column\":50,\"offset\":7149}}}],\"position\":{\"start\":{\"line\":130,\"column\":8,\"offset\":7107},\"end\":{\"line\":130,\"column\":50,\"offset\":7149}}},{\"type\":\"text\",\"value\":\" \",\"position\":{\"start\":{\"line\":130,\"column\":50,\"offset\":7149},\"end\":{\"line\":130,\"column\":51,\"offset\":7150}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msubsup\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"m\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"n\"}]}]},{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"≠\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"q_{min}^{tid} \\\\neq 0\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:1.1078em;vertical-align:-0.2587em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.03588em;\"},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.8491em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"min\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-3.063em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2587em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"vbox\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"thinbox\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"rlap\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.8889em;vertical-align:-0.1944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"inner\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"fix\"]},\"children\":[]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"=\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6444em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]}]}]},{\"type\":\"text\",\"value\":\". When an admin makes a token id \",\"position\":{\"start\":{\"line\":130,\"column\":73,\"offset\":7172},\"end\":{\"line\":130,\"column\":106,\"offset\":7205}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"tid\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]}]}]}]},{\"type\":\"text\",\"value\":\" tradable \",\"position\":{\"start\":{\"line\":130,\"column\":111,\"offset\":7210},\"end\":{\"line\":130,\"column\":121,\"offset\":7220}}},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/libraries/SonicOrderBookLibrary.sol#L55-L57\"},\"children\":[{\"type\":\"text\",\"value\":\"it has been checked\",\"position\":{\"start\":{\"line\":130,\"column\":122,\"offset\":7221},\"end\":{\"line\":130,\"column\":141,\"offset\":7240}}}],\"position\":{\"start\":{\"line\":130,\"column\":121,\"offset\":7220},\"end\":{\"line\":130,\"column\":296,\"offset\":7395}}},{\"type\":\"text\",\"value\":\" that \",\"position\":{\"start\":{\"line\":130,\"column\":296,\"offset\":7395},\"end\":{\"line\":130,\"column\":302,\"offset\":7401}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"Δ\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"∣\"}]},{\"type\":\"element\",\"tagName\":\"msubsup\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"m\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"n\"}]}]},{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\Delta q | q_{min}^{tid}\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:1.1078em;vertical-align:-0.2587em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"Δ\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.03588em;\"},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"∣\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.03588em;\"},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.8491em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"min\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-3.063em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2587em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\" and \",\"position\":{\"start\":{\"line\":130,\"column\":328,\"offset\":7427},\"end\":{\"line\":130,\"column\":333,\"offset\":7432}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"Δ\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"≤\"}]},{\"type\":\"element\",\"tagName\":\"msubsup\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"m\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"n\"}]}]},{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\Delta q \\\\leq q_{min}^{tid}\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.8778em;vertical-align:-0.1944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"Δ\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.03588em;\"},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"≤\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:1.1078em;vertical-align:-0.2587em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.03588em;\"},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.8491em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"min\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-3.063em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"t\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2587em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\".\",\"position\":{\"start\":{\"line\":130,\"column\":362,\"offset\":7461},\"end\":{\"line\":130,\"column\":363,\"offset\":7462}}}],\"position\":{\"start\":{\"line\":130,\"column\":5,\"offset\":7104},\"end\":{\"line\":130,\"column\":363,\"offset\":7462}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"q_o\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.625em;vertical-align:-0.1944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.03588em;\"},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.1514em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\" \",\"position\":{\"start\":{\"line\":131,\"column\":13,\"offset\":7475},\"end\":{\"line\":131,\"column\":14,\"offset\":7476}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"order.quantity\",\"position\":{\"start\":{\"line\":131,\"column\":14,\"offset\":7476},\"end\":{\"line\":131,\"column\":30,\"offset\":7492}}}],\"position\":{\"start\":{\"line\":131,\"column\":14,\"offset\":7476},\"end\":{\"line\":131,\"column\":30,\"offset\":7492}}},{\"type\":\"text\",\"value\":\" is quantised by \",\"position\":{\"start\":{\"line\":131,\"column\":30,\"offset\":7492},\"end\":{\"line\":131,\"column\":47,\"offset\":7509}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"Δ\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\Delta q\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.8778em;vertical-align:-0.1944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"Δ\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.03588em;\"},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]}]}]}]},{\"type\":\"text\",\"value\":\" and is non-zero. This has been checked.\",\"position\":{\"start\":{\"line\":131,\"column\":57,\"offset\":7519},\"end\":{\"line\":131,\"column\":97,\"offset\":7559}}}],\"position\":{\"start\":{\"line\":131,\"column\":5,\"offset\":7467},\"end\":{\"line\":131,\"column\":97,\"offset\":7559}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"quantityFulfilled\",\"position\":{\"start\":{\"line\":132,\"column\":8,\"offset\":7567},\"end\":{\"line\":132,\"column\":27,\"offset\":7586}}}],\"position\":{\"start\":{\"line\":132,\"column\":8,\"offset\":7567},\"end\":{\"line\":132,\"column\":27,\"offset\":7586}}},{\"type\":\"text\",\"value\":\" \",\"position\":{\"start\":{\"line\":132,\"column\":27,\"offset\":7586},\"end\":{\"line\":132,\"column\":28,\"offset\":7587}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"f\"}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"q_f\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.7167em;vertical-align:-0.2861em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.03588em;\"},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.3361em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"],\"style\":\"margin-right:0.10764em;\"},\"children\":[{\"type\":\"text\",\"value\":\"f\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2861em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\" is also quantised by \",\"position\":{\"start\":{\"line\":132,\"column\":33,\"offset\":7592},\"end\":{\"line\":132,\"column\":55,\"offset\":7614}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"Δ\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\Delta q\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.8778em;vertical-align:-0.1944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"Δ\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.03588em;\"},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]}]}]}]},{\"type\":\"text\",\"value\":\". This can be proved by induction/recursion in \",\"position\":{\"start\":{\"line\":132,\"column\":65,\"offset\":7624},\"end\":{\"line\":132,\"column\":112,\"offset\":7671}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_parseOrder\",\"position\":{\"start\":{\"line\":132,\"column\":112,\"offset\":7671},\"end\":{\"line\":132,\"column\":125,\"offset\":7684}}}],\"position\":{\"start\":{\"line\":132,\"column\":112,\"offset\":7671},\"end\":{\"line\":132,\"column\":125,\"offset\":7684}}},{\"type\":\"text\",\"value\":\".\",\"position\":{\"start\":{\"line\":132,\"column\":125,\"offset\":7684},\"end\":{\"line\":132,\"column\":126,\"offset\":7685}}}],\"position\":{\"start\":{\"line\":132,\"column\":5,\"offset\":7564},\"end\":{\"line\":132,\"column\":126,\"offset\":7685}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":130,\"column\":5,\"offset\":7104},\"end\":{\"line\":132,\"column\":126,\"offset\":7685}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"And thus one can deduce that in the branch where \",\"position\":{\"start\":{\"line\":134,\"column\":5,\"offset\":7691},\"end\":{\"line\":134,\"column\":54,\"offset\":7740}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_addToBook(...)\",\"position\":{\"start\":{\"line\":134,\"column\":54,\"offset\":7740},\"end\":{\"line\":134,\"column\":71,\"offset\":7757}}}],\"position\":{\"start\":{\"line\":134,\"column\":54,\"offset\":7740},\"end\":{\"line\":134,\"column\":71,\"offset\":7757}}},{\"type\":\"text\",\"value\":\" is called, \",\"position\":{\"start\":{\"line\":134,\"column\":71,\"offset\":7757},\"end\":{\"line\":134,\"column\":83,\"offset\":7769}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"quantityRemaining\",\"position\":{\"start\":{\"line\":134,\"column\":83,\"offset\":7769},\"end\":{\"line\":134,\"column\":102,\"offset\":7788}}}],\"position\":{\"start\":{\"line\":134,\"column\":83,\"offset\":7769},\"end\":{\"line\":134,\"column\":102,\"offset\":7788}}},{\"type\":\"text\",\"value\":\" \",\"position\":{\"start\":{\"line\":134,\"column\":102,\"offset\":7788},\"end\":{\"line\":134,\"column\":103,\"offset\":7789}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"r\"}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"q_r\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.625em;vertical-align:-0.1944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.03588em;\"},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.1514em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"],\"style\":\"margin-right:0.02778em;\"},\"children\":[{\"type\":\"text\",\"value\":\"r\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\" is also quantised by \",\"position\":{\"start\":{\"line\":134,\"column\":108,\"offset\":7794},\"end\":{\"line\":134,\"column\":130,\"offset\":7816}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"Δ\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\Delta q\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.8778em;vertical-align:-0.1944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"Δ\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.03588em;\"},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]}]}]}]},{\"type\":\"text\",\"value\":\" and is non-zero.\",\"position\":{\"start\":{\"line\":134,\"column\":140,\"offset\":7826},\"end\":{\"line\":134,\"column\":157,\"offset\":7843}}}],\"position\":{\"start\":{\"line\":134,\"column\":5,\"offset\":7691},\"end\":{\"line\":134,\"column\":157,\"offset\":7843}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"This is very important as it would guarantee one would not add slots to the price segment with a non-zero order id but with \",\"position\":{\"start\":{\"line\":136,\"column\":5,\"offset\":7849},\"end\":{\"line\":136,\"column\":129,\"offset\":7973}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6444em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]}]}]},{\"type\":\"text\",\"value\":\" quantised/normalised quantities, ie adding a slot of the form \",\"position\":{\"start\":{\"line\":136,\"column\":132,\"offset\":7976},\"end\":{\"line\":136,\"column\":195,\"offset\":8039}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{\"stretchy\":\"false\"},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{\"separator\":\"true\"},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{\"stretchy\":\"false\"},\"children\":[{\"type\":\"text\",\"value\":\")\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"(0, i)\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:1em;vertical-align:-0.25em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mopen\"]},\"children\":[{\"type\":\"text\",\"value\":\"(\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mpunct\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.1667em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"i\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mclose\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]}]}]}]},{\"type\":\"text\",\"value\":\" should not be possible as this would break (Inv 2.).\",\"position\":{\"start\":{\"line\":136,\"column\":203,\"offset\":8047},\"end\":{\"line\":136,\"column\":256,\"offset\":8100}}}],\"position\":{\"start\":{\"line\":136,\"column\":5,\"offset\":7849},\"end\":{\"line\":136,\"column\":256,\"offset\":8100}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-solidity\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"_addOrderToEndOfSegments(...) private {\\n    if (segments.length != 0) {\\n        if (lastSegmentIndex \u003e= node.tombstoneSegmentOffset) {\\n            // Branch A: If there is space at the end of last segment\\n            //           and if this last segment is in the active aread of the price segment\\n            //           add the order slot here and `return`\\n        }\\n    }\\n\\n    // Branch B: push a new segment [(0,0), (0,0), (qn, oid)] to price segment\\n    //           as the last segment is full.\\n    bytes32 segment = SlotLibrary.createSlotAsBytes32(orderId, normalizedQuantity);\\n    segments.push(segment);\\n}\\n\"}],\"position\":{\"start\":{\"line\":138,\"column\":5,\"offset\":8106},\"end\":{\"line\":153,\"column\":8,\"offset\":8794}}}],\"position\":{\"start\":{\"line\":138,\"column\":5,\"offset\":8106},\"end\":{\"line\":153,\"column\":8,\"offset\":8794}}},{\"type\":\"text\",\"value\":\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\"},{\"type\":\"element\",\"tagName\":\"table\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"thead\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"tr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"method\",\"position\":{\"start\":{\"line\":155,\"column\":7,\"offset\":8802},\"end\":{\"line\":155,\"column\":13,\"offset\":8808}}}],\"position\":{\"start\":{\"line\":155,\"column\":5,\"offset\":8800},\"end\":{\"line\":155,\"column\":14,\"offset\":8809}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv 1.\",\"position\":{\"start\":{\"line\":155,\"column\":16,\"offset\":8811},\"end\":{\"line\":155,\"column\":22,\"offset\":8817}}}],\"position\":{\"start\":{\"line\":155,\"column\":14,\"offset\":8809},\"end\":{\"line\":155,\"column\":23,\"offset\":8818}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv 2.\",\"position\":{\"start\":{\"line\":155,\"column\":25,\"offset\":8820},\"end\":{\"line\":155,\"column\":31,\"offset\":8826}}}],\"position\":{\"start\":{\"line\":155,\"column\":23,\"offset\":8818},\"end\":{\"line\":155,\"column\":32,\"offset\":8827}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv 3.\",\"position\":{\"start\":{\"line\":155,\"column\":34,\"offset\":8829},\"end\":{\"line\":155,\"column\":40,\"offset\":8835}}}],\"position\":{\"start\":{\"line\":155,\"column\":32,\"offset\":8827},\"end\":{\"line\":155,\"column\":41,\"offset\":8836}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv 4.\",\"position\":{\"start\":{\"line\":155,\"column\":43,\"offset\":8838},\"end\":{\"line\":155,\"column\":49,\"offset\":8844}}}],\"position\":{\"start\":{\"line\":155,\"column\":41,\"offset\":8836},\"end\":{\"line\":155,\"column\":50,\"offset\":8845}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv 5.\",\"position\":{\"start\":{\"line\":155,\"column\":52,\"offset\":8847},\"end\":{\"line\":155,\"column\":58,\"offset\":8853}}}],\"position\":{\"start\":{\"line\":155,\"column\":50,\"offset\":8845},\"end\":{\"line\":155,\"column\":59,\"offset\":8854}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv 6.\",\"position\":{\"start\":{\"line\":155,\"column\":61,\"offset\":8856},\"end\":{\"line\":155,\"column\":67,\"offset\":8862}}}],\"position\":{\"start\":{\"line\":155,\"column\":59,\"offset\":8854},\"end\":{\"line\":155,\"column\":68,\"offset\":8863}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv 7.\",\"position\":{\"start\":{\"line\":155,\"column\":70,\"offset\":8865},\"end\":{\"line\":155,\"column\":76,\"offset\":8871}}}],\"position\":{\"start\":{\"line\":155,\"column\":68,\"offset\":8863},\"end\":{\"line\":155,\"column\":77,\"offset\":8872}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv. 8\",\"position\":{\"start\":{\"line\":155,\"column\":79,\"offset\":8874},\"end\":{\"line\":155,\"column\":85,\"offset\":8880}}}],\"position\":{\"start\":{\"line\":155,\"column\":77,\"offset\":8872},\"end\":{\"line\":155,\"column\":86,\"offset\":8881}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv. 9\",\"position\":{\"start\":{\"line\":155,\"column\":88,\"offset\":8883},\"end\":{\"line\":155,\"column\":94,\"offset\":8889}}}],\"position\":{\"start\":{\"line\":155,\"column\":86,\"offset\":8881},\"end\":{\"line\":155,\"column\":95,\"offset\":8890}}},{\"type\":\"element\",\"tagName\":\"th\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv 10.\",\"position\":{\"start\":{\"line\":155,\"column\":97,\"offset\":8892},\"end\":{\"line\":155,\"column\":104,\"offset\":8899}}}],\"position\":{\"start\":{\"line\":155,\"column\":95,\"offset\":8890},\"end\":{\"line\":155,\"column\":106,\"offset\":8901}}}],\"position\":{\"start\":{\"line\":155,\"column\":5,\"offset\":8800},\"end\":{\"line\":155,\"column\":106,\"offset\":8901}}}],\"position\":{\"start\":{\"line\":155,\"column\":5,\"offset\":8800},\"end\":{\"line\":155,\"column\":106,\"offset\":8901}}},{\"type\":\"element\",\"tagName\":\"tbody\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"tr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"placing limit orders (branch A)\",\"position\":{\"start\":{\"line\":157,\"column\":7,\"offset\":8990},\"end\":{\"line\":157,\"column\":38,\"offset\":9021}}}],\"position\":{\"start\":{\"line\":157,\"column\":5,\"offset\":8988},\"end\":{\"line\":157,\"column\":41,\"offset\":9024}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":157,\"column\":43,\"offset\":9026},\"end\":{\"line\":157,\"column\":44,\"offset\":9027}}}],\"position\":{\"start\":{\"line\":157,\"column\":41,\"offset\":9024},\"end\":{\"line\":157,\"column\":45,\"offset\":9028}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":157,\"column\":47,\"offset\":9030},\"end\":{\"line\":157,\"column\":48,\"offset\":9031}}}],\"position\":{\"start\":{\"line\":157,\"column\":45,\"offset\":9028},\"end\":{\"line\":157,\"column\":49,\"offset\":9032}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":157,\"column\":51,\"offset\":9034},\"end\":{\"line\":157,\"column\":52,\"offset\":9035}}}],\"position\":{\"start\":{\"line\":157,\"column\":49,\"offset\":9032},\"end\":{\"line\":157,\"column\":53,\"offset\":9036}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"N/A\",\"position\":{\"start\":{\"line\":157,\"column\":55,\"offset\":9038},\"end\":{\"line\":157,\"column\":58,\"offset\":9041}}}],\"position\":{\"start\":{\"line\":157,\"column\":53,\"offset\":9036},\"end\":{\"line\":157,\"column\":59,\"offset\":9042}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":157,\"column\":61,\"offset\":9044},\"end\":{\"line\":157,\"column\":62,\"offset\":9045}}}],\"position\":{\"start\":{\"line\":157,\"column\":59,\"offset\":9042},\"end\":{\"line\":157,\"column\":63,\"offset\":9046}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":157,\"column\":65,\"offset\":9048},\"end\":{\"line\":157,\"column\":66,\"offset\":9049}}}],\"position\":{\"start\":{\"line\":157,\"column\":63,\"offset\":9046},\"end\":{\"line\":157,\"column\":67,\"offset\":9050}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"N/A\",\"position\":{\"start\":{\"line\":157,\"column\":69,\"offset\":9052},\"end\":{\"line\":157,\"column\":72,\"offset\":9055}}}],\"position\":{\"start\":{\"line\":157,\"column\":67,\"offset\":9050},\"end\":{\"line\":157,\"column\":73,\"offset\":9056}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":157,\"column\":75,\"offset\":9058},\"end\":{\"line\":157,\"column\":76,\"offset\":9059}}}],\"position\":{\"start\":{\"line\":157,\"column\":73,\"offset\":9056},\"end\":{\"line\":157,\"column\":77,\"offset\":9060}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":157,\"column\":79,\"offset\":9062},\"end\":{\"line\":157,\"column\":80,\"offset\":9063}}}],\"position\":{\"start\":{\"line\":157,\"column\":77,\"offset\":9060},\"end\":{\"line\":157,\"column\":81,\"offset\":9064}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":157,\"column\":83,\"offset\":9066},\"end\":{\"line\":157,\"column\":84,\"offset\":9067}}}],\"position\":{\"start\":{\"line\":157,\"column\":81,\"offset\":9064},\"end\":{\"line\":157,\"column\":86,\"offset\":9069}}}],\"position\":{\"start\":{\"line\":157,\"column\":5,\"offset\":8988},\"end\":{\"line\":157,\"column\":86,\"offset\":9069}}},{\"type\":\"element\",\"tagName\":\"tr\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"placing limit orders (branch B)\",\"position\":{\"start\":{\"line\":158,\"column\":7,\"offset\":9076},\"end\":{\"line\":158,\"column\":38,\"offset\":9107}}}],\"position\":{\"start\":{\"line\":158,\"column\":5,\"offset\":9074},\"end\":{\"line\":158,\"column\":41,\"offset\":9110}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":158,\"column\":43,\"offset\":9112},\"end\":{\"line\":158,\"column\":44,\"offset\":9113}}}],\"position\":{\"start\":{\"line\":158,\"column\":41,\"offset\":9110},\"end\":{\"line\":158,\"column\":45,\"offset\":9114}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":158,\"column\":47,\"offset\":9116},\"end\":{\"line\":158,\"column\":48,\"offset\":9117}}}],\"position\":{\"start\":{\"line\":158,\"column\":45,\"offset\":9114},\"end\":{\"line\":158,\"column\":49,\"offset\":9118}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":158,\"column\":51,\"offset\":9120},\"end\":{\"line\":158,\"column\":52,\"offset\":9121}}}],\"position\":{\"start\":{\"line\":158,\"column\":49,\"offset\":9118},\"end\":{\"line\":158,\"column\":53,\"offset\":9122}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"N/A\",\"position\":{\"start\":{\"line\":158,\"column\":55,\"offset\":9124},\"end\":{\"line\":158,\"column\":58,\"offset\":9127}}}],\"position\":{\"start\":{\"line\":158,\"column\":53,\"offset\":9122},\"end\":{\"line\":158,\"column\":59,\"offset\":9128}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":158,\"column\":61,\"offset\":9130},\"end\":{\"line\":158,\"column\":62,\"offset\":9131}}}],\"position\":{\"start\":{\"line\":158,\"column\":59,\"offset\":9128},\"end\":{\"line\":158,\"column\":63,\"offset\":9132}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":158,\"column\":65,\"offset\":9134},\"end\":{\"line\":158,\"column\":66,\"offset\":9135}}}],\"position\":{\"start\":{\"line\":158,\"column\":63,\"offset\":9132},\"end\":{\"line\":158,\"column\":67,\"offset\":9136}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"N/A\",\"position\":{\"start\":{\"line\":158,\"column\":69,\"offset\":9138},\"end\":{\"line\":158,\"column\":72,\"offset\":9141}}}],\"position\":{\"start\":{\"line\":158,\"column\":67,\"offset\":9136},\"end\":{\"line\":158,\"column\":73,\"offset\":9142}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":158,\"column\":75,\"offset\":9144},\"end\":{\"line\":158,\"column\":76,\"offset\":9145}}}],\"position\":{\"start\":{\"line\":158,\"column\":73,\"offset\":9142},\"end\":{\"line\":158,\"column\":77,\"offset\":9146}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":158,\"column\":79,\"offset\":9148},\"end\":{\"line\":158,\"column\":80,\"offset\":9149}}}],\"position\":{\"start\":{\"line\":158,\"column\":77,\"offset\":9146},\"end\":{\"line\":158,\"column\":81,\"offset\":9150}}},{\"type\":\"element\",\"tagName\":\"td\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"✅\",\"position\":{\"start\":{\"line\":158,\"column\":83,\"offset\":9152},\"end\":{\"line\":158,\"column\":84,\"offset\":9153}}}],\"position\":{\"start\":{\"line\":158,\"column\":81,\"offset\":9150},\"end\":{\"line\":158,\"column\":86,\"offset\":9155}}}],\"position\":{\"start\":{\"line\":158,\"column\":5,\"offset\":9074},\"end\":{\"line\":158,\"column\":86,\"offset\":9155}}}],\"position\":{\"start\":{\"line\":157,\"column\":5,\"offset\":8988},\"end\":{\"line\":158,\"column\":86,\"offset\":9155}}}],\"position\":{\"start\":{\"line\":155,\"column\":5,\"offset\":8800},\"end\":{\"line\":158,\"column\":86,\"offset\":9155}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":128,\"column\":1,\"offset\":7023},\"end\":{\"line\":158,\"column\":86,\"offset\":9155}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"strong\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"matching orders\",\"position\":{\"start\":{\"line\":161,\"column\":5,\"offset\":9162},\"end\":{\"line\":161,\"column\":20,\"offset\":9177}}}],\"position\":{\"start\":{\"line\":161,\"column\":3,\"offset\":9160},\"end\":{\"line\":161,\"column\":22,\"offset\":9179}}},{\"type\":\"text\",\"value\":\": If the last segment is not deleted but all its orders get consumed, this last segment is not popped out instead just set to \",\"position\":{\"start\":{\"line\":161,\"column\":22,\"offset\":9179},\"end\":{\"line\":161,\"column\":148,\"offset\":9305}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"bytes32(0)\",\"position\":{\"start\":{\"line\":161,\"column\":148,\"offset\":9305},\"end\":{\"line\":161,\"column\":160,\"offset\":9317}}}],\"position\":{\"start\":{\"line\":161,\"column\":148,\"offset\":9305},\"end\":{\"line\":161,\"column\":160,\"offset\":9317}}},{\"type\":\"text\",\"value\":\" \",\"position\":{\"start\":{\"line\":161,\"column\":160,\"offset\":9317},\"end\":{\"line\":161,\"column\":161,\"offset\":9318}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\square \\\\square \\\\square\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.675em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"□□□\"}]}]}]}]},{\"type\":\"text\",\"value\":\" (\",\"position\":{\"start\":{\"line\":161,\"column\":186,\"offset\":9343},\"end\":{\"line\":161,\"column\":188,\"offset\":9345}}},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/SonicOrderBook.sol#L948-L950\"},\"children\":[{\"type\":\"text\",\"value\":\"ref\",\"position\":{\"start\":{\"line\":161,\"column\":189,\"offset\":9346},\"end\":{\"line\":161,\"column\":192,\"offset\":9349}}}],\"position\":{\"start\":{\"line\":161,\"column\":188,\"offset\":9345},\"end\":{\"line\":161,\"column\":332,\"offset\":9489}}},{\"type\":\"text\",\"value\":\").\",\"position\":{\"start\":{\"line\":161,\"column\":332,\"offset\":9489},\"end\":{\"line\":161,\"column\":334,\"offset\":9491}}}],\"position\":{\"start\":{\"line\":161,\"column\":3,\"offset\":9160},\"end\":{\"line\":161,\"column\":334,\"offset\":9491}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":161,\"column\":1,\"offset\":9158},\"end\":{\"line\":161,\"column\":334,\"offset\":9491}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":103,\"column\":1,\"offset\":5406},\"end\":{\"line\":161,\"column\":334,\"offset\":9491}}},\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:14:props:node:children:1:children:1\",\"children\":[[\"$\",\"$L2f\",\"strong-0\",{\"as\":\"strong\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:14:props:node:children:1:children:1:children:0\",\"children\":\"canceling orders\"}],\": We should have \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"p\"}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"∈\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"T\"}],[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"t\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"i\"}],[\"$\",\"mi\",\"mi-2\",{\"children\":\"d\"}],[\"$\",\"mo\",\"mo-0\",{\"separator\":\"true\",\"children\":\",\"}],[\"$\",\"mi\",\"mi-3\",{\"children\":\"s\"}]]}]]}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"p \\\\in T_{tid,s}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.7335em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"children\":\"p\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":\"∈\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.9694em\",\"verticalAlign\":\"-0.2861em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.13889em\"},\"children\":\"T\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3361em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.1389em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal mtight\",\"children\":\"i\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mpunct mtight\",\"children\":\",\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord mathnormal mtight\",\"children\":\"s\"}]]}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2861em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}]]}],\" otherwise the call should fail. First the order's position in the price segment should be found using \",[\"$\",\"$L44\",\"a-0\",{\"repoId\":\"$undefined\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/SonicOrderBook.sol#L1006\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:14:props:node:children:1:children:1:children:4\",\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"_find\",\"inline\":true,\"language\":\"text\"}]}],\". The \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"_find\",\"inline\":true,\"language\":\"text\"}],\" flow relies on the fact that there are no holes (inv 1.) in the price segments and orders are placed in a monotonically increasing fashion (Inv 10.). The invariant checks need to be performed for each branch in \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"_cancelOrder\",\"inline\":true,\"language\":\"text\"}],\":\"]}],\"\\n\",[\"$\",\"$L45\",\"pre-0\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:14:props:node:children:1:children:3\",\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"if (isFinalSegment \u0026\u0026 isOnlyOrderInSegment) {\\n    // branch A\\n} else {\\n    // Branch B: this branch has many sub-branches\\n    for (/* ... */) {\\n        if (nextSlot == 0) {\\n            // this branch should only be hit on the last segment,\\n            // ie, when `currentOrNextSegment == segments.length - 1`\\n            // one can add a require statement. 🟡\\n        }\\n    }\\n\\n    // Branch B1: `for` loop gets skipped (`absoluteSlotIndexToRemove == totalOrders`)\\n    // Branch B2: `for` loop is entered   (`absoluteSlotIndexToRemove  \u003c totalOrders`)\\n}\",\"inline\":false,\"language\":\"solidity\"}]}],[\"$\",\"$L46\",null,{\"content\":\"if (isFinalSegment \u0026\u0026 isOnlyOrderInSegment) {\\n    // branch A\\n} else {\\n    // Branch B: this branch has many sub-branches\\n    for (/* ... */) {\\n        if (nextSlot == 0) {\\n            // this branch should only be hit on the last segment,\\n            // ie, when `currentOrNextSegment == segments.length - 1`\\n            // one can add a require statement. 🟡\\n        }\\n    }\\n\\n    // Branch B1: `for` loop gets skipped (`absoluteSlotIndexToRemove == totalOrders`)\\n    // Branch B2: `for` loop is entered   (`absoluteSlotIndexToRemove  \u003c totalOrders`)\\n}\\n\"}]]}],\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\",[\"$\",\"table\",\"table-0\",{\"children\":[[\"$\",\"thead\",\"thead-0\",{\"children\":[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"th\",\"th-0\",{\"children\":\"method\"}],[\"$\",\"th\",\"th-1\",{\"children\":\"Inv 1.\"}],[\"$\",\"th\",\"th-2\",{\"children\":\"Inv 2.\"}],[\"$\",\"th\",\"th-3\",{\"children\":\"Inv 3.\"}],[\"$\",\"th\",\"th-4\",{\"children\":\"Inv 4.\"}],[\"$\",\"th\",\"th-5\",{\"children\":\"Inv 5.\"}],[\"$\",\"th\",\"th-6\",{\"children\":\"Inv 6.\"}],[\"$\",\"th\",\"th-7\",{\"children\":\"Inv 7.\"}],[\"$\",\"th\",\"th-8\",{\"children\":\"Inv. 8\"}],[\"$\",\"th\",\"th-9\",{\"children\":\"Inv. 9\"}],[\"$\",\"th\",\"th-10\",{\"children\":\"Inv 10.\"}]]}]}],[\"$\",\"tbody\",\"tbody-0\",{\"children\":[[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"children\":\"canceling orders (branch A)\"}],[\"$\",\"td\",\"td-1\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-2\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-3\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-4\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-5\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-6\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-7\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-8\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-9\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-10\",{\"children\":\"✅\"}]]}],[\"$\",\"tr\",\"tr-1\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"children\":\"canceling orders (branch B1)\"}],[\"$\",\"td\",\"td-1\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-2\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-3\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-4\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-5\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-6\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-7\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-8\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-9\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-10\",{\"children\":\"✅\"}]]}],[\"$\",\"tr\",\"tr-2\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"children\":\"canceling orders (branch B2)\"}],[\"$\",\"td\",\"td-1\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-2\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-3\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-4\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-5\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-6\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-7\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-8\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-9\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-10\",{\"children\":\"✅\"}]]}]]}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:14:props:node:children:3:children:1\",\"children\":[[\"$\",\"$L2f\",\"strong-0\",{\"as\":\"strong\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:14:props:node:children:3:children:1:children:0\",\"children\":\"placing limit orders\"}],\" (adding to the book): It is very important that:\"]}],\"\\n\",[\"$\",\"$L3b\",\"ol-0\",{\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:14:props:node:children:3:children:3\",\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[[\"$\",\"$L43\",\"code-0\",{\"code\":\"_tokenIdInfos[order.tokenId].minQuantity\",\"inline\":true,\"language\":\"text\"}],\" \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"msubsup\",\"msubsup-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"q\"}],[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"m\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"i\"}],[\"$\",\"mi\",\"mi-2\",{\"children\":\"n\"}]]}],[\"$\",\"mrow\",\"mrow-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"t\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"i\"}],[\"$\",\"mi\",\"mi-2\",{\"children\":\"d\"}]]}]]}],[\"$\",\"mo\",\"mo-0\",{\"mathvariant\":\"normal\",\"children\":\"≠\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"0\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"q_{min}^{tid} \\\\neq 0\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"1.1078em\",\"verticalAlign\":\"-0.2587em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.8491em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.4413em\",\"marginLeft\":\"-0.0359em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"min\"}]}]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.063em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal mtight\",\"children\":\"i\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}]]}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2587em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mrel\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord vbox\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"thinbox\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"rlap\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.8889em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"inner\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mrel\",\"children\":\"\"}]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"fix\"}]]}]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mrel\",\"children\":\"=\"}]]}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"0\"}]]}]]}]]}],\". When an admin makes a token id \",[\"$\",\"span\",\"span-1\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"t\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"i\"}],[\"$\",\"mi\",\"mi-2\",{\"children\":\"d\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"tid\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"children\":\"t\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord mathnormal\",\"children\":\"i\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mord mathnormal\",\"children\":\"d\"}]]}]}]]}],\" tradable \",[\"$\",\"$L44\",\"a-0\",{\"repoId\":\"$undefined\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/libraries/SonicOrderBookLibrary.sol#L55-L57\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:14:props:node:children:3:children:3:children:1:children:6\",\"children\":\"it has been checked\"}],\" that \",[\"$\",\"span\",\"span-2\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"Δ\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"q\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"∣\"}],[\"$\",\"msubsup\",\"msubsup-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"q\"}],[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"m\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"i\"}],[\"$\",\"mi\",\"mi-2\",{\"children\":\"n\"}]]}],[\"$\",\"mrow\",\"mrow-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"t\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"i\"}],[\"$\",\"mi\",\"mi-2\",{\"children\":\"d\"}]]}]]}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\Delta q | q_{min}^{tid}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"1.1078em\",\"verticalAlign\":\"-0.2587em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"Δ\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mord\",\"children\":\"∣\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.8491em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.4413em\",\"marginLeft\":\"-0.0359em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"min\"}]}]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.063em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal mtight\",\"children\":\"i\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}]]}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2587em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]}]]}],\" and \",[\"$\",\"span\",\"span-3\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"Δ\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"q\"}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"≤\"}],[\"$\",\"msubsup\",\"msubsup-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"q\"}],[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"m\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"i\"}],[\"$\",\"mi\",\"mi-2\",{\"children\":\"n\"}]]}],[\"$\",\"mrow\",\"mrow-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"t\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"i\"}],[\"$\",\"mi\",\"mi-2\",{\"children\":\"d\"}]]}]]}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\Delta q \\\\leq q_{min}^{tid}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.8778em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"Δ\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mrel\",\"children\":\"≤\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"1.1078em\",\"verticalAlign\":\"-0.2587em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.8491em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.4413em\",\"marginLeft\":\"-0.0359em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"min\"}]}]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.063em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal mtight\",\"children\":\"i\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}]]}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2587em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}]]}],\".\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"q\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"o\"}]]}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"q_o\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.625em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.0359em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"o\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]}]]}],\" \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"order.quantity\",\"inline\":true,\"language\":\"text\"}],\" is quantised by \",[\"$\",\"span\",\"span-1\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"Δ\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"q\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\Delta q\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.8778em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"Δ\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}]]}]}]]}],\" and is non-zero. This has been checked.\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":[[\"$\",\"$L43\",\"code-0\",{\"code\":\"quantityFulfilled\",\"inline\":true,\"language\":\"text\"}],\" \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"q\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"f\"}]]}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"q_f\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.7167em\",\"verticalAlign\":\"-0.2861em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3361em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.0359em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.10764em\"},\"children\":\"f\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2861em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]}]]}],\" is also quantised by \",[\"$\",\"span\",\"span-1\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"Δ\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"q\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\Delta q\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.8778em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"Δ\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}]]}]}]]}],\". This can be proved by induction/recursion in \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"_parseOrder\",\"inline\":true,\"language\":\"text\"}],\".\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"$L2f\",\"p-1\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:14:props:node:children:3:children:5\",\"children\":[\"And thus one can deduce that in the branch where \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"_addToBook(...)\",\"inline\":true,\"language\":\"text\"}],\" is called, \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"quantityRemaining\",\"inline\":true,\"language\":\"text\"}],\" \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"q\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"r\"}]]}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"q_r\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.625em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.0359em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.02778em\"},\"children\":\"r\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]}]]}],\" is also quantised by \",[\"$\",\"span\",\"span-1\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"Δ\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"q\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\Delta q\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.8778em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"Δ\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}]]}]}]]}],\" and is non-zero.\"]}],\"\\n\",[\"$\",\"$L2f\",\"p-2\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:14:props:node:children:3:children:7\",\"children\":[\"This is very important as it would guarantee one would not add slots to the price segment with a non-zero order id but with \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mn\",\"mn-0\",{\"children\":\"0\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"0\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"0\"}]]}]}]]}],\" quantised/normalised quantities, ie adding a slot of the form \",[\"$\",\"span\",\"span-1\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"0\"}],[\"$\",\"mo\",\"mo-1\",{\"separator\":\"true\",\"children\":\",\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"i\"}],[\"$\",\"mo\",\"mo-2\",{\"stretchy\":\"false\",\"children\":\")\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"(0, i)\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-0.25em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord\",\"children\":\"0\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mpunct\",\"children\":\",\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-5\",{\"className\":\"mord mathnormal\",\"children\":\"i\"}],[\"$\",\"span\",\"span-6\",{\"className\":\"mclose\",\"children\":\")\"}]]}]}]]}],\" should not be possible as this would break (Inv 2.).\"]}],\"\\n\",[\"$\",\"$L45\",\"pre-0\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:14:props:node:children:3:children:9\",\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"_addOrderToEndOfSegments(...) private {\\n    if (segments.length != 0) {\\n        if (lastSegmentIndex \u003e= node.tombstoneSegmentOffset) {\\n            // Branch A: If there is space at the end of last segment\\n            //           and if this last segment is in the active aread of the price segment\\n            //           add the order slot here and `return`\\n        }\\n    }\\n\\n    // Branch B: push a new segment [(0,0), (0,0), (qn, oid)] to price segment\\n    //           as the last segment is full.\\n    bytes32 segment = SlotLibrary.createSlotAsBytes32(orderId, normalizedQuantity);\\n    segments.push(segment);\\n}\",\"inline\":false,\"language\":\"solidity\"}]}],[\"$\",\"$L46\",null,{\"content\":\"_addOrderToEndOfSegments(...) private {\\n    if (segments.length != 0) {\\n        if (lastSegmentIndex \u003e= node.tombstoneSegmentOffset) {\\n            // Branch A: If there is space at the end of last segment\\n            //           and if this last segment is in the active aread of the price segment\\n            //           add the order slot here and `return`\\n        }\\n    }\\n\\n    // Branch B: push a new segment [(0,0), (0,0), (qn, oid)] to price segment\\n    //           as the last segment is full.\\n    bytes32 segment = SlotLibrary.createSlotAsBytes32(orderId, normalizedQuantity);\\n    segments.push(segment);\\n}\\n\"}]]}],\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\",[\"$\",\"table\",\"table-0\",{\"children\":[[\"$\",\"thead\",\"thead-0\",{\"children\":[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"th\",\"th-0\",{\"children\":\"method\"}],[\"$\",\"th\",\"th-1\",{\"children\":\"Inv 1.\"}],[\"$\",\"th\",\"th-2\",{\"children\":\"Inv 2.\"}],[\"$\",\"th\",\"th-3\",{\"children\":\"Inv 3.\"}],[\"$\",\"th\",\"th-4\",{\"children\":\"Inv 4.\"}],[\"$\",\"th\",\"th-5\",{\"children\":\"Inv 5.\"}],[\"$\",\"th\",\"th-6\",{\"children\":\"Inv 6.\"}],[\"$\",\"th\",\"th-7\",{\"children\":\"Inv 7.\"}],[\"$\",\"th\",\"th-8\",{\"children\":\"Inv. 8\"}],[\"$\",\"th\",\"th-9\",{\"children\":\"Inv. 9\"}],[\"$\",\"th\",\"th-10\",{\"children\":\"Inv 10.\"}]]}]}],[\"$\",\"tbody\",\"tbody-0\",{\"children\":[[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"children\":\"placing limit orders (branch A)\"}],[\"$\",\"td\",\"td-1\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-2\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-3\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-4\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-5\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-6\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-7\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-8\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-9\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-10\",{\"children\":\"✅\"}]]}],[\"$\",\"tr\",\"tr-1\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"children\":\"placing limit orders (branch B)\"}],[\"$\",\"td\",\"td-1\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-2\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-3\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-4\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-5\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-6\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-7\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-8\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-9\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-10\",{\"children\":\"✅\"}]]}]]}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":[\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:14:props:node:children:5:children:1\",\"children\":[[\"$\",\"$L2f\",\"strong-0\",{\"as\":\"strong\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:14:props:node:children:5:children:1:children:0\",\"children\":\"matching orders\"}],\": If the last segment is not deleted but all its orders get consumed, this last segment is not popped out instead just set to \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"bytes32(0)\",\"inline\":true,\"language\":\"text\"}],\" \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"□\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\square \\\\square \\\\square\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.675em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord amsrm\",\"children\":\"□□□\"}]]}]}]]}],\" (\",[\"$\",\"$L44\",\"a-0\",{\"repoId\":\"$undefined\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/SonicOrderBook.sol#L948-L950\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:14:props:node:children:5:children:1:children:6\",\"children\":\"ref\"}],\").\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"$L2f\",\"p-1\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"The invariants broken ❌\",\"position\":{\"start\":{\"line\":163,\"column\":1,\"offset\":9493},\"end\":{\"line\":163,\"column\":24,\"offset\":9516}}}],\"position\":{\"start\":{\"line\":163,\"column\":1,\"offset\":9493},\"end\":{\"line\":163,\"column\":25,\"offset\":9517}}},\"children\":\"The invariants broken ❌\"}],\"\\n\",[\"$\",\"$L37\",\"h2-1\",{\"as\":\"h2\",\"id\":\"recommendation\",\"mb\":\"5\",\"size\":\"xl\",\"node\":{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Recommendation\",\"position\":{\"start\":{\"line\":165,\"column\":4,\"offset\":9522},\"end\":{\"line\":165,\"column\":18,\"offset\":9536}}}],\"position\":{\"start\":{\"line\":165,\"column\":1,\"offset\":9519},\"end\":{\"line\":165,\"column\":18,\"offset\":9536}}},\"children\":\"Recommendation\"}],\"\\n\",[\"$\",\"$L2f\",\"p-2\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Invariant checks after applying the suggested patches:\",\"position\":{\"start\":{\"line\":167,\"column\":1,\"offset\":9538},\"end\":{\"line\":167,\"column\":55,\"offset\":9592}}}],\"position\":{\"start\":{\"line\":167,\"column\":1,\"offset\":9538},\"end\":{\"line\":167,\"column\":55,\"offset\":9592}}},\"children\":\"Invariant checks after applying the suggested patches:\"}],\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\",[\"$\",\"table\",\"table-1\",{\"children\":[[\"$\",\"thead\",\"thead-0\",{\"children\":[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"th\",\"th-0\",{\"children\":\"method\"}],[\"$\",\"th\",\"th-1\",{\"children\":\"Inv 1.\"}],[\"$\",\"th\",\"th-2\",{\"children\":\"Inv 2.\"}],[\"$\",\"th\",\"th-3\",{\"children\":\"Inv 3.\"}],[\"$\",\"th\",\"th-4\",{\"children\":\"Inv 4.\"}],[\"$\",\"th\",\"th-5\",{\"children\":\"Inv 5.\"}],[\"$\",\"th\",\"th-6\",{\"children\":\"Inv 6.\"}],[\"$\",\"th\",\"th-7\",{\"children\":\"Inv 7.\"}],[\"$\",\"th\",\"th-8\",{\"children\":\"Inv. 8\"}],[\"$\",\"th\",\"th-9\",{\"children\":\"Inv. 9\"}],[\"$\",\"th\",\"th-10\",{\"children\":\"Inv 10.\"}]]}]}],[\"$\",\"tbody\",\"tbody-0\",{\"children\":[[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"children\":\"canceling orders\"}],[\"$\",\"td\",\"td-1\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-2\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-3\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-4\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-5\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-6\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-7\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-8\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-9\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-10\",{\"children\":\"✅\"}]]}],[\"$\",\"tr\",\"tr-1\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"children\":\"placing limit orders\"}],[\"$\",\"td\",\"td-1\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-2\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-3\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-4\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-5\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-6\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-7\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-8\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-9\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-10\",{\"children\":\"✅\"}]]}],[\"$\",\"tr\",\"tr-2\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"children\":\"matching orders\"}],[\"$\",\"td\",\"td-1\",{}],[\"$\",\"td\",\"td-2\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-3\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-4\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-5\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-6\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-7\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-8\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-9\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-10\",{\"children\":\"✅\"}]]}]]}]]}],\"\\n\",[\"$\",\"$L37\",\"h3-1\",{\"as\":\"h3\",\"id\":\"matching-orders\",\"mb\":\"4\",\"size\":\"lg\",\"node\":{\"type\":\"element\",\"tagName\":\"h3\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"matching orders\",\"position\":{\"start\":{\"line\":175,\"column\":5,\"offset\":9975},\"end\":{\"line\":175,\"column\":20,\"offset\":9990}}}],\"position\":{\"start\":{\"line\":175,\"column\":1,\"offset\":9971},\"end\":{\"line\":175,\"column\":20,\"offset\":9990}}},\"children\":\"matching orders\"}],\"\\n\",[\"$\",\"$L2f\",\"p-3\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"The fix for \",\"position\":{\"start\":{\"line\":177,\"column\":1,\"offset\":9992},\"end\":{\"line\":177,\"column\":13,\"offset\":10004}}},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://cantina.xyz/code/533c3043-fa7a-4275-8bae-e2313e1b5d18/findings?finding=4\"},\"children\":[{\"type\":\"text\",\"value\":\"#Finding #4\",\"position\":{\"start\":{\"line\":177,\"column\":14,\"offset\":10005},\"end\":{\"line\":177,\"column\":25,\"offset\":10016}}}],\"position\":{\"start\":{\"line\":177,\"column\":13,\"offset\":10004},\"end\":{\"line\":177,\"column\":108,\"offset\":10099}}},{\"type\":\"text\",\"value\":\" needs to be applied as well is:\",\"position\":{\"start\":{\"line\":177,\"column\":108,\"offset\":10099},\"end\":{\"line\":177,\"column\":140,\"offset\":10131}}}],\"position\":{\"start\":{\"line\":177,\"column\":1,\"offset\":9992},\"end\":{\"line\":177,\"column\":140,\"offset\":10131}}},\"children\":[\"The fix for \",[\"$\",\"$L44\",\"a-0\",{\"repoId\":\"$undefined\",\"href\":\"https://cantina.xyz/code/533c3043-fa7a-4275-8bae-e2313e1b5d18/findings?finding=4\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:26:props:node:children:1\",\"children\":\"#Finding #4\"}],\" needs to be applied as well is:\"]}],\"\\n\",[\"$\",\"$L37\",\"h4-0\",{\"as\":\"h4\",\"id\":\"inv-6\",\"mb\":\"3\",\"size\":\"md\",\"node\":{\"type\":\"element\",\"tagName\":\"h4\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Inv 6.\",\"position\":{\"start\":{\"line\":179,\"column\":6,\"offset\":10138},\"end\":{\"line\":179,\"column\":12,\"offset\":10144}}}],\"position\":{\"start\":{\"line\":179,\"column\":1,\"offset\":10133},\"end\":{\"line\":179,\"column\":12,\"offset\":10144}}},\"children\":\"Inv 6.\"}],\"\\n\",[\"$\",\"$L2f\",\"p-4\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Currently the Inv 6. is broken, apply the patch below to fix:\",\"position\":{\"start\":{\"line\":181,\"column\":1,\"offset\":10146},\"end\":{\"line\":181,\"column\":62,\"offset\":10207}}}],\"position\":{\"start\":{\"line\":181,\"column\":1,\"offset\":10146},\"end\":{\"line\":181,\"column\":62,\"offset\":10207}}},\"children\":\"Currently the Inv 6. is broken, apply the patch below to fix:\"}],\"\\n\",[\"$\",\"details\",\"details-0\",{\"children\":[[\"$\",\"summary\",\"summary-0\",{\"children\":\"📝 Click here to view patch\"}],\"\\n\",[\"$\",\"$L45\",\"pre-0\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-diff\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"$55\"}],\"position\":{\"start\":{\"line\":185,\"column\":1,\"offset\":10266},\"end\":{\"line\":418,\"column\":4,\"offset\":22642}}}],\"position\":{\"start\":{\"line\":185,\"column\":1,\"offset\":10266},\"end\":{\"line\":418,\"column\":4,\"offset\":22642}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"$56\",\"inline\":false,\"language\":\"diff\"}]}],[\"$\",\"$L46\",null,{\"content\":\"$57\"}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"$L2f\",\"p-5\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"This patch makes reasoning about other invariants easier due to the modification for \",\"position\":{\"start\":{\"line\":422,\"column\":1,\"offset\":22656},\"end\":{\"line\":422,\"column\":86,\"offset\":22741}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_updateSegmentsAndTree\",\"position\":{\"start\":{\"line\":422,\"column\":86,\"offset\":22741},\"end\":{\"line\":422,\"column\":110,\"offset\":22765}}}],\"position\":{\"start\":{\"line\":422,\"column\":86,\"offset\":22741},\"end\":{\"line\":422,\"column\":110,\"offset\":22765}}},{\"type\":\"text\",\"value\":\".\",\"position\":{\"start\":{\"line\":422,\"column\":110,\"offset\":22765},\"end\":{\"line\":422,\"column\":111,\"offset\":22766}}}],\"position\":{\"start\":{\"line\":422,\"column\":1,\"offset\":22656},\"end\":{\"line\":422,\"column\":111,\"offset\":22766}}},\"children\":[\"This patch makes reasoning about other invariants easier due to the modification for \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"_updateSegmentsAndTree\",\"inline\":true,\"language\":\"text\"}],\".\"]}],\"\\n\",[\"$\",\"details\",\"details-1\",{\"children\":[\"\\n\",[\"$\",\"summary\",\"summary-0\",{\"children\":[\"Modifications of \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"_updateSegmentsAndTree\",\"inline\":true,\"language\":\"text\"}],\" with comments removed\"]}],\"\\n\",[\"$\",\"$L45\",\"pre-0\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-solidity\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"$58\"}],\"position\":{\"start\":{\"line\":428,\"column\":1,\"offset\":22874},\"end\":{\"line\":474,\"column\":4,\"offset\":24612}}}],\"position\":{\"start\":{\"line\":428,\"column\":1,\"offset\":22874},\"end\":{\"line\":474,\"column\":4,\"offset\":24612}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"$59\",\"inline\":false,\"language\":\"solidity\"}]}],[\"$\",\"$L46\",null,{\"content\":\"$5a\"}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"$L45\",\"pre-0\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-solidity\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"  function _updateSegmentsAndTree(...) private {\\n    // ...\\n    if (lastSegmentIndex == newTombstoneSegmentOffset) {\\n      // ...\\n      if (uint256(lastSegment) == 0) {\\n        // ...\\n        newTombstoneSegmentOffset = lastSegmentIndex + 1;\\n        // Branch A\\n      } else {\\n        // ...\\n        segments[lastSegmentIndex] = lastSegment;\\n        // Branch B\\n      }\\n    } else {\\n      require(lastSegmentIndex + 1 == newTombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset());\\n      // Branch C\\n    }\\n\\n    // ...\\n  }\\n\"}],\"position\":{\"start\":{\"line\":478,\"column\":1,\"offset\":24626},\"end\":{\"line\":499,\"column\":4,\"offset\":25189}}}],\"position\":{\"start\":{\"line\":478,\"column\":1,\"offset\":24626},\"end\":{\"line\":499,\"column\":4,\"offset\":25189}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"function _updateSegmentsAndTree(...) private {\\n    // ...\\n    if (lastSegmentIndex == newTombstoneSegmentOffset) {\\n      // ...\\n      if (uint256(lastSegment) == 0) {\\n        // ...\\n        newTombstoneSegmentOffset = lastSegmentIndex + 1;\\n        // Branch A\\n      } else {\\n        // ...\\n        segments[lastSegmentIndex] = lastSegment;\\n        // Branch B\\n      }\\n    } else {\\n      require(lastSegmentIndex + 1 == newTombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset());\\n      // Branch C\\n    }\\n\\n    // ...\\n  }\",\"inline\":false,\"language\":\"solidity\"}]}],[\"$\",\"$L46\",null,{\"content\":\"  function _updateSegmentsAndTree(...) private {\\n    // ...\\n    if (lastSegmentIndex == newTombstoneSegmentOffset) {\\n      // ...\\n      if (uint256(lastSegment) == 0) {\\n        // ...\\n        newTombstoneSegmentOffset = lastSegmentIndex + 1;\\n        // Branch A\\n      } else {\\n        // ...\\n        segments[lastSegmentIndex] = lastSegment;\\n        // Branch B\\n      }\\n    } else {\\n      require(lastSegmentIndex + 1 == newTombstoneSegmentOffset, IncorrectDiffBetweenLastSegmentAndTheNewTombstoneOffset());\\n      // Branch C\\n    }\\n\\n    // ...\\n  }\\n\"}]]}],\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\",[\"$\",\"table\",\"table-2\",{\"children\":[[\"$\",\"thead\",\"thead-0\",{\"children\":[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"th\",\"th-0\",{\"children\":\"method\"}],[\"$\",\"th\",\"th-1\",{\"children\":\"Inv 1.\"}],[\"$\",\"th\",\"th-2\",{\"children\":\"Inv 2.\"}],[\"$\",\"th\",\"th-3\",{\"children\":\"Inv 3.\"}],[\"$\",\"th\",\"th-4\",{\"children\":\"Inv 4.\"}],[\"$\",\"th\",\"th-5\",{\"children\":\"Inv 5.\"}],[\"$\",\"th\",\"th-6\",{\"children\":\"Inv 6.\"}],[\"$\",\"th\",\"th-7\",{\"children\":\"Inv 7.\"}],[\"$\",\"th\",\"th-8\",{\"children\":\"Inv. 8\"}],[\"$\",\"th\",\"th-9\",{\"children\":\"Inv. 9\"}],[\"$\",\"th\",\"th-10\",{\"children\":\"Inv 10.\"}]]}]}],[\"$\",\"tbody\",\"tbody-0\",{\"children\":[[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"children\":\"matching orders (patch above) Branch A\"}],[\"$\",\"td\",\"td-1\",{\"children\":\"🌓\"}],[\"$\",\"td\",\"td-2\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-3\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-4\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-5\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-6\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-7\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-8\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-9\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-10\",{\"children\":\"✅\"}]]}],[\"$\",\"tr\",\"tr-1\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"children\":\"matching orders (patch above) Branch B\"}],[\"$\",\"td\",\"td-1\",{\"children\":\"🌓\"}],[\"$\",\"td\",\"td-2\",{\"children\":\"🌓\"}],[\"$\",\"td\",\"td-3\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-4\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-5\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-6\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-7\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-8\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-9\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-10\",{\"children\":\"✅\"}]]}],[\"$\",\"tr\",\"tr-2\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"children\":\"matching orders (patch above) Branch C\"}],[\"$\",\"td\",\"td-1\",{\"children\":\"🌓\"}],[\"$\",\"td\",\"td-2\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-3\",{\"children\":\"N/A\"}],[\"$\",\"td\",\"td-4\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-5\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-6\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-7\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-8\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-9\",{\"children\":\"✅\"}],[\"$\",\"td\",\"td-10\",{\"children\":\"✅\"}]]}]]}]]}],\"\\n\",[\"$\",\"$L54\",\"ul-2\",{\"node\":{\"type\":\"element\",\"tagName\":\"ul\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"🌓 (Branch A, Inv 1.): If the a hole was about to get introduced it will be ignored. The final price segment would not end up having a hole.\",\"position\":{\"start\":{\"line\":507,\"column\":3,\"offset\":25626},\"end\":{\"line\":507,\"column\":143,\"offset\":25766}}}],\"position\":{\"start\":{\"line\":507,\"column\":1,\"offset\":25624},\"end\":{\"line\":507,\"column\":143,\"offset\":25766}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"🌓 (Branch C, Inv 1.): If the a hole was about to get introduced it will be ignored. The final price segment would not end up having a hole.\",\"position\":{\"start\":{\"line\":508,\"column\":3,\"offset\":25769},\"end\":{\"line\":508,\"column\":143,\"offset\":25909}}}],\"position\":{\"start\":{\"line\":508,\"column\":1,\"offset\":25767},\"end\":{\"line\":508,\"column\":143,\"offset\":25909}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"🌓 (Branch B, Inv 1.): If the a hole was about to get introduced it will be ignored the transaction would revert with \",\"position\":{\"start\":{\"line\":509,\"column\":3,\"offset\":25912},\"end\":{\"line\":509,\"column\":121,\"offset\":26030}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"PriceSegmentHasAHole()\",\"position\":{\"start\":{\"line\":509,\"column\":121,\"offset\":26030},\"end\":{\"line\":509,\"column\":145,\"offset\":26054}}}],\"position\":{\"start\":{\"line\":509,\"column\":121,\"offset\":26030},\"end\":{\"line\":509,\"column\":145,\"offset\":26054}}},{\"type\":\"text\",\"value\":\". One still need to check the upstream flow in \",\"position\":{\"start\":{\"line\":509,\"column\":145,\"offset\":26054},\"end\":{\"line\":509,\"column\":192,\"offset\":26101}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_consumePriceSegments --\u003e loops --\u003e _parseOrder\",\"position\":{\"start\":{\"line\":509,\"column\":192,\"offset\":26101},\"end\":{\"line\":509,\"column\":241,\"offset\":26150}}}],\"position\":{\"start\":{\"line\":509,\"column\":192,\"offset\":26101},\"end\":{\"line\":509,\"column\":241,\"offset\":26150}}},{\"type\":\"text\",\"value\":\" to make sure one would not hit error. The upside is the new approach would prevent price segmements having holes and in case of an error one needs to check the upstream logic.\",\"position\":{\"start\":{\"line\":509,\"column\":241,\"offset\":26150},\"end\":{\"line\":509,\"column\":417,\"offset\":26326}}}],\"position\":{\"start\":{\"line\":509,\"column\":1,\"offset\":25910},\"end\":{\"line\":509,\"column\":417,\"offset\":26326}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":507,\"column\":1,\"offset\":25624},\"end\":{\"line\":509,\"column\":417,\"offset\":26326}}},\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":\"🌓 (Branch A, Inv 1.): If the a hole was about to get introduced it will be ignored. The final price segment would not end up having a hole.\"}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":\"🌓 (Branch C, Inv 1.): If the a hole was about to get introduced it will be ignored. The final price segment would not end up having a hole.\"}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":[\"🌓 (Branch B, Inv 1.): If the a hole was about to get introduced it will be ignored the transaction would revert with \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"PriceSegmentHasAHole()\",\"inline\":true,\"language\":\"text\"}],\". One still need to check the upstream flow in \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"_consumePriceSegments --\u003e loops --\u003e _parseOrder\",\"inline\":true,\"language\":\"text\"}],\" to make sure one would not hit error. The upside is the new approach would prevent price segmements having holes and in case of an error one needs to check the upstream logic.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"$L3b\",\"ol-1\",{\"node\":{\"type\":\"element\",\"tagName\":\"ol\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"One can prove that \",\"position\":{\"start\":{\"line\":511,\"column\":4,\"offset\":26331},\"end\":{\"line\":511,\"column\":23,\"offset\":26350}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_parseOrder\",\"position\":{\"start\":{\"line\":511,\"column\":23,\"offset\":26350},\"end\":{\"line\":511,\"column\":36,\"offset\":26363}}}],\"position\":{\"start\":{\"line\":511,\"column\":23,\"offset\":26350},\"end\":{\"line\":511,\"column\":36,\"offset\":26363}}},{\"type\":\"text\",\"value\":\" preserves the compressed status (ie the shape) of a segment and thus througout the loops in \",\"position\":{\"start\":{\"line\":511,\"column\":36,\"offset\":26363},\"end\":{\"line\":511,\"column\":129,\"offset\":26456}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_consumePriceSegments\",\"position\":{\"start\":{\"line\":511,\"column\":129,\"offset\":26456},\"end\":{\"line\":511,\"column\":152,\"offset\":26479}}}],\"position\":{\"start\":{\"line\":511,\"column\":129,\"offset\":26456},\"end\":{\"line\":511,\"column\":152,\"offset\":26479}}},{\"type\":\"text\",\"value\":\" up to the point were one enters \",\"position\":{\"start\":{\"line\":511,\"column\":152,\"offset\":26479},\"end\":{\"line\":511,\"column\":185,\"offset\":26512}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_updateSegmentsAndTree\",\"position\":{\"start\":{\"line\":511,\"column\":185,\"offset\":26512},\"end\":{\"line\":511,\"column\":209,\"offset\":26536}}}],\"position\":{\"start\":{\"line\":511,\"column\":185,\"offset\":26512},\"end\":{\"line\":511,\"column\":209,\"offset\":26536}}},{\"type\":\"text\",\"value\":\" the compressed status (the shape) if the price segment stays the same. Thus the shapes used for invariants 1, 2, 5, 6, 8, 9 are not modified while parsing through the price segment slots.\",\"position\":{\"start\":{\"line\":511,\"column\":209,\"offset\":26536},\"end\":{\"line\":511,\"column\":397,\"offset\":26724}}}],\"position\":{\"start\":{\"line\":511,\"column\":4,\"offset\":26331},\"end\":{\"line\":511,\"column\":397,\"offset\":26724}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":511,\"column\":1,\"offset\":26328},\"end\":{\"line\":511,\"column\":397,\"offset\":26724}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"In this whole flow it is important that once one partially matches a slot, the loops should terminate and the paramters \",\"position\":{\"start\":{\"line\":513,\"column\":4,\"offset\":26729},\"end\":{\"line\":513,\"column\":124,\"offset\":26849}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"numOrdersFullyConsumed\",\"position\":{\"start\":{\"line\":513,\"column\":124,\"offset\":26849},\"end\":{\"line\":513,\"column\":148,\"offset\":26873}}}],\"position\":{\"start\":{\"line\":513,\"column\":124,\"offset\":26849},\"end\":{\"line\":513,\"column\":148,\"offset\":26873}}},{\"type\":\"text\",\"value\":\", \",\"position\":{\"start\":{\"line\":513,\"column\":148,\"offset\":26873},\"end\":{\"line\":513,\"column\":150,\"offset\":26875}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"segment\",\"position\":{\"start\":{\"line\":513,\"column\":150,\"offset\":26875},\"end\":{\"line\":513,\"column\":159,\"offset\":26884}}}],\"position\":{\"start\":{\"line\":513,\"column\":150,\"offset\":26875},\"end\":{\"line\":513,\"column\":159,\"offset\":26884}}},{\"type\":\"text\",\"value\":\" and \",\"position\":{\"start\":{\"line\":513,\"column\":159,\"offset\":26884},\"end\":{\"line\":513,\"column\":164,\"offset\":26889}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"lastConsumedSegmentIndex\",\"position\":{\"start\":{\"line\":513,\"column\":164,\"offset\":26889},\"end\":{\"line\":513,\"column\":190,\"offset\":26915}}}],\"position\":{\"start\":{\"line\":513,\"column\":164,\"offset\":26889},\"end\":{\"line\":513,\"column\":190,\"offset\":26915}}},{\"type\":\"text\",\"value\":\" should not change after this point on (🚨).\",\"position\":{\"start\":{\"line\":513,\"column\":190,\"offset\":26915},\"end\":{\"line\":513,\"column\":234,\"offset\":26959}}}],\"position\":{\"start\":{\"line\":513,\"column\":4,\"offset\":26729},\"end\":{\"line\":513,\"column\":234,\"offset\":26959}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Checking and proving the above points 1. and 2. should prove that \",\"position\":{\"start\":{\"line\":515,\"column\":5,\"offset\":26965},\"end\":{\"line\":515,\"column\":71,\"offset\":27031}}},{\"type\":\"element\",\"tagName\":\"strong\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"invariant 1\",\"position\":{\"start\":{\"line\":515,\"column\":73,\"offset\":27033},\"end\":{\"line\":515,\"column\":84,\"offset\":27044}}}],\"position\":{\"start\":{\"line\":515,\"column\":71,\"offset\":27031},\"end\":{\"line\":515,\"column\":86,\"offset\":27046}}},{\"type\":\"text\",\"value\":\" is satisfied for the matching order flow (before and after jumping in \",\"position\":{\"start\":{\"line\":515,\"column\":86,\"offset\":27046},\"end\":{\"line\":515,\"column\":157,\"offset\":27117}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_updateSegmentsAndTree\",\"position\":{\"start\":{\"line\":515,\"column\":157,\"offset\":27117},\"end\":{\"line\":515,\"column\":181,\"offset\":27141}}}],\"position\":{\"start\":{\"line\":515,\"column\":157,\"offset\":27117},\"end\":{\"line\":515,\"column\":181,\"offset\":27141}}},{\"type\":\"text\",\"value\":\").\",\"position\":{\"start\":{\"line\":515,\"column\":181,\"offset\":27141},\"end\":{\"line\":515,\"column\":183,\"offset\":27143}}}],\"position\":{\"start\":{\"line\":515,\"column\":5,\"offset\":26965},\"end\":{\"line\":515,\"column\":183,\"offset\":27143}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":513,\"column\":1,\"offset\":26726},\"end\":{\"line\":515,\"column\":183,\"offset\":27143}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":511,\"column\":1,\"offset\":26328},\"end\":{\"line\":515,\"column\":183,\"offset\":27143}}},\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:44:props:node:children:1:children:1\",\"children\":[\"One can prove that \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"_parseOrder\",\"inline\":true,\"language\":\"text\"}],\" preserves the compressed status (ie the shape) of a segment and thus througout the loops in \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"_consumePriceSegments\",\"inline\":true,\"language\":\"text\"}],\" up to the point were one enters \",[\"$\",\"$L43\",\"code-2\",{\"code\":\"_updateSegmentsAndTree\",\"inline\":true,\"language\":\"text\"}],\" the compressed status (the shape) if the price segment stays the same. Thus the shapes used for invariants 1, 2, 5, 6, 8, 9 are not modified while parsing through the price segment slots.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:44:props:node:children:3:children:1\",\"children\":[\"In this whole flow it is important that once one partially matches a slot, the loops should terminate and the paramters \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"numOrdersFullyConsumed\",\"inline\":true,\"language\":\"text\"}],\", \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"segment\",\"inline\":true,\"language\":\"text\"}],\" and \",[\"$\",\"$L43\",\"code-2\",{\"code\":\"lastConsumedSegmentIndex\",\"inline\":true,\"language\":\"text\"}],\" should not change after this point on (🚨).\"]}],\"\\n\",[\"$\",\"$L2f\",\"p-1\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:44:props:node:children:3:children:3\",\"children\":[\"Checking and proving the above points 1. and 2. should prove that \",[\"$\",\"$L2f\",\"strong-0\",{\"as\":\"strong\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:44:props:node:children:3:children:3:children:1\",\"children\":\"invariant 1\"}],\" is satisfied for the matching order flow (before and after jumping in \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"_updateSegmentsAndTree\",\"inline\":true,\"language\":\"text\"}],\").\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"$L54\",\"ul-3\",{\"node\":{\"type\":\"element\",\"tagName\":\"ul\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"🌓 (Branch B, Inv 2.): \",\"position\":{\"start\":{\"line\":517,\"column\":3,\"offset\":27147},\"end\":{\"line\":517,\"column\":26,\"offset\":27170}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_parseOrder\",\"position\":{\"start\":{\"line\":517,\"column\":26,\"offset\":27170},\"end\":{\"line\":517,\"column\":39,\"offset\":27183}}}],\"position\":{\"start\":{\"line\":517,\"column\":26,\"offset\":27170},\"end\":{\"line\":517,\"column\":39,\"offset\":27183}}},{\"type\":\"text\",\"value\":\" needs to be verified to not break this invariant. It has already been checked that the slot being parsed in \",\"position\":{\"start\":{\"line\":517,\"column\":39,\"offset\":27183},\"end\":{\"line\":517,\"column\":148,\"offset\":27292}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_parseOrder\",\"position\":{\"start\":{\"line\":517,\"column\":148,\"offset\":27292},\"end\":{\"line\":517,\"column\":161,\"offset\":27305}}}],\"position\":{\"start\":{\"line\":517,\"column\":148,\"offset\":27292},\"end\":{\"line\":517,\"column\":161,\"offset\":27305}}},{\"type\":\"text\",\"value\":\" has a non-zero \",\"position\":{\"start\":{\"line\":517,\"column\":161,\"offset\":27305},\"end\":{\"line\":517,\"column\":177,\"offset\":27321}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"orderId\",\"position\":{\"start\":{\"line\":517,\"column\":177,\"offset\":27321},\"end\":{\"line\":517,\"column\":186,\"offset\":27330}}}],\"position\":{\"start\":{\"line\":517,\"column\":177,\"offset\":27321},\"end\":{\"line\":517,\"column\":186,\"offset\":27330}}},{\"type\":\"text\",\"value\":\" before \",\"position\":{\"start\":{\"line\":517,\"column\":186,\"offset\":27330},\"end\":{\"line\":517,\"column\":194,\"offset\":27338}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_parseOrder\",\"position\":{\"start\":{\"line\":517,\"column\":194,\"offset\":27338},\"end\":{\"line\":517,\"column\":207,\"offset\":27351}}}],\"position\":{\"start\":{\"line\":517,\"column\":194,\"offset\":27338},\"end\":{\"line\":517,\"column\":207,\"offset\":27351}}},{\"type\":\"text\",\"value\":\" gets called. So we just need to make sure the normalised quantity does not end up being \",\"position\":{\"start\":{\"line\":517,\"column\":207,\"offset\":27351},\"end\":{\"line\":517,\"column\":296,\"offset\":27440}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6444em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]}]}]},{\"type\":\"text\",\"value\":\" for this slot (✅ proof below).\",\"position\":{\"start\":{\"line\":517,\"column\":299,\"offset\":27443},\"end\":{\"line\":517,\"column\":330,\"offset\":27474}}}],\"position\":{\"start\":{\"line\":517,\"column\":1,\"offset\":27145},\"end\":{\"line\":517,\"column\":330,\"offset\":27474}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":517,\"column\":1,\"offset\":27145},\"end\":{\"line\":517,\"column\":330,\"offset\":27474}}},\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[\"🌓 (Branch B, Inv 2.): \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"_parseOrder\",\"inline\":true,\"language\":\"text\"}],\" needs to be verified to not break this invariant. It has already been checked that the slot being parsed in \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"_parseOrder\",\"inline\":true,\"language\":\"text\"}],\" has a non-zero \",[\"$\",\"$L43\",\"code-2\",{\"code\":\"orderId\",\"inline\":true,\"language\":\"text\"}],\" before \",[\"$\",\"$L43\",\"code-3\",{\"code\":\"_parseOrder\",\"inline\":true,\"language\":\"text\"}],\" gets called. So we just need to make sure the normalised quantity does not end up being \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mn\",\"mn-0\",{\"children\":\"0\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"0\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"0\"}]]}]}]]}],\" for this slot (✅ proof below).\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"$L37\",\"h5-0\",{\"as\":\"h5\",\"id\":\"case-1-budget-constrained-buy-market-orders\",\"mb\":\"2\",\"size\":\"sm\",\"node\":{\"type\":\"element\",\"tagName\":\"h5\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Case 1. budget-constrained buy market orders\",\"position\":{\"start\":{\"line\":519,\"column\":7,\"offset\":27482},\"end\":{\"line\":519,\"column\":51,\"offset\":27526}}}],\"position\":{\"start\":{\"line\":519,\"column\":1,\"offset\":27476},\"end\":{\"line\":519,\"column\":51,\"offset\":27526}}},\"children\":\"Case 1. budget-constrained buy market orders\"}],\"\\n\",[\"$\",\"span\",\"span-1\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"0\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"\u003c\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"q\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"n\"}]]}],[\"$\",\"mo\",\"mo-2\",{\"stretchy\":\"false\",\"children\":\")\"}],[\"$\",\"mo\",\"mo-3\",{\"children\":\"∧\"}],[\"$\",\"mo\",\"mo-4\",{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"msub\",\"msub-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"c\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"r\"}]]}],[\"$\",\"mo\",\"mo-5\",{\"children\":\"\u003c\"}],[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"fence\":\"true\",\"children\":\"⌊\"}],[\"$\",\"mfrac\",\"mfrac-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"q\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"n\"}]]}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋅\"}],[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"Δ\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"q\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"⋅\"}],[\"$\",\"msub\",\"msub-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"p\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"b\"}]]}]]}],[\"$\",\"msup\",\"msup-0\",{\"children\":[[\"$\",\"mn\",\"mn-0\",{\"children\":\"10\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"d\"}]]}]]}],[\"$\",\"mo\",\"mo-1\",{\"fence\":\"true\",\"children\":\"⌋\"}]]}],[\"$\",\"mo\",\"mo-6\",{\"stretchy\":\"false\",\"children\":\")\"}],[\"$\",\"mo\",\"mo-7\",{\"children\":\"⇒\"}],[\"$\",\"msub\",\"msub-2\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"q\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"n\"}]]}],[\"$\",\"mo\",\"mo-8\",{\"children\":\"−\"}],[\"$\",\"mrow\",\"mrow-1\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"fence\":\"true\",\"children\":\"⌊\"}],[\"$\",\"mfrac\",\"mfrac-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"fence\":\"true\",\"children\":\"⌊\"}],[\"$\",\"mfrac\",\"mfrac-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"c\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"r\"}]]}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋅\"}],[\"$\",\"msup\",\"msup-0\",{\"children\":[[\"$\",\"mn\",\"mn-0\",{\"children\":\"10\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"d\"}]]}]]}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"p\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"b\"}]]}]]}],[\"$\",\"mo\",\"mo-1\",{\"fence\":\"true\",\"children\":\"⌋\"}]]}],[\"$\",\"mrow\",\"mrow-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"Δ\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"q\"}]]}]]}],[\"$\",\"mo\",\"mo-1\",{\"fence\":\"true\",\"children\":\"⌋\"}]]}],[\"$\",\"mo\",\"mo-9\",{\"children\":\"\u003e\"}],[\"$\",\"mn\",\"mn-1\",{\"children\":\"0\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"(0 \u003c q_n) \\\\land (c_r \u003c \\\\left\\\\lfloor \\\\frac{q_n \\\\cdot \\\\Delta q \\\\cdot p_b}{10^d} \\\\right\\\\rfloor)\\n\\\\Rightarrow \\nq_n - \\\\left\\\\lfloor \\\\frac{\\n    \\\\left\\\\lfloor \\\\frac{c_r \\\\cdot 10^{d}}{p_b} \\\\right\\\\rfloor\\n}{\\\\Delta q} \\\\right\\\\rfloor \u003e 0\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-0.25em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord\",\"children\":\"0\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mrel\",\"children\":\"\u003c\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-0.25em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.0359em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"n\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose\",\"children\":\")\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mbin\",\"children\":\"∧\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-0.25em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"c\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.02778em\"},\"children\":\"r\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mrel\",\"children\":\"\u003c\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-3\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"2.4em\",\"verticalAlign\":\"-0.95em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"minner\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size3\",\"children\":\"⌊\"}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen nulldelimiter\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mfrac\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.3603em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.314em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"1\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"0\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.7751em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.989em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}]}]]}]}]}]}]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.23em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"frac-line\",\"style\":{\"borderBottomWidth\":\"0.04em\"}}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-3.677em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.0359em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"n\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mbin\",\"children\":\"⋅\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord\",\"children\":\"Δ\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-6\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-7\",{\"className\":\"mbin\",\"children\":\"⋅\"}],[\"$\",\"span\",\"span-8\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-9\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"p\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3361em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"b\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.686em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose nulldelimiter\"}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size3\",\"children\":\"⌋\"}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose\",\"children\":\")\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mrel\",\"children\":\"⇒\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-4\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.7778em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.0359em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"n\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mbin\",\"children\":\"−\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}]]}],[\"$\",\"span\",\"span-5\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"3.74em\",\"verticalAlign\":\"-1.55em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"minner\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing mult\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"2.05em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-4.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"5.6em\"}}],[\"$\",\"span\",\"span-1\",{\"style\":{\"width\":\"0.667em\",\"height\":\"3.600em\"},\"children\":[\"$\",\"svg\",\"svg-0\",{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"0.667em\",\"height\":\"3.600em\",\"viewBox\":\"0 0 667 3600\",\"children\":[\"$\",\"path\",\"path-0\",{\"d\":\"M319 602 V0 H403 V602 v1200 v1715 h263 v84 H319z\\nMM319 602 V0 H403 V602 v1200 v1715 H319z\"}]}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.55em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen nulldelimiter\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mfrac\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"2.19em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.464em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"Δ\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}]]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.38em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"frac-line\",\"style\":{\"borderBottomWidth\":\"0.04em\"}}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-4.19em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"minner\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size2\",\"children\":\"⌊\"}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen nulldelimiter\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mfrac\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.059em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.655em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"p\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3448em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.3488em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.0714em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size3 size1 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"b\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1512em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]}]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.23em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"frac-line\",\"style\":{\"borderBottomWidth\":\"0.04em\"}}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-3.4101em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"c\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1645em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.357em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.0714em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size3 size1 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.02778em\"},\"children\":\"r\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.143em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mbin mtight\",\"children\":\"⋅\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord mtight\",\"children\":\"1\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":\"0\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.927em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.931em\",\"marginRight\":\"0.0714em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size3 size1 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}]}]}]]}]}]}]}]}]]}]]}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.4811em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose nulldelimiter\"}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size2\",\"children\":\"⌋\"}]}]]}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.8804em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose nulldelimiter\"}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing mult\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"2.05em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-4.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"5.6em\"}}],[\"$\",\"span\",\"span-1\",{\"style\":{\"width\":\"0.667em\",\"height\":\"3.600em\"},\"children\":[\"$\",\"svg\",\"svg-0\",{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"0.667em\",\"height\":\"3.600em\",\"viewBox\":\"0 0 667 3600\",\"children\":[\"$\",\"path\",\"path-0\",{\"d\":\"M319 602 V0 H403 V602 v1200 v1799 H0 v-84 H319z\\nMM319 602 V0 H403 V602 v1200 v1715 H319z\"}]}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.55em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":\"\u003e\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-6\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"0\"}]]}]]}]]}]}],\"\\n\",[\"$\",\"$L2f\",\"p-6\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"One can prove:\",\"position\":{\"start\":{\"line\":529,\"column\":1,\"offset\":27757},\"end\":{\"line\":529,\"column\":15,\"offset\":27771}}}],\"position\":{\"start\":{\"line\":529,\"column\":1,\"offset\":27757},\"end\":{\"line\":529,\"column\":15,\"offset\":27771}}},\"children\":\"One can prove:\"}],\"\\n\",[\"$\",\"span\",\"span-2\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mn\",\"mn-0\",{\"children\":\"0\"}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"≤\"}],[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"fence\":\"true\",\"children\":\"(\"}],[\"$\",\"mfrac\",\"mfrac-0\",{\"children\":[[\"$\",\"msup\",\"msup-0\",{\"children\":[[\"$\",\"mn\",\"mn-0\",{\"children\":\"10\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"d\"}]]}],[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"Δ\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"q\"}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋅\"}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"p\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"b\"}]]}]]}]]}],[\"$\",\"mo\",\"mo-1\",{\"fence\":\"true\",\"children\":\")\"}]]}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"ϵ\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"0\"}]]}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"+\"}],[\"$\",\"mrow\",\"mrow-1\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"fence\":\"true\",\"children\":\"(\"}],[\"$\",\"mfrac\",\"mfrac-0\",{\"children\":[[\"$\",\"mn\",\"mn-0\",{\"children\":\"1\"}],[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"Δ\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"q\"}]]}]]}],[\"$\",\"mo\",\"mo-1\",{\"fence\":\"true\",\"children\":\")\"}]]}],[\"$\",\"msub\",\"msub-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"ϵ\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"1\"}]]}],[\"$\",\"mo\",\"mo-2\",{\"children\":\"+\"}],[\"$\",\"msub\",\"msub-2\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"ϵ\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"2\"}]]}],[\"$\",\"mo\",\"mo-3\",{\"children\":\"\u003c\"}],[\"$\",\"msub\",\"msub-3\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"q\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"n\"}]]}],[\"$\",\"mo\",\"mo-4\",{\"children\":\"−\"}],[\"$\",\"mrow\",\"mrow-2\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"fence\":\"true\",\"children\":\"⌊\"}],[\"$\",\"mfrac\",\"mfrac-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"fence\":\"true\",\"children\":\"⌊\"}],[\"$\",\"mfrac\",\"mfrac-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"c\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"r\"}]]}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋅\"}],[\"$\",\"msup\",\"msup-0\",{\"children\":[[\"$\",\"mn\",\"mn-0\",{\"children\":\"10\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"d\"}]]}]]}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"p\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"b\"}]]}]]}],[\"$\",\"mo\",\"mo-1\",{\"fence\":\"true\",\"children\":\"⌋\"}]]}],[\"$\",\"mrow\",\"mrow-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"Δ\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"q\"}]]}]]}],[\"$\",\"mo\",\"mo-1\",{\"fence\":\"true\",\"children\":\"⌋\"}]]}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"0 \\\\leq \\n\\\\left(\\\\frac{10^d}{\\\\Delta q \\\\cdot p_b}\\\\right)\\\\epsilon_0 +\\n\\\\left(\\\\frac{1}{\\\\Delta q}\\\\right)\\\\epsilon_1 +\\n\\\\epsilon_2 \u003c\\n\\nq_n - \\\\left\\\\lfloor \\\\frac{\\n    \\\\left\\\\lfloor \\\\frac{c_r \\\\cdot 10^{d}}{p_b} \\\\right\\\\rfloor\\n}{\\\\Delta q} \\\\right\\\\rfloor\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.7804em\",\"verticalAlign\":\"-0.136em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"0\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":\"≤\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"2.4761em\",\"verticalAlign\":\"-0.95em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"minner\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size3\",\"children\":\"(\"}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen nulldelimiter\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mfrac\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.5261em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.314em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"Δ\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mbin\",\"children\":\"⋅\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-5\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"p\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3361em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"b\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.23em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"frac-line\",\"style\":{\"borderBottomWidth\":\"0.04em\"}}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-3.677em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"1\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"0\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.8491em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-3.063em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}]}]]}]}]}]}]}]]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.8804em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose nulldelimiter\"}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size3\",\"children\":\")\"}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"ϵ\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3011em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":\"0\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-5\",{\"className\":\"mbin\",\"children\":\"+\"}],[\"$\",\"span\",\"span-6\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"2.4em\",\"verticalAlign\":\"-0.95em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"minner\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size3\",\"children\":\"(\"}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen nulldelimiter\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mfrac\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.3214em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.314em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"Δ\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}]]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.23em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"frac-line\",\"style\":{\"borderBottomWidth\":\"0.04em\"}}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-3.677em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"1\"}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.8804em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose nulldelimiter\"}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size3\",\"children\":\")\"}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"ϵ\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3011em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":\"1\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-5\",{\"className\":\"mbin\",\"children\":\"+\"}],[\"$\",\"span\",\"span-6\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}]]}],[\"$\",\"span\",\"span-3\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6891em\",\"verticalAlign\":\"-0.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"ϵ\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3011em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":\"2\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":\"\u003c\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-4\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.7778em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.0359em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"n\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mbin\",\"children\":\"−\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}]]}],[\"$\",\"span\",\"span-5\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"3.74em\",\"verticalAlign\":\"-1.55em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"minner\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing mult\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"2.05em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-4.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"5.6em\"}}],[\"$\",\"span\",\"span-1\",{\"style\":{\"width\":\"0.667em\",\"height\":\"3.600em\"},\"children\":[\"$\",\"svg\",\"svg-0\",{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"0.667em\",\"height\":\"3.600em\",\"viewBox\":\"0 0 667 3600\",\"children\":[\"$\",\"path\",\"path-0\",{\"d\":\"M319 602 V0 H403 V602 v1200 v1715 h263 v84 H319z\\nMM319 602 V0 H403 V602 v1200 v1715 H319z\"}]}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.55em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen nulldelimiter\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mfrac\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"2.19em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.464em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"Δ\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}]]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.38em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"frac-line\",\"style\":{\"borderBottomWidth\":\"0.04em\"}}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-4.19em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"minner\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size2\",\"children\":\"⌊\"}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen nulldelimiter\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mfrac\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.059em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.655em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"p\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3448em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.3488em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.0714em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size3 size1 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"b\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1512em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]}]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.23em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"frac-line\",\"style\":{\"borderBottomWidth\":\"0.04em\"}}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-3.4101em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"c\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1645em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.357em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.0714em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size3 size1 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.02778em\"},\"children\":\"r\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.143em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mbin mtight\",\"children\":\"⋅\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord mtight\",\"children\":\"1\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mord mtight\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":\"0\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.927em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.931em\",\"marginRight\":\"0.0714em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.5em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size3 size1 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}]}]}]]}]}]}]}]}]]}]]}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.4811em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose nulldelimiter\"}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size2\",\"children\":\"⌋\"}]}]]}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.8804em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose nulldelimiter\"}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing mult\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"2.05em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-4.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"5.6em\"}}],[\"$\",\"span\",\"span-1\",{\"style\":{\"width\":\"0.667em\",\"height\":\"3.600em\"},\"children\":[\"$\",\"svg\",\"svg-0\",{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"0.667em\",\"height\":\"3.600em\",\"viewBox\":\"0 0 667 3600\",\"children\":[\"$\",\"path\",\"path-0\",{\"d\":\"M319 602 V0 H403 V602 v1200 v1799 H0 v-84 H319z\\nMM319 602 V0 H403 V602 v1200 v1715 H319z\"}]}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.55em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]}]]}]]}]]}]]}]}],\"\\n\",[\"$\",\"$L2f\",\"p-7\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"where \",\"position\":{\"start\":{\"line\":542,\"column\":1,\"offset\":28015},\"end\":{\"line\":542,\"column\":7,\"offset\":28021}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"ϵ\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{\"separator\":\"true\"},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"ϵ\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{\"separator\":\"true\"},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"ϵ\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"∈\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{\"stretchy\":\"false\"},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{\"separator\":\"true\"},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{\"stretchy\":\"false\"},\"children\":[{\"type\":\"text\",\"value\":\")\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\epsilon_0, \\\\epsilon_1, \\\\epsilon_2 \\\\in [0,1)\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.7335em;vertical-align:-0.1944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"ϵ\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.3011em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mpunct\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.1667em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"ϵ\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.3011em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mpunct\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.1667em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"ϵ\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.3011em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"2\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"text\",\"value\":\"∈\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:1em;vertical-align:-0.25em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mopen\"]},\"children\":[{\"type\":\"text\",\"value\":\"[\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mpunct\"]},\"children\":[{\"type\":\"text\",\"value\":\",\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.1667em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mclose\"]},\"children\":[{\"type\":\"text\",\"value\":\")\"}]}]}]}]}],\"position\":{\"start\":{\"line\":542,\"column\":1,\"offset\":28015},\"end\":{\"line\":542,\"column\":53,\"offset\":28067}}},\"children\":[\"where \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"ϵ\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"0\"}]]}],[\"$\",\"mo\",\"mo-0\",{\"separator\":\"true\",\"children\":\",\"}],[\"$\",\"msub\",\"msub-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"ϵ\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"1\"}]]}],[\"$\",\"mo\",\"mo-1\",{\"separator\":\"true\",\"children\":\",\"}],[\"$\",\"msub\",\"msub-2\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"ϵ\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"2\"}]]}],[\"$\",\"mo\",\"mo-2\",{\"children\":\"∈\"}],[\"$\",\"mo\",\"mo-3\",{\"stretchy\":\"false\",\"children\":\"[\"}],[\"$\",\"mn\",\"mn-0\",{\"children\":\"0\"}],[\"$\",\"mo\",\"mo-4\",{\"separator\":\"true\",\"children\":\",\"}],[\"$\",\"mn\",\"mn-1\",{\"children\":\"1\"}],[\"$\",\"mo\",\"mo-5\",{\"stretchy\":\"false\",\"children\":\")\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\epsilon_0, \\\\epsilon_1, \\\\epsilon_2 \\\\in [0,1)\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.7335em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"ϵ\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3011em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":\"0\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mpunct\",\"children\":\",\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"ϵ\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3011em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":\"1\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-5\",{\"className\":\"mpunct\",\"children\":\",\"}],[\"$\",\"span\",\"span-6\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-7\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"ϵ\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3011em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":\"2\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-8\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-9\",{\"className\":\"mrel\",\"children\":\"∈\"}],[\"$\",\"span\",\"span-10\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"1em\",\"verticalAlign\":\"-0.25em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mopen\",\"children\":\"[\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord\",\"children\":\"0\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mpunct\",\"children\":\",\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-5\",{\"className\":\"mord\",\"children\":\"1\"}],[\"$\",\"span\",\"span-6\",{\"className\":\"mclose\",\"children\":\")\"}]]}]]}]]}]]}],\"\\n\",[\"$\",\"$L37\",\"h5-1\",{\"as\":\"h5\",\"id\":\"case-2-all-other-cases\",\"mb\":\"2\",\"size\":\"sm\",\"node\":{\"type\":\"element\",\"tagName\":\"h5\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"case 2. all other cases\",\"position\":{\"start\":{\"line\":544,\"column\":7,\"offset\":28075},\"end\":{\"line\":544,\"column\":30,\"offset\":28098}}}],\"position\":{\"start\":{\"line\":544,\"column\":1,\"offset\":28069},\"end\":{\"line\":544,\"column\":30,\"offset\":28098}}},\"children\":\"case 2. all other cases\"}],\"\\n\",[\"$\",\"$L2f\",\"p-8\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"This is obvious based on \",\"position\":{\"start\":{\"line\":546,\"column\":1,\"offset\":28100},\"end\":{\"line\":546,\"column\":26,\"offset\":28125}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"if\",\"position\":{\"start\":{\"line\":546,\"column\":26,\"offset\":28125},\"end\":{\"line\":546,\"column\":30,\"offset\":28129}}}],\"position\":{\"start\":{\"line\":546,\"column\":26,\"offset\":28125},\"end\":{\"line\":546,\"column\":30,\"offset\":28129}}},{\"type\":\"text\",\"value\":\"/\",\"position\":{\"start\":{\"line\":546,\"column\":30,\"offset\":28129},\"end\":{\"line\":546,\"column\":31,\"offset\":28130}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"else\",\"position\":{\"start\":{\"line\":546,\"column\":31,\"offset\":28130},\"end\":{\"line\":546,\"column\":37,\"offset\":28136}}}],\"position\":{\"start\":{\"line\":546,\"column\":31,\"offset\":28130},\"end\":{\"line\":546,\"column\":37,\"offset\":28136}}},{\"type\":\"text\",\"value\":\" branch conditions.\",\"position\":{\"start\":{\"line\":546,\"column\":37,\"offset\":28136},\"end\":{\"line\":546,\"column\":56,\"offset\":28155}}}],\"position\":{\"start\":{\"line\":546,\"column\":1,\"offset\":28100},\"end\":{\"line\":546,\"column\":56,\"offset\":28155}}},\"children\":[\"This is obvious based on \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"if\",\"inline\":true,\"language\":\"text\"}],\"/\",[\"$\",\"$L43\",\"code-1\",{\"code\":\"else\",\"inline\":true,\"language\":\"text\"}],\" branch conditions.\"]}],\"\\n\",[\"$\",\"$L37\",\"h3-2\",{\"as\":\"h3\",\"id\":\"canceling-orders\",\"mb\":\"4\",\"size\":\"lg\",\"node\":{\"type\":\"element\",\"tagName\":\"h3\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"canceling orders\",\"position\":{\"start\":{\"line\":549,\"column\":5,\"offset\":28162},\"end\":{\"line\":549,\"column\":21,\"offset\":28178}}}],\"position\":{\"start\":{\"line\":549,\"column\":1,\"offset\":28158},\"end\":{\"line\":549,\"column\":21,\"offset\":28178}}},\"children\":\"canceling orders\"}],\"\\n\",[\"$\",\"$L2f\",\"p-9\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Applying the recommendation in \",\"position\":{\"start\":{\"line\":551,\"column\":1,\"offset\":28180},\"end\":{\"line\":551,\"column\":32,\"offset\":28211}}},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://cantina.xyz/code/533c3043-fa7a-4275-8bae-e2313e1b5d18/findings?finding=1\"},\"children\":[{\"type\":\"text\",\"value\":\"Finding #1\",\"position\":{\"start\":{\"line\":551,\"column\":33,\"offset\":28212},\"end\":{\"line\":551,\"column\":43,\"offset\":28222}}}],\"position\":{\"start\":{\"line\":551,\"column\":32,\"offset\":28211},\"end\":{\"line\":551,\"column\":126,\"offset\":28305}}},{\"type\":\"text\",\"value\":\" is recommended.\",\"position\":{\"start\":{\"line\":551,\"column\":126,\"offset\":28305},\"end\":{\"line\":551,\"column\":142,\"offset\":28321}}}],\"position\":{\"start\":{\"line\":551,\"column\":1,\"offset\":28180},\"end\":{\"line\":551,\"column\":142,\"offset\":28321}}},\"children\":[\"Applying the recommendation in \",[\"$\",\"$L44\",\"a-0\",{\"repoId\":\"$undefined\",\"href\":\"https://cantina.xyz/code/533c3043-fa7a-4275-8bae-e2313e1b5d18/findings?finding=1\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:1:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:64:props:node:children:1\",\"children\":\"Finding #1\"}],\" is recommended.\"]}],\"\\n\",[\"$\",\"$L37\",\"h2-2\",{\"as\":\"h2\",\"id\":\"summary\",\"mb\":\"5\",\"size\":\"xl\",\"node\":{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Summary\",\"position\":{\"start\":{\"line\":553,\"column\":4,\"offset\":28326},\"end\":{\"line\":553,\"column\":11,\"offset\":28333}}}],\"position\":{\"start\":{\"line\":553,\"column\":1,\"offset\":28323},\"end\":{\"line\":553,\"column\":11,\"offset\":28333}}},\"children\":\"Summary\"}],\"\\n\",[\"$\",\"$L2f\",\"p-10\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Apply the following patch. This would cover the changes required for:\",\"position\":{\"start\":{\"line\":555,\"column\":1,\"offset\":28335},\"end\":{\"line\":555,\"column\":70,\"offset\":28404}}}],\"position\":{\"start\":{\"line\":555,\"column\":1,\"offset\":28335},\"end\":{\"line\":555,\"column\":70,\"offset\":28404}}},\"children\":\"Apply the following patch. This would cover the changes required for:\"}],\"\\n\",[\"$\",\"$L54\",\"ul-4\",{\"node\":{\"type\":\"element\",\"tagName\":\"ul\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Finding 1\",\"position\":{\"start\":{\"line\":557,\"column\":3,\"offset\":28408},\"end\":{\"line\":557,\"column\":12,\"offset\":28417}}}],\"position\":{\"start\":{\"line\":557,\"column\":1,\"offset\":28406},\"end\":{\"line\":557,\"column\":12,\"offset\":28417}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Finding 2\",\"position\":{\"start\":{\"line\":558,\"column\":3,\"offset\":28420},\"end\":{\"line\":558,\"column\":12,\"offset\":28429}}}],\"position\":{\"start\":{\"line\":558,\"column\":1,\"offset\":28418},\"end\":{\"line\":558,\"column\":12,\"offset\":28429}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Finding 3\",\"position\":{\"start\":{\"line\":559,\"column\":3,\"offset\":28432},\"end\":{\"line\":559,\"column\":12,\"offset\":28441}}}],\"position\":{\"start\":{\"line\":559,\"column\":1,\"offset\":28430},\"end\":{\"line\":559,\"column\":12,\"offset\":28441}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Finding 5 (make sure price ticks are multiple of 100)\",\"position\":{\"start\":{\"line\":560,\"column\":3,\"offset\":28444},\"end\":{\"line\":560,\"column\":56,\"offset\":28497}}}],\"position\":{\"start\":{\"line\":560,\"column\":1,\"offset\":28442},\"end\":{\"line\":560,\"column\":56,\"offset\":28497}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Finding 6 (patch above plus some improvements)\",\"position\":{\"start\":{\"line\":561,\"column\":3,\"offset\":28500},\"end\":{\"line\":561,\"column\":49,\"offset\":28546}}}],\"position\":{\"start\":{\"line\":561,\"column\":1,\"offset\":28498},\"end\":{\"line\":561,\"column\":49,\"offset\":28546}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Finding 7 (order cancelation flow checks, order addition checks needs another patch)\",\"position\":{\"start\":{\"line\":562,\"column\":3,\"offset\":28549},\"end\":{\"line\":562,\"column\":87,\"offset\":28633}}}],\"position\":{\"start\":{\"line\":562,\"column\":1,\"offset\":28547},\"end\":{\"line\":562,\"column\":87,\"offset\":28633}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":557,\"column\":1,\"offset\":28406},\"end\":{\"line\":562,\"column\":87,\"offset\":28633}}},\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":\"Finding 1\"}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":\"Finding 2\"}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":\"Finding 3\"}],\"\\n\",[\"$\",\"li\",\"li-3\",{\"children\":\"Finding 5 (make sure price ticks are multiple of 100)\"}],\"\\n\",[\"$\",\"li\",\"li-4\",{\"children\":\"Finding 6 (patch above plus some improvements)\"}],\"\\n\",[\"$\",\"li\",\"li-5\",{\"children\":\"Finding 7 (order cancelation flow checks, order addition checks needs another patch)\"}],\"\\n\"]}],\"\\n\",[\"$\",\"details\",\"details-2\",{\"children\":[\"\\n\",[\"$\",\"summary\",\"summary-0\",{\"children\":\"📝 Click here to view the patch.\"}],\"\\n\",[\"$\",\"$L45\",\"pre-0\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-diff\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"$5b\"}],\"position\":{\"start\":{\"line\":567,\"column\":1,\"offset\":28698},\"end\":{\"line\":991,\"column\":4,\"offset\":50297}}}],\"position\":{\"start\":{\"line\":567,\"column\":1,\"offset\":28698},\"end\":{\"line\":991,\"column\":4,\"offset\":50297}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"$5c\",\"inline\":false,\"language\":\"diff\"}]}],[\"$\",\"$L46\",null,{\"content\":\"$5d\"}]]}],\"\\n\"]}]]]}]}],false]}]}]]}]]}],[\"$\",\"$L2d\",\"medium\",{\"alignItems\":\"stretch\",\"as\":\"section\",\"gap\":4,\"children\":[[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":4,\"children\":[[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.medium\",\"borderRadius\":\"full\",\"boxSize\":4}],[\"$\",\"$L37\",null,{\"_before\":{\"content\":\"counter(report-severities) \\\".\\\"\"},\"alignItems\":\"center\",\"as\":\"h3\",\"display\":\"flex\",\"flexWrap\":\"wrap\",\"fontSize\":{\"base\":\"2xl\",\"md\":\"3xl\"},\"fontWeight\":\"semibold\",\"gap\":2,\"sx\":{\"counterIncrement\":\"report-severities\"},\"children\":[\"Medium Risk\",[\"$\",\"$L2f\",null,{\"as\":\"span\",\"color\":\"gray.500\",\"children\":[3,\" \",\"findings\"]}]]}]]}],[\"$\",\"$L3b\",null,{\"m\":0,\"spacing\":8,\"styleType\":\"none\",\"sx\":{\"counterReset\":\"report-severity-findings\"},\"children\":[[\"$\",\"$L3c\",\"1d0e1a54-b60c-4780-8624-b7b22c8e7985\",{\"children\":[\"$\",\"$L2d\",\"1d0e1a54-b60c-4780-8624-b7b22c8e7985\",{\"alignItems\":\"flex-start\",\"as\":\"section\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"borderRadius\":\"md\",\"gap\":6,\"p\":8,\"children\":[[\"$\",\"$L37\",null,{\"_before\":{\"content\":\"counter(report-severities) \\\".\\\" counter(report-severity-findings) \\\" \\\"\"},\"as\":\"h4\",\"color\":\"gray.950\",\"fontSize\":{\"base\":\"2xl\",\"md\":\"3xl\"},\"fontWeight\":\"semibold\",\"sx\":{\"counterIncrement\":\"report-severity-findings\"},\"wordBreak\":\"break-word\",\"children\":[\"$\",\"$L3d\",null,{\"text\":\"unsafe node check in `_cancelOrdersSide`\"}]}],[\"$\",\"$L2d\",null,{\"alignItems\":\"stretch\",\"as\":\"dl\",\"gap\":2,\"sx\":{\"w\":\"full\",\"containerType\":\"inline-size\"},\"children\":[[\"$\",\"$L2e\",\"State\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"State\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":2,\"children\":[[\"$\",\"$L3e\",null,{\"alignItems\":\"center\",\"bgColor\":\"status.bg.fixed\",\"border\":\"1px solid\",\"borderColor\":\"status.bg.fixed\",\"color\":\"status.fixed\",\"display\":\"inline-flex\",\"gap\":1.5,\"lineHeight\":\"1rem\",\"minWidth\":\"fit-content\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"role\":\"$undefined\",\"size\":\"sm\",\"children\":[[\"$\",\"$L3f\",null,{\"boxSize\":3.5,\"strokeWidth\":\"2px\",\"children\":[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-wrench\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"cbrjhi\",{\"d\":\"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z\"}],\"$undefined\"]}]}],[\"$\",\"$L40\",null,{\"color\":\"inherit\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":\"Fixed\"}]]}],[[\"$\",\"$L3e\",\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\",{\"_hover\":{\"bg\":\"gray.100\"},\"as\":\"a\",\"bg\":\"white\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"borderRadius\":\"full\",\"color\":\"gray.950\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\",\"maxW\":\"10rem\",\"size\":\"sm\",\"target\":\"_blank\",\"children\":[\"$\",\"$L2f\",null,{\"isTruncated\":true,\"children\":\"PR #106\"}]}]]]}]}]]}],[\"$\",\"$L2e\",\"Severity\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Severity\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":2,\"children\":[[\"$\",\"$L3e\",null,{\"ref\":\"$undefined\",\"alignItems\":\"center\",\"bgColor\":\"transparent\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"display\":\"flex\",\"gap\":\"0.375rem\",\"lineHeight\":\"1rem\",\"size\":\"sm\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"fontWeight\":\"600\",\"children\":[[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.medium\",\"borderRadius\":\"full\",\"boxSize\":\"0.5rem\"}],[\"$\",\"$L40\",null,{\"color\":\"gray.950\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":[[\"Severity\",\": \"],\"Medium\"]}]]}],[[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"children\":\"≈\"}],[\"$\",\"$L3e\",null,{\"ref\":\"$undefined\",\"alignItems\":\"center\",\"bgColor\":\"transparent\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"display\":\"flex\",\"gap\":\"0.375rem\",\"lineHeight\":\"1rem\",\"size\":\"sm\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"fontWeight\":\"600\",\"children\":[[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.low\",\"borderRadius\":\"full\",\"boxSize\":\"0.5rem\"}],[\"$\",\"$L40\",null,{\"color\":\"gray.950\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":[[\"Likelihood\",\": \"],\"Low\"]}]]}],[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"children\":\"×\"}],[\"$\",\"$L3e\",null,{\"ref\":\"$undefined\",\"alignItems\":\"center\",\"bgColor\":\"transparent\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"display\":\"flex\",\"gap\":\"0.375rem\",\"lineHeight\":\"1rem\",\"size\":\"sm\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"fontWeight\":\"600\",\"children\":[[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.high\",\"borderRadius\":\"full\",\"boxSize\":\"0.5rem\"}],[\"$\",\"$L40\",null,{\"color\":\"gray.950\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":[[\"Impact\",\": \"],\"High\"]}]]}]]]}]}]]}],[\"$\",\"$L2e\",\"Submitted by\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Submitted by\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L33\",null,{\"alignItems\":\"center\",\"as\":\"$34\",\"display\":\"flex\",\"gap\":2,\"href\":\"/u/Saw-mon-and-Natalie\",\"prefetch\":false,\"children\":[[\"$\",\"$L35\",null,{\"height\":\"20px\",\"src\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/8039eb9a-b849-4701-675d-fd94168a3300/public\",\"width\":\"20px\"}],[\"$\",\"$L2f\",null,{\"fontSize\":\"xs\",\"children\":[\" \",\"Saw-mon and Natalie\"]}]]}]}]]}]]}],[\"$\",\"$L36\",null,{}],[\"$\",\"$L41\",null,{\"children\":[\"$\",\"$L20\",null,{\"alignSelf\":\"stretch\",\"bg\":\"transparent\",\"className\":\"markdown-body\",\"flex\":\"1\",\"flexDirection\":\"column\",\"fontFamily\":\"body\",\"fontSize\":\"sm\",\"position\":\"relative\",\"sx\":{\"\u0026 code[class*=\\\"language-\\\"],  \u0026 pre[class*=\\\"language-\\\"]\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 code[class*=\\\"language-\\\"],  \u0026 pre[class*=\\\"language-\\\"]\",\"\u0026 :not(pre)\u003ecode[class*=\\\"language-\\\"]\":{\"whiteSpace\":\"normal\",\"borderRadius\":\"0.2em\",\"padding\":\"0.1em\"},\"\u0026 pre[class*=\\\"language-\\\"]\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 pre[class*=\\\"language-\\\"]\",\"\u0026 [class*=\\\"language-\\\"] .namespace\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 [class*=\\\"language-\\\"] .namespace\",\"\u0026 :where(img, svg, video, canvas, audio, iframe, embed, object)\":{\"display\":\"initial\"},\"\u0026 h1\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 h1\",\"\u0026 h2\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 h2\",\"\u0026 .token.tag,\u0026 .token.selector,\u0026 .token.keyword,\u0026 .token.operator,\u0026 .token.atrule\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.tag,\u0026 .token.selector,\u0026 .token.keyword,\u0026 .token.operator,\u0026 .token.atrule\",\"\u0026 .token.comment,\u0026 .token.prolog,\u0026 .token.doctype,\u0026 .token.cdata\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.comment,\u0026 .token.prolog,\u0026 .token.doctype,\u0026 .token.cdata\",\"\u0026 .token.namespace\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.namespace\",\"\u0026 .token.string,\u0026 .token.attr-value,\u0026 .token.attribute,\u0026 .token.pseudo-class,\u0026 .token.pseudo-element\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.string,\u0026 .token.attr-value,\u0026 .token.attribute,\u0026 .token.pseudo-class,\u0026 .token.pseudo-element\",\"\u0026 .token.number,\u0026 .token.boolean,\u0026 .token.builtin,\u0026 .token.entity,\u0026 .token.url,\u0026 .token.symbol,\u0026 .token.variable,\u0026 .token.constant,\u0026 .token.property,\u0026 .token.regex,\u0026 .token.attr-name,\u0026 .token.unit,\u0026 .token.hexcode\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.number,\u0026 .token.boolean,\u0026 .token.builtin,\u0026 .token.entity,\u0026 .token.url,\u0026 .token.symbol,\u0026 .token.variable,\u0026 .token.constant,\u0026 .token.property,\u0026 .token.regex,\u0026 .token.attr-name,\u0026 .token.unit,\u0026 .token.hexcode\",\"\u0026 .token.punctuation,\u0026 .token.char,\u0026 .token.class\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.punctuation,\u0026 .token.char,\u0026 .token.class\",\"\u0026 .token.function,\u0026 .token.class-name,\u0026 .token.function-variable,\u0026 .token.id\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.function,\u0026 .token.class-name,\u0026 .token.function-variable,\u0026 .token.id\",\"\u0026 .token.important,\u0026 .token.bold\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.important,\u0026 .token.bold\",\"\u0026 .token.italic\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.italic\",\"\u0026 .token.deleted\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.deleted\",\"\u0026 .token.inserted\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.inserted\"},\"wordBreak\":\"break-word\",\"children\":[[\"$\",\"$L42\",null,{\"frontmatter\":{}}],[[\"$\",\"$L37\",\"h2-0\",{\"as\":\"h2\",\"id\":\"description\",\"mb\":\"5\",\"size\":\"xl\",\"node\":{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Description\",\"position\":{\"start\":{\"line\":1,\"column\":4,\"offset\":3},\"end\":{\"line\":1,\"column\":15,\"offset\":14}}}],\"position\":{\"start\":{\"line\":1,\"column\":1,\"offset\":0},\"end\":{\"line\":1,\"column\":15,\"offset\":14}}},\"children\":\"Description\"}],\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"The price \",\"position\":{\"start\":{\"line\":3,\"column\":1,\"offset\":16},\"end\":{\"line\":3,\"column\":11,\"offset\":26}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"node\",\"position\":{\"start\":{\"line\":3,\"column\":11,\"offset\":26},\"end\":{\"line\":3,\"column\":17,\"offset\":32}}}],\"position\":{\"start\":{\"line\":3,\"column\":11,\"offset\":26},\"end\":{\"line\":3,\"column\":17,\"offset\":32}}},{\"type\":\"text\",\"value\":\" queries from the price \",\"position\":{\"start\":{\"line\":3,\"column\":17,\"offset\":32},\"end\":{\"line\":3,\"column\":41,\"offset\":56}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"tree\",\"position\":{\"start\":{\"line\":3,\"column\":41,\"offset\":56},\"end\":{\"line\":3,\"column\":47,\"offset\":62}}}],\"position\":{\"start\":{\"line\":3,\"column\":41,\"offset\":56},\"end\":{\"line\":3,\"column\":47,\"offset\":62}}},{\"type\":\"text\",\"value\":\" uses the \",\"position\":{\"start\":{\"line\":3,\"column\":47,\"offset\":62},\"end\":{\"line\":3,\"column\":57,\"offset\":72}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"getNodeUnsafe\",\"position\":{\"start\":{\"line\":3,\"column\":57,\"offset\":72},\"end\":{\"line\":3,\"column\":72,\"offset\":87}}}],\"position\":{\"start\":{\"line\":3,\"column\":57,\"offset\":72},\"end\":{\"line\":3,\"column\":72,\"offset\":87}}},{\"type\":\"text\",\"value\":\" which omits checking whether the price \",\"position\":{\"start\":{\"line\":3,\"column\":72,\"offset\":87},\"end\":{\"line\":3,\"column\":112,\"offset\":127}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"node\",\"position\":{\"start\":{\"line\":3,\"column\":112,\"offset\":127},\"end\":{\"line\":3,\"column\":118,\"offset\":133}}}],\"position\":{\"start\":{\"line\":3,\"column\":112,\"offset\":127},\"end\":{\"line\":3,\"column\":118,\"offset\":133}}},{\"type\":\"text\",\"value\":\" belongs to the \",\"position\":{\"start\":{\"line\":3,\"column\":118,\"offset\":133},\"end\":{\"line\":3,\"column\":134,\"offset\":149}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"tree\",\"position\":{\"start\":{\"line\":3,\"column\":134,\"offset\":149},\"end\":{\"line\":3,\"column\":140,\"offset\":155}}}],\"position\":{\"start\":{\"line\":3,\"column\":134,\"offset\":149},\"end\":{\"line\":3,\"column\":140,\"offset\":155}}},{\"type\":\"text\",\"value\":\". Ommitting this check was added to save some gas during the cancellation process but creates big risk in terms of making assumptions about the structure of the price segments. The assumption is that if the price \",\"position\":{\"start\":{\"line\":3,\"column\":140,\"offset\":155},\"end\":{\"line\":3,\"column\":353,\"offset\":368}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"node\",\"position\":{\"start\":{\"line\":3,\"column\":353,\"offset\":368},\"end\":{\"line\":3,\"column\":359,\"offset\":374}}}],\"position\":{\"start\":{\"line\":3,\"column\":353,\"offset\":368},\"end\":{\"line\":3,\"column\":359,\"offset\":374}}},{\"type\":\"text\",\"value\":\" did not belong the the \",\"position\":{\"start\":{\"line\":3,\"column\":359,\"offset\":374},\"end\":{\"line\":3,\"column\":383,\"offset\":398}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"tree\",\"position\":{\"start\":{\"line\":3,\"column\":383,\"offset\":398},\"end\":{\"line\":3,\"column\":389,\"offset\":404}}}],\"position\":{\"start\":{\"line\":3,\"column\":383,\"offset\":398},\"end\":{\"line\":3,\"column\":389,\"offset\":404}}},{\"type\":\"text\",\"value\":\" then the \",\"position\":{\"start\":{\"line\":3,\"column\":389,\"offset\":404},\"end\":{\"line\":3,\"column\":399,\"offset\":414}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"node\",\"position\":{\"start\":{\"line\":3,\"column\":399,\"offset\":414},\"end\":{\"line\":3,\"column\":405,\"offset\":420}}}],\"position\":{\"start\":{\"line\":3,\"column\":399,\"offset\":414},\"end\":{\"line\":3,\"column\":405,\"offset\":420}}},{\"type\":\"text\",\"value\":\"'s tombstone offset should be equal to greater than the price segments length:\",\"position\":{\"start\":{\"line\":3,\"column\":405,\"offset\":420},\"end\":{\"line\":3,\"column\":483,\"offset\":498}}}],\"position\":{\"start\":{\"line\":3,\"column\":1,\"offset\":16},\"end\":{\"line\":3,\"column\":483,\"offset\":498}}},\"children\":[\"The price \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"node\",\"inline\":true,\"language\":\"text\"}],\" queries from the price \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"tree\",\"inline\":true,\"language\":\"text\"}],\" uses the \",[\"$\",\"$L43\",\"code-2\",{\"code\":\"getNodeUnsafe\",\"inline\":true,\"language\":\"text\"}],\" which omits checking whether the price \",[\"$\",\"$L43\",\"code-3\",{\"code\":\"node\",\"inline\":true,\"language\":\"text\"}],\" belongs to the \",[\"$\",\"$L43\",\"code-4\",{\"code\":\"tree\",\"inline\":true,\"language\":\"text\"}],\". Ommitting this check was added to save some gas during the cancellation process but creates big risk in terms of making assumptions about the structure of the price segments. The assumption is that if the price \",[\"$\",\"$L43\",\"code-5\",{\"code\":\"node\",\"inline\":true,\"language\":\"text\"}],\" did not belong the the \",[\"$\",\"$L43\",\"code-6\",{\"code\":\"tree\",\"inline\":true,\"language\":\"text\"}],\" then the \",[\"$\",\"$L43\",\"code-7\",{\"code\":\"node\",\"inline\":true,\"language\":\"text\"}],\"'s tombstone offset should be equal to greater than the price segments length:\"]}],\"\\n\",[\"$\",\"span\",\"span-0\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"t\"}]]}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"≥\"}],[\"$\",\"mtext\",\"mtext-0\",{\"mathvariant\":\"monospace\",\"children\":\"seg.len\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"o_t \\\\geq \\\\texttt{seg.len}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.786em\",\"verticalAlign\":\"-0.15em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2806em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"t\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":\"≥\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.8333em\",\"verticalAlign\":\"-0.2222em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord text\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord texttt\",\"children\":\"seg.len\"}]}]]}]]}]]}]}],\"\\n\",[\"$\",\"$L2f\",\"p-1\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Thus when one calls \",\"position\":{\"start\":{\"line\":9,\"column\":1,\"offset\":533},\"end\":{\"line\":9,\"column\":21,\"offset\":553}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_find\",\"position\":{\"start\":{\"line\":9,\"column\":21,\"offset\":553},\"end\":{\"line\":9,\"column\":28,\"offset\":560}}}],\"position\":{\"start\":{\"line\":9,\"column\":21,\"offset\":553},\"end\":{\"line\":9,\"column\":28,\"offset\":560}}},{\"type\":\"text\",\"value\":\" the order should not be found and \",\"position\":{\"start\":{\"line\":9,\"column\":28,\"offset\":560},\"end\":{\"line\":9,\"column\":63,\"offset\":595}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"type(uint256).max\",\"position\":{\"start\":{\"line\":9,\"column\":63,\"offset\":595},\"end\":{\"line\":9,\"column\":82,\"offset\":614}}}],\"position\":{\"start\":{\"line\":9,\"column\":63,\"offset\":595},\"end\":{\"line\":9,\"column\":82,\"offset\":614}}},{\"type\":\"text\",\"value\":\" should be returned for the segment and slot indexes, and so instead one would hit the custom error \",\"position\":{\"start\":{\"line\":9,\"column\":82,\"offset\":614},\"end\":{\"line\":9,\"column\":182,\"offset\":714}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"OrderNotFound(orderId))\",\"position\":{\"start\":{\"line\":9,\"column\":182,\"offset\":714},\"end\":{\"line\":9,\"column\":207,\"offset\":739}}}],\"position\":{\"start\":{\"line\":9,\"column\":182,\"offset\":714},\"end\":{\"line\":9,\"column\":207,\"offset\":739}}},{\"type\":\"text\",\"value\":\" below:\",\"position\":{\"start\":{\"line\":9,\"column\":207,\"offset\":739},\"end\":{\"line\":9,\"column\":214,\"offset\":746}}}],\"position\":{\"start\":{\"line\":9,\"column\":1,\"offset\":533},\"end\":{\"line\":9,\"column\":214,\"offset\":746}}},\"children\":[\"Thus when one calls \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"_find\",\"inline\":true,\"language\":\"text\"}],\" the order should not be found and \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"type(uint256).max\",\"inline\":true,\"language\":\"text\"}],\" should be returned for the segment and slot indexes, and so instead one would hit the custom error \",[\"$\",\"$L43\",\"code-2\",{\"code\":\"OrderNotFound(orderId))\",\"inline\":true,\"language\":\"text\"}],\" below:\"]}],\"\\n\",[\"$\",\"$L45\",\"pre-0\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-solidity\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"require(segmentIndex != type(uint).max, OrderNotFound(orderId));\\n\"}],\"position\":{\"start\":{\"line\":11,\"column\":1,\"offset\":748},\"end\":{\"line\":13,\"column\":4,\"offset\":828}}}],\"position\":{\"start\":{\"line\":11,\"column\":1,\"offset\":748},\"end\":{\"line\":13,\"column\":4,\"offset\":828}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"require(segmentIndex != type(uint).max, OrderNotFound(orderId));\",\"inline\":false,\"language\":\"solidity\"}]}],[\"$\",\"$L46\",null,{\"content\":\"require(segmentIndex != type(uint).max, OrderNotFound(orderId));\\n\"}]]}],\"\\n\",[\"$\",\"$L2f\",\"p-2\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"One is creating assumptions about distant parts of the codebase using an optimistic approach about supposed invariants.\",\"position\":{\"start\":{\"line\":15,\"column\":1,\"offset\":830},\"end\":{\"line\":15,\"column\":120,\"offset\":949}}}],\"position\":{\"start\":{\"line\":15,\"column\":1,\"offset\":830},\"end\":{\"line\":15,\"column\":120,\"offset\":949}}},\"children\":\"One is creating assumptions about distant parts of the codebase using an optimistic approach about supposed invariants.\"}],\"\\n\",[\"$\",\"$L37\",\"h2-1\",{\"as\":\"h2\",\"id\":\"recommendation\",\"mb\":\"5\",\"size\":\"xl\",\"node\":{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Recommendation\",\"position\":{\"start\":{\"line\":17,\"column\":4,\"offset\":954},\"end\":{\"line\":17,\"column\":18,\"offset\":968}}}],\"position\":{\"start\":{\"line\":17,\"column\":1,\"offset\":951},\"end\":{\"line\":17,\"column\":18,\"offset\":968}}},\"children\":\"Recommendation\"}],\"\\n\",[\"$\",\"$L2f\",\"p-3\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"This is a critical flow for orderbook and minimising assumptions to reduce the risk of accounting imbalances would be the recommended suggestion. Thus it would be best to revert back to the original logic of querying the \",\"position\":{\"start\":{\"line\":19,\"column\":1,\"offset\":970},\"end\":{\"line\":19,\"column\":222,\"offset\":1191}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"node\",\"position\":{\"start\":{\"line\":19,\"column\":222,\"offset\":1191},\"end\":{\"line\":19,\"column\":228,\"offset\":1197}}}],\"position\":{\"start\":{\"line\":19,\"column\":222,\"offset\":1191},\"end\":{\"line\":19,\"column\":228,\"offset\":1197}}},{\"type\":\"text\",\"value\":\" in a safe way:\",\"position\":{\"start\":{\"line\":19,\"column\":228,\"offset\":1197},\"end\":{\"line\":19,\"column\":243,\"offset\":1212}}}],\"position\":{\"start\":{\"line\":19,\"column\":1,\"offset\":970},\"end\":{\"line\":19,\"column\":243,\"offset\":1212}}},\"children\":[\"This is a critical flow for orderbook and minimising assumptions to reduce the risk of accounting imbalances would be the recommended suggestion. Thus it would be best to revert back to the original logic of querying the \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"node\",\"inline\":true,\"language\":\"text\"}],\" in a safe way:\"]}],\"\\n\",[\"$\",\"$L45\",\"pre-1\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-solidity\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"BokkyPooBahsRedBlackTreeLibrary.Node storage node = tree.getNode(price);\\n\"}],\"position\":{\"start\":{\"line\":21,\"column\":1,\"offset\":1214},\"end\":{\"line\":23,\"column\":4,\"offset\":1302}}}],\"position\":{\"start\":{\"line\":21,\"column\":1,\"offset\":1214},\"end\":{\"line\":23,\"column\":4,\"offset\":1302}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"BokkyPooBahsRedBlackTreeLibrary.Node storage node = tree.getNode(price);\",\"inline\":false,\"language\":\"solidity\"}]}],[\"$\",\"$L46\",null,{\"content\":\"BokkyPooBahsRedBlackTreeLibrary.Node storage node = tree.getNode(price);\\n\"}]]}],\"\\n\",[\"$\",\"$L2f\",\"p-4\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Thus would make it harder to cancel a potentially malicious non-existent order and steal funds from the orderbook and it is a more defensive approach about safeguarding the contract balances.\",\"position\":{\"start\":{\"line\":25,\"column\":1,\"offset\":1304},\"end\":{\"line\":25,\"column\":192,\"offset\":1495}}}],\"position\":{\"start\":{\"line\":25,\"column\":1,\"offset\":1304},\"end\":{\"line\":25,\"column\":192,\"offset\":1495}}},\"children\":\"Thus would make it harder to cancel a potentially malicious non-existent order and steal funds from the orderbook and it is a more defensive approach about safeguarding the contract balances.\"}]]]}]}],false]}]}],[\"$\",\"$L3c\",\"0bd4fc3d-b504-444b-a393-2ed8a42d7839\",{\"children\":[\"$\",\"$L2d\",\"0bd4fc3d-b504-444b-a393-2ed8a42d7839\",{\"alignItems\":\"flex-start\",\"as\":\"section\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"borderRadius\":\"md\",\"gap\":6,\"p\":8,\"children\":[[\"$\",\"$L37\",null,{\"_before\":{\"content\":\"counter(report-severities) \\\".\\\" counter(report-severity-findings) \\\" \\\"\"},\"as\":\"h4\",\"color\":\"gray.950\",\"fontSize\":{\"base\":\"2xl\",\"md\":\"3xl\"},\"fontWeight\":\"semibold\",\"sx\":{\"counterIncrement\":\"report-severity-findings\"},\"wordBreak\":\"break-word\",\"children\":[\"$\",\"$L3d\",null,{\"text\":\"Add invariant checks to the `_consumePriceSegments` and make it less prone to malfunction\"}]}],[\"$\",\"$L2d\",null,{\"alignItems\":\"stretch\",\"as\":\"dl\",\"gap\":2,\"sx\":{\"w\":\"full\",\"containerType\":\"inline-size\"},\"children\":[[\"$\",\"$L2e\",\"State\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"State\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":2,\"children\":[[\"$\",\"$L3e\",null,{\"alignItems\":\"center\",\"bgColor\":\"status.bg.fixed\",\"border\":\"1px solid\",\"borderColor\":\"status.bg.fixed\",\"color\":\"status.fixed\",\"display\":\"inline-flex\",\"gap\":1.5,\"lineHeight\":\"1rem\",\"minWidth\":\"fit-content\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"role\":\"$undefined\",\"size\":\"sm\",\"children\":[[\"$\",\"$L3f\",null,{\"boxSize\":3.5,\"strokeWidth\":\"2px\",\"children\":[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-wrench\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"cbrjhi\",{\"d\":\"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z\"}],\"$undefined\"]}]}],[\"$\",\"$L40\",null,{\"color\":\"inherit\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":\"Fixed\"}]]}],[[\"$\",\"$L3e\",\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\",{\"_hover\":{\"bg\":\"gray.100\"},\"as\":\"a\",\"bg\":\"white\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"borderRadius\":\"full\",\"color\":\"gray.950\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\",\"maxW\":\"10rem\",\"size\":\"sm\",\"target\":\"_blank\",\"children\":[\"$\",\"$L2f\",null,{\"isTruncated\":true,\"children\":\"PR #106\"}]}]]]}]}]]}],[\"$\",\"$L2e\",\"Severity\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Severity\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":2,\"children\":[[\"$\",\"$L3e\",null,{\"ref\":\"$undefined\",\"alignItems\":\"center\",\"bgColor\":\"transparent\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"display\":\"flex\",\"gap\":\"0.375rem\",\"lineHeight\":\"1rem\",\"size\":\"sm\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"fontWeight\":\"600\",\"children\":[[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.medium\",\"borderRadius\":\"full\",\"boxSize\":\"0.5rem\"}],[\"$\",\"$L40\",null,{\"color\":\"gray.950\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":[[\"Severity\",\": \"],\"Medium\"]}]]}],[[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"children\":\"≈\"}],[\"$\",\"$L3e\",null,{\"ref\":\"$undefined\",\"alignItems\":\"center\",\"bgColor\":\"transparent\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"display\":\"flex\",\"gap\":\"0.375rem\",\"lineHeight\":\"1rem\",\"size\":\"sm\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"fontWeight\":\"600\",\"children\":[[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.low\",\"borderRadius\":\"full\",\"boxSize\":\"0.5rem\"}],[\"$\",\"$L40\",null,{\"color\":\"gray.950\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":[[\"Likelihood\",\": \"],\"Low\"]}]]}],[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"children\":\"×\"}],[\"$\",\"$L3e\",null,{\"ref\":\"$undefined\",\"alignItems\":\"center\",\"bgColor\":\"transparent\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"display\":\"flex\",\"gap\":\"0.375rem\",\"lineHeight\":\"1rem\",\"size\":\"sm\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"fontWeight\":\"600\",\"children\":[[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.high\",\"borderRadius\":\"full\",\"boxSize\":\"0.5rem\"}],[\"$\",\"$L40\",null,{\"color\":\"gray.950\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":[[\"Impact\",\": \"],\"High\"]}]]}]]]}]}]]}],[\"$\",\"$L2e\",\"Submitted by\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Submitted by\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L33\",null,{\"alignItems\":\"center\",\"as\":\"$34\",\"display\":\"flex\",\"gap\":2,\"href\":\"/u/Saw-mon-and-Natalie\",\"prefetch\":false,\"children\":[[\"$\",\"$L35\",null,{\"height\":\"20px\",\"src\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/8039eb9a-b849-4701-675d-fd94168a3300/public\",\"width\":\"20px\"}],[\"$\",\"$L2f\",null,{\"fontSize\":\"xs\",\"children\":[\" \",\"Saw-mon and Natalie\"]}]]}]}]]}]]}],[\"$\",\"$L36\",null,{}],[\"$\",\"$L41\",null,{\"children\":[\"$\",\"$L20\",null,{\"alignSelf\":\"stretch\",\"bg\":\"transparent\",\"className\":\"markdown-body\",\"flex\":\"1\",\"flexDirection\":\"column\",\"fontFamily\":\"body\",\"fontSize\":\"sm\",\"position\":\"relative\",\"sx\":{\"\u0026 code[class*=\\\"language-\\\"],  \u0026 pre[class*=\\\"language-\\\"]\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 code[class*=\\\"language-\\\"],  \u0026 pre[class*=\\\"language-\\\"]\",\"\u0026 :not(pre)\u003ecode[class*=\\\"language-\\\"]\":{\"whiteSpace\":\"normal\",\"borderRadius\":\"0.2em\",\"padding\":\"0.1em\"},\"\u0026 pre[class*=\\\"language-\\\"]\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 pre[class*=\\\"language-\\\"]\",\"\u0026 [class*=\\\"language-\\\"] .namespace\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 [class*=\\\"language-\\\"] .namespace\",\"\u0026 :where(img, svg, video, canvas, audio, iframe, embed, object)\":{\"display\":\"initial\"},\"\u0026 h1\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 h1\",\"\u0026 h2\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 h2\",\"\u0026 .token.tag,\u0026 .token.selector,\u0026 .token.keyword,\u0026 .token.operator,\u0026 .token.atrule\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.tag,\u0026 .token.selector,\u0026 .token.keyword,\u0026 .token.operator,\u0026 .token.atrule\",\"\u0026 .token.comment,\u0026 .token.prolog,\u0026 .token.doctype,\u0026 .token.cdata\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.comment,\u0026 .token.prolog,\u0026 .token.doctype,\u0026 .token.cdata\",\"\u0026 .token.namespace\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.namespace\",\"\u0026 .token.string,\u0026 .token.attr-value,\u0026 .token.attribute,\u0026 .token.pseudo-class,\u0026 .token.pseudo-element\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.string,\u0026 .token.attr-value,\u0026 .token.attribute,\u0026 .token.pseudo-class,\u0026 .token.pseudo-element\",\"\u0026 .token.number,\u0026 .token.boolean,\u0026 .token.builtin,\u0026 .token.entity,\u0026 .token.url,\u0026 .token.symbol,\u0026 .token.variable,\u0026 .token.constant,\u0026 .token.property,\u0026 .token.regex,\u0026 .token.attr-name,\u0026 .token.unit,\u0026 .token.hexcode\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.number,\u0026 .token.boolean,\u0026 .token.builtin,\u0026 .token.entity,\u0026 .token.url,\u0026 .token.symbol,\u0026 .token.variable,\u0026 .token.constant,\u0026 .token.property,\u0026 .token.regex,\u0026 .token.attr-name,\u0026 .token.unit,\u0026 .token.hexcode\",\"\u0026 .token.punctuation,\u0026 .token.char,\u0026 .token.class\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.punctuation,\u0026 .token.char,\u0026 .token.class\",\"\u0026 .token.function,\u0026 .token.class-name,\u0026 .token.function-variable,\u0026 .token.id\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.function,\u0026 .token.class-name,\u0026 .token.function-variable,\u0026 .token.id\",\"\u0026 .token.important,\u0026 .token.bold\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.important,\u0026 .token.bold\",\"\u0026 .token.italic\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.italic\",\"\u0026 .token.deleted\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.deleted\",\"\u0026 .token.inserted\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.inserted\"},\"wordBreak\":\"break-word\",\"children\":[[\"$\",\"$L42\",null,{\"frontmatter\":{}}],[[\"$\",\"$L37\",\"h2-0\",{\"as\":\"h2\",\"id\":\"description\",\"mb\":\"5\",\"size\":\"xl\",\"node\":{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Description\",\"position\":{\"start\":{\"line\":1,\"column\":4,\"offset\":3},\"end\":{\"line\":1,\"column\":15,\"offset\":14}}}],\"position\":{\"start\":{\"line\":1,\"column\":1,\"offset\":0},\"end\":{\"line\":1,\"column\":15,\"offset\":14}}},\"children\":\"Description\"}],\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"There are currently two main spots in \",\"position\":{\"start\":{\"line\":3,\"column\":1,\"offset\":16},\"end\":{\"line\":3,\"column\":39,\"offset\":54}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_consumePriceSegments\",\"position\":{\"start\":{\"line\":3,\"column\":39,\"offset\":54},\"end\":{\"line\":3,\"column\":62,\"offset\":77}}}],\"position\":{\"start\":{\"line\":3,\"column\":39,\"offset\":54},\"end\":{\"line\":3,\"column\":62,\"offset\":77}}},{\"type\":\"text\",\"value\":\" which makes certain assumptions about the structure of the price segments. Mainly:\",\"position\":{\"start\":{\"line\":3,\"column\":62,\"offset\":77},\"end\":{\"line\":3,\"column\":145,\"offset\":160}}}],\"position\":{\"start\":{\"line\":3,\"column\":1,\"offset\":16},\"end\":{\"line\":3,\"column\":145,\"offset\":160}}},\"children\":[\"There are currently two main spots in \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"_consumePriceSegments\",\"inline\":true,\"language\":\"text\"}],\" which makes certain assumptions about the structure of the price segments. Mainly:\"]}],\"\\n\",[\"$\",\"$L3b\",\"ol-0\",{\"node\":{\"type\":\"element\",\"tagName\":\"ol\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"only the beginning of the active area of the price segments can have empty slots\",\"position\":{\"start\":{\"line\":5,\"column\":4,\"offset\":165},\"end\":{\"line\":5,\"column\":84,\"offset\":245}}}],\"position\":{\"start\":{\"line\":5,\"column\":4,\"offset\":165},\"end\":{\"line\":5,\"column\":84,\"offset\":245}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-display\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mover\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{\"lspace\":\"0em\",\"rspace\":\"0em\"},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\cdots\\n\\\\blacksquare \\\\square\\\\square \\\\stackrel{\\\\leftarrow}{\\\\cdots}\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.8698em;vertical-align:-0.0015em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"minner\"]},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.1667em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"■□□\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mop\",\"op-limits\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.8683em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.9985em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mop\"]},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-3.5115em;margin-left:0em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.0015em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"which is assumed in the \",\"position\":{\"start\":{\"line\":12,\"column\":5,\"offset\":339},\"end\":{\"line\":12,\"column\":29,\"offset\":363}}},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/SonicOrderBook.sol#L792-L798\"},\"children\":[{\"type\":\"text\",\"value\":\"snippet below\",\"position\":{\"start\":{\"line\":12,\"column\":30,\"offset\":364},\"end\":{\"line\":12,\"column\":43,\"offset\":377}}}],\"position\":{\"start\":{\"line\":12,\"column\":29,\"offset\":363},\"end\":{\"line\":12,\"column\":183,\"offset\":517}}},{\"type\":\"text\",\"value\":\":\",\"position\":{\"start\":{\"line\":12,\"column\":183,\"offset\":517},\"end\":{\"line\":12,\"column\":184,\"offset\":518}}}],\"position\":{\"start\":{\"line\":12,\"column\":5,\"offset\":339},\"end\":{\"line\":12,\"column\":184,\"offset\":518}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-solidity\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"bytes10 slot = segment.getSlot(slotIndex);\\nuint48 orderId = slot.getOrderId();\\nif (orderId == 0) {\\n   // Skip this order in the segment as it's been deleted\\n   ++numOrdersFullyConsumed;\\n   continue;\\n}\\n\"}],\"position\":{\"start\":{\"line\":14,\"column\":5,\"offset\":524},\"end\":{\"line\":22,\"column\":8,\"offset\":772}}}],\"position\":{\"start\":{\"line\":14,\"column\":5,\"offset\":524},\"end\":{\"line\":22,\"column\":8,\"offset\":772}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":5,\"column\":1,\"offset\":162},\"end\":{\"line\":22,\"column\":8,\"offset\":772}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"only the end the of the active area of the price segments can have empty slots\",\"position\":{\"start\":{\"line\":26,\"column\":4,\"offset\":781},\"end\":{\"line\":26,\"column\":82,\"offset\":859}}}],\"position\":{\"start\":{\"line\":26,\"column\":4,\"offset\":781},\"end\":{\"line\":26,\"column\":82,\"offset\":859}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-display\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mover\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{\"lspace\":\"0em\",\"rspace\":\"0em\"},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\cdots \\\\square\\\\square \\\\blacksquare \\\\stackrel{\\\\leftarrow}{\\\\cdots}\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.8698em;vertical-align:-0.0015em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"minner\"]},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.1667em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"□□■\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mop\",\"op-limits\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.8683em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.9985em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mop\"]},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-3.5115em;margin-left:0em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.0015em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"which is assumed in the \",\"position\":{\"start\":{\"line\":32,\"column\":5,\"offset\":949},\"end\":{\"line\":32,\"column\":29,\"offset\":973}}},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/SonicOrderBook.sol#L786-L790\"},\"children\":[{\"type\":\"text\",\"value\":\"snippet below\",\"position\":{\"start\":{\"line\":32,\"column\":30,\"offset\":974},\"end\":{\"line\":32,\"column\":43,\"offset\":987}}}],\"position\":{\"start\":{\"line\":32,\"column\":29,\"offset\":973},\"end\":{\"line\":32,\"column\":183,\"offset\":1127}}},{\"type\":\"text\",\"value\":\":\",\"position\":{\"start\":{\"line\":32,\"column\":183,\"offset\":1127},\"end\":{\"line\":32,\"column\":184,\"offset\":1128}}}],\"position\":{\"start\":{\"line\":32,\"column\":5,\"offset\":949},\"end\":{\"line\":32,\"column\":184,\"offset\":1128}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-solidity\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"bytes32 remainingSegment = segment.getRemainingSegment(slotIndex);\\nif (remainingSegment == 0) {\\n   // Should only hit this branch on the last segment\\n   break;\\n}\\n\"}],\"position\":{\"start\":{\"line\":34,\"column\":5,\"offset\":1134},\"end\":{\"line\":40,\"column\":8,\"offset\":1335}}}],\"position\":{\"start\":{\"line\":34,\"column\":5,\"offset\":1134},\"end\":{\"line\":40,\"column\":8,\"offset\":1335}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":26,\"column\":1,\"offset\":778},\"end\":{\"line\":40,\"column\":8,\"offset\":1335}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"There are no holes / empty slots in the middle. Configurations like below should not be present:\",\"position\":{\"start\":{\"line\":42,\"column\":4,\"offset\":1340},\"end\":{\"line\":42,\"column\":100,\"offset\":1436}}}],\"position\":{\"start\":{\"line\":42,\"column\":4,\"offset\":1340},\"end\":{\"line\":42,\"column\":100,\"offset\":1436}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-display\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"□\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mover\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]}]},{\"type\":\"element\",\"tagName\":\"mo\",\"properties\":{\"lspace\":\"0em\",\"rspace\":\"0em\"},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]}]}]},{\"type\":\"element\",\"tagName\":\"mspace\",\"properties\":{\"width\":\"1em\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"mtext\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"invariant is broken\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\cdots \\\\blacksquare \\\\square \\\\blacksquare \\\\stackrel{\\\\leftarrow}{\\\\cdots} \\\\quad \\\\text{invariant is broken}\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.8698em;vertical-align:-0.0015em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"minner\"]},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.1667em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"■□■\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mop\",\"op-limits\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.8683em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.9985em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mop\"]},\"children\":[{\"type\":\"text\",\"value\":\"⋯\"}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-3.5115em;margin-left:0em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:3em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mrel\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"←\"}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.0015em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:1em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mspace\"],\"style\":\"margin-right:0.2778em;\"},\"children\":[]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"text\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"invariant is broken\"}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"In a presence of holes \",\"position\":{\"start\":{\"line\":48,\"column\":5,\"offset\":1565},\"end\":{\"line\":48,\"column\":28,\"offset\":1588}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"numOrdersFullyConsumed\",\"position\":{\"start\":{\"line\":48,\"column\":28,\"offset\":1588},\"end\":{\"line\":48,\"column\":52,\"offset\":1612}}}],\"position\":{\"start\":{\"line\":48,\"column\":28,\"offset\":1588},\"end\":{\"line\":48,\"column\":52,\"offset\":1612}}},{\"type\":\"text\",\"value\":\" would not get updated correctly which eventually in \",\"position\":{\"start\":{\"line\":48,\"column\":52,\"offset\":1612},\"end\":{\"line\":48,\"column\":105,\"offset\":1665}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_updateSegmentsAndTree\",\"position\":{\"start\":{\"line\":48,\"column\":105,\"offset\":1665},\"end\":{\"line\":48,\"column\":129,\"offset\":1689}}}],\"position\":{\"start\":{\"line\":48,\"column\":105,\"offset\":1665},\"end\":{\"line\":48,\"column\":129,\"offset\":1689}}},{\"type\":\"text\",\"value\":\" would cause the price segment and tree get updated in correctly in the storage.\",\"position\":{\"start\":{\"line\":48,\"column\":129,\"offset\":1689},\"end\":{\"line\":48,\"column\":209,\"offset\":1769}}}],\"position\":{\"start\":{\"line\":48,\"column\":5,\"offset\":1565},\"end\":{\"line\":48,\"column\":209,\"offset\":1769}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":42,\"column\":1,\"offset\":1337},\"end\":{\"line\":48,\"column\":209,\"offset\":1769}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":5,\"column\":1,\"offset\":162},\"end\":{\"line\":48,\"column\":209,\"offset\":1769}}},\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:2:props:children:1:props:children:1:props:children:props:children:3:props:children:props:children:1:4:props:node:children:1:children:1\",\"children\":\"only the beginning of the active area of the price segments can have empty slots\"}],\"\\n\",[\"$\",\"span\",\"span-0\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":[\"$\",\"mover\",\"mover-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"children\":[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋯\"}]}],[\"$\",\"mo\",\"mo-1\",{\"lspace\":\"0em\",\"rspace\":\"0em\",\"children\":\"←\"}]]}]}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\cdots\\n\\\\blacksquare \\\\square\\\\square \\\\stackrel{\\\\leftarrow}{\\\\cdots}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.8698em\",\"verticalAlign\":\"-0.0015em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mord amsrm\",\"children\":\"■□□\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-5\",{\"className\":\"mrel\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mop op-limits\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.8683em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.9985em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mop\",\"children\":\"⋯\"}]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.5115em\",\"marginLeft\":\"0em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mrel mtight\",\"children\":\"←\"}]}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.0015em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]}]]}]}]]}]}],\"\\n\",[\"$\",\"$L2f\",\"p-1\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:2:props:children:1:props:children:1:props:children:props:children:3:props:children:props:children:1:4:props:node:children:1:children:5\",\"children\":[\"which is assumed in the \",[\"$\",\"$L44\",\"a-0\",{\"repoId\":\"$undefined\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/SonicOrderBook.sol#L792-L798\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:2:props:children:1:props:children:1:props:children:props:children:3:props:children:props:children:1:4:props:node:children:1:children:5:children:1\",\"children\":\"snippet below\"}],\":\"]}],\"\\n\",[\"$\",\"$L45\",\"pre-0\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:2:props:children:1:props:children:1:props:children:props:children:3:props:children:props:children:1:4:props:node:children:1:children:7\",\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"bytes10 slot = segment.getSlot(slotIndex);\\nuint48 orderId = slot.getOrderId();\\nif (orderId == 0) {\\n   // Skip this order in the segment as it's been deleted\\n   ++numOrdersFullyConsumed;\\n   continue;\\n}\",\"inline\":false,\"language\":\"solidity\"}]}],[\"$\",\"$L46\",null,{\"content\":\"bytes10 slot = segment.getSlot(slotIndex);\\nuint48 orderId = slot.getOrderId();\\nif (orderId == 0) {\\n   // Skip this order in the segment as it's been deleted\\n   ++numOrdersFullyConsumed;\\n   continue;\\n}\\n\"}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:2:props:children:1:props:children:1:props:children:props:children:3:props:children:props:children:1:4:props:node:children:3:children:1\",\"children\":\"only the end the of the active area of the price segments can have empty slots\"}],\"\\n\",[\"$\",\"span\",\"span-0\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":[\"$\",\"mover\",\"mover-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"children\":[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋯\"}]}],[\"$\",\"mo\",\"mo-1\",{\"lspace\":\"0em\",\"rspace\":\"0em\",\"children\":\"←\"}]]}]}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\cdots \\\\square\\\\square \\\\blacksquare \\\\stackrel{\\\\leftarrow}{\\\\cdots}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.8698em\",\"verticalAlign\":\"-0.0015em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mord amsrm\",\"children\":\"□□■\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-5\",{\"className\":\"mrel\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mop op-limits\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.8683em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.9985em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mop\",\"children\":\"⋯\"}]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.5115em\",\"marginLeft\":\"0em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mrel mtight\",\"children\":\"←\"}]}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.0015em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]}]]}]}]]}]}],\"\\n\",[\"$\",\"$L2f\",\"p-1\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:2:props:children:1:props:children:1:props:children:props:children:3:props:children:props:children:1:4:props:node:children:3:children:5\",\"children\":[\"which is assumed in the \",[\"$\",\"$L44\",\"a-0\",{\"repoId\":\"$undefined\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/09a09846e01e2a471b593ad7052fde9160ddb154/contracts/SonicOrderBook.sol#L786-L790\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:2:props:children:1:props:children:1:props:children:props:children:3:props:children:props:children:1:4:props:node:children:3:children:5:children:1\",\"children\":\"snippet below\"}],\":\"]}],\"\\n\",[\"$\",\"$L45\",\"pre-0\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:2:props:children:1:props:children:1:props:children:props:children:3:props:children:props:children:1:4:props:node:children:3:children:7\",\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"bytes32 remainingSegment = segment.getRemainingSegment(slotIndex);\\nif (remainingSegment == 0) {\\n   // Should only hit this branch on the last segment\\n   break;\\n}\",\"inline\":false,\"language\":\"solidity\"}]}],[\"$\",\"$L46\",null,{\"content\":\"bytes32 remainingSegment = segment.getRemainingSegment(slotIndex);\\nif (remainingSegment == 0) {\\n   // Should only hit this branch on the last segment\\n   break;\\n}\\n\"}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":[\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:2:props:children:1:props:children:1:props:children:props:children:3:props:children:props:children:1:4:props:node:children:5:children:1\",\"children\":\"There are no holes / empty slots in the middle. Configurations like below should not be present:\"}],\"\\n\",[\"$\",\"span\",\"span-0\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":[\"$\",\"mover\",\"mover-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"children\":[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋯\"}]}],[\"$\",\"mo\",\"mo-1\",{\"lspace\":\"0em\",\"rspace\":\"0em\",\"children\":\"←\"}]]}]}],[\"$\",\"mspace\",\"mspace-0\",{\"width\":\"1em\"}],[\"$\",\"mtext\",\"mtext-0\",{\"children\":\"invariant is broken\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\cdots \\\\blacksquare \\\\square \\\\blacksquare \\\\stackrel{\\\\leftarrow}{\\\\cdots} \\\\quad \\\\text{invariant is broken}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.8698em\",\"verticalAlign\":\"-0.0015em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mord amsrm\",\"children\":\"■□■\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-5\",{\"className\":\"mrel\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mop op-limits\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.8683em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.9985em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mop\",\"children\":\"⋯\"}]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.5115em\",\"marginLeft\":\"0em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mrel mtight\",\"children\":\"←\"}]}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.0015em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]}],[\"$\",\"span\",\"span-6\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"1em\"}}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord text\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"invariant is broken\"}]}]]}]]}]]}]}],\"\\n\",[\"$\",\"$L2f\",\"p-1\",{\"mb\":\"3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:2:props:children:1:props:children:1:props:children:props:children:3:props:children:props:children:1:4:props:node:children:5:children:5\",\"children\":[\"In a presence of holes \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"numOrdersFullyConsumed\",\"inline\":true,\"language\":\"text\"}],\" would not get updated correctly which eventually in \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"_updateSegmentsAndTree\",\"inline\":true,\"language\":\"text\"}],\" would cause the price segment and tree get updated in correctly in the storage.\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"$L2f\",\"p-1\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"ie, if we lined up all the slots of the active area of the price segment it would look like:\",\"position\":{\"start\":{\"line\":50,\"column\":1,\"offset\":1771},\"end\":{\"line\":50,\"column\":93,\"offset\":1863}}}],\"position\":{\"start\":{\"line\":50,\"column\":1,\"offset\":1771},\"end\":{\"line\":50,\"column\":93,\"offset\":1863}}},\"children\":\"ie, if we lined up all the slots of the active area of the price segment it would look like:\"}],\"\\n\",[\"$\",\"span\",\"span-0\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-1\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-2\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mo\",\"mo-1\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-3\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-4\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mo\",\"mo-2\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-5\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-6\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mo\",\"mo-3\",{\"children\":\"⋯\"}],[\"$\",\"mi\",\"mi-7\",{\"mathvariant\":\"normal\",\"children\":\"■\"}],[\"$\",\"mi\",\"mi-8\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mi\",\"mi-9\",{\"mathvariant\":\"normal\",\"children\":\"□\"}],[\"$\",\"mo\",\"mo-4\",{\"children\":[\"$\",\"mover\",\"mover-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"children\":[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋯\"}]}],[\"$\",\"mo\",\"mo-1\",{\"lspace\":\"0em\",\"rspace\":\"0em\",\"children\":\"←\"}]]}]}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\cdots \\\\square\\\\square \\\\blacksquare \\\\cdots \\n\\\\blacksquare\\\\blacksquare \\\\cdots \\\\blacksquare\\\\blacksquare\\n\\\\cdots\\n\\\\blacksquare \\\\square\\\\square \\\\stackrel{\\\\leftarrow}{\\\\cdots}\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.8698em\",\"verticalAlign\":\"-0.0015em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mord amsrm\",\"children\":\"□□■\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-5\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-6\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-7\",{\"className\":\"mord amsrm\",\"children\":\"■■\"}],[\"$\",\"span\",\"span-8\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-9\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-10\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-11\",{\"className\":\"mord amsrm\",\"children\":\"■■\"}],[\"$\",\"span\",\"span-12\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-13\",{\"className\":\"minner\",\"children\":\"⋯\"}],[\"$\",\"span\",\"span-14\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-15\",{\"className\":\"mord amsrm\",\"children\":\"■□□\"}],[\"$\",\"span\",\"span-16\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-17\",{\"className\":\"mrel\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mop op-limits\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.8683em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.9985em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mop\",\"children\":\"⋯\"}]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.5115em\",\"marginLeft\":\"0em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mrel mtight\",\"children\":\"←\"}]}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.0015em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]}]]}]}]]}]}],\"\\n\",[\"$\",\"$L2f\",\"p-2\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Proving the above invariant as well as showing that the order ids of the non-empty slots \",\"position\":{\"start\":{\"line\":59,\"column\":1,\"offset\":2037},\"end\":{\"line\":59,\"column\":90,\"offset\":2126}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{\"mathvariant\":\"normal\"},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"\\\\blacksquare\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.675em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"amsrm\"]},\"children\":[{\"type\":\"text\",\"value\":\"■\"}]}]}]}]},{\"type\":\"text\",\"value\":\" increase monotonically involves many edge cases from different lines of the order book contract.  But this these are very important invariants and in case they get broken, many of the endpoints and storage updates would not act as intended or get modified correctly.\",\"position\":{\"start\":{\"line\":59,\"column\":104,\"offset\":2140},\"end\":{\"line\":59,\"column\":371,\"offset\":2407}}}],\"position\":{\"start\":{\"line\":59,\"column\":1,\"offset\":2037},\"end\":{\"line\":59,\"column\":371,\"offset\":2407}}},\"children\":[\"Proving the above invariant as well as showing that the order ids of the non-empty slots \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"mathvariant\":\"normal\",\"children\":\"■\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\blacksquare\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.675em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord amsrm\",\"children\":\"■\"}]]}]}]]}],\" increase monotonically involves many edge cases from different lines of the order book contract.  But this these are very important invariants and in case they get broken, many of the endpoints and storage updates would not act as intended or get modified correctly.\"]}],\"\\n\",[\"$\",\"$L37\",\"h2-1\",{\"as\":\"h2\",\"id\":\"recommendation\",\"mb\":\"5\",\"size\":\"xl\",\"node\":{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Recommendation\",\"position\":{\"start\":{\"line\":62,\"column\":4,\"offset\":2413},\"end\":{\"line\":62,\"column\":18,\"offset\":2427}}}],\"position\":{\"start\":{\"line\":62,\"column\":1,\"offset\":2410},\"end\":{\"line\":62,\"column\":18,\"offset\":2427}}},\"children\":\"Recommendation\"}],\"\\n\",[\"$\",\"$L2f\",\"p-3\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"It would be best to add invariant checks to the \",\"position\":{\"start\":{\"line\":64,\"column\":1,\"offset\":2429},\"end\":{\"line\":64,\"column\":49,\"offset\":2477}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_consumePriceSegments\",\"position\":{\"start\":{\"line\":64,\"column\":49,\"offset\":2477},\"end\":{\"line\":64,\"column\":72,\"offset\":2500}}}],\"position\":{\"start\":{\"line\":64,\"column\":49,\"offset\":2477},\"end\":{\"line\":64,\"column\":72,\"offset\":2500}}},{\"type\":\"text\",\"value\":\" and make it less prone to malfunction in the presence of holes in price segments:\",\"position\":{\"start\":{\"line\":64,\"column\":72,\"offset\":2500},\"end\":{\"line\":64,\"column\":154,\"offset\":2582}}}],\"position\":{\"start\":{\"line\":64,\"column\":1,\"offset\":2429},\"end\":{\"line\":64,\"column\":154,\"offset\":2582}}},\"children\":[\"It would be best to add invariant checks to the \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"_consumePriceSegments\",\"inline\":true,\"language\":\"text\"}],\" and make it less prone to malfunction in the presence of holes in price segments:\"]}],\"\\n\",[\"$\",\"$L45\",\"pre-0\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-diff\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"$5e\"}],\"position\":{\"start\":{\"line\":66,\"column\":1,\"offset\":2584},\"end\":{\"line\":171,\"column\":4,\"offset\":7513}}}],\"position\":{\"start\":{\"line\":66,\"column\":1,\"offset\":2584},\"end\":{\"line\":171,\"column\":4,\"offset\":7513}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"$5f\",\"inline\":false,\"language\":\"diff\"}]}],[\"$\",\"$L46\",null,{\"content\":\"$60\"}]]}],\"\\n\",[\"$\",\"$L2f\",\"p-4\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"In the branch where on is performing:\",\"position\":{\"start\":{\"line\":173,\"column\":1,\"offset\":7515},\"end\":{\"line\":173,\"column\":38,\"offset\":7552}}}],\"position\":{\"start\":{\"line\":173,\"column\":1,\"offset\":7515},\"end\":{\"line\":173,\"column\":38,\"offset\":7552}}},\"children\":\"In the branch where on is performing:\"}],\"\\n\",[\"$\",\"$L45\",\"pre-1\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-solidity\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"numOrdersFullyConsumed += NUM_SLOTS_PER_SEGMENT - slotIndex;\\n\"}],\"position\":{\"start\":{\"line\":175,\"column\":1,\"offset\":7554},\"end\":{\"line\":177,\"column\":4,\"offset\":7630}}}],\"position\":{\"start\":{\"line\":175,\"column\":1,\"offset\":7554},\"end\":{\"line\":177,\"column\":4,\"offset\":7630}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"numOrdersFullyConsumed += NUM_SLOTS_PER_SEGMENT - slotIndex;\",\"inline\":false,\"language\":\"solidity\"}]}],[\"$\",\"$L46\",null,{\"content\":\"numOrdersFullyConsumed += NUM_SLOTS_PER_SEGMENT - slotIndex;\\n\"}]]}],\"\\n\",[\"$\",\"$L2f\",\"p-5\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"One can instead revert, since it would indicate the precense of holes. But the above make \",\"position\":{\"start\":{\"line\":179,\"column\":1,\"offset\":7632},\"end\":{\"line\":179,\"column\":91,\"offset\":7722}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_consumePriceSegments\",\"position\":{\"start\":{\"line\":179,\"column\":91,\"offset\":7722},\"end\":{\"line\":179,\"column\":114,\"offset\":7745}}}],\"position\":{\"start\":{\"line\":179,\"column\":91,\"offset\":7722},\"end\":{\"line\":179,\"column\":114,\"offset\":7745}}},{\"type\":\"text\",\"value\":\" hole-resistant (ie, in the presence of holes this function would not get broken and act as expected, although the other flows make suffer from the holes such as \",\"position\":{\"start\":{\"line\":179,\"column\":114,\"offset\":7745},\"end\":{\"line\":179,\"column\":276,\"offset\":7907}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_find\",\"position\":{\"start\":{\"line\":179,\"column\":276,\"offset\":7907},\"end\":{\"line\":179,\"column\":283,\"offset\":7914}}}],\"position\":{\"start\":{\"line\":179,\"column\":276,\"offset\":7907},\"end\":{\"line\":179,\"column\":283,\"offset\":7914}}},{\"type\":\"text\",\"value\":\" or \",\"position\":{\"start\":{\"line\":179,\"column\":283,\"offset\":7914},\"end\":{\"line\":179,\"column\":287,\"offset\":7918}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_cancelOrder\",\"position\":{\"start\":{\"line\":179,\"column\":287,\"offset\":7918},\"end\":{\"line\":179,\"column\":301,\"offset\":7932}}}],\"position\":{\"start\":{\"line\":179,\"column\":287,\"offset\":7918},\"end\":{\"line\":179,\"column\":301,\"offset\":7932}}},{\"type\":\"text\",\"value\":\", ...). Another options would be to instead \",\"position\":{\"start\":{\"line\":179,\"column\":301,\"offset\":7932},\"end\":{\"line\":179,\"column\":345,\"offset\":7976}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"revert\",\"position\":{\"start\":{\"line\":179,\"column\":345,\"offset\":7976},\"end\":{\"line\":179,\"column\":353,\"offset\":7984}}}],\"position\":{\"start\":{\"line\":179,\"column\":345,\"offset\":7976},\"end\":{\"line\":179,\"column\":353,\"offset\":7984}}},{\"type\":\"text\",\"value\":\" here:\",\"position\":{\"start\":{\"line\":179,\"column\":353,\"offset\":7984},\"end\":{\"line\":179,\"column\":359,\"offset\":7990}}}],\"position\":{\"start\":{\"line\":179,\"column\":1,\"offset\":7632},\"end\":{\"line\":179,\"column\":359,\"offset\":7990}}},\"children\":[\"One can instead revert, since it would indicate the precense of holes. But the above make \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"_consumePriceSegments\",\"inline\":true,\"language\":\"text\"}],\" hole-resistant (ie, in the presence of holes this function would not get broken and act as expected, although the other flows make suffer from the holes such as \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"_find\",\"inline\":true,\"language\":\"text\"}],\" or \",[\"$\",\"$L43\",\"code-2\",{\"code\":\"_cancelOrder\",\"inline\":true,\"language\":\"text\"}],\", ...). Another options would be to instead \",[\"$\",\"$L43\",\"code-3\",{\"code\":\"revert\",\"inline\":true,\"language\":\"text\"}],\" here:\"]}],\"\\n\",[\"$\",\"$L45\",\"pre-2\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-solidity\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"revert PriceSegmentHasAHole();\\n\"}],\"position\":{\"start\":{\"line\":181,\"column\":1,\"offset\":7992},\"end\":{\"line\":183,\"column\":4,\"offset\":8038}}}],\"position\":{\"start\":{\"line\":181,\"column\":1,\"offset\":7992},\"end\":{\"line\":183,\"column\":4,\"offset\":8038}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"revert PriceSegmentHasAHole();\",\"inline\":false,\"language\":\"solidity\"}]}],[\"$\",\"$L46\",null,{\"content\":\"revert PriceSegmentHasAHole();\\n\"}]]}]]]}]}],false]}]}],[\"$\",\"$L3c\",\"fec5a33b-d790-40e4-ac94-1182dee9a832\",{\"children\":[\"$\",\"$L2d\",\"fec5a33b-d790-40e4-ac94-1182dee9a832\",{\"alignItems\":\"flex-start\",\"as\":\"section\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"borderRadius\":\"md\",\"gap\":6,\"p\":8,\"children\":[[\"$\",\"$L37\",null,{\"_before\":{\"content\":\"counter(report-severities) \\\".\\\" counter(report-severity-findings) \\\" \\\"\"},\"as\":\"h4\",\"color\":\"gray.950\",\"fontSize\":{\"base\":\"2xl\",\"md\":\"3xl\"},\"fontWeight\":\"semibold\",\"sx\":{\"counterIncrement\":\"report-severity-findings\"},\"wordBreak\":\"break-word\",\"children\":[\"$\",\"$L3d\",null,{\"text\":\"quote tokens received by the orderbook versus to-be-claimed quote tokens by sellers\"}]}],[\"$\",\"$L2d\",null,{\"alignItems\":\"stretch\",\"as\":\"dl\",\"gap\":2,\"sx\":{\"w\":\"full\",\"containerType\":\"inline-size\"},\"children\":[[\"$\",\"$L2e\",\"State\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"State\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":2,\"children\":[[\"$\",\"$L3e\",null,{\"alignItems\":\"center\",\"bgColor\":\"status.bg.fixed\",\"border\":\"1px solid\",\"borderColor\":\"status.bg.fixed\",\"color\":\"status.fixed\",\"display\":\"inline-flex\",\"gap\":1.5,\"lineHeight\":\"1rem\",\"minWidth\":\"fit-content\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"role\":\"$undefined\",\"size\":\"sm\",\"children\":[[\"$\",\"$L3f\",null,{\"boxSize\":3.5,\"strokeWidth\":\"2px\",\"children\":[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-wrench\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"cbrjhi\",{\"d\":\"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z\"}],\"$undefined\"]}]}],[\"$\",\"$L40\",null,{\"color\":\"inherit\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":\"Fixed\"}]]}],[[\"$\",\"$L3e\",\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\",{\"_hover\":{\"bg\":\"gray.100\"},\"as\":\"a\",\"bg\":\"white\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"borderRadius\":\"full\",\"color\":\"gray.950\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\",\"maxW\":\"10rem\",\"size\":\"sm\",\"target\":\"_blank\",\"children\":[\"$\",\"$L2f\",null,{\"isTruncated\":true,\"children\":\"PR #106\"}]}]]]}]}]]}],[\"$\",\"$L2e\",\"Severity\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Severity\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":2,\"children\":[[\"$\",\"$L3e\",null,{\"ref\":\"$undefined\",\"alignItems\":\"center\",\"bgColor\":\"transparent\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"display\":\"flex\",\"gap\":\"0.375rem\",\"lineHeight\":\"1rem\",\"size\":\"sm\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"fontWeight\":\"600\",\"children\":[[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.medium\",\"borderRadius\":\"full\",\"boxSize\":\"0.5rem\"}],[\"$\",\"$L40\",null,{\"color\":\"gray.950\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":[[\"Severity\",\": \"],\"Medium\"]}]]}],false]}]}]]}],[\"$\",\"$L2e\",\"Submitted by\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Submitted by\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L33\",null,{\"alignItems\":\"center\",\"as\":\"$34\",\"display\":\"flex\",\"gap\":2,\"href\":\"/u/Saw-mon-and-Natalie\",\"prefetch\":false,\"children\":[[\"$\",\"$L35\",null,{\"height\":\"20px\",\"src\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/8039eb9a-b849-4701-675d-fd94168a3300/public\",\"width\":\"20px\"}],[\"$\",\"$L2f\",null,{\"fontSize\":\"xs\",\"children\":[\" \",\"Saw-mon and Natalie\"]}]]}]}]]}]]}],[\"$\",\"$L36\",null,{}],[\"$\",\"$L41\",null,{\"children\":[\"$\",\"$L20\",null,{\"alignSelf\":\"stretch\",\"bg\":\"transparent\",\"className\":\"markdown-body\",\"flex\":\"1\",\"flexDirection\":\"column\",\"fontFamily\":\"body\",\"fontSize\":\"sm\",\"position\":\"relative\",\"sx\":{\"\u0026 code[class*=\\\"language-\\\"],  \u0026 pre[class*=\\\"language-\\\"]\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 code[class*=\\\"language-\\\"],  \u0026 pre[class*=\\\"language-\\\"]\",\"\u0026 :not(pre)\u003ecode[class*=\\\"language-\\\"]\":{\"whiteSpace\":\"normal\",\"borderRadius\":\"0.2em\",\"padding\":\"0.1em\"},\"\u0026 pre[class*=\\\"language-\\\"]\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 pre[class*=\\\"language-\\\"]\",\"\u0026 [class*=\\\"language-\\\"] .namespace\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 [class*=\\\"language-\\\"] .namespace\",\"\u0026 :where(img, svg, video, canvas, audio, iframe, embed, object)\":{\"display\":\"initial\"},\"\u0026 h1\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 h1\",\"\u0026 h2\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 h2\",\"\u0026 .token.tag,\u0026 .token.selector,\u0026 .token.keyword,\u0026 .token.operator,\u0026 .token.atrule\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.tag,\u0026 .token.selector,\u0026 .token.keyword,\u0026 .token.operator,\u0026 .token.atrule\",\"\u0026 .token.comment,\u0026 .token.prolog,\u0026 .token.doctype,\u0026 .token.cdata\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.comment,\u0026 .token.prolog,\u0026 .token.doctype,\u0026 .token.cdata\",\"\u0026 .token.namespace\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.namespace\",\"\u0026 .token.string,\u0026 .token.attr-value,\u0026 .token.attribute,\u0026 .token.pseudo-class,\u0026 .token.pseudo-element\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.string,\u0026 .token.attr-value,\u0026 .token.attribute,\u0026 .token.pseudo-class,\u0026 .token.pseudo-element\",\"\u0026 .token.number,\u0026 .token.boolean,\u0026 .token.builtin,\u0026 .token.entity,\u0026 .token.url,\u0026 .token.symbol,\u0026 .token.variable,\u0026 .token.constant,\u0026 .token.property,\u0026 .token.regex,\u0026 .token.attr-name,\u0026 .token.unit,\u0026 .token.hexcode\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.number,\u0026 .token.boolean,\u0026 .token.builtin,\u0026 .token.entity,\u0026 .token.url,\u0026 .token.symbol,\u0026 .token.variable,\u0026 .token.constant,\u0026 .token.property,\u0026 .token.regex,\u0026 .token.attr-name,\u0026 .token.unit,\u0026 .token.hexcode\",\"\u0026 .token.punctuation,\u0026 .token.char,\u0026 .token.class\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.punctuation,\u0026 .token.char,\u0026 .token.class\",\"\u0026 .token.function,\u0026 .token.class-name,\u0026 .token.function-variable,\u0026 .token.id\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.function,\u0026 .token.class-name,\u0026 .token.function-variable,\u0026 .token.id\",\"\u0026 .token.important,\u0026 .token.bold\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.important,\u0026 .token.bold\",\"\u0026 .token.italic\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.italic\",\"\u0026 .token.deleted\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.deleted\",\"\u0026 .token.inserted\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.inserted\"},\"wordBreak\":\"break-word\",\"children\":[[\"$\",\"$L42\",null,{\"frontmatter\":{}}],[[\"$\",\"$L37\",\"h2-0\",{\"as\":\"h2\",\"id\":\"description\",\"mb\":\"5\",\"size\":\"xl\",\"node\":{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Description\",\"position\":{\"start\":{\"line\":1,\"column\":4,\"offset\":3},\"end\":{\"line\":1,\"column\":15,\"offset\":14}}}],\"position\":{\"start\":{\"line\":1,\"column\":1,\"offset\":0},\"end\":{\"line\":1,\"column\":15,\"offset\":14}}},\"children\":\"Description\"}],\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"When a sell order is partially matched a few times the amount of quote tokens received by the orderbook would be:\",\"position\":{\"start\":{\"line\":3,\"column\":1,\"offset\":16},\"end\":{\"line\":3,\"column\":114,\"offset\":129}}}],\"position\":{\"start\":{\"line\":3,\"column\":1,\"offset\":16},\"end\":{\"line\":3,\"column\":114,\"offset\":129}}},\"children\":\"When a sell order is partially matched a few times the amount of quote tokens received by the orderbook would be:\"}],\"\\n\",[\"$\",\"span\",\"span-0\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"munder\",\"munder-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"children\":\"∑\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"j\"}]]}],[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"fence\":\"true\",\"children\":\"⌊\"}],[\"$\",\"mfrac\",\"mfrac-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"q\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"j\"}]]}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋅\"}],[\"$\",\"msub\",\"msub-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"p\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"o\"}]]}]]}],[\"$\",\"msup\",\"msup-0\",{\"children\":[[\"$\",\"mn\",\"mn-0\",{\"children\":\"10\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"d\"}]]}]]}],[\"$\",\"mo\",\"mo-1\",{\"fence\":\"true\",\"children\":\"⌋\"}]]}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\sum_{j} \\\\left\\\\lfloor \\\\frac{q_j \\\\cdot p_o}{10^d} \\\\right\\\\rfloor\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"2.5638em\",\"verticalAlign\":\"-1.4138em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mop op-limits\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-1.8723em\",\"marginLeft\":\"0em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.05em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.05724em\"},\"children\":\"j\"}]}]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.05em\"}}],[\"$\",\"span\",\"span-1\",{\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mop op-symbol large-op\",\"children\":\"∑\"}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.4138em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"minner\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size2\",\"children\":\"⌊\"}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen nulldelimiter\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mfrac\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.1215em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.314em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"1\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"0\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.7751em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.989em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}]}]]}]}]}]}]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.23em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"frac-line\",\"style\":{\"borderBottomWidth\":\"0.04em\"}}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-3.677em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3117em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.0359em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.05724em\"},\"children\":\"j\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2861em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mbin\",\"children\":\"⋅\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"p\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"o\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.686em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose nulldelimiter\"}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size2\",\"children\":\"⌋\"}]}]]}]]}]}]]}]}],\"\\n\",[\"$\",\"$L2f\",\"p-1\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"where \",\"position\":{\"start\":{\"line\":9,\"column\":1,\"offset\":201},\"end\":{\"line\":9,\"column\":7,\"offset\":207}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"j\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"j\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.854em;vertical-align:-0.1944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.05724em;\"},\"children\":[{\"type\":\"text\",\"value\":\"j\"}]}]}]}]},{\"type\":\"text\",\"value\":\" iterates over the partial match events of one specific order \",\"position\":{\"start\":{\"line\":9,\"column\":10,\"offset\":210},\"end\":{\"line\":9,\"column\":72,\"offset\":272}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.4306em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]}]}]}]},{\"type\":\"text\",\"value\":\" and \",\"position\":{\"start\":{\"line\":9,\"column\":75,\"offset\":275},\"end\":{\"line\":9,\"column\":80,\"offset\":280}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"p\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"p_o\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.625em;vertical-align:-0.1944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"p\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.1514em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"o\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.15em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\" is the price for this order, \",\"position\":{\"start\":{\"line\":9,\"column\":85,\"offset\":285},\"end\":{\"line\":9,\"column\":115,\"offset\":315}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msub\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"j\"}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"q_j\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.7167em;vertical-align:-0.2861em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"],\"style\":\"margin-right:0.03588em;\"},\"children\":[{\"type\":\"text\",\"value\":\"q\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\",\"vlist-t2\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.3117em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"],\"style\":\"margin-right:0.05724em;\"},\"children\":[{\"type\":\"text\",\"value\":\"j\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-s\"]},\"children\":[{\"type\":\"text\",\"value\":\"​\"}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.2861em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{},\"children\":[]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\" are the partial quantities filled. \",\"position\":{\"start\":{\"line\":9,\"column\":120,\"offset\":320},\"end\":{\"line\":9,\"column\":156,\"offset\":356}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6944em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\"]},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]}]}]}]},{\"type\":\"text\",\"value\":\" is the decimal of the \",\"position\":{\"start\":{\"line\":9,\"column\":159,\"offset\":359},\"end\":{\"line\":9,\"column\":182,\"offset\":382}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"NFT\",\"position\":{\"start\":{\"line\":9,\"column\":182,\"offset\":382},\"end\":{\"line\":9,\"column\":187,\"offset\":387}}}],\"position\":{\"start\":{\"line\":9,\"column\":182,\"offset\":382},\"end\":{\"line\":9,\"column\":187,\"offset\":387}}},{\"type\":\"text\",\"value\":\" contract which in this case would be \",\"position\":{\"start\":{\"line\":9,\"column\":187,\"offset\":387},\"end\":{\"line\":9,\"column\":225,\"offset\":425}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"18\"}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"18\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.6444em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"18\"}]}]}]}]},{\"type\":\"text\",\"value\":\".\",\"position\":{\"start\":{\"line\":9,\"column\":229,\"offset\":429},\"end\":{\"line\":9,\"column\":230,\"offset\":430}}}],\"position\":{\"start\":{\"line\":9,\"column\":1,\"offset\":201},\"end\":{\"line\":9,\"column\":230,\"offset\":430}}},\"children\":[\"where \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"children\":\"j\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"j\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.854em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.05724em\"},\"children\":\"j\"}]]}]}]]}],\" iterates over the partial match events of one specific order \",[\"$\",\"span\",\"span-1\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"children\":\"o\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"o\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.4306em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"children\":\"o\"}]]}]}]]}],\" and \",[\"$\",\"span\",\"span-2\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"p\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"o\"}]]}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"p_o\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.625em\",\"verticalAlign\":\"-0.1944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"p\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"o\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]}]]}],\" is the price for this order, \",[\"$\",\"span\",\"span-3\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"q\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"j\"}]]}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"q_j\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.7167em\",\"verticalAlign\":\"-0.2861em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3117em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.0359em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.05724em\"},\"children\":\"j\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2861em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]}]]}],\" are the partial quantities filled. \",[\"$\",\"span\",\"span-4\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mi\",\"mi-0\",{\"children\":\"d\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"d\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6944em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord mathnormal\",\"children\":\"d\"}]]}]}]]}],\" is the decimal of the \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"NFT\",\"inline\":true,\"language\":\"text\"}],\" contract which in this case would be \",[\"$\",\"span\",\"span-5\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"mn\",\"mn-0\",{\"children\":\"18\"}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"18\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.6444em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"18\"}]]}]}]]}],\".\"]}],\"\\n\",[\"$\",\"$L2f\",\"p-2\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"When the user wants to claim these partial matches in \",\"position\":{\"start\":{\"line\":11,\"column\":1,\"offset\":432},\"end\":{\"line\":11,\"column\":55,\"offset\":486}}},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L360-L383\"},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_claimTokens\",\"position\":{\"start\":{\"line\":11,\"column\":56,\"offset\":487},\"end\":{\"line\":11,\"column\":70,\"offset\":501}}}],\"position\":{\"start\":{\"line\":11,\"column\":56,\"offset\":487},\"end\":{\"line\":11,\"column\":70,\"offset\":501}}}],\"position\":{\"start\":{\"line\":11,\"column\":55,\"offset\":486},\"end\":{\"line\":11,\"column\":210,\"offset\":641}}},{\"type\":\"text\",\"value\":\" and \",\"position\":{\"start\":{\"line\":11,\"column\":210,\"offset\":641},\"end\":{\"line\":11,\"column\":215,\"offset\":646}}},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L1314-L1334\"},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_calculateClaimableTokens\",\"position\":{\"start\":{\"line\":11,\"column\":216,\"offset\":647},\"end\":{\"line\":11,\"column\":243,\"offset\":674}}}],\"position\":{\"start\":{\"line\":11,\"column\":216,\"offset\":647},\"end\":{\"line\":11,\"column\":243,\"offset\":674}}}],\"position\":{\"start\":{\"line\":11,\"column\":215,\"offset\":646},\"end\":{\"line\":11,\"column\":385,\"offset\":816}}},{\"type\":\"text\",\"value\":\" the amount to be claimed and sent to the \",\"position\":{\"start\":{\"line\":11,\"column\":385,\"offset\":816},\"end\":{\"line\":11,\"column\":427,\"offset\":858}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"maker\",\"position\":{\"start\":{\"line\":11,\"column\":427,\"offset\":858},\"end\":{\"line\":11,\"column\":434,\"offset\":865}}}],\"position\":{\"start\":{\"line\":11,\"column\":427,\"offset\":858},\"end\":{\"line\":11,\"column\":434,\"offset\":865}}},{\"type\":\"text\",\"value\":\" and the \",\"position\":{\"start\":{\"line\":11,\"column\":434,\"offset\":865},\"end\":{\"line\":11,\"column\":443,\"offset\":874}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"dev\",\"position\":{\"start\":{\"line\":11,\"column\":443,\"offset\":874},\"end\":{\"line\":11,\"column\":448,\"offset\":879}}}],\"position\":{\"start\":{\"line\":11,\"column\":443,\"offset\":874},\"end\":{\"line\":11,\"column\":448,\"offset\":879}}},{\"type\":\"text\",\"value\":\" would be:\",\"position\":{\"start\":{\"line\":11,\"column\":448,\"offset\":879},\"end\":{\"line\":11,\"column\":458,\"offset\":889}}}],\"position\":{\"start\":{\"line\":11,\"column\":1,\"offset\":432},\"end\":{\"line\":11,\"column\":458,\"offset\":889}}},\"children\":[\"When the user wants to claim these partial matches in \",[\"$\",\"$L44\",\"a-0\",{\"repoId\":\"$undefined\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L360-L383\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:2:props:children:1:props:children:2:props:children:props:children:3:props:children:props:children:1:8:props:node:children:1\",\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"_claimTokens\",\"inline\":true,\"language\":\"text\"}]}],\" and \",[\"$\",\"$L44\",\"a-1\",{\"repoId\":\"$undefined\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/blob/a9d07838e147e78845139270d2ce0374174b8951/contracts/SonicOrderBook.sol#L1314-L1334\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:2:props:children:1:props:children:2:props:children:props:children:3:props:children:props:children:1:8:props:node:children:3\",\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"_calculateClaimableTokens\",\"inline\":true,\"language\":\"text\"}]}],\" the amount to be claimed and sent to the \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"maker\",\"inline\":true,\"language\":\"text\"}],\" and the \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"dev\",\"inline\":true,\"language\":\"text\"}],\" would be:\"]}],\"\\n\",[\"$\",\"span\",\"span-1\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"fence\":\"true\",\"children\":\"⌊\"}],[\"$\",\"mfrac\",\"mfrac-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"munder\",\"munder-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"children\":\"∑\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"j\"}]]}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"q\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"j\"}]]}],[\"$\",\"mo\",\"mo-1\",{\"stretchy\":\"false\",\"children\":\")\"}],[\"$\",\"mo\",\"mo-2\",{\"children\":\"⋅\"}],[\"$\",\"msub\",\"msub-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"p\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"o\"}]]}]]}],[\"$\",\"msup\",\"msup-0\",{\"children\":[[\"$\",\"mn\",\"mn-0\",{\"children\":\"10\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"d\"}]]}]]}],[\"$\",\"mo\",\"mo-1\",{\"fence\":\"true\",\"children\":\"⌋\"}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\left\\\\lfloor \\\\frac{(\\\\sum_j q_j) \\\\cdot p_o}{10^d} \\\\right\\\\rfloor\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"2.5258em\",\"verticalAlign\":\"-0.95em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"minner\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size3\",\"children\":\"⌊\"}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen nulldelimiter\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mfrac\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.5758em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.314em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"1\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"0\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.7751em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.989em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}]}]]}]}]}]}]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.23em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"frac-line\",\"style\":{\"borderBottomWidth\":\"0.04em\"}}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-3.8258em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mop\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mop op-symbol small-op\",\"style\":{\"position\":\"relative\",\"top\":\"0em\"},\"children\":\"∑\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.162em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.4003em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.05724em\"},\"children\":\"j\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.4358em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3117em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.0359em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.05724em\"},\"children\":\"j\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2861em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-4\",{\"className\":\"mclose\",\"children\":\")\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mbin\",\"children\":\"⋅\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"p\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"o\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.686em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose nulldelimiter\"}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size3\",\"children\":\"⌋\"}]}]]}]]}]}]]}]}],\"\\n\",[\"$\",\"$L2f\",\"p-3\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"But we have:\",\"position\":{\"start\":{\"line\":17,\"column\":1,\"offset\":961},\"end\":{\"line\":17,\"column\":13,\"offset\":973}}}],\"position\":{\"start\":{\"line\":17,\"column\":1,\"offset\":961},\"end\":{\"line\":17,\"column\":13,\"offset\":973}}},\"children\":\"But we have:\"}],\"\\n\",[\"$\",\"span\",\"span-2\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"fence\":\"true\",\"children\":\"⌊\"}],[\"$\",\"mfrac\",\"mfrac-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"munder\",\"munder-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"children\":\"∑\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"j\"}]]}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"q\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"j\"}]]}],[\"$\",\"mo\",\"mo-1\",{\"stretchy\":\"false\",\"children\":\")\"}],[\"$\",\"mo\",\"mo-2\",{\"children\":\"⋅\"}],[\"$\",\"msub\",\"msub-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"p\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"o\"}]]}]]}],[\"$\",\"msup\",\"msup-0\",{\"children\":[[\"$\",\"mn\",\"mn-0\",{\"children\":\"10\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"d\"}]]}]]}],[\"$\",\"mo\",\"mo-1\",{\"fence\":\"true\",\"children\":\"⌋\"}]]}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"≥\"}],[\"$\",\"munder\",\"munder-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"children\":\"∑\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"j\"}]]}],[\"$\",\"mrow\",\"mrow-1\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"fence\":\"true\",\"children\":\"⌊\"}],[\"$\",\"mfrac\",\"mfrac-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"q\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"j\"}]]}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋅\"}],[\"$\",\"msub\",\"msub-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"p\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"o\"}]]}]]}],[\"$\",\"msup\",\"msup-0\",{\"children\":[[\"$\",\"mn\",\"mn-0\",{\"children\":\"10\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"d\"}]]}]]}],[\"$\",\"mo\",\"mo-1\",{\"fence\":\"true\",\"children\":\"⌋\"}]]}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\left\\\\lfloor \\\\frac{(\\\\sum_j q_j) \\\\cdot p_o}{10^d} \\\\right\\\\rfloor \\\\geq \\\\sum_{j} \\\\left\\\\lfloor \\\\frac{q_j \\\\cdot p_o}{10^d} \\\\right\\\\rfloor\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"2.5258em\",\"verticalAlign\":\"-0.95em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"minner\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size3\",\"children\":\"⌊\"}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen nulldelimiter\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mfrac\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.5758em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.314em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"1\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"0\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.7751em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.989em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}]}]]}]}]}]}]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.23em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"frac-line\",\"style\":{\"borderBottomWidth\":\"0.04em\"}}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-3.8258em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mop\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mop op-symbol small-op\",\"style\":{\"position\":\"relative\",\"top\":\"0em\"},\"children\":\"∑\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.162em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.4003em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.05724em\"},\"children\":\"j\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.4358em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3117em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.0359em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.05724em\"},\"children\":\"j\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2861em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-4\",{\"className\":\"mclose\",\"children\":\")\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mbin\",\"children\":\"⋅\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"p\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"o\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.686em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose nulldelimiter\"}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size3\",\"children\":\"⌋\"}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":\"≥\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"2.5638em\",\"verticalAlign\":\"-1.4138em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mop op-limits\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-1.8723em\",\"marginLeft\":\"0em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.05em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.05724em\"},\"children\":\"j\"}]}]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.05em\"}}],[\"$\",\"span\",\"span-1\",{\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mop op-symbol large-op\",\"children\":\"∑\"}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.4138em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"minner\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size2\",\"children\":\"⌊\"}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen nulldelimiter\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mfrac\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.1215em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.314em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"1\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"0\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.7751em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.989em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}]}]]}]}]}]}]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.23em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"frac-line\",\"style\":{\"borderBottomWidth\":\"0.04em\"}}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-3.677em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3117em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.0359em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.05724em\"},\"children\":\"j\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2861em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mbin\",\"children\":\"⋅\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"p\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"o\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.686em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose nulldelimiter\"}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size2\",\"children\":\"⌋\"}]}]]}]]}]]}]]}]}],\"\\n\",[\"$\",\"$L2f\",\"p-4\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Thus if these divisions are not exact, the orderbook would not have enough quote tokens to compensate for the claims.\",\"position\":{\"start\":{\"line\":23,\"column\":1,\"offset\":1113},\"end\":{\"line\":23,\"column\":118,\"offset\":1230}}}],\"position\":{\"start\":{\"line\":23,\"column\":1,\"offset\":1113},\"end\":{\"line\":23,\"column\":118,\"offset\":1230}}},\"children\":\"Thus if these divisions are not exact, the orderbook would not have enough quote tokens to compensate for the claims.\"}],\"\\n\",[\"$\",\"$L37\",\"h2-1\",{\"as\":\"h2\",\"id\":\"recommendation\",\"mb\":\"5\",\"size\":\"xl\",\"node\":{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Recommendation\",\"position\":{\"start\":{\"line\":25,\"column\":4,\"offset\":1235},\"end\":{\"line\":25,\"column\":18,\"offset\":1249}}}],\"position\":{\"start\":{\"line\":25,\"column\":1,\"offset\":1232},\"end\":{\"line\":25,\"column\":18,\"offset\":1249}}},\"children\":\"Recommendation\"}],\"\\n\",[\"$\",\"$L2f\",\"p-5\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Either one needs to make sure the divisions are exact by setting restrictions on the \",\"position\":{\"start\":{\"line\":27,\"column\":1,\"offset\":1251},\"end\":{\"line\":27,\"column\":86,\"offset\":1336}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"priceTicks\",\"position\":{\"start\":{\"line\":27,\"column\":86,\"offset\":1336},\"end\":{\"line\":27,\"column\":98,\"offset\":1348}}}],\"position\":{\"start\":{\"line\":27,\"column\":86,\"offset\":1336},\"end\":{\"line\":27,\"column\":98,\"offset\":1348}}},{\"type\":\"text\",\"value\":\" and quantity ticks to make sure their product would be division by \",\"position\":{\"start\":{\"line\":27,\"column\":98,\"offset\":1348},\"end\":{\"line\":27,\"column\":166,\"offset\":1416}}},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-mathml\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"math\",\"properties\":{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\"},\"children\":[{\"type\":\"element\",\"tagName\":\"semantics\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mrow\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"msup\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"mn\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"10\"}]},{\"type\":\"element\",\"tagName\":\"mi\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]}]}]},{\"type\":\"element\",\"tagName\":\"annotation\",\"properties\":{\"encoding\":\"application/x-tex\"},\"children\":[{\"type\":\"text\",\"value\":\"10^d\"}]}]}]}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"katex-html\"],\"ariaHidden\":\"true\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"base\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"strut\"],\"style\":\"height:0.8491em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"1\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\"]},\"children\":[{\"type\":\"text\",\"value\":\"0\"}]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"msupsub\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-t\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist-r\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"vlist\"],\"style\":\"height:0.8491em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"style\":\"top:-3.063em;margin-right:0.05em;\"},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"pstrut\"],\"style\":\"height:2.7em;\"},\"children\":[]},{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"sizing\",\"reset-size6\",\"size3\",\"mtight\"]},\"children\":[{\"type\":\"element\",\"tagName\":\"span\",\"properties\":{\"className\":[\"mord\",\"mathnormal\",\"mtight\"]},\"children\":[{\"type\":\"text\",\"value\":\"d\"}]}]}]}]}]}]}]}]}]}]}]},{\"type\":\"text\",\"value\":\". Moreover one needs to throughout the codebase make sure that the invariant of\",\"position\":{\"start\":{\"line\":27,\"column\":172,\"offset\":1422},\"end\":{\"line\":27,\"column\":251,\"offset\":1501}}}],\"position\":{\"start\":{\"line\":27,\"column\":1,\"offset\":1251},\"end\":{\"line\":27,\"column\":252,\"offset\":1502}}},\"children\":[\"Either one needs to make sure the divisions are exact by setting restrictions on the \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"priceTicks\",\"inline\":true,\"language\":\"text\"}],\" and quantity ticks to make sure their product would be division by \",[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[\"$\",\"msup\",\"msup-0\",{\"children\":[[\"$\",\"mn\",\"mn-0\",{\"children\":\"10\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"d\"}]]}]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"10^d\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"0.8491em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":\"1\"}],[\"$\",\"span\",\"span-2\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"0\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.8491em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-3.063em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}]}]]}]}]}]}]}]]}]]}]}]]}],\". Moreover one needs to throughout the codebase make sure that the invariant of\"]}],\"\\n\",[\"$\",\"$L3b\",\"ol-0\",{\"node\":{\"type\":\"element\",\"tagName\":\"ol\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"prices being divisible by \",\"position\":{\"start\":{\"line\":29,\"column\":4,\"offset\":1507},\"end\":{\"line\":29,\"column\":30,\"offset\":1533}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"priceTick\",\"position\":{\"start\":{\"line\":29,\"column\":30,\"offset\":1533},\"end\":{\"line\":29,\"column\":41,\"offset\":1544}}}],\"position\":{\"start\":{\"line\":29,\"column\":30,\"offset\":1533},\"end\":{\"line\":29,\"column\":41,\"offset\":1544}}}],\"position\":{\"start\":{\"line\":29,\"column\":1,\"offset\":1504},\"end\":{\"line\":29,\"column\":41,\"offset\":1544}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"quantities being divisible by quantity tick\",\"position\":{\"start\":{\"line\":30,\"column\":4,\"offset\":1548},\"end\":{\"line\":30,\"column\":47,\"offset\":1591}}}],\"position\":{\"start\":{\"line\":30,\"column\":1,\"offset\":1545},\"end\":{\"line\":30,\"column\":47,\"offset\":1591}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":29,\"column\":1,\"offset\":1504},\"end\":{\"line\":30,\"column\":47,\"offset\":1591}}},\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[\"prices being divisible by \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"priceTick\",\"inline\":true,\"language\":\"text\"}]]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":\"quantities being divisible by quantity tick\"}],\"\\n\"]}],\"\\n\",[\"$\",\"$L2f\",\"p-6\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"to be satisfied.\",\"position\":{\"start\":{\"line\":32,\"column\":1,\"offset\":1593},\"end\":{\"line\":32,\"column\":17,\"offset\":1609}}}],\"position\":{\"start\":{\"line\":32,\"column\":1,\"offset\":1593},\"end\":{\"line\":32,\"column\":17,\"offset\":1609}}},\"children\":\"to be satisfied.\"}],\"\\n\",[\"$\",\"$L2f\",\"p-7\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"For the above apply this patch:\",\"position\":{\"start\":{\"line\":34,\"column\":1,\"offset\":1611},\"end\":{\"line\":34,\"column\":32,\"offset\":1642}}}],\"position\":{\"start\":{\"line\":34,\"column\":1,\"offset\":1611},\"end\":{\"line\":34,\"column\":32,\"offset\":1642}}},\"children\":\"For the above apply this patch:\"}],\"\\n\",[\"$\",\"$L45\",\"pre-0\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-diff\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"diff --git a/contracts/libraries/SonicOrderBookLibrary.sol b/contracts/libraries/SonicOrderBookLibrary.sol\\nindex de229f7..08cd374 100644\\n--- a/contracts/libraries/SonicOrderBookLibrary.sol\\n+++ b/contracts/libraries/SonicOrderBookLibrary.sol\\n@@ -31,6 +31,7 @@ library SonicOrderBookLibrary {\\n   error DevFeeTooHigh();\\n   error DevFeeNotSet();\\n   error MaxOrdersNotMultipleOfOrdersInSegment();\\n+  error PriceTickShouldBeAMultipleOf100();\\n \\n   uint256 private constant SET_TRADEABLE_THRESHOLD_LOCKED_BURN_TIME = 7 days;\\n \\n@@ -57,6 +58,7 @@ library SonicOrderBookLibrary {\\n \\n       require(existingTick == 0 || existingTick == newTick, PriceTickCannotBeChanged());\\n       require(newTick != 0, PriceTickCannotBeZero());\\n+      require(newTick % 100 == 0, PriceTickShouldBeAMultipleOf100());\\n \\n       SeasonData memory seasonData = nft.getSeasonData(Season(tokenId));\\n       if (seasonData.startTime != 0 \u0026\u0026 tokenIdInfos[i].isTradeable) {\\n\"}],\"position\":{\"start\":{\"line\":36,\"column\":1,\"offset\":1644},\"end\":{\"line\":57,\"column\":4,\"offset\":2589}}}],\"position\":{\"start\":{\"line\":36,\"column\":1,\"offset\":1644},\"end\":{\"line\":57,\"column\":4,\"offset\":2589}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"diff --git a/contracts/libraries/SonicOrderBookLibrary.sol b/contracts/libraries/SonicOrderBookLibrary.sol\\nindex de229f7..08cd374 100644\\n--- a/contracts/libraries/SonicOrderBookLibrary.sol\\n+++ b/contracts/libraries/SonicOrderBookLibrary.sol\\n@@ -31,6 +31,7 @@ library SonicOrderBookLibrary {\\n   error DevFeeTooHigh();\\n   error DevFeeNotSet();\\n   error MaxOrdersNotMultipleOfOrdersInSegment();\\n+  error PriceTickShouldBeAMultipleOf100();\\n \\n   uint256 private constant SET_TRADEABLE_THRESHOLD_LOCKED_BURN_TIME = 7 days;\\n \\n@@ -57,6 +58,7 @@ library SonicOrderBookLibrary {\\n \\n       require(existingTick == 0 || existingTick == newTick, PriceTickCannotBeChanged());\\n       require(newTick != 0, PriceTickCannotBeZero());\\n+      require(newTick % 100 == 0, PriceTickShouldBeAMultipleOf100());\\n \\n       SeasonData memory seasonData = nft.getSeasonData(Season(tokenId));\\n       if (seasonData.startTime != 0 \u0026\u0026 tokenIdInfos[i].isTradeable) {\",\"inline\":false,\"language\":\"diff\"}]}],[\"$\",\"$L46\",null,{\"content\":\"diff --git a/contracts/libraries/SonicOrderBookLibrary.sol b/contracts/libraries/SonicOrderBookLibrary.sol\\nindex de229f7..08cd374 100644\\n--- a/contracts/libraries/SonicOrderBookLibrary.sol\\n+++ b/contracts/libraries/SonicOrderBookLibrary.sol\\n@@ -31,6 +31,7 @@ library SonicOrderBookLibrary {\\n   error DevFeeTooHigh();\\n   error DevFeeNotSet();\\n   error MaxOrdersNotMultipleOfOrdersInSegment();\\n+  error PriceTickShouldBeAMultipleOf100();\\n \\n   uint256 private constant SET_TRADEABLE_THRESHOLD_LOCKED_BURN_TIME = 7 days;\\n \\n@@ -57,6 +58,7 @@ library SonicOrderBookLibrary {\\n \\n       require(existingTick == 0 || existingTick == newTick, PriceTickCannotBeChanged());\\n       require(newTick != 0, PriceTickCannotBeZero());\\n+      require(newTick % 100 == 0, PriceTickShouldBeAMultipleOf100());\\n \\n       SeasonData memory seasonData = nft.getSeasonData(Season(tokenId));\\n       if (seasonData.startTime != 0 \u0026\u0026 tokenIdInfos[i].isTradeable) {\\n\"}]]}],\"\\n\",[\"$\",\"$L2f\",\"p-8\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Another solution would be to simply overestimate the case (this would not require checking for the above conditions at least for cost related issues). Overestimating would guarantee that for partially matching a specific order multiple times we would have:\",\"position\":{\"start\":{\"line\":59,\"column\":1,\"offset\":2591},\"end\":{\"line\":59,\"column\":257,\"offset\":2847}}}],\"position\":{\"start\":{\"line\":59,\"column\":1,\"offset\":2591},\"end\":{\"line\":59,\"column\":257,\"offset\":2847}}},\"children\":\"Another solution would be to simply overestimate the case (this would not require checking for the above conditions at least for cost related issues). Overestimating would guarantee that for partially matching a specific order multiple times we would have:\"}],\"\\n\",[\"$\",\"span\",\"span-3\",{\"className\":\"katex-display\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"katex\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"katex-mathml\",\"children\":[\"$\",\"math\",\"math-0\",{\"xmlns\":\"http://www.w3.org/1998/Math/MathML\",\"display\":\"block\",\"children\":[\"$\",\"semantics\",\"semantics-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"fence\":\"true\",\"children\":\"⌈\"}],[\"$\",\"mfrac\",\"mfrac-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"stretchy\":\"false\",\"children\":\"(\"}],[\"$\",\"munder\",\"munder-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"children\":\"∑\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"j\"}]]}],[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"q\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"j\"}]]}],[\"$\",\"mo\",\"mo-1\",{\"stretchy\":\"false\",\"children\":\")\"}],[\"$\",\"mo\",\"mo-2\",{\"children\":\"⋅\"}],[\"$\",\"msub\",\"msub-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"p\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"o\"}]]}]]}],[\"$\",\"msup\",\"msup-0\",{\"children\":[[\"$\",\"mn\",\"mn-0\",{\"children\":\"10\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"d\"}]]}]]}],[\"$\",\"mo\",\"mo-1\",{\"fence\":\"true\",\"children\":\"⌉\"}]]}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"≤\"}],[\"$\",\"munder\",\"munder-0\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"children\":\"∑\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"j\"}]]}],[\"$\",\"mrow\",\"mrow-1\",{\"children\":[[\"$\",\"mo\",\"mo-0\",{\"fence\":\"true\",\"children\":\"⌈\"}],[\"$\",\"mfrac\",\"mfrac-0\",{\"children\":[[\"$\",\"mrow\",\"mrow-0\",{\"children\":[[\"$\",\"msub\",\"msub-0\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"q\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"j\"}]]}],[\"$\",\"mo\",\"mo-0\",{\"children\":\"⋅\"}],[\"$\",\"msub\",\"msub-1\",{\"children\":[[\"$\",\"mi\",\"mi-0\",{\"children\":\"p\"}],[\"$\",\"mi\",\"mi-1\",{\"children\":\"o\"}]]}]]}],[\"$\",\"msup\",\"msup-0\",{\"children\":[[\"$\",\"mn\",\"mn-0\",{\"children\":\"10\"}],[\"$\",\"mi\",\"mi-0\",{\"children\":\"d\"}]]}]]}],[\"$\",\"mo\",\"mo-1\",{\"fence\":\"true\",\"children\":\"⌉\"}]]}]]}],[\"$\",\"annotation\",\"annotation-0\",{\"encoding\":\"application/x-tex\",\"children\":\"\\\\left\\\\lceil \\\\frac{(\\\\sum_j q_j) \\\\cdot p_o}{10^d} \\\\right\\\\rceil \\\\leq \\\\sum_{j} \\\\left\\\\lceil \\\\frac{q_j \\\\cdot p_o}{10^d} \\\\right\\\\rceil\"}]]}]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"katex-html\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"2.5258em\",\"verticalAlign\":\"-0.95em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"minner\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size3\",\"children\":\"⌈\"}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen nulldelimiter\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mfrac\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.5758em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.314em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"1\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"0\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.7751em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.989em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}]}]]}]}]}]}]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.23em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"frac-line\",\"style\":{\"borderBottomWidth\":\"0.04em\"}}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-3.8258em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen\",\"children\":\"(\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mop\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mop op-symbol small-op\",\"style\":{\"position\":\"relative\",\"top\":\"0em\"},\"children\":\"∑\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.162em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.4003em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.05724em\"},\"children\":\"j\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.4358em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3117em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.0359em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.05724em\"},\"children\":\"j\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2861em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-4\",{\"className\":\"mclose\",\"children\":\")\"}],[\"$\",\"span\",\"span-5\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-6\",{\"className\":\"mbin\",\"children\":\"⋅\"}],[\"$\",\"span\",\"span-7\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-8\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"p\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"o\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.686em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose nulldelimiter\"}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size3\",\"children\":\"⌉\"}]}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"mrel\",\"children\":\"≤\"}],[\"$\",\"span\",\"span-4\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2778em\"}}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"base\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"strut\",\"style\":{\"height\":\"2.5638em\",\"verticalAlign\":\"-1.4138em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mop op-limits\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-1.8723em\",\"marginLeft\":\"0em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.05em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.05724em\"},\"children\":\"j\"}]}]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3.05em\"}}],[\"$\",\"span\",\"span-1\",{\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mop op-symbol large-op\",\"children\":\"∑\"}]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.4138em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.1667em\"}}],[\"$\",\"span\",\"span-3\",{\"className\":\"minner\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size2\",\"children\":\"⌈\"}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mopen nulldelimiter\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mfrac\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"1.1215em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.314em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"1\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":\"0\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.7751em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.989em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"d\"}]}]]}]}]}]}]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"style\":{\"top\":\"-3.23em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"frac-line\",\"style\":{\"borderBottomWidth\":\"0.04em\"}}]]}],[\"$\",\"span\",\"span-2\",{\"style\":{\"top\":\"-3.677em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"3em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"style\":{\"marginRight\":\"0.03588em\"},\"children\":\"q\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.3117em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"-0.0359em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"style\":{\"marginRight\":\"0.05724em\"},\"children\":\"j\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.2861em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-2\",{\"className\":\"mbin\",\"children\":\"⋅\"}],[\"$\",\"span\",\"span-3\",{\"className\":\"mspace\",\"style\":{\"marginRight\":\"0.2222em\"}}],[\"$\",\"span\",\"span-4\",{\"className\":\"mord\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal\",\"children\":\"p\"}],[\"$\",\"span\",\"span-1\",{\"className\":\"msupsub\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-t vlist-t2\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist-r\",\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.1514em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"top\":\"-2.55em\",\"marginLeft\":\"0em\",\"marginRight\":\"0.05em\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"className\":\"pstrut\",\"style\":{\"height\":\"2.7em\"}}],[\"$\",\"span\",\"span-1\",{\"className\":\"sizing reset-size6 size3 mtight\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"mord mathnormal mtight\",\"children\":\"o\"}]}]]}]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.15em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}]]}]]}]]}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-s\",\"children\":\"​\"}]]}],[\"$\",\"span\",\"span-1\",{\"className\":\"vlist-r\",\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"vlist\",\"style\":{\"height\":\"0.686em\"},\"children\":[\"$\",\"span\",\"span-0\",{}]}]}]]}]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose nulldelimiter\"}]]}],[\"$\",\"span\",\"span-2\",{\"className\":\"mclose delimcenter\",\"style\":{\"top\":\"0em\"},\"children\":[\"$\",\"span\",\"span-0\",{\"className\":\"delimsizing size2\",\"children\":\"⌉\"}]}]]}]]}]]}]]}]}],\"\\n\",[\"$\",\"$L2f\",\"p-9\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"ie, in this case the orderbook should have enough quote tokens to cover the cost of a maker whose sell orders get partially filled a few times.\",\"position\":{\"start\":{\"line\":65,\"column\":1,\"offset\":2983},\"end\":{\"line\":65,\"column\":144,\"offset\":3126}}}],\"position\":{\"start\":{\"line\":65,\"column\":1,\"offset\":2983},\"end\":{\"line\":65,\"column\":144,\"offset\":3126}}},\"children\":\"ie, in this case the orderbook should have enough quote tokens to cover the cost of a maker whose sell orders get partially filled a few times.\"}],\"\\n\",[\"$\",\"$L2f\",\"p-10\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"So in summary:\",\"position\":{\"start\":{\"line\":67,\"column\":1,\"offset\":3128},\"end\":{\"line\":67,\"column\":15,\"offset\":3142}}}],\"position\":{\"start\":{\"line\":67,\"column\":1,\"offset\":3128},\"end\":{\"line\":67,\"column\":15,\"offset\":3142}}},\"children\":\"So in summary:\"}],\"\\n\",[\"$\",\"$L54\",\"ul-0\",{\"node\":{\"type\":\"element\",\"tagName\":\"ul\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"overestimate the cost for matching into sell orders\",\"position\":{\"start\":{\"line\":69,\"column\":3,\"offset\":3146},\"end\":{\"line\":69,\"column\":54,\"offset\":3197}}}],\"position\":{\"start\":{\"line\":69,\"column\":1,\"offset\":3144},\"end\":{\"line\":69,\"column\":54,\"offset\":3197}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"underestimate the cost for matching into buy orders\",\"position\":{\"start\":{\"line\":70,\"column\":3,\"offset\":3200},\"end\":{\"line\":70,\"column\":54,\"offset\":3251}}}],\"position\":{\"start\":{\"line\":70,\"column\":1,\"offset\":3198},\"end\":{\"line\":70,\"column\":54,\"offset\":3251}}},{\"type\":\"text\",\"value\":\"\\n\"},{\"type\":\"element\",\"tagName\":\"li\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"overestimate the cost for placing buy limit orders\",\"position\":{\"start\":{\"line\":71,\"column\":3,\"offset\":3254},\"end\":{\"line\":71,\"column\":53,\"offset\":3304}}}],\"position\":{\"start\":{\"line\":71,\"column\":1,\"offset\":3252},\"end\":{\"line\":71,\"column\":53,\"offset\":3304}}},{\"type\":\"text\",\"value\":\"\\n\"}],\"position\":{\"start\":{\"line\":69,\"column\":1,\"offset\":3144},\"end\":{\"line\":71,\"column\":53,\"offset\":3304}}},\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":\"overestimate the cost for matching into sell orders\"}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":\"underestimate the cost for matching into buy orders\"}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":\"overestimate the cost for placing buy limit orders\"}],\"\\n\"]}]]]}]}],false]}]}]]}]]}],null,[\"$\",\"$L2d\",\"informational\",{\"alignItems\":\"stretch\",\"as\":\"section\",\"gap\":4,\"children\":[[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":4,\"children\":[[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.informational\",\"borderRadius\":\"full\",\"boxSize\":4}],[\"$\",\"$L37\",null,{\"_before\":{\"content\":\"counter(report-severities) \\\".\\\"\"},\"alignItems\":\"center\",\"as\":\"h3\",\"display\":\"flex\",\"flexWrap\":\"wrap\",\"fontSize\":{\"base\":\"2xl\",\"md\":\"3xl\"},\"fontWeight\":\"semibold\",\"gap\":2,\"sx\":{\"counterIncrement\":\"report-severities\"},\"children\":[\"Informational\",[\"$\",\"$L2f\",null,{\"as\":\"span\",\"color\":\"gray.500\",\"children\":[2,\" \",\"findings\"]}]]}]]}],[\"$\",\"$L3b\",null,{\"m\":0,\"spacing\":8,\"styleType\":\"none\",\"sx\":{\"counterReset\":\"report-severity-findings\"},\"children\":[[\"$\",\"$L3c\",\"d26e4d46-b9cc-47b0-af68-9e72afeb4b7b\",{\"children\":[\"$\",\"$L2d\",\"d26e4d46-b9cc-47b0-af68-9e72afeb4b7b\",{\"alignItems\":\"flex-start\",\"as\":\"section\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"borderRadius\":\"md\",\"gap\":6,\"p\":8,\"children\":[[\"$\",\"$L37\",null,{\"_before\":{\"content\":\"counter(report-severities) \\\".\\\" counter(report-severity-findings) \\\" \\\"\"},\"as\":\"h4\",\"color\":\"gray.950\",\"fontSize\":{\"base\":\"2xl\",\"md\":\"3xl\"},\"fontWeight\":\"semibold\",\"sx\":{\"counterIncrement\":\"report-severity-findings\"},\"wordBreak\":\"break-word\",\"children\":[\"$\",\"$L3d\",null,{\"text\":\"Add invariant checks when adding and canceling orders\"}]}],[\"$\",\"$L2d\",null,{\"alignItems\":\"stretch\",\"as\":\"dl\",\"gap\":2,\"sx\":{\"w\":\"full\",\"containerType\":\"inline-size\"},\"children\":[[\"$\",\"$L2e\",\"State\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"State\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":2,\"children\":[[\"$\",\"$L3e\",null,{\"alignItems\":\"center\",\"bgColor\":\"status.bg.fixed\",\"border\":\"1px solid\",\"borderColor\":\"status.bg.fixed\",\"color\":\"status.fixed\",\"display\":\"inline-flex\",\"gap\":1.5,\"lineHeight\":\"1rem\",\"minWidth\":\"fit-content\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"role\":\"$undefined\",\"size\":\"sm\",\"children\":[[\"$\",\"$L3f\",null,{\"boxSize\":3.5,\"strokeWidth\":\"2px\",\"children\":[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-wrench\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"cbrjhi\",{\"d\":\"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z\"}],\"$undefined\"]}]}],[\"$\",\"$L40\",null,{\"color\":\"inherit\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":\"Fixed\"}]]}],[[\"$\",\"$L3e\",\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\",{\"_hover\":{\"bg\":\"gray.100\"},\"as\":\"a\",\"bg\":\"white\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"borderRadius\":\"full\",\"color\":\"gray.950\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\",\"maxW\":\"10rem\",\"size\":\"sm\",\"target\":\"_blank\",\"children\":[\"$\",\"$L2f\",null,{\"isTruncated\":true,\"children\":\"PR #106\"}]}]]]}]}]]}],[\"$\",\"$L2e\",\"Severity\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Severity\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":2,\"children\":[[\"$\",\"$L3e\",null,{\"ref\":\"$undefined\",\"alignItems\":\"center\",\"bgColor\":\"transparent\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"display\":\"flex\",\"gap\":\"0.375rem\",\"lineHeight\":\"1rem\",\"size\":\"sm\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"fontWeight\":\"600\",\"children\":[[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.informational\",\"borderRadius\":\"full\",\"boxSize\":\"0.5rem\"}],[\"$\",\"$L40\",null,{\"color\":\"gray.950\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":[[\"Severity\",\": \"],\"Informational\"]}]]}],false]}]}]]}],[\"$\",\"$L2e\",\"Submitted by\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Submitted by\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L33\",null,{\"alignItems\":\"center\",\"as\":\"$34\",\"display\":\"flex\",\"gap\":2,\"href\":\"/u/thereksfour\",\"prefetch\":false,\"children\":[[\"$\",\"$L35\",null,{\"height\":\"20px\",\"src\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/d5e6d378-e0c9-47e8-66eb-fba7e9ce9700/public\",\"width\":\"20px\"}],[\"$\",\"$L2f\",null,{\"fontSize\":\"xs\",\"children\":[\" \",\"cccz\"]}]]}]}]]}]]}],[\"$\",\"$L36\",null,{}],[\"$\",\"$L41\",null,{\"children\":[\"$\",\"$L20\",null,{\"alignSelf\":\"stretch\",\"bg\":\"transparent\",\"className\":\"markdown-body\",\"flex\":\"1\",\"flexDirection\":\"column\",\"fontFamily\":\"body\",\"fontSize\":\"sm\",\"position\":\"relative\",\"sx\":{\"\u0026 code[class*=\\\"language-\\\"],  \u0026 pre[class*=\\\"language-\\\"]\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 code[class*=\\\"language-\\\"],  \u0026 pre[class*=\\\"language-\\\"]\",\"\u0026 :not(pre)\u003ecode[class*=\\\"language-\\\"]\":{\"whiteSpace\":\"normal\",\"borderRadius\":\"0.2em\",\"padding\":\"0.1em\"},\"\u0026 pre[class*=\\\"language-\\\"]\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 pre[class*=\\\"language-\\\"]\",\"\u0026 [class*=\\\"language-\\\"] .namespace\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 [class*=\\\"language-\\\"] .namespace\",\"\u0026 :where(img, svg, video, canvas, audio, iframe, embed, object)\":{\"display\":\"initial\"},\"\u0026 h1\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 h1\",\"\u0026 h2\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 h2\",\"\u0026 .token.tag,\u0026 .token.selector,\u0026 .token.keyword,\u0026 .token.operator,\u0026 .token.atrule\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.tag,\u0026 .token.selector,\u0026 .token.keyword,\u0026 .token.operator,\u0026 .token.atrule\",\"\u0026 .token.comment,\u0026 .token.prolog,\u0026 .token.doctype,\u0026 .token.cdata\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.comment,\u0026 .token.prolog,\u0026 .token.doctype,\u0026 .token.cdata\",\"\u0026 .token.namespace\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.namespace\",\"\u0026 .token.string,\u0026 .token.attr-value,\u0026 .token.attribute,\u0026 .token.pseudo-class,\u0026 .token.pseudo-element\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.string,\u0026 .token.attr-value,\u0026 .token.attribute,\u0026 .token.pseudo-class,\u0026 .token.pseudo-element\",\"\u0026 .token.number,\u0026 .token.boolean,\u0026 .token.builtin,\u0026 .token.entity,\u0026 .token.url,\u0026 .token.symbol,\u0026 .token.variable,\u0026 .token.constant,\u0026 .token.property,\u0026 .token.regex,\u0026 .token.attr-name,\u0026 .token.unit,\u0026 .token.hexcode\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.number,\u0026 .token.boolean,\u0026 .token.builtin,\u0026 .token.entity,\u0026 .token.url,\u0026 .token.symbol,\u0026 .token.variable,\u0026 .token.constant,\u0026 .token.property,\u0026 .token.regex,\u0026 .token.attr-name,\u0026 .token.unit,\u0026 .token.hexcode\",\"\u0026 .token.punctuation,\u0026 .token.char,\u0026 .token.class\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.punctuation,\u0026 .token.char,\u0026 .token.class\",\"\u0026 .token.function,\u0026 .token.class-name,\u0026 .token.function-variable,\u0026 .token.id\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.function,\u0026 .token.class-name,\u0026 .token.function-variable,\u0026 .token.id\",\"\u0026 .token.important,\u0026 .token.bold\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.important,\u0026 .token.bold\",\"\u0026 .token.italic\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.italic\",\"\u0026 .token.deleted\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.deleted\",\"\u0026 .token.inserted\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.inserted\"},\"wordBreak\":\"break-word\",\"children\":[[\"$\",\"$L42\",null,{\"frontmatter\":{}}],[[\"$\",\"$L37\",\"h2-0\",{\"as\":\"h2\",\"id\":\"description\",\"mb\":\"5\",\"size\":\"xl\",\"node\":{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Description\",\"position\":{\"start\":{\"line\":1,\"column\":4,\"offset\":3},\"end\":{\"line\":1,\"column\":15,\"offset\":14}}}],\"position\":{\"start\":{\"line\":1,\"column\":1,\"offset\":0},\"end\":{\"line\":1,\"column\":15,\"offset\":14}}},\"children\":\"Description\"}],\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"The protocol modifies segments when adding/canceling/matching orders.\",\"position\":{\"start\":{\"line\":3,\"column\":1,\"offset\":16},\"end\":{\"line\":3,\"column\":70,\"offset\":85}}}],\"position\":{\"start\":{\"line\":3,\"column\":1,\"offset\":16},\"end\":{\"line\":3,\"column\":71,\"offset\":86}}},\"children\":\"The protocol modifies segments when adding/canceling/matching orders.\"}],\"\\n\",[\"$\",\"$L2f\",\"p-1\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"When matching orders, \",\"position\":{\"start\":{\"line\":5,\"column\":1,\"offset\":88},\"end\":{\"line\":5,\"column\":23,\"offset\":110}}},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://cantina.xyz/code/533c3043-fa7a-4275-8bae-e2313e1b5d18/findings/3\"},\"children\":[{\"type\":\"text\",\"value\":\"Finding #3\",\"position\":{\"start\":{\"line\":5,\"column\":24,\"offset\":111},\"end\":{\"line\":5,\"column\":34,\"offset\":121}}}],\"position\":{\"start\":{\"line\":5,\"column\":23,\"offset\":110},\"end\":{\"line\":5,\"column\":109,\"offset\":196}}},{\"type\":\"text\",\"value\":\" checks segments in \",\"position\":{\"start\":{\"line\":5,\"column\":109,\"offset\":196},\"end\":{\"line\":5,\"column\":129,\"offset\":216}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_consumePriceSegments()\",\"position\":{\"start\":{\"line\":5,\"column\":129,\"offset\":216},\"end\":{\"line\":5,\"column\":154,\"offset\":241}}}],\"position\":{\"start\":{\"line\":5,\"column\":129,\"offset\":216},\"end\":{\"line\":5,\"column\":154,\"offset\":241}}},{\"type\":\"text\",\"value\":\" to ensure that the segment state follows the invariant, and \",\"position\":{\"start\":{\"line\":5,\"column\":154,\"offset\":241},\"end\":{\"line\":5,\"column\":215,\"offset\":302}}},{\"type\":\"element\",\"tagName\":\"a\",\"properties\":{\"href\":\"https://cantina.xyz/code/533c3043-fa7a-4275-8bae-e2313e1b5d18/findings/6\"},\"children\":[{\"type\":\"text\",\"value\":\"Finding #6\",\"position\":{\"start\":{\"line\":5,\"column\":216,\"offset\":303},\"end\":{\"line\":5,\"column\":226,\"offset\":313}}}],\"position\":{\"start\":{\"line\":5,\"column\":215,\"offset\":302},\"end\":{\"line\":5,\"column\":301,\"offset\":388}}},{\"type\":\"text\",\"value\":\" also makes some assumption checks when modifying segments in \",\"position\":{\"start\":{\"line\":5,\"column\":301,\"offset\":388},\"end\":{\"line\":5,\"column\":363,\"offset\":450}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"_updateSegmentsAndTree()\",\"position\":{\"start\":{\"line\":5,\"column\":363,\"offset\":450},\"end\":{\"line\":5,\"column\":389,\"offset\":476}}}],\"position\":{\"start\":{\"line\":5,\"column\":363,\"offset\":450},\"end\":{\"line\":5,\"column\":389,\"offset\":476}}},{\"type\":\"text\",\"value\":\".\",\"position\":{\"start\":{\"line\":5,\"column\":389,\"offset\":476},\"end\":{\"line\":5,\"column\":390,\"offset\":477}}}],\"position\":{\"start\":{\"line\":5,\"column\":1,\"offset\":88},\"end\":{\"line\":5,\"column\":390,\"offset\":477}}},\"children\":[\"When matching orders, \",[\"$\",\"$L44\",\"a-0\",{\"repoId\":\"$undefined\",\"href\":\"https://cantina.xyz/code/533c3043-fa7a-4275-8bae-e2313e1b5d18/findings/3\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:4:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:4:props:node:children:1\",\"children\":\"Finding #3\"}],\" checks segments in \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"_consumePriceSegments()\",\"inline\":true,\"language\":\"text\"}],\" to ensure that the segment state follows the invariant, and \",[\"$\",\"$L44\",\"a-1\",{\"repoId\":\"$undefined\",\"href\":\"https://cantina.xyz/code/533c3043-fa7a-4275-8bae-e2313e1b5d18/findings/6\",\"node\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:4:props:children:1:props:children:0:props:children:props:children:3:props:children:props:children:1:4:props:node:children:5\",\"children\":\"Finding #6\"}],\" also makes some assumption checks when modifying segments in \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"_updateSegmentsAndTree()\",\"inline\":true,\"language\":\"text\"}],\".\"]}],\"\\n\",[\"$\",\"$L2f\",\"p-2\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"For adding/canceling orders, some invariant checks need to be added to ensure that the segment state is as expected.\",\"position\":{\"start\":{\"line\":7,\"column\":1,\"offset\":479},\"end\":{\"line\":7,\"column\":117,\"offset\":595}}}],\"position\":{\"start\":{\"line\":7,\"column\":1,\"offset\":479},\"end\":{\"line\":7,\"column\":117,\"offset\":595}}},\"children\":\"For adding/canceling orders, some invariant checks need to be added to ensure that the segment state is as expected.\"}],\"\\n\",[\"$\",\"$L2f\",\"p-3\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Below are all cases of slots in the segment.\",\"position\":{\"start\":{\"line\":9,\"column\":1,\"offset\":597},\"end\":{\"line\":9,\"column\":45,\"offset\":641}}}],\"position\":{\"start\":{\"line\":9,\"column\":1,\"offset\":597},\"end\":{\"line\":9,\"column\":45,\"offset\":641}}},\"children\":\"Below are all cases of slots in the segment.\"}],\"\\n\",[\"$\",\"$L45\",\"pre-0\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"(1) o o o  BAD\\n(2) o o x  ALLOW, holes Must be tail\\n(3) o x o  ALLOW, holes Must be head\u0026tail\\n(4) x o o  ALLOW, holes Must be head\\n(5) o x x  ALLOW, holes Must be tail\\n(6) x o x  BAD\\n(7) x x o  ALLOW, holes Must be head\\n(8) x x x  ALLOW, No holes\\n\"}],\"position\":{\"start\":{\"line\":10,\"column\":1,\"offset\":642},\"end\":{\"line\":19,\"column\":4,\"offset\":896}}}],\"position\":{\"start\":{\"line\":10,\"column\":1,\"offset\":642},\"end\":{\"line\":19,\"column\":4,\"offset\":896}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"(1) o o o  BAD\\n(2) o o x  ALLOW, holes Must be tail\\n(3) o x o  ALLOW, holes Must be head\u0026tail\\n(4) x o o  ALLOW, holes Must be head\\n(5) o x x  ALLOW, holes Must be tail\\n(6) x o x  BAD\\n(7) x x o  ALLOW, holes Must be head\\n(8) x x x  ALLOW, No holes\",\"inline\":false,\"language\":\"text\"}]}],[\"$\",\"$L46\",null,{\"content\":\"(1) o o o  BAD\\n(2) o o x  ALLOW, holes Must be tail\\n(3) o x o  ALLOW, holes Must be head\u0026tail\\n(4) x o o  ALLOW, holes Must be head\\n(5) o x x  ALLOW, holes Must be tail\\n(6) x o x  BAD\\n(7) x x o  ALLOW, holes Must be head\\n(8) x x x  ALLOW, No holes\\n\"}]]}],\"\\n\",[\"$\",\"$L37\",\"h2-1\",{\"as\":\"h2\",\"id\":\"recommendation\",\"mb\":\"5\",\"size\":\"xl\",\"node\":{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Recommendation\",\"position\":{\"start\":{\"line\":20,\"column\":4,\"offset\":900},\"end\":{\"line\":20,\"column\":18,\"offset\":914}}}],\"position\":{\"start\":{\"line\":20,\"column\":1,\"offset\":897},\"end\":{\"line\":20,\"column\":18,\"offset\":914}}},\"children\":\"Recommendation\"}],\"\\n\",[\"$\",\"$L2f\",\"p-4\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"For order additions.\",\"position\":{\"start\":{\"line\":21,\"column\":1,\"offset\":915},\"end\":{\"line\":21,\"column\":21,\"offset\":935}}}],\"position\":{\"start\":{\"line\":21,\"column\":1,\"offset\":915},\"end\":{\"line\":21,\"column\":21,\"offset\":935}}},\"children\":\"For order additions.\"}],\"\\n\",[\"$\",\"$L45\",\"pre-1\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-diff\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"$61\"}],\"position\":{\"start\":{\"line\":22,\"column\":1,\"offset\":936},\"end\":{\"line\":55,\"column\":4,\"offset\":2709}}}],\"position\":{\"start\":{\"line\":22,\"column\":1,\"offset\":936},\"end\":{\"line\":55,\"column\":4,\"offset\":2709}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"$62\",\"inline\":false,\"language\":\"diff\"}]}],[\"$\",\"$L46\",null,{\"content\":\"$63\"}]]}],\"\\n\",[\"$\",\"$L2f\",\"p-5\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"For order cancellation.\",\"position\":{\"start\":{\"line\":57,\"column\":1,\"offset\":2711},\"end\":{\"line\":57,\"column\":24,\"offset\":2734}}}],\"position\":{\"start\":{\"line\":57,\"column\":1,\"offset\":2711},\"end\":{\"line\":57,\"column\":24,\"offset\":2734}}},\"children\":\"For order cancellation.\"}],\"\\n\",[\"$\",\"$L45\",\"pre-2\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-diff\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"@@ -1410,6 +1428,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\\n         bytes10 nextSlot = currentOrNextSegment.getSlot(nextSlotIndex);\\n         if (nextSlot == 0) {\\n           // There are no more orders left, reset back to the currently iterated order as the last\\n+          // When reaching a hole, make sure it has iterated to the last order.\\n+          require(nextSegmentIndex == segments.length - 1, PriceSegmentHasAHole()); // Must iterate to the last seg\\n+          require(currentOrNextSegment.getRemainingSegment(nextSlotIndex) == 0, PriceSegmentHasAHole()); // nextSlot and subsequent slots must be empty\\n+          require(nextSlotIndex \u003e 0, LastPriceSegmentCannotBeEmpty()); // The last non-empty order must be in seg[seg.len-1](seg.len-1 cannot point to an empty segment).\\n           nextSegmentIndex = currentSegmentIndex;\\n           nextSlotIndex = currentSlotIndex;\\n           break;\\n\"}],\"position\":{\"start\":{\"line\":58,\"column\":1,\"offset\":2735},\"end\":{\"line\":70,\"column\":4,\"offset\":3689}}}],\"position\":{\"start\":{\"line\":58,\"column\":1,\"offset\":2735},\"end\":{\"line\":70,\"column\":4,\"offset\":3689}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"@@ -1410,6 +1428,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\\n         bytes10 nextSlot = currentOrNextSegment.getSlot(nextSlotIndex);\\n         if (nextSlot == 0) {\\n           // There are no more orders left, reset back to the currently iterated order as the last\\n+          // When reaching a hole, make sure it has iterated to the last order.\\n+          require(nextSegmentIndex == segments.length - 1, PriceSegmentHasAHole()); // Must iterate to the last seg\\n+          require(currentOrNextSegment.getRemainingSegment(nextSlotIndex) == 0, PriceSegmentHasAHole()); // nextSlot and subsequent slots must be empty\\n+          require(nextSlotIndex \u003e 0, LastPriceSegmentCannotBeEmpty()); // The last non-empty order must be in seg[seg.len-1](seg.len-1 cannot point to an empty segment).\\n           nextSegmentIndex = currentSegmentIndex;\\n           nextSlotIndex = currentSlotIndex;\\n           break;\",\"inline\":false,\"language\":\"diff\"}]}],[\"$\",\"$L46\",null,{\"content\":\"@@ -1410,6 +1428,10 @@ contract SonicOrderBook is UUPSUpgradeable, OwnableUpgradeable, ERC1155Holder, R\\n         bytes10 nextSlot = currentOrNextSegment.getSlot(nextSlotIndex);\\n         if (nextSlot == 0) {\\n           // There are no more orders left, reset back to the currently iterated order as the last\\n+          // When reaching a hole, make sure it has iterated to the last order.\\n+          require(nextSegmentIndex == segments.length - 1, PriceSegmentHasAHole()); // Must iterate to the last seg\\n+          require(currentOrNextSegment.getRemainingSegment(nextSlotIndex) == 0, PriceSegmentHasAHole()); // nextSlot and subsequent slots must be empty\\n+          require(nextSlotIndex \u003e 0, LastPriceSegmentCannotBeEmpty()); // The last non-empty order must be in seg[seg.len-1](seg.len-1 cannot point to an empty segment).\\n           nextSegmentIndex = currentSegmentIndex;\\n           nextSlotIndex = currentSlotIndex;\\n           break;\\n\"}]]}]]]}]}],false]}]}],[\"$\",\"$L3c\",\"0e21dae8-c652-4bdc-ada9-f3420fe41e67\",{\"children\":[\"$\",\"$L2d\",\"0e21dae8-c652-4bdc-ada9-f3420fe41e67\",{\"alignItems\":\"flex-start\",\"as\":\"section\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"borderRadius\":\"md\",\"gap\":6,\"p\":8,\"children\":[[\"$\",\"$L37\",null,{\"_before\":{\"content\":\"counter(report-severities) \\\".\\\" counter(report-severity-findings) \\\" \\\"\"},\"as\":\"h4\",\"color\":\"gray.950\",\"fontSize\":{\"base\":\"2xl\",\"md\":\"3xl\"},\"fontWeight\":\"semibold\",\"sx\":{\"counterIncrement\":\"report-severity-findings\"},\"wordBreak\":\"break-word\",\"children\":[\"$\",\"$L3d\",null,{\"text\":\"Use `quantityFulfilled` for sell market orders when transferring NFTs\"}]}],[\"$\",\"$L2d\",null,{\"alignItems\":\"stretch\",\"as\":\"dl\",\"gap\":2,\"sx\":{\"w\":\"full\",\"containerType\":\"inline-size\"},\"children\":[[\"$\",\"$L2e\",\"State\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"State\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":2,\"children\":[[\"$\",\"$L3e\",null,{\"alignItems\":\"center\",\"bgColor\":\"status.bg.fixed\",\"border\":\"1px solid\",\"borderColor\":\"status.bg.fixed\",\"color\":\"status.fixed\",\"display\":\"inline-flex\",\"gap\":1.5,\"lineHeight\":\"1rem\",\"minWidth\":\"fit-content\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"role\":\"$undefined\",\"size\":\"sm\",\"children\":[[\"$\",\"$L3f\",null,{\"boxSize\":3.5,\"strokeWidth\":\"2px\",\"children\":[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-wrench\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"cbrjhi\",{\"d\":\"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z\"}],\"$undefined\"]}]}],[\"$\",\"$L40\",null,{\"color\":\"inherit\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":\"Fixed\"}]]}],[[\"$\",\"$L3e\",\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\",{\"_hover\":{\"bg\":\"gray.100\"},\"as\":\"a\",\"bg\":\"white\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"borderRadius\":\"full\",\"color\":\"gray.950\",\"href\":\"https://github.com/PaintSwap/sonic-airdrop-contracts/pull/106\",\"maxW\":\"10rem\",\"size\":\"sm\",\"target\":\"_blank\",\"children\":[\"$\",\"$L2f\",null,{\"isTruncated\":true,\"children\":\"PR #106\"}]}]]]}]}]]}],[\"$\",\"$L2e\",\"Severity\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Severity\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L30\",null,{\"flexWrap\":\"wrap\",\"gap\":2,\"children\":[[\"$\",\"$L3e\",null,{\"ref\":\"$undefined\",\"alignItems\":\"center\",\"bgColor\":\"transparent\",\"border\":\"1px solid\",\"borderColor\":\"chakra-border-color\",\"display\":\"flex\",\"gap\":\"0.375rem\",\"lineHeight\":\"1rem\",\"size\":\"sm\",\"px\":\"0.375rem\",\"py\":\"0.125rem\",\"fontWeight\":\"600\",\"children\":[[\"$\",\"$L3a\",null,{\"backgroundColor\":\"severity.informational\",\"borderRadius\":\"full\",\"boxSize\":\"0.5rem\"}],[\"$\",\"$L40\",null,{\"color\":\"gray.950\",\"fontSize\":\"inherit\",\"lineHeight\":\"1rem\",\"textTransform\":\"capitalize\",\"children\":[[\"Severity\",\": \"],\"Informational\"]}]]}],false]}]}]]}],[\"$\",\"$L2e\",\"Submitted by\",{\"alignItems\":\"center\",\"gap\":1,\"gridTemplateColumns\":\"120px 1fr\",\"sx\":{\"@container (max-width: 350px)\":{\"gridTemplateColumns\":\"1fr\",\"\u003e dt\":{\"fontWeight\":\"bold\"}}},\"children\":[[\"$\",\"$L20\",null,{\"alignItems\":\"center\",\"alignSelf\":\"start\",\"as\":\"dt\",\"minH\":6,\"children\":[\"$\",\"$L2f\",null,{\"color\":\"gray.500\",\"fontSize\":\"xs\",\"fontWeight\":\"medium\",\"children\":\"Submitted by\"}]}],[\"$\",\"$L30\",null,{\"as\":\"dd\",\"gap\":0,\"minH\":6,\"children\":[\"$\",\"$L33\",null,{\"alignItems\":\"center\",\"as\":\"$34\",\"display\":\"flex\",\"gap\":2,\"href\":\"/u/Saw-mon-and-Natalie\",\"prefetch\":false,\"children\":[[\"$\",\"$L35\",null,{\"height\":\"20px\",\"src\":\"https://imagedelivery.net/wtv4_V7VzVsxpAFaxzmpbw/8039eb9a-b849-4701-675d-fd94168a3300/public\",\"width\":\"20px\"}],[\"$\",\"$L2f\",null,{\"fontSize\":\"xs\",\"children\":[\" \",\"Saw-mon and Natalie\"]}]]}]}]]}]]}],[\"$\",\"$L36\",null,{}],[\"$\",\"$L41\",null,{\"children\":[\"$\",\"$L20\",null,{\"alignSelf\":\"stretch\",\"bg\":\"transparent\",\"className\":\"markdown-body\",\"flex\":\"1\",\"flexDirection\":\"column\",\"fontFamily\":\"body\",\"fontSize\":\"sm\",\"position\":\"relative\",\"sx\":{\"\u0026 code[class*=\\\"language-\\\"],  \u0026 pre[class*=\\\"language-\\\"]\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 code[class*=\\\"language-\\\"],  \u0026 pre[class*=\\\"language-\\\"]\",\"\u0026 :not(pre)\u003ecode[class*=\\\"language-\\\"]\":{\"whiteSpace\":\"normal\",\"borderRadius\":\"0.2em\",\"padding\":\"0.1em\"},\"\u0026 pre[class*=\\\"language-\\\"]\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 pre[class*=\\\"language-\\\"]\",\"\u0026 [class*=\\\"language-\\\"] .namespace\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 [class*=\\\"language-\\\"] .namespace\",\"\u0026 :where(img, svg, video, canvas, audio, iframe, embed, object)\":{\"display\":\"initial\"},\"\u0026 h1\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 h1\",\"\u0026 h2\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 h2\",\"\u0026 .token.tag,\u0026 .token.selector,\u0026 .token.keyword,\u0026 .token.operator,\u0026 .token.atrule\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.tag,\u0026 .token.selector,\u0026 .token.keyword,\u0026 .token.operator,\u0026 .token.atrule\",\"\u0026 .token.comment,\u0026 .token.prolog,\u0026 .token.doctype,\u0026 .token.cdata\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.comment,\u0026 .token.prolog,\u0026 .token.doctype,\u0026 .token.cdata\",\"\u0026 .token.namespace\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.namespace\",\"\u0026 .token.string,\u0026 .token.attr-value,\u0026 .token.attribute,\u0026 .token.pseudo-class,\u0026 .token.pseudo-element\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.string,\u0026 .token.attr-value,\u0026 .token.attribute,\u0026 .token.pseudo-class,\u0026 .token.pseudo-element\",\"\u0026 .token.number,\u0026 .token.boolean,\u0026 .token.builtin,\u0026 .token.entity,\u0026 .token.url,\u0026 .token.symbol,\u0026 .token.variable,\u0026 .token.constant,\u0026 .token.property,\u0026 .token.regex,\u0026 .token.attr-name,\u0026 .token.unit,\u0026 .token.hexcode\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.number,\u0026 .token.boolean,\u0026 .token.builtin,\u0026 .token.entity,\u0026 .token.url,\u0026 .token.symbol,\u0026 .token.variable,\u0026 .token.constant,\u0026 .token.property,\u0026 .token.regex,\u0026 .token.attr-name,\u0026 .token.unit,\u0026 .token.hexcode\",\"\u0026 .token.punctuation,\u0026 .token.char,\u0026 .token.class\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.punctuation,\u0026 .token.char,\u0026 .token.class\",\"\u0026 .token.function,\u0026 .token.class-name,\u0026 .token.function-variable,\u0026 .token.id\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.function,\u0026 .token.class-name,\u0026 .token.function-variable,\u0026 .token.id\",\"\u0026 .token.important,\u0026 .token.bold\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.important,\u0026 .token.bold\",\"\u0026 .token.italic\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.italic\",\"\u0026 .token.deleted\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.deleted\",\"\u0026 .token.inserted\":\"$e:props:children:1:props:children:props:children:1:1:props:children:1:props:children:1:1:props:children:0:props:children:1:props:children:0:props:children:props:children:3:props:children:props:sx:\u0026 .token.inserted\"},\"wordBreak\":\"break-word\",\"children\":[[\"$\",\"$L42\",null,{\"frontmatter\":{}}],[[\"$\",\"$L37\",\"h2-0\",{\"as\":\"h2\",\"id\":\"description\",\"mb\":\"5\",\"size\":\"xl\",\"node\":{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Description\",\"position\":{\"start\":{\"line\":1,\"column\":4,\"offset\":3},\"end\":{\"line\":1,\"column\":15,\"offset\":14}}}],\"position\":{\"start\":{\"line\":1,\"column\":1,\"offset\":0},\"end\":{\"line\":1,\"column\":15,\"offset\":14}}},\"children\":\"Description\"}],\"\\n\",[\"$\",\"$L2f\",\"p-0\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"order.quantity\",\"position\":{\"start\":{\"line\":3,\"column\":1,\"offset\":16},\"end\":{\"line\":3,\"column\":17,\"offset\":32}}}],\"position\":{\"start\":{\"line\":3,\"column\":1,\"offset\":16},\"end\":{\"line\":3,\"column\":17,\"offset\":32}}},{\"type\":\"text\",\"value\":\" and \",\"position\":{\"start\":{\"line\":3,\"column\":17,\"offset\":32},\"end\":{\"line\":3,\"column\":22,\"offset\":37}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"quantityFulfilled\",\"position\":{\"start\":{\"line\":3,\"column\":22,\"offset\":37},\"end\":{\"line\":3,\"column\":41,\"offset\":56}}}],\"position\":{\"start\":{\"line\":3,\"column\":22,\"offset\":37},\"end\":{\"line\":3,\"column\":41,\"offset\":56}}},{\"type\":\"text\",\"value\":\" are supposed to have the same value in this branch (sell market orders need to use exact quantity).\",\"position\":{\"start\":{\"line\":3,\"column\":41,\"offset\":56},\"end\":{\"line\":3,\"column\":141,\"offset\":156}}}],\"position\":{\"start\":{\"line\":3,\"column\":1,\"offset\":16},\"end\":{\"line\":3,\"column\":141,\"offset\":156}}},\"children\":[[\"$\",\"$L43\",\"code-0\",{\"code\":\"order.quantity\",\"inline\":true,\"language\":\"text\"}],\" and \",[\"$\",\"$L43\",\"code-1\",{\"code\":\"quantityFulfilled\",\"inline\":true,\"language\":\"text\"}],\" are supposed to have the same value in this branch (sell market orders need to use exact quantity).\"]}],\"\\n\",[\"$\",\"$L37\",\"h2-1\",{\"as\":\"h2\",\"id\":\"recommendation\",\"mb\":\"5\",\"size\":\"xl\",\"node\":{\"type\":\"element\",\"tagName\":\"h2\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"Recommendation\",\"position\":{\"start\":{\"line\":5,\"column\":4,\"offset\":161},\"end\":{\"line\":5,\"column\":18,\"offset\":175}}}],\"position\":{\"start\":{\"line\":5,\"column\":1,\"offset\":158},\"end\":{\"line\":5,\"column\":18,\"offset\":175}}},\"children\":\"Recommendation\"}],\"\\n\",[\"$\",\"$L2f\",\"p-1\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"but to avoid future foot gun it would be best to use \",\"position\":{\"start\":{\"line\":7,\"column\":1,\"offset\":177},\"end\":{\"line\":7,\"column\":54,\"offset\":230}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"quantityFulfilled\",\"position\":{\"start\":{\"line\":7,\"column\":54,\"offset\":230},\"end\":{\"line\":7,\"column\":73,\"offset\":249}}}],\"position\":{\"start\":{\"line\":7,\"column\":54,\"offset\":230},\"end\":{\"line\":7,\"column\":73,\"offset\":249}}},{\"type\":\"text\",\"value\":\" here:\",\"position\":{\"start\":{\"line\":7,\"column\":73,\"offset\":249},\"end\":{\"line\":7,\"column\":79,\"offset\":255}}}],\"position\":{\"start\":{\"line\":7,\"column\":1,\"offset\":177},\"end\":{\"line\":7,\"column\":79,\"offset\":255}}},\"children\":[\"but to avoid future foot gun it would be best to use \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"quantityFulfilled\",\"inline\":true,\"language\":\"text\"}],\" here:\"]}],\"\\n\",[\"$\",\"$L45\",\"pre-0\",{\"style\":{\"position\":\"relative\"},\"whiteSpace\":\"pre-wrap\",\"node\":{\"type\":\"element\",\"tagName\":\"pre\",\"properties\":{},\"children\":[{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-solidity\"],\"inline\":false},\"children\":[{\"type\":\"text\",\"value\":\"_safeTransferNFTsToUs(sender, order.tokenId, quantityFulfilled);\\n\"}],\"position\":{\"start\":{\"line\":9,\"column\":1,\"offset\":257},\"end\":{\"line\":11,\"column\":4,\"offset\":337}}}],\"position\":{\"start\":{\"line\":9,\"column\":1,\"offset\":257},\"end\":{\"line\":11,\"column\":4,\"offset\":337}}},\"children\":[[\"$\",\"$L45\",null,{\"as\":\"pre\",\"className\":\"$undefined\",\"style\":{\"overflow\":\"auto\",\"overflowWrap\":\"anywhere\",\"whiteSpace\":\"pre-wrap\"},\"children\":[\"$\",\"$L43\",\"code-0\",{\"code\":\"_safeTransferNFTsToUs(sender, order.tokenId, quantityFulfilled);\",\"inline\":false,\"language\":\"solidity\"}]}],[\"$\",\"$L46\",null,{\"content\":\"_safeTransferNFTsToUs(sender, order.tokenId, quantityFulfilled);\\n\"}]]}],\"\\n\",[\"$\",\"$L2f\",\"p-2\",{\"mb\":\"3\",\"node\":{\"type\":\"element\",\"tagName\":\"p\",\"properties\":{},\"children\":[{\"type\":\"text\",\"value\":\"This is due to the fact that if the check regarding exact quantities gets modified the actual value traded would be \",\"position\":{\"start\":{\"line\":13,\"column\":1,\"offset\":339},\"end\":{\"line\":13,\"column\":117,\"offset\":455}}},{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"inline\":true},\"children\":[{\"type\":\"text\",\"value\":\"quantityFulfilled\",\"position\":{\"start\":{\"line\":13,\"column\":117,\"offset\":455},\"end\":{\"line\":13,\"column\":136,\"offset\":474}}}],\"position\":{\"start\":{\"line\":13,\"column\":117,\"offset\":455},\"end\":{\"line\":13,\"column\":136,\"offset\":474}}},{\"type\":\"text\",\"value\":\".\",\"position\":{\"start\":{\"line\":13,\"column\":136,\"offset\":474},\"end\":{\"line\":13,\"column\":137,\"offset\":475}}}],\"position\":{\"start\":{\"line\":13,\"column\":1,\"offset\":339},\"end\":{\"line\":13,\"column\":137,\"offset\":475}}},\"children\":[\"This is due to the fact that if the check regarding exact quantities gets modified the actual value traded would be \",[\"$\",\"$L43\",\"code-0\",{\"code\":\"quantityFulfilled\",\"inline\":true,\"language\":\"text\"}],\".\"]}]]]}]}],false]}]}]]}]]}],null]}]]]}]]}]]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"14:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"12:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Sonic Airdrop Contracts | Cantina\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"From 25 July 2025 to 30 July 2025 a Cantina assembled team conducted a review of Sonic Airdrop Contracts of https://github.com/PaintSwap/sonic-airdrop-contracts on commit hash 09a09846e01e2a471b593ad7052fde9160ddb154.\"}],[\"$\",\"meta\",\"3\",{\"name\":\"robots\",\"content\":\"index, follow\"}],[\"$\",\"link\",\"4\",{\"rel\":\"canonical\",\"href\":\"https://cantina.xyz/portfolio/80b2fc65-3c2e-4ae7-8e48-6383fa936e6d\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:title\",\"content\":\"Sonic Airdrop Contracts | Cantina\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:description\",\"content\":\"From 25 July 2025 to 30 July 2025 a Cantina assembled team conducted a review of Sonic Airdrop Contracts of https://github.com/PaintSwap/sonic-airdrop-contracts on commit hash 09a09846e01e2a471b593ad7052fde9160ddb154.\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:url\",\"content\":\"https://cantina.xyz/portfolio/80b2fc65-3c2e-4ae7-8e48-6383fa936e6d\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:site_name\",\"content\":\"Cantina\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:locale\",\"content\":\"en_US\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:image:alt\",\"content\":\"Portfolio report Sonic Airdrop Contracts cover\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:image:type\",\"content\":\"image/png\"}],[\"$\",\"meta\",\"12\",{\"property\":\"og:image\",\"content\":\"https://cantina.xyz/portfolio/80b2fc65-3c2e-4ae7-8e48-6383fa936e6d/opengraph-image-1txs31/default?28e4039fb4c32605\"}],[\"$\",\"meta\",\"13\",{\"property\":\"og:image:width\",\"content\":\"1200\"}],[\"$\",\"meta\",\"14\",{\"property\":\"og:image:height\",\"content\":\"630\"}],[\"$\",\"meta\",\"15\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"16\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"17\",{\"name\":\"twitter:site\",\"content\":\"@cantinaxyz\"}],[\"$\",\"meta\",\"18\",{\"name\":\"twitter:creator\",\"content\":\"@cantinaxyz\"}],[\"$\",\"meta\",\"19\",{\"name\":\"twitter:title\",\"content\":\"Sonic Airdrop Contracts | Cantina\"}],[\"$\",\"meta\",\"20\",{\"name\":\"twitter:description\",\"content\":\"From 25 July 2025 to 30 July 2025 a Cantina assembled team conducted a review of Sonic Airdrop Contracts of https://github.com/PaintSwap/sonic-airdrop-contracts on commit hash 09a09846e01e2a471b593ad7052fde9160ddb154.\"}],[\"$\",\"meta\",\"21\",{\"name\":\"twitter:image:type\",\"content\":\"image/png\"}],[\"$\",\"meta\",\"22\",{\"name\":\"twitter:image\",\"content\":\"https://cantina.xyz/portfolio/80b2fc65-3c2e-4ae7-8e48-6383fa936e6d/twitter-image-1txs31?e253867fbbe1849c\"}],[\"$\",\"link\",\"23\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"48x48\"}],[\"$\",\"link\",\"24\",{\"rel\":\"icon\",\"href\":\"/icon.svg?f8ffad73bfade710\",\"type\":\"image/svg+xml\",\"sizes\":\"any\"}],[\"$\",\"link\",\"25\",{\"rel\":\"apple-touch-icon\",\"href\":\"/apple-icon.png?b59cca6bd6dadda0\",\"type\":\"image/png\",\"sizes\":\"512x512\"}]]\n"])</script><script>self.__next_f.push([1,"10:null\n"])</script></body></html>